



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/udet/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Udet - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#calculation-of-u-and-j-using-cococcionis-approach" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  DFT_PLUS_U
                </span>
              
            
            Udet
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" checked>
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Udet
      </label>
    
    <a href="./" title="Udet" class="md-nav__link md-nav__link--active">
      Udet
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-approach" title="How to determine U for DFT+U in ABINIT ? Cococcioni's approach." class="md-nav__link">
    How to determine U for DFT+U in ABINIT ? Cococcioni's approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-linear-response-method-to-determine-u" title="1 Summary of linear response method to determine U" class="md-nav__link">
    1 Summary of linear response method to determine U
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-determine-u-in-abinit" title="2 Determine U in ABINIT" class="md-nav__link">
    2 Determine U in ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-ujdet-utility" title="3 The ujdet utility" class="md-nav__link">
    3 The ujdet utility
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-approach" title="How to determine U for DFT+U in ABINIT ? Cococcioni's approach." class="md-nav__link">
    How to determine U for DFT+U in ABINIT ? Cococcioni's approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-linear-response-method-to-determine-u" title="1 Summary of linear response method to determine U" class="md-nav__link">
    1 Summary of linear response method to determine U
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-determine-u-in-abinit" title="2 Determine U in ABINIT" class="md-nav__link">
    2 Determine U in ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-ujdet-utility" title="3 The ujdet utility" class="md-nav__link">
    3 The ujdet utility
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/udet.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="calculation-of-u-and-j-using-cococcionis-approach">Calculation of U and J using Cococcioni&rsquo;s approach<a class="headerlink" href="#calculation-of-u-and-j-using-cococcionis-approach" title="Permanent link">&para;</a></h1>
<h2 id="how-to-determine-u-for-dftu-in-abinit-cococcionis-approach">How to determine U for DFT+U in ABINIT ? Cococcioni&rsquo;s approach.<a class="headerlink" href="#how-to-determine-u-for-dftu-in-abinit-cococcionis-approach" title="Permanent link">&para;</a></h2>
<p>This lesson aims to show how you can determine U for further DFT+U
calculations consistently and in a fast an easy way. You will learn to prepare
the input files for the determination and to use the main parameters implemented for this aim.<br />
It is supposed that you already know how to run ABINIT in the PAW mode (lesson <a href="../paw1">PAW1</a>). 
Obviously, you should also read the lesson <a href="../dftu">DFT+U</a>, and likely the lesson  <a href="../paw2">PAW2</a>, 
to generate PAW atomic data.  </p>
<p>This lesson should take about &frac12; hour.</p>
<h2 id="1-summary-of-linear-response-method-to-determine-u">1 Summary of linear response method to determine U<a class="headerlink" href="#1-summary-of-linear-response-method-to-determine-u" title="Permanent link">&para;</a></h2>
<p>The linear response method has been introduced by several authors [1-6]. It is
based on the fact that U corresponds to the energy to localize an additional
electron on the same site: U=E[n+1]+E[n-1]-2E[n] [4]. This can be reformulated
as the response to an infinitesimal change of of occupation of the orbital by
the electrons dn. Then U is the second derivative of the energy with respect
to the occupation U=d^2E/ d^2n. The first method fixed the occupation by
cutting the hopping terms of localized orbitals. Later propositions
constrained the occupation through Lagrange multipliers [3,5]. The Lagrange
multiplier \alpha corresponds to a local potential that has to be applied to
augment or decrease the occupation by &plusmn;1 electron. Note that the occupation
need not to vary by 1 electron, but the occupation shift can be infinitesimal.</p>
<p>It is recommended to read the following papers to understand the basic
concepts of the linear response calculations to calculate U:</p>
<p>[1] &ldquo;A LDA+U study of selected iron compounds &ldquo;, M. Cococcioni, Ph.D. thesis,
International School for Advanced Studies (SISSA), Trieste (2002)<br />
[2] &ldquo;Linear response approach to the calculation of the effective interaction
parameters in the LDA + U method&rdquo;, M. Cococcioni and S. de Gironcoli, Physical
Review B 71, 035105 (2005)  </p>
<p>Some further reading:</p>
<p>[3] &ldquo;Ground States of Constrained Systems: Application to Cerium Impurities&rdquo;,
P. H. Dederichs, S. Blugel, R. Zeller, and H. Akai, Phys. Rev. Lett. 53, 2512 (1984)<br />
[4] &ldquo;Calculation of Coulomb-interaction parameters for La2CuO4 using a
constrained-density-functional approach&rdquo;, M. S. Hybertsen, M. Schluter, and N.
E. Christensen, Phys. Rev. B 39, 9028 (1989)<br />
[5] &ldquo;Density-functional calculation of effective Coulomb interactions in
metals&rdquo;, V. I. Anisimov and O. Gunnarsson, Phys. Rev. B42, 7570 (1991)<br />
[6] &ldquo;Reformulation of the LDA+U method for a local-orbital basis&rdquo;, W. E.
Pickett, S. C. Erwin, and E. C. Ethridge, Phys. Rev. B58, 1201 (1998)  </p>
<p>The implementation of the determination of U in ABINIT is described in the
following paper, soon to appear:</p>
<p>[7] &ldquo;Consistent determination of U in the PAW approximation&rdquo;, D. Adams, B.
Amadon, S. Biermann, unpublished (2010)</p>
<h2 id="2-determine-u-in-abinit">2 Determine U in ABINIT<a class="headerlink" href="#2-determine-u-in-abinit" title="Permanent link">&para;</a></h2>
<p><em>Before continuing, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_udet&rdquo;?</em> </p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In what follows, the name of files are mentioned as if you were in this subdirectory.<br />
All the input files can be found in the ~abinit/tests/tutorial/Input directory
 You can compare your results with reference output files located in
_~abinit/tests/tutorial/Refs directories (for the present tutorial they are named tudet*.out).</p>
</div>
<p>The input file tudet_1.in is an example of a file to prepare a wave function
for further processing. You might use the file tudet_1.files as a &ldquo;files&rdquo;
file, and get the corresponding output file ../Refs/tudet_1.out).  </p>
<p>Copy the files tudet_1.in and tudet_1.files in your work directory, and run ABINIT:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tudet_1.files &gt; tudet_1.log
</pre></div>


<p>In the meantime, you can read the input file and see that this is a usual
DFT+U calculation, with U=0. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-b022e2a5-c6da-4f74-abb3-79a42eb38329" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tudet_1.files
</button>
<button type="button" id="uuid-1586c1b6-5641-4c0e-94dc-3569753f8fe2" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tudet_1.in
</button>
</div></div>

<div id="uuid-47eb1b8d-ffa1-4a49-ac52-96dd4780d9ff" class="my_dialog" title="tests/tutorial/Input/tudet_1.files" hidden><div><pre class="small-text">
tudet_1.in
tudet_1.out
tudet_1i
tudet_1o
tudet_1x
../../../Psps_for_tests/26fe.paw

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-47eb1b8d-ffa1-4a49-ac52-96dd4780d9ff", "#uuid-b022e2a5-c6da-4f74-abb3-79a42eb38329") }); </script>

<div id="uuid-5debaa73-9931-4d94-8077-af4d69738845" class="my_dialog" title="tests/tutorial/Input/tudet_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Automatic test for ABINIT:                                    #</span>
<span class="c1"># Prelimirary step for test v5#39 (macro_uj)                    #</span>
<span class="c1">#                       and v5#40 (testirdden)                  #</span>
<span class="c1">#                                                               #</span>
<span class="c1"># Fe bcc 2 atomic supercell - ferromag.- PAW DJA 2010 &amp; MT 2009 #</span>
<span class="c1">#################################################################</span>
<span class="c1">#Unit cell</span>
      acell  <span class="m">3</span>*5.42
    chkprim  <span class="m">0</span>                  <span class="c1"># 0: do not check if uc primitive</span>
      rprim  <span class="m">1</span>.00 <span class="m">0</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">1</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">0</span>.00 <span class="m">1</span>.00

<span class="c1">#Spin polarization</span>
      nsppol  <span class="m">2</span>                    <span class="c1">#1 unpolarized / 2 polarized</span>
      spinat  <span class="m">0</span> <span class="m">0</span>  <span class="m">2</span>.843062
              <span class="m">0</span> <span class="m">0</span>  <span class="m">2</span>.843062


<span class="c1">#Definition of the atom types</span>
     ntypat  <span class="m">1</span>
      znucl  <span class="m">26</span>

<span class="c1">#Definition of the atoms</span>
      natom  <span class="m">2</span>
      typat  <span class="m">2</span>*1               <span class="c1"># atomic types</span>
       xred
             <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
             <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
       ecut  <span class="m">8</span>                   <span class="c1"># Energy cutoff</span>
  pawecutdg  <span class="m">20</span>                  <span class="c1"># pawecutdg &gt; 2*ecut</span>
      nband  <span class="m">25</span>                  <span class="c1"># Fe_2 minband=17</span>

<span class="c1">#Definition of the SCF procedure</span>
      nstep  <span class="m">15</span>                  <span class="c1"># max  number SCF cycles</span>
      tolvrs 10d-12

<span class="c1">#Definition of the k-point grid</span>
     kptopt  <span class="m">1</span>                    <span class="c1"># 1:  automatic generation of k points</span>
      ngkpt  <span class="m">3</span> <span class="m">3</span> <span class="m">3</span>                <span class="c1"># n x n x n</span>
    nshiftk  <span class="m">1</span>
     shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Smearing</span>
     occopt  <span class="m">4</span>
     tsmear  <span class="m">0</span>.05 eV

<span class="c1">#DFT+U</span>
    usepawu  <span class="m">1</span>                    <span class="c1"># 1 at lim dble cnt / 2 rnd m fld dle cnt</span>
      lpawu  <span class="m">2</span>                    <span class="c1"># ang moments corrrected</span>

<span class="c1">#Save disk space &amp; Miscelaneous</span>
     prteig  <span class="m">0</span>
     prtden  <span class="m">1</span>                    <span class="c1"># This is the default value    </span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tudet_1.in, tudet_2.in, tudet_3.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tudet_1.out, tolnlines=  2, tolabs=  7.000e-09, tolrel=  2.000e-10</span>
<span class="c1">#%% psp_files =  26fe.paw</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW, LDAU</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Fe bcc 2 atomic supercell - ferromag.- PAW DJA 2010 &amp; MT 2009</span>
<span class="c1">#%%   Prelimirary step for test v5#39 (macro_uj) </span>
<span class="c1">#%%                         and v5#40 (testirdden)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5debaa73-9931-4d94-8077-af4d69738845", "#uuid-1586c1b6-5641-4c0e-94dc-3569753f8fe2") }); </script>

<p>This setting allows us to read the occupations of
the Fe 3d orbitals (<a class="wikilink codevar-wikilink" href="../../variables/paw#lpawu">lpawu</a> 2). The cell contains 2 atoms. This is the
minimum to get reasonable response matrices. We converge the electronic
structure to a high accuracy (<a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> 10d-12), which usually allows to
determine occupations with a precision of 10d-10. The <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> is chosen very low,
in order to accelerate calculations.<br />
We do not suppress the writing of the _WFK file, because this is the input for
the calculations of U.</p>
<p>Once this calculation has finished, run the second one:<br />
Copy the files tudet_2.in and tudet_2.files in your work directory, and run ABINIT:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tudet_2.files &gt; tudet_1.log
</pre></div>


<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-03cccdb1-b356-4b81-956d-bb34737cd675" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tudet_2.files
</button>
<button type="button" id="uuid-020217df-f9ac-47a2-93b3-d1ea02789c45" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tudet_2.in
</button>
</div></div>

<div id="uuid-59263c65-5df8-4d45-a421-94dc7853aab3" class="my_dialog" title="tests/tutorial/Input/tudet_2.files" hidden><div><pre class="small-text">
tudet_2.in
tudet_2.out
tudet_1o 
tudet_2o
tudet_2x
../../../Psps_for_tests/26fe.paw

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-59263c65-5df8-4d45-a421-94dc7853aab3", "#uuid-03cccdb1-b356-4b81-956d-bb34737cd675") }); </script>

<div id="uuid-d5080ea4-aa1c-4682-afb9-0a68e0f107a0" class="my_dialog" title="tests/tutorial/Input/tudet_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">###################################################################</span>
<span class="c1">## Automatic test for ABINIT:                                    ##</span>
<span class="c1">## determine U from change of occupation on atoms upon potential ##</span>
<span class="c1">##  shift on atom 1                                              ##</span>
<span class="c1">## Fe bcc structure - ferromagnetic PAW                 DJA 2010 ##</span>
<span class="c1">###################################################################</span>

<span class="c1"># 2 atomic supercell</span>
      acell  <span class="m">3</span>*5.42
    chkprim  <span class="m">0</span>                  <span class="c1"># 0: do not check if uc primitive</span>
      rprim  <span class="m">1</span>.00 <span class="m">0</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">1</span>.00 <span class="m">0</span>.00
             <span class="m">0</span>.00 <span class="m">0</span>.00 <span class="m">1</span>.00
     nsppol  <span class="m">2</span>        

<span class="c1">#Definition of the atom types</span>
     ntypat  <span class="m">1</span>
      znucl  <span class="m">26</span>

<span class="c1">#Definition of the atoms</span>
      natom  <span class="m">2</span>
      typat  <span class="m">2</span>*1               <span class="c1"># atomic types</span>
       xred
             <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
             <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
       ecut  <span class="m">8</span>                   <span class="c1"># Energy cutoff</span>
  pawecutdg  <span class="m">40</span>                  <span class="c1"># pawecutdg &gt; 2*ecut</span>
      nband  <span class="m">25</span>                  <span class="c1"># Fe_2 minband=17</span>

<span class="c1">#Definition of the k-point grid</span>
     kptopt  <span class="m">1</span>                    <span class="c1"># 1:  automatic generation of k points</span>
      ngkpt  <span class="m">3</span> <span class="m">3</span> <span class="m">3</span>                <span class="c1"># n x n x n</span>
    nshiftk  <span class="m">1</span>
     shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Smearing</span>
     occopt  <span class="m">4</span>
     tsmear  <span class="m">0</span>.05 eV

<span class="c1">#DFT+U</span>
    usepawu  <span class="m">1</span>                    <span class="c1"># 1 at lim dble cnt / 2 rnd m fld dle cnt</span>
      lpawu  <span class="m">2</span>                    <span class="c1"># ang moments corrrected</span>
       nsym  <span class="m">48</span>                   <span class="c1"># nsym&amp;symrel: break cubic symmetry of crystal: allow </span>
                                  <span class="c1"># individual ionicoccupations</span>
     symrel   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
             -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>       <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>
              <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>      -1  <span class="m">0</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span> -1  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span> -1  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>
              <span class="m">0</span>  <span class="m">0</span>  <span class="m">1</span>   <span class="m">0</span> -1  <span class="m">0</span>  -1  <span class="m">0</span>  <span class="m">0</span>       <span class="m">0</span>  <span class="m">0</span> -1   <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
    pawujat  <span class="m">1</span>                    <span class="c1"># default, the atom on which U is determined</span>
     pawujv  <span class="m">0</span>.1 eV               <span class="c1"># default, size of the potential shift</span>
   macro_uj  <span class="m">1</span>                    <span class="c1"># activate determination of U</span>
   pawujrad  <span class="m">2</span>.66866              <span class="c1"># optional, radius ASA-sphere to which U should be extrapolated </span>

<span class="c1">#Only to accelerate test</span>
     irdwfk  <span class="m">1</span>                    <span class="c1"># default for macro_uj = 1                     </span>
 <span class="c1">#    nline  2 </span>
 <span class="c1">#   nnsclo  2</span>
     tolvrs  10d-9                <span class="c1"># default for macro_uj = 1</span>


<span class="c1">#Save disk space </span>
     prteig  <span class="m">0</span>
      prtwf  <span class="m">0</span>
     prtden  <span class="m">0</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tudet_1.in, tudet_2.in, tudet_3.in</span>
<span class="c1">#%% input_prefix = tudet_1o</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tudet_2.out, tolnlines=  4, tolabs=  8.000e-03, tolrel=  6.500e-01, fld_options = -easy</span>
<span class="c1">#%% psp_files =  26fe.paw</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D.J. Adams</span>
<span class="c1">#%% keywords = PAW, LDAU</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Fe bcc structure - ferromagnetic PAW </span>
<span class="c1">#%%  determine U from change of occupation on atoms upon potential</span>
<span class="c1">#%%  shift on atom 1                                              </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d5080ea4-aa1c-4682-afb9-0a68e0f107a0", "#uuid-020217df-f9ac-47a2-93b3-d1ea02789c45") }); </script>

<p>As you can see from the tudet_2.files file, this run uses the tudet_1o_WFK as
an input. In the tudet_2.in all the symmetry relations are specified
explicitly. In the tudet_2.log you can verify that none of the symmetries
connects atoms 1 with atom 2:  </p>
<div class="codehilite"><pre><span></span><span class="n">symatm</span><span class="o">:</span> <span class="n">atom</span> <span class="n">number</span>    <span class="mi">1</span> <span class="k">is</span> <span class="n">reached</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">atom</span>

   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>

   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span>

 <span class="n">symatm</span><span class="o">:</span> <span class="n">atom</span> <span class="n">number</span>    <span class="mi">2</span> <span class="k">is</span> <span class="n">reached</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">atom</span>

   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>

   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>
</pre></div>


<p>This is important. Otherwise the occupation numbers have no freedom to evolve
separately on the atoms surrounding the atom on which you apply the perturbation.</p>
<p>You can generate these symmetries, in a separate run, where you specify the
atom where the perturbation is done as a different species. From the output
you read the number of symmetries (<a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>), the symmetry relations
(<a class="wikilink codevar-wikilink" href="../../variables/basic#symrel">symrel</a>) and the non-symmorphic vectors (<a class="wikilink codevar-wikilink" href="../../variables/basic#tnons">tnons</a>). This is already
done here and inserted in the tudet_2.in file. Note that you can alternatively
just break all the symmetries (<a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>=1), or break specific symmetries by
displacing the impurity atom in the preliminary run. However, for the
determination of U, the positions should be the ideal positions and only the
symmetry should be reduced.</p>
<p>For the rest, usually it is enough to set <a class="wikilink codevar-wikilink" href="../../variables/dev#macro_uj">macro_uj</a> 1 to run the
calculation of U. Note also, that the <a class="wikilink codevar-wikilink" href="../../variables/files#irdwfk">irdwfk</a> 1 and the <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> 1d-8
need not be set explicitly, because they are the defaults with <a class="wikilink codevar-wikilink" href="../../variables/dev#macro_uj">macro_uj</a> 1.</p>
<p>Once the calculation tudet_2 is converged, you can have look at the output.
You can see, that the atomic shift (<a class="wikilink codevar-wikilink" href="../../variables/ffield#atvshift">atvshift</a>) is automatically set:</p>
<div class="codehilite"><pre><span></span>         atvshift      0.00367    0.00367    0.00367    0.00367    0.00367
                       0.00367    0.00367    0.00367    0.00367    0.00367
                       0.00000    0.00000    0.00000    0.00000    0.00000
                       0.00000    0.00000    0.00000    0.00000    0.00000
</pre></div>


<p>This means, that all the 10 3d spin-spin orbitals on the first Fe atom where
shifted by 0.1 eV (=0.00367 Ha). On the second atom no shift was applied.
Self-consistency was reached twice: Once for a positive shift, once for the negative shift:</p>
<div class="codehilite"><pre><span></span>grep SCF  tudet_2.out
</pre></div>


<p>The lines starting with URES</p>
<div class="codehilite"><pre><span></span> URES      ii    nat       r_max    U(J)[eV]   U_ASA[eV]   U_inf[eV]
 URES       1      2     4.69390     4.74555     3.67983     3.20150
 URES       2     16     9.38770     8.77694     6.80588     5.92122
 URES       3     54    14.08160     9.17082     7.11130     6.18694
 URES       4    128    18.77540     9.25647     7.17772     6.24472
 URES       5    250    23.46930     9.28509     7.19991     6.26403
</pre></div>


<p>contain U for different supercells. The column &ldquo;nat&rdquo; indicates how many atoms
were involved in the supercell, r_max indicates the maximal distance of the
impurity atoms in that supercell. The column U indicates the actual U you
calculated and should use in your further calculations. U_ASA is an estimate
of U for more extended projectors and U_\inf is the estimate for a projector
extended even further.</p>
<p>Although it is enough to set <a class="wikilink codevar-wikilink" href="../../variables/dev#macro_uj">macro_uj</a> 1, you can further tune your runs.
As a standard, the potential shift to the 1<sup>st</sup> atom treated in DFT+U, with a
potential shift of 0.1 eV. If you wish to determine U on the second atom you
put <a class="wikilink codevar-wikilink" href="../../variables/dev#pawujat">pawujat</a> 2. To change the size of the potential shift use e.g.
<a class="wikilink codevar-wikilink" href="../../variables/dev#pawujv">pawujv</a> 0.05 eV. Our tests show that 0.1 eV is the optimal value, but the
linear response is linear in a wide range (1-0.001 eV).</p>
<h2 id="3-the-ujdet-utility">3 The ujdet utility<a class="headerlink" href="#3-the-ujdet-utility" title="Permanent link">&para;</a></h2>
<p>In general the calculation of U with abinit as described above is sufficient.
For some post-treatment that goes beyond the standard applications, a separate
executable ujdet was created. The output of abinit is formatted so that you
can easily &ldquo;cut&rdquo; the part with the ujdet input variables : you can generate
the standard input file for the ujdet utility by typing:</p>
<div class="codehilite"><pre><span></span>sed -n &quot;/MARK/,/MARK/p&quot; tudet_2.out  &gt; ujdet.in
</pre></div>


<p>Note that the input for the ujdet utility is always called ujdet.in</p>
<p>It contains the potential shifts applied vsh (there are 4 shifts: vsh1, vsh3
for non-selfconsistent calculations that allows to extract the contribution to
U originating from a non-interacting electron gas, and vsh2, vsh4 for positive
and negative potential shift). The same applies for the occupations occ[1-4].</p>
<p>We now calculate U for an even larger supercell: Uncomment the line scdim in ujdet.in and add</p>
<div class="codehilite"><pre><span></span> scdim 6 6 6
</pre></div>


<p>to specify a 6 6 6 supercell or</p>
<div class="codehilite"><pre><span></span> scdim 700 0 0
</pre></div>


<p>to specify the maximum total number of atoms in the supercell. Then, run ujdet:</p>
<div class="codehilite"><pre><span></span>rm ujdet.[ol]* ; ujdet &gt; ujdet.log

grep URES ujdet.out

 URES      ii    nat       r_max    U(J)[eV]   U_ASA[eV]   U_inf[eV]
 URES       1      2     4.69390     4.74555     3.67983     3.20150
 URES       2     16     9.38770     8.77694     6.80588     5.92122
 URES       3     54    14.08160     9.17082     7.11130     6.18694
 URES       4    128    18.77540     9.25647     7.17772     6.24472
 URES       5    250    23.46930     9.28509     7.19991     6.26403
 URES       6    432    28.16310     9.29738     7.20944     6.27232
</pre></div>


<p>As you can see, U has now been extrapolated to a supercell containing 432 atoms.</p>
<p>The value of U depends strongly on the extension of the projectors used in the
calculation. If you want to use U in LMTO-ASA calculations you can use the
keyword <a class="wikilink codevar-wikilink" href="../../variables/dev#pawujrad">pawujrad</a> in the ujdet.in file to get grips of the U you want to
use there. Just uncomment the line and add the ASA-radius of the specific atom e.g.</p>
<div class="codehilite"><pre><span></span>  pawujrad 2.5
</pre></div>


<p>Running</p>
<div class="codehilite"><pre><span></span>rm ujdet.[ol]* ; ujdet &gt; ujdet.log
</pre></div>


<p>gives now higher values in the column U_ASA than in the runs before (8.07 eV
compared to 7.21 eV): For more localized projectors the U value has to be bigger.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../dftu/" title="Dftu" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Dftu
              </span>
            </div>
          </a>
        
        
          <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Ucalc crpa
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (DJA)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>