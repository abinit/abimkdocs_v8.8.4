



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/positron/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Positron - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#electron-positron-annihilation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
            
            Positron
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Positron
      </label>
    
    <a href="./" title="Positron" class="md-nav__link md-nav__link--active">
      Positron
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calculation-of-positron-lifetime-and-momentum-distribution-in-si" title="Calculation of positron lifetime and momentum distribution in Si" class="md-nav__link">
    Calculation of positron lifetime and momentum distribution in Si
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-computing-the-positron-lifetime-in-si-lattice" title="1 Computing the positron lifetime in Si lattice" class="md-nav__link">
    1 Computing the positron lifetime in Si lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computing-the-positron-lifetime-in-a-si-monovacancy" title="2 Computing the positron lifetime in a Si monovacancy" class="md-nav__link">
    2 Computing the positron lifetime in a Si monovacancy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-performing-self-consistent-electron-positron-calculations-for-a-vacancy" title="3 Performing self consistent electron-positron calculations for a vacancy" class="md-nav__link">
    3 Performing self consistent electron-positron calculations for a vacancy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-relaxing-the-vacancy-according-to-forces-due-to-electrons-and-the-positron" title="4 Relaxing the vacancy according to forces due to electrons and the positron" class="md-nav__link">
    4 Relaxing the vacancy according to forces due to electrons and the positron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-computing-the-electron-positron-momentum-distribution-doppler-spectrum-of-a-si-lattice" title="5 Computing the electron-positron momentum distribution (Doppler spectrum) of a Si lattice" class="md-nav__link">
    5 Computing the electron-positron momentum distribution (Doppler spectrum) of a Si lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-studying-the-effect-of-the-paw-dataset-completeness" title="6 Studying the effect of the PAW dataset completeness" class="md-nav__link">
    6 Studying the effect of the PAW dataset completeness
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calculation-of-positron-lifetime-and-momentum-distribution-in-si" title="Calculation of positron lifetime and momentum distribution in Si" class="md-nav__link">
    Calculation of positron lifetime and momentum distribution in Si
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-computing-the-positron-lifetime-in-si-lattice" title="1 Computing the positron lifetime in Si lattice" class="md-nav__link">
    1 Computing the positron lifetime in Si lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computing-the-positron-lifetime-in-a-si-monovacancy" title="2 Computing the positron lifetime in a Si monovacancy" class="md-nav__link">
    2 Computing the positron lifetime in a Si monovacancy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-performing-self-consistent-electron-positron-calculations-for-a-vacancy" title="3 Performing self consistent electron-positron calculations for a vacancy" class="md-nav__link">
    3 Performing self consistent electron-positron calculations for a vacancy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-relaxing-the-vacancy-according-to-forces-due-to-electrons-and-the-positron" title="4 Relaxing the vacancy according to forces due to electrons and the positron" class="md-nav__link">
    4 Relaxing the vacancy according to forces due to electrons and the positron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-computing-the-electron-positron-momentum-distribution-doppler-spectrum-of-a-si-lattice" title="5 Computing the electron-positron momentum distribution (Doppler spectrum) of a Si lattice" class="md-nav__link">
    5 Computing the electron-positron momentum distribution (Doppler spectrum) of a Si lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-studying-the-effect-of-the-paw-dataset-completeness" title="6 Studying the effect of the PAW dataset completeness" class="md-nav__link">
    6 Studying the effect of the PAW dataset completeness
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/positron.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="electron-positron-annihilation">Electron-positron annihilation<a class="headerlink" href="#electron-positron-annihilation" title="Permanent link">&para;</a></h1>
<h2 id="calculation-of-positron-lifetime-and-momentum-distribution-in-si">Calculation of positron lifetime and momentum distribution in Si<a class="headerlink" href="#calculation-of-positron-lifetime-and-momentum-distribution-in-si" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to perform Two-Component Density-Functional
Theory (TCDFT) calculations in the PAW framework to obtain the following
physical properties:</p>
<ul>
<li>the positron lifetime in the perfect material </li>
<li>the lifetime of a positron localized in a vacancy </li>
<li>the electron-positron momentum distribution </li>
</ul>
<p>For the description of the implementation of TCDFT in ABINIT see <a class="wikilink citation-wikilink" data-content="Two-component density functional theory within the projector augmented-wave approach: Accurate and self-consistent computations of positron lifetimes and momentum distributions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#wiktor2015">[Wiktor2015]</a>.</p>
<p>The user should be familiar with the four basic lessons of ABINIT and the <a href="../paw1">first PAW tutorial</a>.</p>
<p>This lesson should take about 2 hours.</p>
<h2 id="1-computing-the-positron-lifetime-in-si-lattice">1 Computing the positron lifetime in Si lattice<a class="headerlink" href="#1-computing-the-positron-lifetime-in-si-lattice" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not &rdquo; Work_positron&rdquo;?</em></p>
<p>The lesson begins with a calculation of the positron lifetime in a Si lattice.
In a perfect material the positron is delocalized. We can assume that its
density approaches zero and it cannot affect the electron density. We will
perform only two steps of calculations:</p>
<ol>
<li>Calculation of the ground-state electron density without the positron. </li>
<li>Calculation of the ground-state positron density in the presence of the electron density from step 1. </li>
</ol>
<p>The two densities are used to calculate the positron lifetime, which is
proportional to the inverse of the overlap of the electron and positron
densities. This two-step calculation, considering the zero-positron density
limit corresponds to the conventional scheme (CONV).</p>
<p>In the tpositron_1.in file, you will find two datasets. </p>
<div class="text-center"><button type="button" id="uuid-fad17705-a7df-49bc-8b21-3c8e169e2889" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpositron_1.in
</button></div>

<div id="uuid-c3433fe2-be29-450f-b99f-a871c02a54a9" class="my_dialog" title="tests/tutorial/Input/tpositron_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Input file for the positron tutorial                          #</span>
<span class="c1">#    Positron lifetime calculation within PAW                   #</span>
<span class="c1">#                                                               #</span>
<span class="c1">#              Si, 2 atoms in the box                           #</span>
<span class="c1">#################################################################</span>

<span class="c1"># Datasets definition</span>
  ndtset <span class="m">2</span>

  positron1  <span class="m">0</span>      ! Dataset <span class="m">1</span> is a simple electronic GS calculation

  positron2  <span class="m">1</span>      ! Dataset <span class="m">2</span> is a positronic GS calculation
  getden2    <span class="m">1</span>      !   in presence of the previous electronic density
  kptopt2    <span class="m">0</span>      !   Use only <span class="nv">k</span><span class="o">=</span>gamma point

  ixcpositron2  <span class="m">1</span>   ! We are using the Boronski and Nieminen parametrization

<span class="c1"># Common input parameters</span>
  ! Unit cell
    acell   <span class="m">3</span>*5.43 angstrom
    rprim   <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.5
            <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.5
            <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.0

    natom  <span class="m">2</span>
    ntypat  <span class="m">1</span>
    typat <span class="m">2</span>*1
    znucl <span class="m">14</span>
    xred  <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

  ! K-points and occupations
    kptopt <span class="m">1</span>
    ngkpt <span class="m">4</span> <span class="m">4</span> <span class="m">4</span> 
    nshiftk <span class="m">1</span>
    shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
    occopt <span class="m">1</span>
    nband <span class="m">6</span>

    posocc2 <span class="m">1</span>  ! Occupation number <span class="k">for</span> the positron <span class="o">(</span>should be <span class="nb">set</span> &lt;<span class="m">1</span> <span class="k">for</span> bulk calculation with a small cell<span class="o">)</span>.
               ! Here the zero positron density limit is used, so results <span class="k">do</span> not depend on posocc.

  ! Convergence parameters
    ecut <span class="m">8</span>. pawecutdg <span class="m">15</span>.
    iscf <span class="m">17</span>
    nstep <span class="m">50</span> tolvrs <span class="m">1</span>.d-8

!   Miscelaneous
    prtwf <span class="m">0</span> prteig <span class="m">0</span>           ! To save disk space
    optforces <span class="m">0</span> optstress <span class="m">0</span>    ! Not relevant here

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tpositron_1.out, tolnlines=  0, tolabs= 0.0, tolrel= 0.0, fld_options= -easy</span>
<span class="c1">#%% psp_files = Si.LDA-PW-paw.abinit</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = J. Wiktor</span>
<span class="c1">#%% keywords = POSITRON,PAW</span>
<span class="c1">#%% description = First step of the tutorial on electron-positron annihilation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-c3433fe2-be29-450f-b99f-a871c02a54a9", "#uuid-fad17705-a7df-49bc-8b21-3c8e169e2889") }); </script>

<p>The first dataset is a standard ground-state calculation. The second one introduces a positron into
the system. You can see that in this case we set:</p>
<div class="codehilite"><pre><span></span>  positron2  1      ! Dataset 2 is a positronic GS calculation
  getden2    1      !   in presence of the previous electronic density
  kptopt2    0      !   Use only k=gamma point

  ixcpositron2  1   ! We are using the Boronski and Nieminen parametrization
</pre></div>


<p>Here we set <a class="wikilink codevar-wikilink" href="../../variables/gstate#positron">positron</a>=1, which corresponds to a positronic ground-state
calculation, considering that the electrons are not perturbed by the presence
of the positron. The electron density is read from the file resulting from
dataset 1. As we consider the positron to be completely delocalized, we only
consider the Γ point. The keyword <a class="wikilink codevar-wikilink" href="../../variables/gstate#ixcpositron">ixcpositron</a> selects the electron-
positron correlation functional and enhancement factor. In this calculation we
use the functional parametrized by Boronski and Nieminen [Phys. Rev. B 34,
3820 (1986)], using the data provided by Arponen and Pajanne [J. Phys. F 9, 2359 (1979)].</p>
<p>We can now run the calculation. In the directory
~abinit/tests/tutorial/Input/Work_positron, copy the files
~abinit/tests/tutorial/Input/tpositron_x.files and tpositron_1.in.</p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_x.files &gt;&amp; tpositron_1.log
</pre></div>


<p>This calculation should only take a few seconds.</p>
<p>You can look at the tpositron_1.out file. We find the positron lifetime
calculated in the RPA limit:</p>
<div class="codehilite"><pre><span></span>########## Lifetime computation 2

 # Zero-positron density limit of Arponen and Pajanne provided by Boronski &amp; Nieminen
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)
 # Enhancement factor of Boronski &amp; Nieminen IN THE RPA LIMIT
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)

 Positron lifetime                         (ps)   =  2.22891945E+02
</pre></div>


<p>The lifetime of 223 ps agrees well with the value of 225 ps calculated with
the same number of valence electrons in [Phys. Rev. B 92, 125113 (2015)] and
with the experimental value of about 219 ps [Phys. Rev. B 56, 7356 (1997)].</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If we had not used the &ldquo;zero positron density limit&rdquo; approximation
(using, for example, another value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#ixcpositron">ixcpositron</a>), we would theoretically
have needed a box of infinite size for the positron to completely delocalise
itself in the crystal. This can be avoided by the use of the <a class="wikilink codevar-wikilink" href="../../variables/gstate#posocc">posocc</a> input
parameter. Numerically, it is equivalent to calculate the density of 1
positron in a box of size N and that of x positron in a box of size N * x.
Thus, we can calculate the lifetime of a positron in a primitive cell by
setting <a class="wikilink codevar-wikilink" href="../../variables/gstate#posocc">posocc</a> to a small value (0.0001 &hellip;). This value must obviously be tested&hellip;</p>
</div>
<h2 id="2-computing-the-positron-lifetime-in-a-si-monovacancy">2 Computing the positron lifetime in a Si monovacancy<a class="headerlink" href="#2-computing-the-positron-lifetime-in-a-si-monovacancy" title="Permanent link">&para;</a></h2>
<p>We will now perform a positron lifetime calculation for a monovacancy in
silicon in the conventional scheme (which we applied to the perfect lattice
previously). Note that when the positron localizes inside a vacancy, the zero-
positron density limit does not apply anymore. However, in some cases, the
conventional scheme proved to yield results in agreement with experiments.</p>
<p>For the purpose of this tutorial, we generate a defect in a cell containing
only 16 atoms. This supercell is too small to get converged results, but the
calculation is relatively fast.</p>
<div class="text-center"><button type="button" id="uuid-6200e0a1-837a-43a6-bb4e-d064df700a85" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpositron_2.in
</button></div>

<div id="uuid-b3264920-6ee9-4252-b813-c85f57351175" class="my_dialog" title="tests/tutorial/Input/tpositron_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Input file for the positron tutorial                          #</span>
<span class="c1">#    Positron lifetime calculation within PAW                   #</span>
<span class="c1">#                                                               #</span>
<span class="c1">#              Si monovacancy, &quot;conventional&quot; scheme            #</span>
<span class="c1">#################################################################</span>

<span class="c1"># Datasets definition</span>
  ndtset <span class="m">2</span>

  positron1  <span class="m">0</span>      ! Dataset <span class="m">1</span> is a simple electronic GS calculation

  positron2  <span class="m">1</span>      ! Dataset <span class="m">2</span> is a positronic GS calculation
  getden2    <span class="m">1</span>      !   in presence of the previous electronic density
  kptopt2    <span class="m">0</span>      !   Use only <span class="nv">k</span><span class="o">=</span>gamma point

  ixcpositron2  <span class="m">1</span>   ! We are using the Boronski and Nieminen parametrization

<span class="c1"># Common input parameters</span>
  ! Unit cell
    acell   <span class="m">3</span>*5.43 angstrom
    rprim   <span class="m">0</span>.0 <span class="m">1</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">0</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">1</span>.0 <span class="m">0</span>.0
    chkprim <span class="m">0</span>
    natom  <span class="m">15</span>
    ntypat  <span class="m">1</span>
    typat <span class="m">15</span>*1
    znucl <span class="m">14</span>
    xred  
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.5

          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.125
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.125
!          <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.625 ! We remove one Si atom

  ! K-points and occupations
    kptopt <span class="m">1</span>
    ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span> 
    nshiftk <span class="m">1</span>
    shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
    occopt <span class="m">1</span>
    nband <span class="m">36</span>

    posocc2 <span class="m">1</span>.0  ! Occupation number <span class="k">for</span> the positron <span class="o">(</span>should be <span class="nb">set</span> &lt;<span class="m">1</span> <span class="k">for</span> bulk calculation with a small cell<span class="o">)</span>.
                 ! Here the zero positron density limit is used, so results <span class="k">do</span> not depend on posocc.

  ! Convergence parameters
    ecut <span class="m">8</span>. pawecutdg <span class="m">15</span>.
    iscf <span class="m">17</span>
    nstep <span class="m">50</span> tolvrs <span class="m">1</span>.d-8

!   Miscelaneous
    prtwf <span class="m">0</span> prteig <span class="m">0</span>           ! To save disk space
    optforces <span class="m">0</span> optstress <span class="m">0</span>    ! Not relevant here

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tpositron_2.out, tolnlines=  0, tolabs= 0.0, tolrel= 0.0, fld_options= -easy</span>
<span class="c1">#%% psp_files = Si.LDA-PW-paw.abinit</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = J. Wiktor</span>
<span class="c1">#%% keywords = POSITRON,PAW</span>
<span class="c1">#%% description = Second step of the tutorial on electron-positron annihilation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b3264920-6ee9-4252-b813-c85f57351175", "#uuid-6200e0a1-837a-43a6-bb4e-d064df700a85") }); </script>

<p>You can now, issue (after having replaced tpositron_1 by tpositron_2 in the
tpositron_x.files file):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_x.files &gt;&amp; tpositron_2.log
</pre></div>


<p>Once the calculation is finished, look at the tpositron_2.out file. 
Again, we look at the reported lifetime:</p>
<div class="codehilite"><pre><span></span>########## Lifetime computation 2

 # Zero-positron density limit of Arponen and Pajanne provided by Boronski &amp; Nieminen
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)
 # Enhancement factor of Boronski &amp; Nieminen IN THE RPA LIMIT
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)

 Positron lifetime                         (ps)   =  2.46936401E+02
</pre></div>


<p>We observe that when the positron localizes inside the vacancy, its lifetime
increases from 223 to 247 ps. This is because now the majority of the positron
density is localized in the vacancy region, where the electron density is
small. The overlap of the electron and positron densities is reduced, and the lifetime increased.</p>
<p>In the Work directory, you will also find a tpositron_2o_DS2_DEN_POSITRON
file, containing the positron density. Visualizing this file (using e.g.
<em>cut3d</em> and <em>XcrysDen</em> or <em>VMD</em> ) you can see that the positron is localized
inside the vacancy. You can see below how the positron (in red, isodensity at
30% of the maximum density) localized the silicon monovacancy looks like:</p>
<p><img alt="" src="../positron_assets/posdensity.png" /></p>
<h2 id="3-performing-self-consistent-electron-positron-calculations-for-a-vacancy">3 Performing self consistent electron-positron calculations for a vacancy<a class="headerlink" href="#3-performing-self-consistent-electron-positron-calculations-for-a-vacancy" title="Permanent link">&para;</a></h2>
<p>We will now perform a self-consistent calculation of the positron and electron
densities. As this calculation will take a few minutes, you can already issue
(putting tpositron_3.in in tpositron_x.files):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_x.files &gt;&amp; tpositron_3.log
</pre></div>


<div class="text-center"><button type="button" id="uuid-1568062b-945c-4112-a7f3-f8b4a2289abc" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpositron_3.in
</button></div>

<div id="uuid-81c1ccb4-27f2-418b-96c2-9bb6cab324a0" class="my_dialog" title="tests/tutorial/Input/tpositron_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Input file for the positron tutorial                          #</span>
<span class="c1">#    Positron lifetime calculation within PAW                   #</span>
<span class="c1">#                                                               #</span>
<span class="c1">#              Si monovacancy, self-consistent scheme           #</span>
<span class="c1">#################################################################</span>

<span class="c1"># Self-consistent positron lifetime calculation</span>

  positron  -10     ! We perform automatic calculation of electrons and positron densities in the two-component DFT context
  postoldfe  1d-5   ! We will repeat the electon and positron steps <span class="k">until</span> the energy difference is lower than 1d-5
  posnstep   <span class="m">20</span>     ! Maximum number of electon and positron steps

  ixcpositron  <span class="m">1</span>  ! We are using the Boronski and Nieminen parametrization

<span class="c1"># Common input parameters</span>
  ! Unit cell
    acell   <span class="m">3</span>*5.43 angstrom
    rprim   <span class="m">0</span>.0 <span class="m">1</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">0</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">1</span>.0 <span class="m">0</span>.0
    chkprim <span class="m">0</span>
    natom  <span class="m">15</span>
    ntypat  <span class="m">1</span>
    typat <span class="m">15</span>*1
    znucl <span class="m">14</span>
    xred  
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.5

          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.125
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.125
!         <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.625 ! We remove one Si atom

  ! K-points and occupations
    kptopt <span class="m">1</span>
    ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span> 
    nshiftk <span class="m">1</span>
    shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
    occopt <span class="m">1</span>
    nband <span class="m">36</span>

    posocc <span class="m">1</span>.0  ! Occupation number <span class="k">for</span> the positron <span class="o">(</span>we have one positron in the cell<span class="o">)</span>.

  ! Convergence parameters
    ecut <span class="m">8</span>. pawecutdg <span class="m">15</span>.
    iscf <span class="m">17</span>
    nstep <span class="m">500</span>  ! We increase nstep
    toldfe <span class="m">1</span>.d-8

!   Miscelaneous
    prtwf <span class="m">0</span> prteig <span class="m">0</span>           ! To save disk space
    optforces <span class="m">0</span> optstress <span class="m">0</span>    ! Not relevant here

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tpositron_3.out, tolnlines= 27, tolabs= 9.0e-4, tolrel= 3.0e-1, fld_options= -easy</span>
<span class="c1">#%% psp_files = Si.LDA-PW-paw.abinit</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = J. Wiktor</span>
<span class="c1">#%% keywords = POSITRON,PAW</span>
<span class="c1">#%% description = Third step of the tutorial on electron-positron annihilation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-81c1ccb4-27f2-418b-96c2-9bb6cab324a0", "#uuid-1568062b-945c-4112-a7f3-f8b4a2289abc") }); </script>

<p>This calculation is significantly longer than the previous one, because the
electron and positron steps will be repeated until the convergence criterion is reached. </p>
<p>In tpositron_3.in we only have one dataset and we set
<a class="wikilink codevar-wikilink" href="../../variables/gstate#positron">positron</a>=-10 to perform an automatic calculation of electrons and positron
densities. The convergence is controlled by <a class="wikilink codevar-wikilink" href="../../variables/gstate#postoldfe">postoldfe</a>=1d-5. This means
that we will repeat the electron and positron steps until the energy
difference between them is lower than 1d-5 Ha. This value should always be
larger than <a class="wikilink codevar-wikilink" href="../../variables/basic#toldfe">toldfe</a>. In this calculation we still use <a class="wikilink codevar-wikilink" href="../../variables/gstate#ixcpositron">ixcpositron</a>=1,
which means that we are using the GGGC scheme (see [Phys. Rev. Lett. 72, 3214
(1994)] and [Phys. Rev. B 92, 125113 (2015)].</p>
<p>Once the calculation is finished, look at the positron lifetime in tpositron_3.out.</p>
<div class="codehilite"><pre><span></span>########## Lifetime computation 2

 # Zero-positron density limit of Arponen and Pajanne provided by Boronski &amp; Nieminen
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)
 # Enhancement factor of Boronski &amp; Nieminen IN THE RPA LIMIT
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)

 Positron lifetime                         (ps)   =  2.55617112E+02
</pre></div>


<p>Including the self-consistency increases the positron lifetime, because its
localization inside the vacancy becomes stronger when the positron and the
electron densities are allowed to relax.</p>
<h2 id="4-relaxing-the-vacancy-according-to-forces-due-to-electrons-and-the-positron">4 Relaxing the vacancy according to forces due to electrons and the positron<a class="headerlink" href="#4-relaxing-the-vacancy-according-to-forces-due-to-electrons-and-the-positron" title="Permanent link">&para;</a></h2>
<p>In addition to the self-consistency, the lifetime of a positron inside a
vacancy can be strongly affected by the relaxation of the atoms due to the
forces coming from both the electrons and the positron. You can already start
the relaxation of the vacancy by issuing:  </p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_4.files &gt;&amp; tpositron_4.log
</pre></div>


<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Don&rsquo;t forget to put tpositron_4.in in tpositron_x.files.</p>
</div>
<p>In this calculation we switched on the atomic relaxation by setting
<a class="wikilink codevar-wikilink" href="../../variables/rlx#ionmov">ionmov</a>=2. We need to calculate forces to be able to move the atoms, so we
set <a class="wikilink codevar-wikilink" href="../../variables/dev#optforces">optforces</a>=1. In the provided tpositron_4.in file, We only perform 4
relaxation steps (<a class="wikilink codevar-wikilink" href="../../variables/rlx#ntime">ntime</a>=4) to save time, but more steps would be needed to
converge the positron lifetime.</p>
<div class="text-center"><button type="button" id="uuid-eb7c423d-e06b-49cd-909e-2b647e7ea6cc" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpositron_3.in
</button></div>

<div id="uuid-a2d6ee7c-c68d-4eab-9e15-24735639d18b" class="my_dialog" title="tests/tutorial/Input/tpositron_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Input file for the positron tutorial                          #</span>
<span class="c1">#    Positron lifetime calculation within PAW                   #</span>
<span class="c1">#                                                               #</span>
<span class="c1">#              Si monovacancy, self-consistent scheme           #</span>
<span class="c1">#################################################################</span>

<span class="c1"># Self-consistent positron lifetime calculation</span>

  positron  -10     ! We perform automatic calculation of electrons and positron densities in the two-component DFT context
  postoldfe  1d-5   ! We will repeat the electon and positron steps <span class="k">until</span> the energy difference is lower than 1d-5
  posnstep   <span class="m">20</span>     ! Maximum number of electon and positron steps

  ixcpositron  <span class="m">1</span>  ! We are using the Boronski and Nieminen parametrization

<span class="c1"># Common input parameters</span>
  ! Unit cell
    acell   <span class="m">3</span>*5.43 angstrom
    rprim   <span class="m">0</span>.0 <span class="m">1</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">0</span>.0 <span class="m">1</span>.0
            <span class="m">1</span>.0 <span class="m">1</span>.0 <span class="m">0</span>.0
    chkprim <span class="m">0</span>
    natom  <span class="m">15</span>
    ntypat  <span class="m">1</span>
    typat <span class="m">15</span>*1
    znucl <span class="m">14</span>
    xred  
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.0   <span class="m">0</span>.5   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.0   <span class="m">0</span>.5
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.0
          <span class="m">0</span>.5   <span class="m">0</span>.5   <span class="m">0</span>.5

          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.125
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.125
          <span class="m">0</span>.125 <span class="m">0</span>.625 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.125 <span class="m">0</span>.625
          <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.125
!         <span class="m">0</span>.625 <span class="m">0</span>.625 <span class="m">0</span>.625 ! We remove one Si atom

  ! K-points and occupations
    kptopt <span class="m">1</span>
    ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span> 
    nshiftk <span class="m">1</span>
    shiftk <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
    occopt <span class="m">1</span>
    nband <span class="m">36</span>

    posocc <span class="m">1</span>.0  ! Occupation number <span class="k">for</span> the positron <span class="o">(</span>we have one positron in the cell<span class="o">)</span>.

  ! Convergence parameters
    ecut <span class="m">8</span>. pawecutdg <span class="m">15</span>.
    iscf <span class="m">17</span>
    nstep <span class="m">500</span>  ! We increase nstep
    toldfe <span class="m">1</span>.d-8

!   Miscelaneous
    prtwf <span class="m">0</span> prteig <span class="m">0</span>           ! To save disk space
    optforces <span class="m">0</span> optstress <span class="m">0</span>    ! Not relevant here

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tpositron_3.out, tolnlines= 27, tolabs= 9.0e-4, tolrel= 3.0e-1, fld_options= -easy</span>
<span class="c1">#%% psp_files = Si.LDA-PW-paw.abinit</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = J. Wiktor</span>
<span class="c1">#%% keywords = POSITRON,PAW</span>
<span class="c1">#%% description = Third step of the tutorial on electron-positron annihilation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a2d6ee7c-c68d-4eab-9e15-24735639d18b", "#uuid-eb7c423d-e06b-49cd-909e-2b647e7ea6cc") }); </script>

<p>Look at the positron lifetime in the RPA limit after each ionic step:</p>
<div class="codehilite"><pre><span></span> Positron lifetime                         (ps)   =  2.55617112E+02
 Positron lifetime                         (ps)   =  2.56981105E+02
 Positron lifetime                         (ps)   =  2.81986785E+02
 Positron lifetime                         (ps)   =  2.82826327E+02
</pre></div>


<p>As the vacancy relaxes outwards, the positron lifetime increases. 4 steps were
not enough to relax the defect completely, as the lifetime still changes.
Indeed, setting <a class="wikilink codevar-wikilink" href="../../variables/rlx#ntime">ntime</a> to 10 delivers:</p>
<div class="codehilite"><pre><span></span>Positron lifetime                         (ps)   =  2.55617112E+02
Positron lifetime                         (ps)   =  2.56981106E+02
Positron lifetime                         (ps)   =  2.81986782E+02
Positron lifetime                         (ps)   =  2.82826326E+02
Positron lifetime                         (ps)   =  2.86660064E+02
Positron lifetime                         (ps)   =  2.87040831E+02
Positron lifetime                         (ps)   =  2.87284438E+02
Positron lifetime                         (ps)   =  2.87360829E+02
Positron lifetime                         (ps)   =  2.87302206E+02
</pre></div>


<p>Although the results at ionic steps 3 and 4 differ from each other by less
than one percent, they differ by more from the final result. The one percent
convergence is only reached at ionic step 5 and after.</p>
<p>Also, remember that the 16-atom supercell is not large enough to get converged
results. In Table IV of [Phys. Rev. B 92, 125113 (2015)] you can see converged
results of the positron lifetime of Si monovacancy in various methods.</p>
<h2 id="5-computing-the-electron-positron-momentum-distribution-doppler-spectrum-of-a-si-lattice">5 Computing the electron-positron momentum distribution (Doppler spectrum) of a Si lattice<a class="headerlink" href="#5-computing-the-electron-positron-momentum-distribution-doppler-spectrum-of-a-si-lattice" title="Permanent link">&para;</a></h2>
<p>In the last part of the tutorial we will calculate the electron-positron
momentum distribution (Doppler spectrum) of a Si lattice in the conventional
scheme. This type of calculation is much more time and memory consuming than
the lifetime calculation, as it is calculated using the electron and positron
wavefunctions and not densities.</p>
<p>You can already issue (putting tpositron_5.in in tpositron_x.files)_:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_5.files &gt;&amp; tpositron_5.log
</pre></div>


<p>Now take a look at the input file tpositron_5.in. </p>
<div class="text-center"><button type="button" id="uuid-bca92789-72fe-403b-9504-4c76c5cf34c9" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpositron_5.in
</button></div>

<div id="uuid-456cbfa2-e23d-4ffb-8bfc-7ca374478e41" class="my_dialog" title="tests/tutorial/Input/tpositron_5.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Input file for the positron tutorial                          #</span>
<span class="c1">#    Doppler spectrum calculation within PAW                    #</span>
<span class="c1">#                                                               #</span>
<span class="c1">#              Si, 2 atoms in the box                           #</span>
<span class="c1">#################################################################</span>

  positron -10    ! Electron/positron GS calculation
                  ! Automatic electron-positron loop has to be switched on in Doppler calculations
                  ! to have both electron and positron wavefunctions in memory

  posnstep  <span class="m">2</span>     ! We simulate a delocalized positron, so we only perform two steps of electon-positron calculations.
                  ! It means that the electronic wavefunction is not affected by the positron.
  posdoppler <span class="m">1</span>    ! Activation of Doppler broadening calculation

  ixcpositron  <span class="m">1</span>  ! We are using the Boronski and Nieminen parametrization

<span class="c1"># Common input parameters</span>
  ! Unit cell
    acell   <span class="m">3</span>*5.43 angstrom
    rprim   <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.5
            <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.5
            <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.0

    natom  <span class="m">2</span>
    ntypat  <span class="m">1</span>
    typat <span class="m">2</span>*1
    znucl <span class="m">14</span>
    xred  <span class="m">0</span>.0   <span class="m">0</span>.0   <span class="m">0</span>.0
          <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

  ! K-points and occupations
  ! In Doppler calculation we need to have a uniform 
  ! grid in the momentum space. Symmetries are not used,
  ! so the full grid needs to be specified.

    kptopt <span class="m">0</span>
    istwfk *1
    nkpt <span class="m">8</span>   ! This corresponds to a 2x2x2 grid, denser grids may be needed to get converged spectra
    kpt
    <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>.5
    <span class="m">0</span> <span class="m">0</span>.5 <span class="m">0</span>
    <span class="m">0</span>.5 <span class="m">0</span> <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>.5 <span class="m">0</span>.5
    <span class="m">0</span>.5 <span class="m">0</span> <span class="m">0</span>.5
    <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>
    <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5 

    occopt <span class="m">1</span>
    nband <span class="m">6</span>

    posocc <span class="m">1</span>.0   ! Occupation number <span class="k">for</span> the positron <span class="o">(</span>should be <span class="nb">set</span> &lt;<span class="m">1</span> <span class="k">for</span> bulk calculation with a small cell<span class="o">)</span>.
                 ! Here the zero positron density limit is used, so results <span class="k">do</span> not depend on posocc.

  ! Convergence parameters
    ecut <span class="m">8</span>. pawecutdg <span class="m">15</span>.
    iscf <span class="m">17</span>
    nstep <span class="m">50</span> tolvrs <span class="m">1</span>.d-8

!   Miscelaneous
    prtwf <span class="m">0</span> prteig <span class="m">0</span>           ! To save disk space
    optforces <span class="m">0</span> optstress <span class="m">0</span>    ! Not relevant here

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tpositron_5.out, tolnlines= 3, tolabs= 2.6e-2, tolrel= 3.8e-2, fld_options= -easy</span>
<span class="c1">#%% psp_files = Si.LDA-PW-paw.abinit</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = J. Wiktor</span>
<span class="c1">#%% keywords = POSITRON,PAW</span>
<span class="c1">#%% description = Fifth step of the tutorial on electron-positron annihilation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-456cbfa2-e23d-4ffb-8bfc-7ca374478e41", "#uuid-bca92789-72fe-403b-9504-4c76c5cf34c9") }); </script>

<p>The momentum distribution calculation is activated by <a class="wikilink codevar-wikilink" href="../../variables/gstate#posdoppler">posdoppler</a>=1. You can also notice that instead
of having two datasets as in the first part of this tutorial, we now use the
automatic electron-positron loop and set <a class="wikilink codevar-wikilink" href="../../variables/gstate#posnstep">posnstep</a>=2. This is done because
we need to have the full electron and positron wavefunctions in memory, which
is only the case when <a class="wikilink codevar-wikilink" href="../../variables/gstate#positron">positron</a>&lt;=-10. Additionally, the momentum
distribution calculations require using a full k-point grid. In the input file we set:</p>
<div class="codehilite"><pre><span></span>    kptopt 0
    istwfk *1
    nkpt 8   # This corresponds to a 2x2x2 grid, denser grids may be needed to get converged spectra
    kpt
    0 0 0
    0 0 0.5
    0 0.5 0
    0.5 0 0
    0 0.5 0.5
    0.5 0 0.5
    0.5 0.5 0
    0.5 0.5 0.5
</pre></div>


<p>This grid is used in both electron and positron calculations, but only the
positron wavefunction at the first point is taken in the momentum distribution
calculation, so the Γ point should always be given first.</p>
<p>In the calculation of the momentum distribution, we need to include both core
and valence electrons. The wavefunctions of the core electron are read from a
file (one per atom type), which need to be provided. This core WF file should
be named &lsquo;<psp_file_name>.corewf&rsquo; (where <psp_file_name> is the name of the
pseudo-potential (or PAW) file) or &lsquo;corewf.abinit <ityp>&lsquo; (where <ityp> is the
index of the atom type). Core WF files can be obtained with the atompaw tool
(see <a class="wikilink lesson-wikilink" href="../paw2">lesson on generating the PAW datasets</a>) by the use of the
&lsquo;prtcorewf&rsquo; keyword. You will find the core wavefunction file used in this calculation in</p>
<div class="codehilite"><pre><span></span>~abinit/tests/Psps_for_tests/Si.LDA-PW-paw.abinit.corewf
</pre></div>


<p>Once the calculation is complete, you will find a file tpositron_5o_DOPPLER
containing the momentum distribution on the FFT grid. You can use the
<strong>~abinit/scripts/post_processing/posdopspectra.F90</strong> tool to generate 1D
projections (Doppler spectra) in (001), (011) and (111) directions and to
calculate the low- and high-momentum contributions to the contributions to the
momentum distribution (so called S and W parameters, see [Phys. Rev. B 92, 125113 (2015)]).</p>
<h2 id="6-studying-the-effect-of-the-paw-dataset-completeness">6 Studying the effect of the PAW dataset completeness<a class="headerlink" href="#6-studying-the-effect-of-the-paw-dataset-completeness" title="Permanent link">&para;</a></h2>
<p>The positron lifetime and momentum distribution calculations within the PAW
method are very sensitive to the number of valence electrons in the PAW
dataset. It is due to the fact that it is not easy to describe the positron
wavefunction, tending to zero at the nucleus, using the electron atomic
orbitals. The PAW basis set in this case needs to be more complete than only
for describing the electron wavefunctions. </p>
<p>The simplest way to make the PAW
dataset more complete is to include semicore electrons. It is also possible to
add the partial waves corresponding to the semicore electrons in the basis
used only for the positron wave function description, while keeping the
initial number of valence electrons (as done in [Phys. Rev. B 92, 125113
(2015)]). However, the second method is less straightforward.</p>
<p>The previous calculations were done with only 4 valence electrons (3s and 3p).
We will now see what happens if we include the 2s and 2p states in the PAW
dataset. In tpositron_12el_x.files we have replaced the Si.LDA-PW-paw.abinit
dataset with Si.12el.LDA-PW-paw.abinit. We can now rerun the lifetime calculation:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_12el_x.files &gt;&amp; tpositron_6.log
</pre></div>


<p>We now find the positron lifetime calculated in the RPA limit:</p>
<div class="codehilite"><pre><span></span>########## Lifetime computation 2

 # Zero-positron density limit of Arponen and Pajanne provided by Boronski &amp; Nieminen
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)
 # Enhancement factor of Boronski &amp; Nieminen IN THE RPA LIMIT
   Ref.: Boronski and R.M. Nieminen, Phys. Rev. B 34, 3820 (1986)

 Positron lifetime                         (ps)   =  2.11481560E+02
</pre></div>


<p>This value is significantly lower than 223 ps achieved with 4 valence
electrons in the first step. It is, therefore, very important to always test
the PAW dataset completeness for positron calculations.</p>
<p>The PAW dataset completeness is even more important in the Doppler spectra
calculations. We will now recalculate the momentum distribution including 12
valence electrons (using tpositron_7.in in tpositron_12el_x.files):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpositron_12el_x.files &gt;&amp; tpositron_7.log
</pre></div>


<p>Before processing the new tpositron_7o_DOPPLER file, you should copy files
rho_001, rho_011, rho_111 from the fifth step to for instance si4el_001, si4el_011 and si4el_111.<br />
By plotting the Doppler spectra in the (001) direction calculated with 4 and
12 valence electrons, you should obtain a figure like this:</p>
<p><img alt="" src="../positron_assets/doppler.png" /></p>
<p>The dataset with 4 valence electrons is not complete enough to describe the
positron wavefunction around the nucleus. This is reflected in the
unphysically high probability at high momenta in the spectrum.</p>
<p>Further explanation of the influence of the PAW dataset on the Doppler spectra
can be found in Phys. Rev. B 92, 125113 (2015). In case you need to generate
your own dataset for momentum distribution calculations, you can follow the
lesson on generating the PAW datasets <a class="wikilink lesson-wikilink" href="../paw2">lesson on generating the PAW datasets</a>.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../optic/" title="Optic" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Optic
              </span>
            </div>
          </a>
        
        
          <a href="../source_code/" title="Source code" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Source code
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (JW, MT)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>