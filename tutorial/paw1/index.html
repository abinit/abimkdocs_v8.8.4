



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paw1/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>PAW1 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#first-lesson-on-the-projector-augmented-wave-paw-technique" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  PAW
                </span>
              
            
            PAW1
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" checked>
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        PAW1
      </label>
    
    <a href="./" title="PAW1" class="md-nav__link md-nav__link--active">
      PAW1
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#projector-augmented-wave-technique-how-to-use-it" title="Projector Augmented-Wave technique, how to use it?" class="md-nav__link">
    Projector Augmented-Wave technique, how to use it?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-the-paw-method" title="1 Summary of the PAW method" class="md-nav__link">
    1 Summary of the PAW method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-paw-with-abinit" title="2 Using PAW with ABINIT" class="md-nav__link">
    2 Using PAW with ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-convergence-on-plane-wave-cut-off" title="3 The convergence on plane-wave cut-off" class="md-nav__link">
    3 The convergence on plane-wave cut-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-convergence-on-the-double-grid-fft-cut-off" title="4 The convergence on the double grid FFT cut-off" class="md-nav__link">
    4 The convergence on the double grid FFT cut-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-plotting-paw-contributions-to-the-density-of-states-dos" title="5 Plotting PAW contributions to the Density of States (DOS)" class="md-nav__link">
    5 Plotting PAW contributions to the Density of States (DOS)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-testing-the-completeness-of-the-paw-partial-wave-basis" title="6 Testing the completeness of the PAW partial wave basis" class="md-nav__link">
    6 Testing the completeness of the PAW partial wave basis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-checking-the-validity-of-paw-results" title="7 Checking the validity of PAW results" class="md-nav__link">
    7 Checking the validity of PAW results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-additional-comments-about-paw-in-abinit" title="8 Additional comments about PAW in ABINIT" class="md-nav__link">
    8 Additional comments about PAW in ABINIT
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixing-scheme-for-the-self-consistent-cycle-decomposition-of-the-total-energy" title="Mixing scheme for the Self-Consistent cycle; decomposition of the total energy" class="md-nav__link">
    Mixing scheme for the Self-Consistent cycle; decomposition of the total energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overlap-of-paw-spheres" title="Overlap of PAW spheres" class="md-nav__link">
    Overlap of PAW spheres
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printing-volume-for-paw" title="Printing volume for PAW" class="md-nav__link">
    Printing volume for PAW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-paw-input-variables" title="Additional PAW input variables" class="md-nav__link">
    Additional PAW input variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pawu" title="PAW+U" class="md-nav__link">
    PAW+U
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#projector-augmented-wave-technique-how-to-use-it" title="Projector Augmented-Wave technique, how to use it?" class="md-nav__link">
    Projector Augmented-Wave technique, how to use it?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-the-paw-method" title="1 Summary of the PAW method" class="md-nav__link">
    1 Summary of the PAW method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-using-paw-with-abinit" title="2 Using PAW with ABINIT" class="md-nav__link">
    2 Using PAW with ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-convergence-on-plane-wave-cut-off" title="3 The convergence on plane-wave cut-off" class="md-nav__link">
    3 The convergence on plane-wave cut-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-convergence-on-the-double-grid-fft-cut-off" title="4 The convergence on the double grid FFT cut-off" class="md-nav__link">
    4 The convergence on the double grid FFT cut-off
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-plotting-paw-contributions-to-the-density-of-states-dos" title="5 Plotting PAW contributions to the Density of States (DOS)" class="md-nav__link">
    5 Plotting PAW contributions to the Density of States (DOS)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-testing-the-completeness-of-the-paw-partial-wave-basis" title="6 Testing the completeness of the PAW partial wave basis" class="md-nav__link">
    6 Testing the completeness of the PAW partial wave basis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-checking-the-validity-of-paw-results" title="7 Checking the validity of PAW results" class="md-nav__link">
    7 Checking the validity of PAW results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-additional-comments-about-paw-in-abinit" title="8 Additional comments about PAW in ABINIT" class="md-nav__link">
    8 Additional comments about PAW in ABINIT
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixing-scheme-for-the-self-consistent-cycle-decomposition-of-the-total-energy" title="Mixing scheme for the Self-Consistent cycle; decomposition of the total energy" class="md-nav__link">
    Mixing scheme for the Self-Consistent cycle; decomposition of the total energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overlap-of-paw-spheres" title="Overlap of PAW spheres" class="md-nav__link">
    Overlap of PAW spheres
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printing-volume-for-paw" title="Printing volume for PAW" class="md-nav__link">
    Printing volume for PAW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-paw-input-variables" title="Additional PAW input variables" class="md-nav__link">
    Additional PAW input variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pawu" title="PAW+U" class="md-nav__link">
    PAW+U
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paw1.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="first-lesson-on-the-projector-augmented-wave-paw-technique">First lesson on the projector-augmented wave (PAW) technique<a class="headerlink" href="#first-lesson-on-the-projector-augmented-wave-paw-technique" title="Permanent link">&para;</a></h1>
<h2 id="projector-augmented-wave-technique-how-to-use-it">Projector Augmented-Wave technique, how to use it?<a class="headerlink" href="#projector-augmented-wave-technique-how-to-use-it" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to perform a calculation in the frame of the PAW method.</p>
<p>You will learn how to launch a PAW calculation and what are the main input
variables that govern convergence and numerical efficiency.
It is supposed that you already know how to use ABINIT in the norm-conserving pseudopotential case.  </p>
<p>This lesson should take about 1.5 hour.</p>
<h2 id="1-summary-of-the-paw-method">1 Summary of the PAW method<a class="headerlink" href="#1-summary-of-the-paw-method" title="Permanent link">&para;</a></h2>
<p>The PAW (Projector Augmented-Wave) method has been introduced by Peter Blochl in 1994. 
As he says:</p>
<blockquote>
<p>The projector augmented-wave method is an extension of
  augmented wave methods and the pseudopotential approach, which combines their
  traditions into a unified electronic structure method&rdquo;.<br />
  It is based on a linear and invertible transformation (the PAW transformation)
  that connects the &ldquo;true&rdquo; wavefunctions <script type="math/tex">\Psi</script> with &ldquo;auxiliary&rdquo; (or &ldquo;pseudo&rdquo;) soft
  wavefunctions <script type="math/tex">\tPsi</script>:</p>
</blockquote>
<p>
<script type="math/tex; mode=display">\begin{equation} \label{eq:PAW_true_wavefunction}
|\Psi\rangle = |\tPsi\rangle + \sum_i \sum_a \Bigl(|\phi_i^a\rangle - |\tphi_i^a\rangle \Bigr)
\,\langle \tprj_i^a|\tPsi\rangle = |\tPsi\rangle + \sum_a |\Psi^1_a\rangle - |\tPsi_a^1\rangle 
\end{equation}</script>
</p>
<p>This relation is based on the definition of atomic spheres (augmentation
regions) of radius <script type="math/tex">r_c</script>, around the atoms of the system in which the partial
waves  <script type="math/tex">|\phi_i\rangle</script> form a basis of atomic wavefunctions; <script type="math/tex">|\tphi_i\rangle</script> are &ldquo;pseudized&rdquo;
partial waves (obtained from <script type="math/tex">|\phi_i\rangle</script>), and <script type="math/tex">|\tprj_i\rangle</script> are dual functions of the <script type="math/tex">|\tphi_i\rangle</script>
called projectors.
It is therefore possible to write every quantity depending on <script type="math/tex">\Psi_n</script> (density,
energy, Hamiltonian) as a function of <script type="math/tex">\tPsi_n</script> and to find <script type="math/tex">\tPsi_n</script> by solving self-consistent equations.</p>
<p>The PAW method has two main advantages:  </p>
<ol>
<li>From <script type="math/tex">\tPsi</script>, it is always possible to obtain the true &ldquo;all electron&rdquo; wavefunction <script type="math/tex">\Psi</script>.  </li>
<li>The convergency is comparable to an ultrasoft pseudopotential one.</li>
</ol>
<p>From a practical point of view (user&rsquo;s point of view), a PAW calculation is
rather similar to a norm-conserving pseudopotential one. Most noticeably, one
will have to use a special atomic data file (PAW dataset) that contains the
<script type="math/tex">\phi_i</script>, <script type="math/tex">\tphi_i</script> and <script type="math/tex">\tprj_i</script> and that plays the same role as a pseudopotential file.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is highly recommended to read the following papers to understand correctly
the basic concepts of the PAW method: <a class="wikilink citation-wikilink" data-content="Projector augmented-wave method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bloechl1994">[Bloechl1994]</a> and <a class="wikilink citation-wikilink" data-content="From ultrasoft pseudopotentials to the projector augmented-wave method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#kresse1999">[Kresse1999]</a>.
The implementation of the PAW method in ABINIT is detailed in <a class="wikilink citation-wikilink" data-content="Implementation of the projector augmented-wave method in the ABINIT code: Application to the study of iron under pressure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#torrent2008">[Torrent2008]</a>,
describing specific notations and formulations</p>
</div>
<h2 id="2-using-paw-with-abinit">2 Using PAW with ABINIT<a class="headerlink" href="#2-using-paw-with-abinit" title="Permanent link">&para;</a></h2>
<p><em>Before continuing, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_paw1&rdquo;?
In what follows, the name of files are mentioned as if you were in this subdirectory.
All the input files can be found in the ~abinit/tests/tutorial/Input directory.</em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><em>You can compare your results with reference output files located in
~abinit/tests/tutorial/Refs and ~abinit/tests/tutorial/Refs/tpaw1_addons
directories (for the present tutorial they are named <code class="codehilite">tpaw1_*.out</code>).</em></p>
</div>
<p>The input file tpaw1_1.in is an example of a file that contains data for
computing the total energy for diamond at the experimental volume (within the
LDA exchange-correlation functional). You might use the file tpaw1_1.files
(with a standard norm-conserving pseudopotential) as a &ldquo;files&rdquo; file, and get
the corresponding output file (it is available in ../Refs/tpaw1_1.out).<br />
Copy the files tpaw1_1.in and tpaw1_1.files in your work directory, and run ABINIT:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpaw1_1.files &gt; tmp-log
</pre></div>


<p>In the meantime, you can read the input file and see that there is no PAW input variable.<br />
ABINIT should run very quickly&hellip;</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-f7d9fba1-51b6-4766-8aed-c5e7ac8ef7fe" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_1.files
</button>
<button type="button" id="uuid-7ce9adf3-6155-4baf-953f-e2d1d0391c96" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_1.in
</button>
</div></div>

<div id="uuid-2b5ba8ff-fd02-4148-bab7-b6c89a8c494c" class="my_dialog" title="tests/tutorial/Input/tpaw1_1.files" hidden><div><pre class="small-text">
tpaw1_1.in
tpaw1_1.out
tpaw1_1i
tpaw1_1o
tpaw1_1tmp
../../../Psps_for_tests/6c.pspnc

#PAW: Replace the last line by the following
../../../Psps_for_tests/6c.lda.atompaw

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-2b5ba8ff-fd02-4148-bab7-b6c89a8c494c", "#uuid-f7d9fba1-51b6-4766-8aed-c5e7ac8ef7fe") }); </script>

<div id="uuid-208d0ccf-c2ee-44d0-b546-7d4adfa28fdc" class="my_dialog" title="tests/tutorial/Input/tpaw1_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># =======================================</span>
<span class="c1"># Input for PAW1 tutorial</span>
<span class="c1"># Diamond at experimental volume</span>
<span class="c1"># =======================================</span>

<span class="c1">#Cell and atoms definition</span>
 acell <span class="m">3</span>*3.567 angstrom
 rprim <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
 ntypat <span class="m">1</span>  natom <span class="m">2</span>  typat <span class="m">2</span>*1
 xred <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
      <span class="m">1</span>/4 <span class="m">1</span>/4 <span class="m">1</span>/4
 znucl <span class="m">6</span>  nband <span class="m">6</span>

<span class="c1">#Grid definitions</span>
 ecut <span class="m">15</span>.
 ecutsm <span class="m">0</span>.5

<span class="c1">#SCF cycle parameters</span>
 tolvrs <span class="m">1</span>.0d-10
 nstep <span class="m">20</span>

<span class="c1">#K-points and sym</span>
 nsym <span class="m">0</span>       
 occopt <span class="m">1</span>
 ngkpt <span class="m">6</span> <span class="m">6</span> <span class="m">6</span>
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#I/O parameters</span>
 prtwf <span class="m">0</span> prtden <span class="m">0</span>  prteig <span class="m">0</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw1_1.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00</span>
<span class="c1">#%% psp_files =  6c.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Input for PAW1 tutorial</span>
<span class="c1">#%%   Diamond at experimental volume</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-208d0ccf-c2ee-44d0-b546-7d4adfa28fdc", "#uuid-7ce9adf3-6155-4baf-953f-e2d1d0391c96") }); </script>

<p>Now, open the tpaw1_1.files and modify the last line; replace the 6c.pspnc file by 6c.lda.atompaw.
Run ABINIT again:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpaw1_1.files &gt; tmp-log
</pre></div>


<p>Your run should stop almost immediately!
The input file is missing the mandatory argument <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>!!</p>
<p>Add the line:</p>
<div class="codehilite"><pre><span></span>pawecutdg 50
</pre></div>


<p>to tpaw1_1.in file and run ABINIT again. Now the code runs to the end.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The time needed for the PAW run is greater than the time needed for
the norm-conserving pseudopotential run; indeed, at constant value of plane
wave cut-off energy <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> PAW requires more computational resources:    </p>
<ul>
<li>the &ldquo;on-site&rdquo; contributions have to be computed,  </li>
<li>the nonlocal contribution of the PAW dataset uses 2 projectors per angular momentum, 
  while the nonlocal contribution of the present norm-conserving pseudopotential uses only one.  </li>
</ul>
<p>However, as the plane wave cut-off energy required by PAW is much smaller than
the cut-off needed for the norm-conserving pseudopotential (see next section),
a PAW calculation will actually require less CPU time.</p>
</div>
<p>Let&rsquo;s open the output file and have a look inside
(be careful, it is the last output file of the tpaw1_1 series).
Compared to an output file for a norm-conserving pseudopotential run, an
output file for PAW contains the following specific topics:</p>
<p>At the beginning of the file,
some specific default PAW input variables (<a class="wikilink codevar-wikilink" href="../../variables/paw#ngfftdg">ngfftdg</a>, <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>, and
<a class="wikilink codevar-wikilink" href="../../variables/dev#useylm">useylm</a>) are mentioned in the section:</p>
<div class="codehilite"><pre><span></span>-outvars: echo values of preprocessed input variables --------
</pre></div>


<p>The use of two FFT grids, mentioned in:</p>
<div class="codehilite"><pre><span></span>Coarse grid specifications (used for wave-functions):  

getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  18  
        ecut(hartree)=     15.000   =&gt; boxcut(ratio)=   2.17276  

Fine grid specifications (used for densities):  

getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  32  32  32  
        ecut(hartree)=     50.000   =&gt; boxcut(ratio)=   2.10918 
</pre></div>

<p>A specific description of the PAW dataset (you might follow the tutorial <a class="wikilink lesson-wikilink" href="../paw2">PAW2</a>, 
devoted to the building of the PAW atomic data, for a complete understanding of the file):</p>
<div class="codehilite"><pre><span></span>Pseudopotential format is: paw4  
basis_size (lnmax)=  4 (lmn_size=  8), orbitals=   0   0   1   1  
Spheres core radius: rc_sph= 1.50000000  
4 radial meshes are used:  
 - mesh 1: r(i)=AA*[exp(BB*(i-1))-1], size= 505 , AA= 0.21824E-02 BB=0.13095E-01  
 - mesh 2: r(i)=AA*[exp(BB*(i-1))-1], size= 500 , AA= 0.21824E-02 BB=0.13095E-01  
 - mesh 3: r(i)=AA*[exp(BB*(i-1))-1], size= 530 , AA= 0.21824E-02 BB=0.13095E-01  
 - mesh 4: r(i)=AA*[exp(BB*(i-1))-1], size= 644 , AA= 0.21824E-02 BB=0.13095E-01  
Shapefunction is SIN type: shapef(r)=[sin(pi*r/rshp)/(pi*r/rshp)]**2  
Radius for shape functions = sphere core radius  
Radial grid used for partial waves is grid 1  
Radial grid used for projectors is grid 2  
Radial grid used for (t)core density is grid 3  
Radial grid used for Vloc is grid 4  
Radial grid used for pseudo valence density is grid 4
</pre></div>

<p>After the SCF cycle section:</p>
<p>The value of the integrated compensation charge evaluated by two different
numerical methodologies (remember: PAW atomic dataset are not norm-conserving
pseudopotentials); it is given calculated in the augmentation regions (PAW
spheres) on the &ldquo;spherical&rdquo; grid and also in the whole simulation cell on the
&ldquo;FFT&rdquo; grid. A discussion on these two values will be done in a forthcoming section.</p>
<div class="codehilite"><pre><span></span>PAW TEST:  
==== Compensation charge inside spheres ============  
The following values must be close to each other ...  
Compensation charge over spherical meshes =      0.413178580356274  
Compensation charge over fine fft grid    =      0.413177280314290
</pre></div>

<p>Information concerning the non-local term (pseudopotential strength <script type="math/tex">D_{ij}</script>)
and the spherical density matrix (augmentation wave occupancies <script type="math/tex">\rho_{ij}</script>):</p>
<div class="codehilite"><pre><span></span>==== Results concerning PAW augmentation regions ====  

Total pseudopotential strength Dij (hartree):  
Atom #  1  
  ...  
Atom #  2  
  ...

ugmentation waves occupancies Rhoij:  
Atom #  1  
 ...  
Atom #  2  
 ...
</pre></div>

<p>At the end of the file we find the decomposition of the total energy both 
by direct calculation and double counting calculation:</p>
<div class="codehilite"><pre><span></span>--------------------------------------------------------------------------------  
 Components of total free energy (in Hartree) :  

    Kinetic energy  =  6.40164318808980E+00  
    Hartree energy  =  9.63456708252837E-01  
    XC energy       = -3.53223656186138E+00  
    Ewald energy    = -1.27864121210521E+01  
    PspCore energy  =  5.41017918797015E-01  
    Loc. psp. energy= -5.27003595856857E+00  
    Spherical terms =  2.15689044331394E+00  
    &gt;&gt;&gt;&gt;&gt; Internal E= -1.15256763830284E+01  

 &quot;Double-counting&quot; decomposition of free energy:  
    Band energy     =  6.87331579398577E-01  
    Ewald energy    = -1.27864121210521E+01  
    PspCore energy  =  5.41017918797015E-01  
    Dble-C XC-energy=  1.22161340385476E-01  
    Spherical terms = -8.97688814082645E-02  
    &gt;&gt;&gt;&gt;&gt; Internal E= -1.15256701638793E+01  

  &gt;Total energy in eV           = -3.13629604304723E+02  
  &gt;Total DC energy in eV        = -3.13629435073068E+02
</pre></div>

<p>Note that the total energy calculated in PAW is not the same as the one
obtained in the norm-conserving pseudopotential case. This is normal: in the
norm-conserving potential case, the energy reference has been arbitrarily
modified by the pseudopotential construction procedure. Comparing total
energies computed with different PAW potentials is more meaningful: most of
the parts of the energy are calculated exactly, and in general you should be
able to compare numbers for (valence) <em>energies</em> between different PAW potentials or different codes.</p>
<h2 id="3-the-convergence-on-plane-wave-cut-off">3 The convergence on plane-wave cut-off<a class="headerlink" href="#3-the-convergence-on-plane-wave-cut-off" title="Permanent link">&para;</a></h2>
<p>As in the usual case, the critical convergence parameter is the cut-off
defining the size of the plane-wave basis&hellip;</p>
<p><strong>3.a</strong> <strong>Computing the convergence in ecut for diamond in the norm-conserving case</strong></p>
<p>The input file tpaw1_2.in contains data for computing the convergence in ecut
for diamond (at experimental volume). There are 9 datasets, for which <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>
increases from 8 Ha to 24 Ha by step of 2 Ha.
You might use the tpaw1_2.files file (with a standard norm-conserving
pseudopotential), and run ABINIT:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpaw1_2.files &gt; tmp-log
</pre></div>


<p>You should obtain the values (output file tpaw1_2.out):</p>
<div class="codehilite"><pre><span></span>etotal1  -1.1628880677E+01  
etotal2  -1.1828052470E+01  
etotal3  -1.1921833945E+01  
etotal4  -1.1976374633E+01  
etotal5  -1.2017601960E+01  
etotal6  -1.2046855404E+01  
etotal7  -1.2062173253E+01  
etotal8  -1.2069642342E+01  
etotal9  -1.2073328672E+01
</pre></div>


<p>You can check that the etotal convergence (at the 1 mHartree level) is not
achieved for ecut = 24 Hartree.</p>
<p><strong>3.b</strong> <strong>Computing the convergence in ecut for diamond in the PAW case</strong></p>
<p>Use the same input files as in section 1.a.
Again, modify the last line of tpaw1_2.files, replacing the 6c.pspnc file by 6c.lda.atompaw.
Run ABINIT again and open the output file (it should be tpaw1_2.outA)
You should obtain the values:</p>
<div class="codehilite"><pre><span></span>etotal1  -1.1474828697E+01  
etotal2  -1.1518675625E+01  
etotal3  -1.1524581240E+01  
etotal4  -1.1525548758E+01  
etotal5  -1.1525741818E+01  
etotal6  -1.1525865084E+01  
etotal7  -1.1525926864E+01  
etotal8  -1.1525947400E+01  
etotal9  -1.1525954817E+01
</pre></div>


<p>You can check that:</p>
<ol>
<li>The etotal convergence (at 1 mHartree) is achieved for 12&lt;=ecut&lt;=14 Hartree
   (etotal4 is within 1 mHartree of the final value);  </li>
<li>The etotal convergence (at 0.1 mHartree) is achieved for 16&lt;=ecut&lt;=18 Hartree
   (etotal6 is within 0.1 mHartree of the final value).</li>
</ol>
<p>So with the same input, a PAW calculation for diamond needs a lower cutoff,
compared to a norm-conserving pseudopotential calculation.</p>
<h2 id="4-the-convergence-on-the-double-grid-fft-cut-off">4 The convergence on the double grid FFT cut-off<a class="headerlink" href="#4-the-convergence-on-the-double-grid-fft-cut-off" title="Permanent link">&para;</a></h2>
<p>In a norm-conserving calculation, the (plane wave) density
grid is (at least) twice bigger than the wavefunctions grid, in each
direction. In a PAW calculation, the (plane wave) density grid is tunable
thanks to the input variable <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> (PAW: ECUT for Double Grid). This
is needed because of the mapping of objects (densities, potentials) located
in the augmentation regions (PAW spheres) onto the global FFT grid.<br />
The number of points of the Fourier grid located in the spheres must be high
enough to preserve the accuracy. It is determined from the cut-off energy
<a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>. An alternative is to use directly the input variable
<a class="wikilink codevar-wikilink" href="../../variables/paw#ngfftdg">ngfftdg</a>. One of the most sensitive objects affected by this &ldquo;grid
transfer&rdquo; is the compensation charge density; its integral over the
augmentation regions (on spherical grids) must cancel with its integral over
the whole simulation cell (on the FFT grid).</p>
<p>Use now the input file tpaw1_3.in and the associated tpaw1_3.files file.<br />
The only difference with the tpaw1_2.in file is that <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> is fixed to 12
Ha, while <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> runs from 12 to 39 Ha.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-f2b2c2e2-787f-474c-b48d-62580ab29b14" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_3.files
</button>
<button type="button" id="uuid-2ef98e38-f37e-40c6-9db5-f15dff88e6c5" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_3.in
</button>
</div></div>

<div id="uuid-a88c9ef5-c6f4-4611-ac1f-de1f461f0af1" class="my_dialog" title="tests/tutorial/Input/tpaw1_3.files" hidden><div><pre class="small-text">
tpaw1_3.in
tpaw1_3.out
tpaw1_3i
tpaw1_3o
tpaw1_3tmp
../../../Psps_for_tests/6c.lda.atompaw

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a88c9ef5-c6f4-4611-ac1f-de1f461f0af1", "#uuid-f2b2c2e2-787f-474c-b48d-62580ab29b14") }); </script>

<div id="uuid-09e399ce-5f5d-482b-a00b-f164c0bfaac6" class="my_dialog" title="tests/tutorial/Input/tpaw1_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># =======================================</span>
<span class="c1"># Input for PAW1 tutorial</span>
<span class="c1"># Diamond at experimental volume</span>
<span class="c1"># =======================================</span>

<span class="c1">#Datasets: convergence on pawecutdg</span>
ndtset <span class="m">10</span>   pawecutdg: <span class="m">12</span>. pawecutdg+ <span class="m">3</span>.

<span class="c1">#Cell and atoms definition</span>
 acell <span class="m">3</span>*3.567 angstrom
 rprim <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
 ntypat <span class="m">1</span>  natom <span class="m">2</span>  typat <span class="m">2</span>*1
 xred <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
      <span class="m">1</span>/4 <span class="m">1</span>/4 <span class="m">1</span>/4
 znucl <span class="m">6</span>  nband <span class="m">6</span>

<span class="c1">#Basis definitions</span>
 ecut <span class="m">12</span>.
 ecutsm <span class="m">0</span>.5

<span class="c1">#SCF cycle parameters</span>
 tolvrs <span class="m">1</span>.0d-10
 nstep <span class="m">20</span>

<span class="c1">#K-points and sym</span>
 nsym <span class="m">0</span>       
 occopt <span class="m">1</span>
 ngkpt <span class="m">6</span> <span class="m">6</span> <span class="m">6</span>
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#I/O parameters</span>
 prtwf <span class="m">1</span> prtden <span class="m">0</span>  prteig <span class="m">0</span>
 getwfk -1


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw1_3.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options=-easy</span>
<span class="c1">#%% psp_files =  6c.lda.atompaw </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Input for PAW1 tutorial</span>
<span class="c1">#%%   Diamond at experimental volume</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-09e399ce-5f5d-482b-a00b-f164c0bfaac6", "#uuid-2ef98e38-f37e-40c6-9db5-f15dff88e6c5") }); </script>

<p>Launch ABINIT with these files; you should obtain the values (file tpaw1_3.out):</p>
<div class="codehilite"><pre><span></span>etotal1  -1.1524629595E+01  
etotal2  -1.1524595840E+01  
etotal3  -1.1524585370E+01  
etotal4  -1.1524580630E+01  
etotal5  -1.1524584720E+01  
etotal6  -1.1524583573E+01  
etotal7  -1.1524582786E+01  
etotal8  -1.1524582633E+01  
etotal9  -1.1524582213E+01  
etotal10 -1.1524582316E+01
</pre></div>


<p>We see that the variation of the energy wit respect to this parameter is well
below the 1 mHa level. In principle, it should be sufficient to choose
pawecutdg=12 Ha in order to obtain an energy change lower than 1 mHa. In
practice, it is better to keep a security margin. Here, for pawecutdg=24 Ha
(5<sup>th</sup> dataset), the energy change is lower than 0.001 mHa``: this choice will be more than enough.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note the steps in the convergence. They are due to the sudden (integer)
changes in the grid size (see the output values for  <a class="wikilink codevar-wikilink" href="../../variables/paw#ngfftdg">ngfftdg</a>) which do not
occur for each increase of <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>. To avoid troubles due to these
steps, it is better to choose a value of pawecutdg slightly higher.  </p>
</div>
<p>The convergence of the compensation charge has a similar behaviour; it is
possible to check it in the output file, just after the SCF cycle by looking at:</p>
<div class="codehilite"><pre><span></span>PAW TEST:  
==== Compensation charge inside spheres ============  
The following values must be close...  
Compensation charge over spherical meshes =      0.409392121335747  
Compensation charge over fine fft grid    =      0.409392418241149
</pre></div>

<p>The two values of the integrated compensation charge density must be close to each other.
Note that, for numerical reasons, they cannot be exactly the same (integration
over a radial grid does not use the same scheme as integration over a FFT grid).</p>
<p>Additional test:<br />
We want now to check the convergence in <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> with a fixed value of 24 Ha
for <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>. Modify the file tpaw1_2.in, setting pawecutdg to 24 Ha, and launch ABINIT again&hellip;<br />
You should obtain the values:  </p>
<div class="codehilite"><pre><span></span>etotal1  -1.1474831477E+01  
etotal2  -1.1518678975E+01  
etotal3  -1.1524584720E+01  
etotal4  -1.1525552267E+01  
etotal5  -1.1525745330E+01  
etotal6  -1.1525868591E+01  
etotal7  -1.1525930368E+01  
etotal8  -1.1525950904E+01  
etotal9  -1.1525958319E+01
</pre></div>


<p>You can check again that:  </p>
<ol>
<li>The etotal convergence (at the 1 mHartree level) is achieved for 12&lt;=ecut&lt;=14 Hartree;</li>
<li>The etotal convergence (at the 0.1 mHartree level) is achieved for 16&lt;=ecut&lt;=18 Hartree.  </li>
</ol>
<dl>
<dt>Note 1</dt>
<dd>Associated with the input variable <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> is the input variable
<a class="wikilink codevar-wikilink" href="../../variables/paw#ngfftdg">ngfftdg</a>: it gives the size of the FFT grid associated with <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>.
Note that <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> is only useful to define the FFT grid for the density
in a convenient way. You can therefore tune directly <a class="wikilink codevar-wikilink" href="../../variables/paw#ngfftdg">ngfftdg</a> to define the
size of the FFT grid for the density.  </dd>
<dt>Note 2</dt>
<dd>Although <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> should always be checked, in practice, a common use it
to put it bigger than <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> and keep it constant during all calculations.
Increasing <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> slightly changes the CPU execution time, but above
all it is memory-consuming.
Note that, if <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> is already high, there is no need for a high <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a>.  </dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When testing <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> convergency, <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> has to remain
constant to obtain consistent results.</p>
</div>
<h2 id="5-plotting-paw-contributions-to-the-density-of-states-dos">5 Plotting PAW contributions to the Density of States (DOS)<a class="headerlink" href="#5-plotting-paw-contributions-to-the-density-of-states-dos" title="Permanent link">&para;</a></h2>
<p>We now use the input file tpaw1_4.in and the associated tpaw1_4.files file.
ABINIT is now asked to compute the Density Of State (DOS) (see the  <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a>
keyword in the input file). Also note that more k-points are used in order to
increase the accuracy of the DOS. <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> is set to 12 Ha, while <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> is 24 Ha.</p>
<div class="text-center"><button type="button" id="uuid-511b491f-0961-4bf8-8563-a3ca96b67cea" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_4.in
</button></div>

<div id="uuid-5bed41a0-9694-45ae-b9d1-543aeb1aeffc" class="my_dialog" title="tests/tutorial/Input/tpaw1_4.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># =======================================</span>
<span class="c1"># Input for PAW1 tutorial</span>
<span class="c1"># Diamond at experimental volume</span>
<span class="c1"># =======================================</span>

<span class="c1">#Output of the total DOS</span>
 prtdos <span class="m">1</span>

<span class="c1">#Output of the projected DOS (with PAW contribs)</span>
<span class="c1"># prtdos 3  pawprtdos 1</span>
<span class="c1"># natsph 1 iatsph 1 ratsph 1.5</span>


<span class="c1">#Cell and atoms definition</span>
 acell <span class="m">3</span>*3.567 angstrom
 rprim <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
 ntypat <span class="m">1</span>  natom <span class="m">2</span>  typat <span class="m">2</span>*1
 xred <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
      <span class="m">1</span>/4 <span class="m">1</span>/4 <span class="m">1</span>/4
 znucl <span class="m">6</span>  nband <span class="m">6</span>

<span class="c1">#Basis definitions</span>
 ecut <span class="m">12</span>.
 ecutsm <span class="m">0</span>.5
 pawecutdg <span class="m">24</span>.

<span class="c1">#SCF cycle parameters</span>
 tolwfr <span class="m">1</span>.0d-12 nbdbuf <span class="m">2</span>  <span class="c1">#nbdbuf:does not take care of empty bands</span>
 nstep <span class="m">10</span>

<span class="c1">#K-points and sym</span>
 nsym <span class="m">0</span>       
 occopt <span class="m">7</span>  tsmear <span class="m">0</span>.005
 ngkpt <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#I/O parameters</span>
 prtwf <span class="m">0</span> prtden <span class="m">0</span> prteig <span class="m">0</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw1_4.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  6c.lda.atompaw</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Input for PAW1 tutorial</span>
<span class="c1">#%%   Diamond at experimental volume</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5bed41a0-9694-45ae-b9d1-543aeb1aeffc", "#uuid-511b491f-0961-4bf8-8563-a3ca96b67cea") }); </script>

<p>Launch ABINIT with these files; you should obtain the tpaw1_4.out and the DOS file (tpaw1_4o_DOS):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpaw1_4.files &gt; tmp-log
</pre></div>


<p>You can plot the DOS file if you want; for this purpose, use a graphical tool
and plot column 3 with respect to column 2. If you use the &ldquo;xmgrace&rdquo; tool, launch:</p>
<div class="codehilite"><pre><span></span>xmgrace -block tpaw1_4o_DOS -bxy 1:2
</pre></div>


<p>At this stage, you have the usual plot for a DOS; nothing specific to PAW.</p>
<p>Now, edit the tpaw1_4.in file, comment the &ldquo;<a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a> 1&rdquo;, and uncomment (or add):</p>
<div class="codehilite"><pre><span></span>prtdos 3  pawprtdos 1 natsph 1 iatsph 1 ratsph 1.5
</pre></div>


<p>The &rdquo; <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a> 3&rdquo; statement now requires the output of the projected DOS;
&ldquo;<a class="wikilink codevar-wikilink" href="../../variables/gstate#natsph">natsph</a> 1  <a class="wikilink codevar-wikilink" href="../../variables/gstate#iatsph">iatsph</a> 1  <a class="wikilink codevar-wikilink" href="../../variables/gstate#ratsph">ratsph</a> 1.5&rdquo; selects the first carbon atom as
the center of projection, and sets the radius of the projection area to 1.5
atomic units (this is exactly the radius of the PAW augmentation regions:
generally the best choice).
The &ldquo;<a class="wikilink codevar-wikilink" href="../../variables/paw#pawprtdos">pawprtdos</a> 1&rdquo; is specific to PAW. With this option, ABINIT is asked to
compute all the contributions to the projected DOS.</p>
<p>Let&rsquo;s remember that:</p>
<p>
<script type="math/tex; mode=display">\begin{equation*} 
|\Psi\rangle = |\tPsi\rangle + \sum_i \sum_a \Bigl(|\phi_i^a\rangle - |\tphi_i^a\rangle \Bigr)
\,\langle \tprj_i^a|\tPsi\rangle 
\end{equation*}</script>
</p>
<p>Within PAW, the total projected DOS has 3 contributions:  </p>
<ol>
<li>the smooth plane-waves contribution (from <script type="math/tex">|\tPsi\rangle</script>)  </li>
<li>the all-electron on-site contribution (from <script type="math/tex">\phi_i \langle \tprj_i|\tPsi\rangle</script>
</li>
<li>the pseudo on-site contribution (from <script type="math/tex">\tphi_i \langle \tprj_i|\tPsi\rangle</script>
</li>
</ol>
<p>Launch ABINIT again (with the modified input file). You get a new DOS file, named tpaw1_4o_DOS_AT0001.
You can edit it and look inside; it contains the 3 PAW contributions
(mentioned above) for each angular momentum. In the diamond case, only l=0 and
l=1 momenta are treated.</p>
<p>Now, plot the file, using the 7<sup>th</sup>, 12<sup>th</sup> and 17<sup>th</sup> columns with respect to the
2<sup>nd</sup> one; it plots the 3 PAW contributions for l=0 (the total DOS is the sum of
the three contributions).
If you use the &ldquo;xmgrace&rdquo; tool, launch:</p>
<div class="codehilite"><pre><span></span>xmgrace -block tpaw1_4o_DOS_AT0001 -bxy 1:7 -bxy 1:12 -bxy 1:17
</pre></div>


<p>You should get this:</p>
<p><img alt="Projected DOS - 4 proj" src="../paw1_assets/DOS-4proj.jpg" />  </p>
<p>As you can see, the smooth PW contribution and the PS on-site contribution are close.
So, in a first approach, they cancel; we could approximate the DOS by the AE
on-site part taken alone.
That is exactly what is done when <a class="wikilink codevar-wikilink" href="../../variables/paw#pawprtdos">pawprtdos</a>=2; in that case, only the AE
on-site contribution is computed and given as a good approximation of the
total projected DOS. The main advantage of this option is the decrease of the
CPU time needed to compute the DOS (it is instantaneously computed).</p>
<p>But, as you will see in the next section, this approximation is only valid when:</p>
<ol>
<li>the <script type="math/tex">\tphi_i</script> basis is complete enough  </li>
<li>the electronic density is mainly contained in the sphere defined by <a class="wikilink codevar-wikilink" href="../../variables/gstate#ratsph">ratsph</a>.</li>
</ol>
<h2 id="6-testing-the-completeness-of-the-paw-partial-wave-basis">6 Testing the completeness of the PAW partial wave basis<a class="headerlink" href="#6-testing-the-completeness-of-the-paw-partial-wave-basis" title="Permanent link">&para;</a></h2>
<p>Note that, in the previous section, we used a &ldquo;standard&rdquo; PAW dataset, with 2
partial waves per angular momentum. It is generally the best compromise
between the completeness of the partial wave basis and the efficiency of the
PAW dataset (the more partial waves you have, the longer the CPU time used by ABINIT is).</p>
<p>Let&rsquo;s have a look at the ~abinit/tests/Psps_for_tests/6c.lda.atompaw file.
The sixth line indicates the number of partial waves and their l angular momentum.
In the present file, &ldquo;0 0 1 1&rdquo; means &ldquo;two l=0 partial waves, two l=1 partial waves&rdquo;.  </p>
<p>Now, let&rsquo;s open the  ~abinit/tests/Psps_for_tests/6c.lda.test-2proj.atompaw
and ~abinit/tests/Psps_for_tests/6c.lda.test-6proj.atompaw files. In the first
file, only one partial wave per l is present; in the second one, 3 partial
waves per l are present. In other words, the completeness of the partial wave
basis increases when you use 6c.lda.test-2proj.atompaw, 6c.lda.atompaw and
6c.lda.test-6proj.atompaw.</p>
<p>Now, let&rsquo;s plot the DOS for the two new PAW datasets.  </p>
<ol>
<li>First, save the existing tpaw1_4o_DOS_AT0001 file, naming it, for instance,
   tpaw1_4o_4proj_DOS_AT0001.</li>
<li>Open the tpaw1_4.files file and modify it in order to use the 6c.lda.test-2proj.atompaw PAW dataset.</li>
<li>Launch ABINIT again.</li>
<li>Save the new tpaw1_4o_DOS_AT0001 file, naming it, for instance, tpaw1_4o_2proj_DOS_AT0001.</li>
<li>Open the tpaw1_4.files file and modify it in order to use the 6c.lda.test-6proj.atompaw PAW dataset.</li>
<li>Launch ABINIT again.</li>
<li>Save the new tpaw1_4o_DOS_AT0001 file, naming it, for instance, tpaw1_4o_6proj_DOS_AT0001.</li>
</ol>
<p>Then, plot the contributions to the projected DOS for the two new DOS files.
You should get:</p>
<p><img alt="Projected DOS - 2 proj" src="../paw1_assets/DOS-2proj.jpg" /></p>
<p><img alt="Projected DOS - 6 proj" src="../paw1_assets/DOS-6proj.jpg" />  </p>
<p>Adding the DOS obtained in the previous section to the comparison, you
immediately see that the superposition of the Smooth part DOS and the PS 
on-site DOS depends on the completeness of the partial wave basis!</p>
<p>Now, you can have a look at the 3 output files (one for each PAW dataset)&hellip;
for instance in a comparison tool.
A way to estimate the completeness of the partial wave basis is to compare
derivatives of total energy; if you look at the stress stensor:</p>
<div class="codehilite"><pre><span></span>For the 2 partial-wave bases:  -1.0866668849E-03 -1.0866668849E-03 -1.0866668849E-03  0.  0.  0.  
For the 4 partial-wave basis:   4.1504385879E-04  4.1504385879E-04  4.1504385879E-04  0.  0.  0.  
For the 6 partial-wave basis:   4.1469803037E-04  4.1469803037E-04  4.1469803037E-04  0.  0.  0.
</pre></div>

<p>The 2 partial-wave basis is clearly not complete; the 4 partial-wave basis results are correct&hellip;
Such a test is useful to estimate the precision we can expect on the stress
tensor (at least due to the partial wave basis).</p>
<p>You can compare other results in the 3 output files: total energy, eigenvalues, occupations&hellip;
Also notice that the dimensions of the PAW on-site quantities change: have a
look at &ldquo;Pseudopotential strength Dij&rdquo; or &ldquo;Augmentation waves occupancies Rhoij&rdquo; sections&hellip;</p>
<p>Note: if you want to learn how to generate PAW datasets with different partial
wave bases, you might follow the tutorial PAW2.</p>
<h2 id="7-checking-the-validity-of-paw-results">7 Checking the validity of PAW results<a class="headerlink" href="#7-checking-the-validity-of-paw-results" title="Permanent link">&para;</a></h2>
<p>As usual, the validity of a &ldquo;pseudopotential&rdquo; (PAW dataset) has to be checked
by comparison, on known structures, with known results. In the case of
diamond, lots of computations and experimental results exist.
Very important remark: the validity (completeness of plane wave basis and
partial wave basis) of PAW calculations should always be checked by comparison
with all-electrons computation results (or with other existing PAW results);
it should not be done by comparison with experimental results.
As the PAW method has the same accuracy than all-electron methods, results should be very close.</p>
<p>Concerning diamond, all-electron results can be found (for instance) in PRB 55, 2005 (1997).
With the famous WIEN2K code (which uses the FP-LAPW method), all-electron
equilibrium parameters for diamond (for LDA) are:</p>
<div class="codehilite"><pre><span></span>a0 = 3.54 angstrom 
B = 470 GPa
</pre></div>


<p>Experiments give:</p>
<div class="codehilite"><pre><span></span>a0 = 3.56 angstrom
B = 443 GPa
</pre></div>


<p>Let&rsquo;s test with ABINIT.
We use now the input file tpaw1_5.in and the associated tpaw1_5.files file.
ABINIT is now asked to compute values of etotal for several cell parameters
around 3.54 angstrom, using the standard PAW dataset.</p>
<div class="text-center"><button type="button" id="uuid-de38be90-ccf7-4944-bbbf-b76acfe11da8" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw1_5.in
</button></div>

<div id="uuid-5d3e0539-07aa-48b5-8135-7a981b9f3c27" class="my_dialog" title="tests/tutorial/Input/tpaw1_5.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># =======================================</span>
<span class="c1"># Input for PAW1 tutorial</span>
<span class="c1"># Diamond: etotal vs acell curve around equilibrium</span>
<span class="c1"># =======================================</span>

<span class="c1">#Datasets: etotal vs acell</span>
ndtset <span class="m">7</span>   acell: <span class="m">3</span>*3.52 angstrom  acell+ <span class="m">3</span>*0.005 angstrom

<span class="c1">#Cell and atoms definition</span>
 acell <span class="m">3</span>*3.567 angstrom
 rprim <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
       <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
 ntypat <span class="m">1</span>  natom <span class="m">2</span>  typat <span class="m">2</span>*1
 xred <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
      <span class="m">1</span>/4 <span class="m">1</span>/4 <span class="m">1</span>/4
 znucl <span class="m">6</span>  nband <span class="m">6</span>

<span class="c1">#Basis definitions</span>
 ecut <span class="m">12</span>.
 ecutsm <span class="m">0</span>.5
 pawecutdg <span class="m">24</span>.

<span class="c1">#SCF cycle parameters</span>
 tolvrs <span class="m">1</span>.0d-10
 nstep <span class="m">10</span>

<span class="c1">#K-points and sym</span>
 nsym <span class="m">0</span>       
 occopt <span class="m">1</span>
 ngkpt <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>
 nshiftk <span class="m">4</span>
 shiftk <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5

<span class="c1">#I/O parameters</span>
 prtwf <span class="m">1</span> prtden <span class="m">0</span> prteig <span class="m">0</span>
 getwfk -1


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw1_5.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  6c.lda.atompaw </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Input for PAW1 tutorial</span>
<span class="c1">#%%   Diamond: etotal vs acell curve around equilibrium</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5d3e0539-07aa-48b5-8135-7a981b9f3c27", "#uuid-de38be90-ccf7-4944-bbbf-b76acfe11da8") }); </script>

<p>Launch ABINIT with these files; you should obtain the tpaw1_5.out.</p>
<div class="codehilite"><pre><span></span>abinit &lt; tpaw1_5.files &gt; tmp-log
</pre></div>


<p>From the tpaw1_5.out file, you can extract the 7 values of acell and 7 values
of etotal, then put them into a file and plot it with a graphical tool. You should get:</p>
<p><img alt="diamond: etotal vs acell" src="../paw1_assets/etotal-acell.jpg" /></p>
<p>From this curve, you can extract the cell values of a0 and B (with the method
of your choice, for example by a Birch-Murnhagan spline fit).
You get:</p>
<div class="codehilite"><pre><span></span>a0 = 3.535 angstrom B = 465 GPa
</pre></div>


<p>These results are in excellent agreement with FP-LAPW ones!</p>
<h2 id="8-additional-comments-about-paw-in-abinit">8 Additional comments about PAW in ABINIT<a class="headerlink" href="#8-additional-comments-about-paw-in-abinit" title="Permanent link">&para;</a></h2>
<h4 id="mixing-scheme-for-the-self-consistent-cycle-decomposition-of-the-total-energy"><strong>Mixing scheme for the Self-Consistent cycle; decomposition of the total energy</strong><a class="headerlink" href="#mixing-scheme-for-the-self-consistent-cycle-decomposition-of-the-total-energy" title="Permanent link">&para;</a></h4>
<p>The use of an efficient mixing scheme in the self-consistent loop is a crucial
point to minimize the number of steps to achieve convergence. This mixing can
be done on the potential or on the valence density. By default, in a 
norm-conserving pseudopotential calculation, the mixing is done on the potential;
but, for technical reasons, this choice is not optimal for PAW calculations.
Thus, by default, the mixing is done on the density when PAW is activated.
The mixing scheme can be controlled by the <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a> variable (please, read</p>
<p>again the different options of this input variable).
By default,  <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=7 for norm-conserving pseudopotentials, while <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>= 17 for PAW&hellip;
To compare both schemes, you can edit the tpaw1_1.in file and try <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=7
or 17 and compare the behaviour of the SC cycle in both cases; as you can see,
final total energy is the same but the way to reach it is completely different.</p>
<p>Now, have a look at the end of the file and focus on the &ldquo;Components of total
free energy&rdquo;; the total energy is decomposed according to both schemes; at
very high convergence of the SCF cycle (very small potential or density
residual), these two values should be the same. But it has been observed that
the converged value was reached more rapidly by the direct energy, when the
mixing is on the potential, and by the double counting energy when the mixing
is on the density. Thus, by default, in the output file is to print the direct
energy when the mixing is on the potential, and the double counting energy
when the mixing is on the density.</p>
<p>You can try (using the tpaw1_1.in file) to decrease the values of <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a>
and look at the difference between both values of energy.</p>
<p>Also note that PAW ρij quantities (occupancies of partial waves) also are
mixed during the SC cycle; by default, the mixing is done in the same way as the density.</p>
<h4 id="overlap-of-paw-spheres"><strong>Overlap of PAW spheres</strong><a class="headerlink" href="#overlap-of-paw-spheres" title="Permanent link">&para;</a></h4>
<p>In principle, the PAW formalism is only valid for non-overlapping augmentation
regions (PAW spheres). But, in usual cases, a small overlap between spheres is acceptable.
By default, ABINIT checks that the distances between atoms are large enough to
avoid overlap; a &ldquo;small&rdquo; voluminal overlap of 5% is accepted by default. This
value can be tuned with the <a class="wikilink codevar-wikilink" href="../../variables/paw#pawovlp">pawovlp</a> input keyword. The overlap check can
even be by-passed with <a class="wikilink codevar-wikilink" href="../../variables/paw#pawovlp">pawovlp</a>=-1.</p>
<p>Important warning: while a small overlap can be acceptable for the
augmentation regions, an overlap of the compensation charge densities has to
be avoided. The compensation charge density is defined by a radius (named
rshape in the PAW dataset file) and an analytical shape function. The overlap
related to the compensation charge radius is checked by ABINIT and a WARNING
is eventually printed&hellip;</p>
<p>Also note that you can control the compensation charge radius and shape
function while generating the PAW dataset (see tutorial PAW2).</p>
<h4 id="printing-volume-for-paw"><strong>Printing volume for PAW</strong><a class="headerlink" href="#printing-volume-for-paw" title="Permanent link">&para;</a></h4>
<p>If you want to get more detailed output concerning the PAW computation, you
can use the <a class="wikilink codevar-wikilink" href="../../variables/paw#pawprtvol">pawprtvol</a> input keyword. See its description in the user&rsquo;s manual&hellip;
It is particularly useful to print details about pseudopotential strength
(<script type="math/tex">D_{ij}</script>) or partial waves occupancies (<script type="math/tex">\rho_{ij}</script>).</p>
<h4 id="additional-paw-input-variables"><strong>Additional PAW input variables</strong><a class="headerlink" href="#additional-paw-input-variables" title="Permanent link">&para;</a></h4>
<p>Looking at the <a class="wikilink" href="../../variables/basic">basic varset</a> file, you can find input ABINIT keywords specific to PAW.
They are to be used when tuning the computation, in order to gain accuracy or save CPU time.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In a standard computation, these variables should not be modified!</p>
</div>
<p>Variables that can be used to gain accuracy (in ascending order of importance):</p>
<dl>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawxcdev">pawxcdev</a></dt>
<dd>control the accuracy of exchange-correlation on-site potentials
(try pawxcdev=2 to increase accuracy).</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#mqgriddg">mqgriddg</a></dt>
<dd>control the accuracy of spline fits to transfer densities/potentials from FFT grid to spherical grid.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawnzlm">pawnzlm</a></dt>
<dd>control the computation of moments of spherical densities that should be zero by symmetry.</dd>
</dl>
<p>Variables that can be used to save memory (in ascending order of importance):</p>
<dl>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawstgylm">pawstgylm</a></dt>
<dd>control the storage of spherical harmonics computed around atoms.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawmixdg">pawmixdg</a></dt>
<dd>control on which grid the potential/density is mixed during SCF cycles.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawlcutd">pawlcutd</a></dt>
<dd>control the number of angular momenta to take into account in on-site densities.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawlmix">pawlmix</a></dt>
<dd>control the number of <script type="math/tex">ρ_{ij}</script> to be mixed during SCF cycle.</dd>
</dl>
<p>Variables that can be used to save CPU time (in ascending order of importance):</p>
<dl>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawnhatxc">pawnhatxc</a></dt>
<dd>control the numerical treatment of gradients of compensation charge density in case of GGA</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawstgylm">pawstgylm</a></dt>
<dd>control the storage of spherical harmonics computed around atoms.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawlcutd">pawlcutd</a></dt>
<dd>control the number of angular momenta to take into account in on-site densities.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#pawlmix">pawlmix</a></dt>
<dd>control the number of ρij to be mixed during SCF cycle.</dd>
<dt><a class="wikilink codevar-wikilink" href="../../variables/paw#bxctmindg">bxctmindg</a></dt>
<dd>can be used to decrease the size of fine FFT grid for a given value of pawecutdg.</dd>
</dl>
<p>The above list is not exhaustive.
Several other keywords can be used to tune ABINIT PAW calculations.</p>
<h3 id="pawu">PAW+U<a class="headerlink" href="#pawu" title="Permanent link">&para;</a></h3>
<p>If the system under study contains strongly correlated electrons, the LDA+U
method can be useful. It is controlled by the  <a class="wikilink codevar-wikilink" href="../../variables/paw#usepawu">usepawu</a>, <a class="wikilink codevar-wikilink" href="../../variables/paw#lpawu">lpawu</a>,
<a class="wikilink codevar-wikilink" href="../../variables/paw#upawu">upawu</a> and <a class="wikilink codevar-wikilink" href="../../variables/paw#jpawu">jpawu</a> input keywords. 
Note that the formalism implemented in ABINIT is approximate, i.e. it is only valid if:</p>
<ol>
<li>the <script type="math/tex">\tphi_i</script> basis is complete enough;</li>
<li>the electronic density is mainly contained in the PAW sphere.</li>
</ol>
<p>The approximation done here is the same as the one explained in the 5<sup>th</sup>
section of this tutorial: considering that smooth PW contributions and PS
on-site contributions are closely related, only the AE on-site contribution is
computed; it is indeed a very good approximation.</p>
<p>Converging a Self-Consistent Cycle, or ensuring the global minimum is reached,
with PAW+U is sometimes difficult. Using <a class="wikilink codevar-wikilink" href="../../variables/paw#usedmatpu">usedmatpu</a> and <a class="wikilink codevar-wikilink" href="../../variables/paw#dmatpawu">dmatpawu</a> can help&hellip;</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../spin/" title="Spin" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Spin
              </span>
            </div>
          </a>
        
        
          <a href="../paw2/" title="PAW2" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PAW2
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (MT, FJ)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>