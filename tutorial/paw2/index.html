



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paw2/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>PAW2 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#second-lesson-on-the-projector-augmented-wave-paw-technique" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  PAW
                </span>
              
            
            PAW2
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" checked>
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        PAW2
      </label>
    
    <a href="./" title="PAW2" class="md-nav__link md-nav__link--active">
      PAW2
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-generation-of-atomic-data" title="The generation of atomic data." class="md-nav__link">
    The generation of atomic data.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-paw-atomic-dataset-introduction" title="1 The PAW atomic dataset - introduction" class="md-nav__link">
    1 The PAW atomic dataset - introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-use-of-the-generation-code" title="2 Use of the generation code" class="md-nav__link">
    2 Use of the generation code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-first-and-basic-paw-dataset-for-nickel" title="3 First (and basic) PAW dataset for Nickel" class="md-nav__link">
    3 First (and basic) PAW dataset for Nickel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-checking-the-sensitivity-of-results-to-some-parameters" title="4 Checking the sensitivity of results to some parameters" class="md-nav__link">
    4 Checking the sensitivity of results to some parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adjusting-partial-waves-and-projectors" title="5 Adjusting partial waves and projectors" class="md-nav__link">
    5 Adjusting partial waves and projectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-examine-the-logarithmic-derivatives" title="6 Examine the logarithmic derivatives" class="md-nav__link">
    6 Examine the logarithmic derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-testing-efficiency-of-paw-dataset" title="7 Testing efficiency of PAW dataset" class="md-nav__link">
    7 Testing efficiency of PAW dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-testing-against-physical-quantities" title="8 Testing against physical quantities" class="md-nav__link">
    8 Testing against physical quantities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-the-real-space-optimization-rso-experienced-users" title="9 The Real Space Optimization (RSO) - experienced users" class="md-nav__link">
    9 The Real Space Optimization (RSO) - experienced users
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-generation-of-atomic-data" title="The generation of atomic data." class="md-nav__link">
    The generation of atomic data.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-paw-atomic-dataset-introduction" title="1 The PAW atomic dataset - introduction" class="md-nav__link">
    1 The PAW atomic dataset - introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-use-of-the-generation-code" title="2 Use of the generation code" class="md-nav__link">
    2 Use of the generation code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-first-and-basic-paw-dataset-for-nickel" title="3 First (and basic) PAW dataset for Nickel" class="md-nav__link">
    3 First (and basic) PAW dataset for Nickel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-checking-the-sensitivity-of-results-to-some-parameters" title="4 Checking the sensitivity of results to some parameters" class="md-nav__link">
    4 Checking the sensitivity of results to some parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adjusting-partial-waves-and-projectors" title="5 Adjusting partial waves and projectors" class="md-nav__link">
    5 Adjusting partial waves and projectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-examine-the-logarithmic-derivatives" title="6 Examine the logarithmic derivatives" class="md-nav__link">
    6 Examine the logarithmic derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-testing-efficiency-of-paw-dataset" title="7 Testing efficiency of PAW dataset" class="md-nav__link">
    7 Testing efficiency of PAW dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-testing-against-physical-quantities" title="8 Testing against physical quantities" class="md-nav__link">
    8 Testing against physical quantities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-the-real-space-optimization-rso-experienced-users" title="9 The Real Space Optimization (RSO) - experienced users" class="md-nav__link">
    9 The Real Space Optimization (RSO) - experienced users
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paw2.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="second-lesson-on-the-projector-augmented-wave-paw-technique">Second lesson on the projector-augmented wave (PAW) technique<a class="headerlink" href="#second-lesson-on-the-projector-augmented-wave-paw-technique" title="Permanent link">&para;</a></h1>
<h2 id="the-generation-of-atomic-data">The generation of atomic data.<a class="headerlink" href="#the-generation-of-atomic-data" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to compute atomic data files for the projector-augmented-wave method.</p>
<p>You will learn how to generate the atomic data and what the main variables are
to govern their softness and transferability.
It is supposed you already know how to use ABINIT in the PAW case</p>
<p>This lesson should take about 1h30.</p>
<h2 id="1-the-paw-atomic-dataset-introduction">1 The PAW atomic dataset - introduction<a class="headerlink" href="#1-the-paw-atomic-dataset-introduction" title="Permanent link">&para;</a></h2>
<p>The PAW method is based on the definition of atomic spheres (augmentation
regions) of radius <script type="math/tex">r_c</script> around the atoms of the system in which a base of
atomic partial waves <script type="math/tex">\phi_i</script>, of &ldquo;pseudized&rdquo; partial waves <script type="math/tex">\tphi_i</script>, and of projectors <script type="math/tex">\tprj_i</script>
(dual to <script type="math/tex">\tphi_i</script>) have to be defined. This set of partial-waves and projectors
functions plus some additional atomic data are stored in a so-called <em>PAW dataset</em>. 
A PAW dataset has to be generated for each atomic species in order
to reproduce atomic behavior as accurate as possible while requiring minimal
CPU and memory resources in executing ABINIT for the crystal simulations.
These two constraints are conflicting.</p>
<p>The PAW dataset generation is the purpose of this tutorial.
It is done according the following procedure (all parameters that define a PAW dataset are in bold):</p>
<ol>
<li>
<p>Choose and define the concerned chemical species (name and atomic number).</p>
</li>
<li>
<p>Solve the atomic all-electrons problem in a given atomic configuration.
  The atomic problem is solved within the DFT formalism, using an exchange-correlation functional
  and either a Schrodinger (default) or scalar-relativistic approximation.
  It is a spherical problem and it is solved on a radial grid.
  The atomic problem is solved for a given electronic configuration that can be an ionized/excited one.</p>
</li>
<li>
<p>Choose a set of electrons that will be considered as frozen around the nucleus (core electrons).
  The others electrons are valence ones and will be used in the PAW basis.
  The core density is then deduced from the core electrons wave functions.
  A smooth core density equal to the core density outside a given rcore matching radius is computed.</p>
</li>
<li>
<p>Choose the size of the PAW basis (number of partial-waves and projectors). 
  Then choose the partial-waves included in the basis. The later can be atomic eigen-functions 
  related to valence electrons (bound states) and/or additional atomic functions, solution 
  of the wave equation for a given l quantum number at arbitrary reference energies (unbound states).</p>
</li>
<li>
<p>Generate pseudo partial-waves (smooth partial-waves build with a pseudization scheme and
  equal to partial-waves outside a given rc matching radius) and associated projector functions.
  Pseudo partial-waves are solutions of the PAW Hamiltonian deduced from the atomic Hamiltonian
  by pseudizing the effective potential (a local pseudopotential is built and equal to effective
  potential outside a rvloc matching radius). Projectors and partial-waves are then
  orthogonalized with a chosen orthogonalization scheme.</p>
</li>
<li>
<p>Build a compensation charge density used later in order to retrieve the total charge of the atom.
  This compensation charge density is located inside the PAW spheres and based on an analytical shape function
  (which analytic form and localization radius rshape can be chosen).</p>
</li>
</ol>
<p>The user can choose between two PAW dataset generators to produce atomic files directly readable by ABINIT.
The first one is the PAW generator ATOMPAW (originally by N. Holzwarth) and
the second one is the Ultra-Soft (US) generator (originally written by D.
Vanderbilt). In this tutorial, we concentrate only on ATOMPAW.</p>
<p>It is highly recommended to refer to the following papers to understand
correctly the generation of PAW atomic datasets:</p>
<ol>
<li>
<p>&ldquo;Projector augmented-wave method, P.E. Blochl, Phys. Rev. B 50, 17953 (1994)  </p>
</li>
<li>
<p>&ldquo;A projector Augmented Wave (PAW) code for electronic structure
    calculations, Part I : atompaw for generating atom-centered functions&rdquo;, N.
    Holzwarth et al., Computer Physics Communications, 329 (2001) (might also be
    available at <a href="http://www.wfu.edu/%7Enatalie/papers/pwpaw/atompaw.pdf">http://www.wfu.edu/%7Enatalie/papers/pwpaw/atompaw.pdf</a>)</p>
</li>
<li>
<p>&ldquo;From ultrasoft pseudopotentials to the projector augmented-wave method&rdquo;,
    G. Kresse, D. Joubert, Phys. Rev. B 59, 1758 (1999)</p>
</li>
<li>
<p>&ldquo;Electronic structure packages: two implementations of the Projector
    Augmented-Wave (PAW) formalism&rdquo;, M. Torrent et al., Computer Physics
    Communications 181, 1862 (2010) (might also be available at
    <a href="http://www.wfu.edu/%7Enatalie/papers/PAWform/PAWformman.sdarticle.pdf">http://www.wfu.edu/%7Enatalie/papers/PAWform/PAWformman.sdarticle.pdf</a>)</p>
</li>
<li>
<p>&ldquo;Notes for revised form of atompaw code&rdquo;, by N. Holzwarth, available at
    <a href="http://www.wfu.edu/%7Enatalie/papers/pwpaw/notes/atompaw/atompawEqns.pdf">http://www.wfu.edu/%7Enatalie/papers/pwpaw/notes/atompaw/atompawEqns.pdf</a></p>
</li>
</ol>
<h2 id="2-use-of-the-generation-code">2 Use of the generation code<a class="headerlink" href="#2-use-of-the-generation-code" title="Permanent link">&para;</a></h2>
<p><em>Before continuing, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_paw2&rdquo;?</em></p>
<p>Provided that ABINIT has been compiled with the:</p>
<div class="codehilite"><pre><span></span>--with-dft-flavor=&quot;...+atompaw`
</pre></div>


<p>option, the ATOMPAW code is directly available from command line.
First, just try to type: atompaw. If &ldquo;atompaw vx.y.z&rdquo; message appears, everything is fine.
Otherwise, you can try:</p>
<div class="codehilite"><pre><span></span>~abinit_compilation_directory/fallbacks/exports/bin/atompaw-abinit
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following, we name atompaw the ATOMPAW executable.</p>
</div>
<p>How to use Atompaw?</p>
<ol>
<li>Edit an input file in a text editor (content of input explained <a href="../paw2_assets/atompaw-usersguide.pdf">here</a>)</li>
<li>Run: atompaw &lt; inputfile</li>
</ol>
<p>Partial waves <script type="math/tex">\phi_i</script>, PS partial waves <script type="math/tex">\tphi_i</script> and projectors <script type="math/tex">\tprj_i</script> are given in wfn.i files.
Logarithmic derivatives from atomic Hamiltonian and PAW Hamiltonian
resolutions are given in logderiv.l files.
A summary of the atomic all-electrons computation and PAW dataset properties
can be found in the Atom_name file (Atom_name is the first parameter of the input file).
Resulting PAW dataset is contained in:</p>
<dl>
<dt>Atom_name.XCfunc-paw.abinit file</dt>
<dd>specific format for ABINIT; present only if requested in inputfile.</dd>
<dt>Atom_name.atomicdata file</dt>
<dd>specific format for PWPAW code)</dd>
<dt>Atom_name.XCfunc.xml file</dt>
<dd>normalized XML file according to the
<a href="https://wiki.fysik.dtu.dk/gpaw/setups/pawxml.html">PAWXML specifications</a>.</dd>
</dl>
<h2 id="3-first-and-basic-paw-dataset-for-nickel">3 First (and basic) PAW dataset for Nickel<a class="headerlink" href="#3-first-and-basic-paw-dataset-for-nickel" title="Permanent link">&para;</a></h2>
<p>Our test case will be nickel <em>(1s2 2s2 2p6 3s2 3p6 3d8 4s2 4p0)</em>.</p>
<p>In a first stage, copy a simple input file for ATOMPAW in your working directory
(find it in ~abinit/doc/tutorial/paw2/paw2_assets/Ni.atompaw.input1).
Edit this file.</p>
<div class="text-center"><button type="button" id="uuid-7ff94ce2-1587-4814-aa64-d0ff3d26a6b6" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tutorial/paw2_assets/Ni.atompaw.input1
</button></div>

<div id="uuid-7b9db141-d611-482c-a95a-1bfb550921e0" class="my_dialog" title="tutorial/paw2_assets/Ni.atompaw.input1" hidden><div><pre class="small-text">
Ni 28                                       ! Definition of material
GGA-PBE scalarrelativistic loggrid 2000     ! All-electrons calc.: GGA+scalar-relativstic - log.grid with 2000 pts
4 4 3 0 0 0                                 ! Max. n per angular momentum: 4s 3p 3d
3 2 8                                       ! Partially occupied states: 3d: occ=8
4 1 0                                       !                            4p: occ=0
0 0 0                                       !             End of occupation section
c                                           ! 1s: core state
c                                           ! 2s: core state
c                                           ! 3s: core state
v                                           ! 4s: valence state
c                                           ! 2p: core state
c                                           ! 3p: core state
v                                           ! 4p: valence state
v                                           ! 3d: valence state
2                                           ! Max. l for partial waves basis
2.3                                         ! r_PAW radius
y                                           ! Do we add an additional s partial wave ? yes
0.5                                         ! Reference energy for this new s partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
y                                           ! Do we add an additional p partial wave ? yes
0.                                          ! Reference energy for this p new partial wave (Ryd)
n                                           ! Do we add an additional p partial wave ? no
y                                           ! Do we add an additional d partial wave ? yes
0.                                          ! Reference energy for this new d partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
bloechl                                     ! Scheme for PS partial waves and projectors
3 0. troulliermartins                       ! Scheme for pseudopotential (l_loc=3, E_loc=0Ry)
2                                           ! Option for ABINIT file creation
default                                     ! All parameters set to default for ABINIT file
0                                           ! End of file

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7b9db141-d611-482c-a95a-1bfb550921e0", "#uuid-7ff94ce2-1587-4814-aa64-d0ff3d26a6b6") }); </script>

<p>This file has been built in the following way:</p>
<ol>
<li>
<p>All-electrons calculation:</p>
<ul>
<li>
<p>First line: define the material in the first line</p>
</li>
<li>
<p>Second line: choose the exchange-correlation functional (LDA-PW or GGA-PBE)
  and select a scalar-relativistic wave equation (nonrelativistic or scalarrelativistic)
  and a (2000 points) logarithmic grid.</p>
</li>
<li>
<p>Next lines: define the electronic configuration:</p>
</li>
</ul>
<p><em>How many electronic states do we need to include in the computation?
  Besides the fully and partially occupied states, it is recommended to add all
  states that could be reached by electrons in the solid. Here, for Nickel, the
  4p state is concerned. So we decide to add it in the computation.</em></p>
</li>
<li>
<p>A line with the maximum n quantum number for each electronic shell; here &ldquo;4 4 3&rdquo; means <em>4s, 4p, 3d</em>.</p>
</li>
<li>
<p>Definition of occupation numbers:</p>
</li>
</ol>
<p>For each partially occupied shell enter the occupation number. An excited
   configuration may be useful if the PAW dataset is intended for use in a
   context where the material is charged (such as oxides). Although, in our
   experience, the results are not highly dependent on the chosen electronic configuration.<br />
   We choose here the <em>3d8 4s2 4p0</em> configuration. Only 3d and 4p shells are
   partially occupied (&ldquo;3 2 8&rdquo; &rdquo; and &ldquo;4 1 0&rdquo; lines). A &ldquo;0 0 0&rdquo; ends the occupation section.</p>
<ol>
<li>Selection of core and valence electrons selection: in a first approach,
select only electrons from outer shells as valence. But, if particular
thermodynamical conditions are to be simulated, it is generally needed to
include &ldquo;semi-core states&rdquo; in the set of valence electrons. Semi-core states
are generally needed with transition metal and rare-earth materials. Note that
all wave functions designated as valence electrons will be used in the partial-wave basis.
Core shells are designated by a &ldquo;c&rdquo; and valence shells by a &ldquo;v&rdquo;. 
All s states first, then p states and finally d states.  </li>
</ol>
<p>Here:</p>
<div class="codehilite"><pre><span></span>c  
c  
c  
v  
c  
c  
v  
v
</pre></div>


<p>means:</p>
<div class="codehilite"><pre><span></span>1s core  
2s core  
3s core  
4s valence  
2p core  
3p core  
4p valence  
3d valence
</pre></div>


<p>Partial-waves basis generation:</p>
<ul>
<li>
<p>A line with lmax the maximum l for the partial waves basis. Here lmax=2.</p>
</li>
<li>
<p>A line with the rPAW radius. Select it to be slightly less than half the inter-atomic distance
  in the solid (as a first choice). Here rPAW=2.3 a.u. If only one radius is input,
  all others pseudization radii will be equal to rPAW (rc, rcore, rVloc and rshape).</p>
</li>
<li>
<p>Next lines: add additional partial-waves <script type="math/tex">\phi_i</script> if needed: choose to have 2 partial-waves
  per angular momentum in the basis (this choice is not necessarily optimal but this is the most common one;
  if rPAW is small enough, 1 partial-wave per l may suffice). As a first guess, put all reference energies
  for additional partial-waves to 0 Rydberg.</p>
</li>
</ul>
<p>Note that for each angular momentum, valence states already are included in
the partial waves basis. Here <em>4s, 4p and 3d</em> states already are in the basis
For each angular momentum, first add &ldquo;y&rdquo; to add an additional partial wave.
Then, next line, put the value in Rydberg units.
Repeat this for each new partial wave and finally put &ldquo;n&rdquo;
In the present file:</p>
<div class="codehilite"><pre><span></span>y  
0.5  
n
</pre></div>


<p>means that an additional s- partial wave at Eref=0.5 Ry as been added.</p>
<div class="codehilite"><pre><span></span>y  
0.  
n
</pre></div>


<p>means that an additional p- partial wave at Eref=0. Ry has been added.</p>
<div class="codehilite"><pre><span></span>y  
0.  
n
</pre></div>


<p>means that an additional d- partial wave at Eref=0. Ry as been added.
Finally, partial waves basis contains two s-, two p-  and two d- partial waves.</p>
<ul>
<li>
<p>Next line: definition of the generation scheme for pseudo partial waves <script type="math/tex">\tphi_i</script>, and of projectors <script type="math/tex">\tprj_i</script>. 
  We begin here with a simple scheme (i.e. &ldquo;Bloechl&rdquo; scheme, proposed by P. Blochl in ref. [1]). 
  This will probably be changed later to make the PAW dataset more efficient.</p>
</li>
<li>
<p>Next line: generation scheme for local pseudopotential Vloc. In order to get PS partial waves, 
  the atomic potential has to be &ldquo;pseudized&rdquo; using an arbitrary pseudization scheme. 
  We choose here a &ldquo;Troullier-Martins&rdquo; using a wave equation at lloc=3 and Eloc=0. Ry. 
  As a first draft, it is always recommended to put lloc=1+lmax (lmax defined above).</p>
</li>
<li>
<p>Next two lines: a &ldquo;2&rdquo; (two) tells ATOMPAW to generate PAW dataset for ABINIT; 
  the next line contains options for this ABINIT file. &ldquo;default&rdquo; set all parameters to their default value. </p>
</li>
<li>
<p>A 0 (zero) to end the file.</p>
</li>
</ul>
<p>At this stage, run atompaw. For this purpose, simply enter:</p>
<div class="codehilite"><pre><span></span>atompaw &lt;Ni.atompaw.input1
</pre></div>


<p>Lot of files are produced. We will examine some of them.
A summary of the PAW dataset generation process has been written in a file
named Ni (name extracted from first line of input file). Open it. It should look like:</p>
<div class="codehilite"><pre><span></span><span class="nt">Atom</span> <span class="o">=</span> <span class="nt">Ni</span> <span class="nt">Z</span> <span class="o">=</span> <span class="nt">28</span>  
<span class="nt">Perdew</span> <span class="err">\</span><span class="nt">-</span> <span class="nt">Burke</span> <span class="nt">-</span> <span class="nt">Ernzerhof</span> <span class="nt">GGA</span> <span class="nt">Log</span> <span class="nt">grid</span> <span class="nt">--</span> <span class="nt">n</span><span class="o">,</span><span class="nt">r0</span><span class="o">,</span><span class="nt">rmax</span> <span class="o">=</span> <span class="nt">2000</span> <span class="nt">2</span><span class="p">.</span><span class="nc">2810899E-04</span>
<span class="nt">8</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">01</span>  
<span class="nt">Scalar</span> <span class="nt">relativistic</span> <span class="nt">calculation</span> <span class="nt">--</span> <span class="nt">point</span> <span class="nt">nucleus</span>  
<span class="nt">all-electron</span> <span class="nt">results</span>  
 <span class="nt">core</span> <span class="nt">states</span> <span class="o">(</span><span class="nt">zcore</span><span class="o">)</span> <span class="o">=</span> <span class="nt">18</span><span class="p">.</span><span class="nc">0000000000000</span>  
   <span class="nt">1</span>  <span class="nt">1</span>  <span class="nt">0</span>  <span class="nt">2</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-6</span><span class="p">.</span><span class="nc">0358607E</span><span class="o">+</span><span class="nt">02</span>  
   <span class="nt">2</span>  <span class="nt">2</span>  <span class="nt">0</span>  <span class="nt">2</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-7</span><span class="p">.</span><span class="nc">2163318E</span><span class="o">+</span><span class="nt">01</span>  
   <span class="nt">3</span>  <span class="nt">3</span>  <span class="nt">0</span>  <span class="nt">2</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-8</span><span class="p">.</span><span class="nc">1627107E</span><span class="o">+</span><span class="nt">00</span>  
   <span class="nt">5</span>  <span class="nt">2</span>  <span class="nt">1</span>  <span class="nt">6</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-6</span><span class="p">.</span><span class="nc">2083048E</span><span class="o">+</span><span class="nt">01</span>  
   <span class="nt">6</span>  <span class="nt">3</span>  <span class="nt">1</span>  <span class="nt">6</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-5</span><span class="p">.</span><span class="nc">2469208E</span><span class="o">+</span><span class="nt">00</span>  
<span class="nt">valence</span> <span class="nt">states</span> <span class="o">(</span><span class="nt">zvale</span><span class="o">)</span> <span class="o">=</span> <span class="nt">10</span><span class="p">.</span><span class="nc">0000000000000</span>  
   <span class="nt">4</span>  <span class="nt">4</span>  <span class="nt">0</span>  <span class="nt">2</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-4</span><span class="p">.</span><span class="nc">1475541E-01</span>  
   <span class="nt">7</span>  <span class="nt">4</span>  <span class="nt">1</span>  <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-9</span><span class="p">.</span><span class="nc">0035738E-02</span>  
   <span class="nt">8</span>  <span class="nt">3</span>  <span class="nt">2</span>  <span class="nt">8</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">-6</span><span class="p">.</span><span class="nc">5223644E-01</span>  
<span class="nt">evale</span> <span class="o">=</span> <span class="nt">-185</span><span class="p">.</span><span class="nc">182300204924</span>  
<span class="nt">selfenergy</span> <span class="nt">contribution</span> <span class="o">=</span> <span class="nt">8</span><span class="p">.</span><span class="nc">13253645212050</span>  
<span class="nt">paw</span> <span class="nt">parameters</span><span class="o">:</span>  
    <span class="nt">lmax</span> <span class="o">=</span> <span class="nt">2</span>  
    <span class="nt">rc</span>   <span class="o">=</span> <span class="nt">2</span><span class="p">.</span><span class="nc">30969849741149</span>  
    <span class="nt">irc</span>  <span class="o">=</span> <span class="nt">1445</span>  
<span class="nt">Vloc</span><span class="o">:</span> <span class="nt">Norm-conserving</span> <span class="nt">Troullier-Martins</span> <span class="nt">form</span><span class="o">;</span> <span class="nt">l</span><span class="o">=</span> <span class="nt">3</span><span class="o">;</span><span class="nt">e</span><span class="o">=</span> <span class="nt">0</span><span class="p">.</span><span class="nc">0000E</span><span class="o">+</span><span class="nt">00</span>  
<span class="nt">Projector</span> <span class="nt">method</span><span class="o">:</span> <span class="nt">Bloechl</span>  
<span class="nt">Sinc</span><span class="o">^</span><span class="nt">2</span> <span class="nt">compensation</span> <span class="nt">charge</span> <span class="nt">shape</span> <span class="nt">zeroed</span> <span class="nt">at</span> <span class="nt">rc</span>

<span class="nt">Number</span> <span class="nt">of</span> <span class="nt">basis</span> <span class="nt">functions</span> <span class="nt">6</span>  
 <span class="nt">No</span><span class="o">.</span>  <span class="nt">n</span>   <span class="nt">l</span>  <span class="nt">Energy</span>          <span class="nt">Cp</span> <span class="nt">coeff</span>      <span class="nt">Occ</span>  
  <span class="nt">1</span>   <span class="nt">4</span>   <span class="nt">0</span>  <span class="nt">-4</span><span class="p">.</span><span class="nc">1475541E-01</span> <span class="nt">-9</span><span class="p">.</span><span class="nc">5091493E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">2</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
  <span class="nt">2</span> <span class="nt">999</span>   <span class="nt">0</span>   <span class="nt">5</span><span class="p">.</span><span class="nc">0000000E-01</span>  <span class="nt">3</span><span class="p">.</span><span class="nc">2926940E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
  <span class="nt">3</span>   <span class="nt">4</span>   <span class="nt">1</span>  <span class="nt">-9</span><span class="p">.</span><span class="nc">0035738E-02</span> <span class="nt">-8</span><span class="p">.</span><span class="nc">9594194E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
  <span class="nt">4</span> <span class="nt">999</span>   <span class="nt">1</span>   <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  <span class="nt">1</span><span class="p">.</span><span class="nc">0836820E</span><span class="o">+</span><span class="nt">01</span> <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
  <span class="nt">5</span>   <span class="nt">3</span>   <span class="nt">2</span>  <span class="nt">-6</span><span class="p">.</span><span class="nc">5223644E-01</span>  <span class="nt">9</span><span class="p">.</span><span class="nc">1576176E</span><span class="o">+</span><span class="nt">00</span> <span class="nt">8</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
  <span class="nt">6</span> <span class="nt">999</span>   <span class="nt">2</span>   <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  <span class="nt">1</span><span class="p">.</span><span class="nc">3369075E</span><span class="o">+</span><span class="nt">01</span> <span class="nt">0</span><span class="p">.</span><span class="nc">0000000E</span><span class="o">+</span><span class="nt">00</span>  
 <span class="nt">evale</span> <span class="nt">from</span> <span class="nt">matrix</span> <span class="nt">elements</span> <span class="nt">-1</span><span class="p">.</span><span class="nc">85182309373359203E</span><span class="o">+</span><span class="nt">02</span>
</pre></div>


<p>The generated PAW dataset (contained in Ni.atomicdata, Ni.GGA-PBE-paw.abinit
or Ni.GGA-PBE.xml file) is a first draft.
Several parameters have to be adjusted, in order to get accurate results and efficient DFT calculations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that only Ni.GGA-PBE-paw.abinit file is directly usable by ABINIT.</p>
</div>
<h2 id="4-checking-the-sensitivity-of-results-to-some-parameters">4 Checking the sensitivity of results to some parameters<a class="headerlink" href="#4-checking-the-sensitivity-of-results-to-some-parameters" title="Permanent link">&para;</a></h2>
<ul>
<li>The radial grid:</li>
</ul>
<p>Try to select 700 points in the logarithmic grid and check if any noticeable
difference in the results appears.
You just have to replace 2000 by 700 in the second line of Ni.atompaw.input1 file.
Then run:</p>
<div class="codehilite"><pre><span></span>atompaw &lt;Ni.atompaw.input1
</pre></div>


<p>again and look at the  Ni file:</p>
<div class="codehilite"><pre><span></span>evale = -185.182300567432  
evale from matrix elements -1.85182301887091256E+02
</pre></div>


<p>As you see, results obtained with this new grid are very close to previous ones. 
We can keep the 700 points grid.</p>
<p>You could decrease the size of the grid; by setting 400 points you should obtain:</p>
<div class="codehilite"><pre><span></span>evale = -185.182294626845

evale from matrix elements -1.85182337214119599E+02
</pre></div>


<p>Small grids give PAW dataset with small size (in kB) and run faster in ABINIT,
but accuracy can be affected.</p>
<p>- Note that the final rPAW value (&ldquo;rc = &hellip;&rdquo; in Ni file) change with the
grid; just because rPAW is adjusted in order to belong exactly to the radial grid.
By looking in ATOMPAW <a href="../paw2_assets/atompaw-usersguide.pdf">user&rsquo;s guide</a>, you can choose to keep it constant.</p>
<p>- Also note that, if the results are difficult to get converged 
(some error produced by ATOMPAW), you should try a linear grid&hellip;</p>
<ul>
<li>The relativistic approximation of the wave equation:</li>
</ul>
<p>Scalar-relativistic option should give better results than non-relativistic one,
but it sometimes produces difficulties for the convergence of the atomic problem 
(either at the all-electrons resolution step or at the PAW Hamiltonian solution step).
If convergence cannot be reached, try a non-relativistic calculation (not recommended for high Z materials).</p>
<p>For the following, note that you always should check the Ni file, especially
the values of valence energy (&ldquo;evale&rdquo;). You can find the valence energy
computed for the exact atomic problem and the valence energy computed with the
PAW parameters (&ldquo;evale from matrix elements&rdquo;). These two results should be in close agreement!</p>
<h2 id="5-adjusting-partial-waves-and-projectors">5 Adjusting partial waves and projectors<a class="headerlink" href="#5-adjusting-partial-waves-and-projectors" title="Permanent link">&para;</a></h2>
<p>Examine the partial-waves, PS partial-waves and projectors.
These are saved in files named wfni, where i ranges over the number of partial
waves used, so 6 in the present example. Each file contains 4 columns:
the radius in column 1, the partial wave <script type="math/tex">\phi_i</script> in column 2, the PS partial wave <script type="math/tex">\tphi_i</script> in
column 3, and the projector <script type="math/tex">\tprj_i</script> in column 4. Plot the three curves as a
function of radius using a plotting tool of your choice.</p>
<p>Here is the first s- partial wave /projector of the Ni example:</p>
<p><img alt="First s partial wave" src="../paw2_assets/wfn1a.jpg" /></p>
<ul>
<li>
<p>The <script type="math/tex">\phi_i</script> should meet the <script type="math/tex">\tphi_i</script> near or after the last maximum (or minimum). 
    If not, it is preferable to change the value of the matching (pseudization) radius.</p>
</li>
<li>
<p>The maxima of the <script type="math/tex">\tphi_i</script> and <script type="math/tex">\tprj_i</script> functions should have the same order of magnitude (but need not agree exactly). 
    If not, you can try to get this in three ways:</p>
</li>
</ul>
<p>- Change the matching radius for this partial-wave; but this is not always
possible (PAW spheres should not overlap in the solid)&hellip;
- Change the pseudopotential scheme (see later).
- If there are two (or more) partial waves for the angular momentum l under
consideration, decreasing the magnitude of the projector is possible by
displacing the references energies. Moving the energies away from each other
generally reduces the magnitude of the projectors, but too big a difference
between energies can lead to wrong logarithmic derivatives (see following section).</p>
<p>Example: plot the wfn6 file, concerning the second d- partial wave:</p>
<p><img alt="2nd d partial wave" src="../paw2_assets/wfn6a.jpg" /></p>
<p>This partial wave has been generated at Eref=0 Ry and orthogonalized with the
first d- partial wave which has an eigenenergy equal to -0.65Ry (see Ni file). 
These two energies are too close and orthogonalization process produces &ldquo;high&rdquo; partial waves.<br />
Try to replace the reference energy for the additional d- partial wave.
For example, put Eref=1. instead of Eref=0. (line 24 of Ni.atompaw.input1 file).</p>
<p>Run ATOMPAW again and plot wfn6 file:</p>
<p><img alt="2nd d partial wave" src="../paw2_assets/wfn6b.jpg" /></p>
<p>Now the PS partial wave and projector have the same order of magnitude!</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note again that you should always check the evale values in Ni file and make
sure they are as close as possible.<br />
If not, choices for projectors and/or partial waves certainly are not judicious.</p>
</div>
<h2 id="6-examine-the-logarithmic-derivatives">6 Examine the logarithmic derivatives<a class="headerlink" href="#6-examine-the-logarithmic-derivatives" title="Permanent link">&para;</a></h2>
<p>Examine the logarithmic derivatives, i.e., derivatives of an l-state
d(log(ψl(E))/dE computed for the exact atomic problem and with the PAW dataset.
They are printed in the logderiv.l files. Each logderiv.l file corresponds to
angular momentum quantum number l, and contains three columns of data: the
energy, the logarithmic derivative of the l-state of the exact atomic problem
and of the pseudized problem. In our Ni example, l=0, 1 or 2.</p>
<p>The logarithmic derivatives should have the following properties:</p>
<ul>
<li>
<p>The 2 curves should be superimposed as much as possible.
    By construction, they are superimposed at the two energies corresponding to the two l partial-waves.
    If the superimposition is not good enough, the reference energy for the second l partial-wave should be changed.</p>
</li>
<li>
<p>Generally a discontinuity in the logarithmic derivative curve appears at 0&lt;=E0&lt;=4 Rydberg.
  A reasonable choice is to choose the 2 reference energies so that E0 is in between.</p>
</li>
<li>
<p>Too close reference energies produce &ldquo;hard&rdquo; projector functions
    (as previously seen in section 5). But moving reference energies away
    from each other can damage accuracy of logarithmic derivatives</p>
</li>
</ul>
<p>Here are the three logarithmic derivative curves for the current dataset:</p>
<p><img alt="l=0 log derivatives" src="../paw2_assets/log0a.jpg" /></p>
<p><img alt="l=1 logderivatives" src="../paw2_assets/log1a.jpg" /></p>
<p><img alt="l=2 logderivatives" src="../paw2_assets/log2a.jpg" />  </p>
<p>As you can see, except for l=2, exact and PAW logarithmic derivatives do not match!
According to the previous remarks, try other values for the references
energies of the s- and p- additional partial waves.
First, edit again the Ni.atompaw.input1 file and put Eref=3Ry for the
additional s- state (line 18); run ATOMPAW again. Plot the logderiv.0 file.
You should get:</p>
<p><img alt="l=0 log derivatives" src="../paw2_assets/log0b.jpg" /></p>
<p>Then put Eref=4Ry for the second p- state (line 21); run ATOMPAW again.
Plot again the logderiv.1 file. You should get:</p>
<p><img alt="l=1 log derivatives" src="../paw2_assets/log1b.jpg" /></p>
<p>Now, all PAW logarithmic derivatives match with the exact ones in a reasonable interval.</p>
<p>Note: enlarging energy range of logarithmic derivatives plots
It is possible to change the interval of energies used to plot logarithmic
derivatives (default is [-5;5]) and also to compute them at more points
(default is 200). Just add the following keywords at the end of the SECOND
LINE of the input file:
logderivrange -10 10 500<br />
In the above example ATOMPAW plots logarithmic derivatives for energies in
[-10;10] at 500 points.<br />
Additional information concerning logarithmic derivatives:<br />
Another possible problem could be the presence of a discontinuity in the PAW
logarithmic derivative curve at an energy where the exact logarithmic derivative is continuous.<br />
This generally shows the presence of a <em>ghost state</em>.  </p>
<ul>
<li>First, try to change to value of reference energies; this sometimes can make the ghost state disappear.</li>
<li>
<p>If not, it can be useful to:</p>
</li>
<li>
<p>Change the pseudopotential scheme. Norm-conserving pseudopotentials are sometimes so deep
  (attractive near r=0) that they produce ghost states.</p>
</li>
</ul>
<p>A first solution is to change the quantum number used to generate the norm-conserving pseudopotential.
But this is generally not sufficient.</p>
<p>A second solution is to select an &ldquo;ultrasoft&rdquo; pseudopotential, freeing the
norm conservation constraint (simply replace &ldquo;troulliermartins&rdquo; by &ldquo;ultrasoft&rdquo; in input file)  </p>
<p>A third solution is to select a simple &ldquo;bessel&rdquo; pseudopotential (replace
&ldquo;troulliermartins&rdquo; by &ldquo;bessel&rdquo; in input file). But, in that case, one has to
noticeably decrease the matching radius rVloc if one wants to keep reasonable
physical results. Selecting a value of rVloc between 0.6*rPAW and 0.8*rPAW is
a good choice; but the best way to adjust rVloc value is to have a look at the
two values of evale in Ni file which are sensitive to the choice of rVloc.
To change the value of  rVloc, one has to detail the line containing all radii
(rPAW, rshape, rVloc and rcore); see <a href="../paw2_assets/atompaw-usersguide.pdf">user&rsquo;s guide</a>.</p>
<ul>
<li>
<p>Change the matching radius rc for one (or both) l partial-wave(s). In some cases, changing rc can remove ghost states. </p>
</li>
<li>
<p>In most cases (changing pseudopotential or matching radius), one has to restart the procedure from step 5.</p>
</li>
</ul>
<p>To see an example of ghost state, use the
~abinit/doc/tutorial/lesson_paw2/Ni.ghost.atompaw.input file and run it with ATOMPAW.
Look at the l=1 logarithmic derivatives (logderiv.1 file). They look like:</p>
<p><img alt="Ni l=1 log derivatives" src="../paw2_assets/log1c.jpg" />  </p>
<p>Now, edit the Ni.ghost.atompaw.input file and replace &ldquo;troulliermartins&rdquo; by
&ldquo;ultrasoft&rdquo;. Run ATOMPAW again&hellip; and look at logderiv.1 file. The ghost state has moved!
Edit again the file and replace &lsquo;ultrasoft&rdquo; by &ldquo;bessel&rdquo;; then change the 17<sup>th</sup>
line (&ldquo;2.0 2.0 2.0 2.0&rdquo;) by &ldquo;2.0 2.0 1.8 2.0&rdquo;. This has the effect of
decreasing the rVloc radius. Run ATOMPAW: the ghost state disappears!
Start from the original state of Ni.ghost.atompaw.input file and put 1.8 for
the matching radius of p- states (put 1.8 on lines 31 and 32). 
Run ATOMPAW: the ghost state disappears!</p>
<h2 id="7-testing-efficiency-of-paw-dataset">7 Testing efficiency of PAW dataset<a class="headerlink" href="#7-testing-efficiency-of-paw-dataset" title="Permanent link">&para;</a></h2>
<p>Let&rsquo;s use again our Ni.atompaw.input1 file for Nickel (with all our modifications).
You get a file Ni.GGA-PBE-paw.abinit containing the PAW dataset designated for ABINIT.</p>
<p>Now, one has to test the efficiency of the generated PAW dataset. We finally will use ABINIT!
You are about to run a DFT computation and determine the size of the plane
wave basis needed to get a given accuracy. If the cut-off energy defining the
plane waves basis is too high (higher than 20 Hartree, if rPAW has a
reasonable value), some changes have to be made in the input file.</p>
<p>Copy ~abinit/tests/tutorial/Input/tpaw2_x.files and
~abinit/tests/tutorial/Input/tpaw2_1.in in your working directory.
Edit ~abinit/tests/tutorial/Input/tpaw2_1.in, and activate the eight datasets 
(only one is kept by default for testing purposes). Run ABINIT with them.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-1a824d49-8e4c-4e64-95a1-45064217d8f3" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw2_x.files
</button>
<button type="button" id="uuid-92de45b6-96cb-4054-9176-8385b63b271a" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw2_1.in
</button>
</div></div>

<div id="uuid-cd94f62b-86f7-48a0-8d09-6125882cd73b" class="my_dialog" title="tests/tutorial/Input/tpaw2_x.files" hidden><div><pre class="small-text">
tpaw2_1.in
tpaw2_1.out
tpaw2_i
tpaw2_o
tpaw2
Ni.GGA-PBE-paw.abinit

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-cd94f62b-86f7-48a0-8d09-6125882cd73b", "#uuid-1a824d49-8e4c-4e64-95a1-45064217d8f3") }); </script>

<div id="uuid-6001fa2f-b41f-4d9f-8831-475a8a5a75de" class="my_dialog" title="tests/tutorial/Input/tpaw2_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Nickel ferromagnetic fcc structure for testing ecut convergence</span>

<span class="c1">#  ndtset 8    # Uncomment this line to recover the results for the tutorial</span>
   ndtset <span class="m">1</span>    <span class="c1"># Comment this line to recover the results for the tutorial</span>

   ecut:  <span class="m">8</span>.
   ecut+  <span class="m">2</span>.

pawecutdg <span class="m">40</span>.

  nstep   <span class="m">50</span>
 tolvrs   <span class="m">1</span>.0d-9
 occopt   <span class="m">7</span>
 tsmear   <span class="m">0</span>.0075

 ntypat   <span class="m">1</span>
  acell   <span class="m">3</span>*3.52 angstrom
  rprim   <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
  natom   <span class="m">1</span>
  typat   <span class="m">1</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
  znucl   <span class="m">28</span>
  nband   <span class="m">14</span>

  nsppol  <span class="m">2</span>
  spinat  <span class="m">0</span>. <span class="m">0</span>. <span class="m">4</span>.

  ngkpt   <span class="m">6</span> <span class="m">6</span> <span class="m">6</span>
nshiftk   <span class="m">4</span>
 shiftk   <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">0</span>.0
          <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">0</span>.0
          <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">1</span>/2

 getwfk -1
 prteig <span class="m">0</span> prtden <span class="m">0</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw2_1.out, tolnlines=  4, tolabs=  1.1e-4,    tolrel=  2.0e-3, fld_options=-medium</span>
<span class="c1">#%% psp_files =  Ni.GGA-PBE-paw.abinit.bloechl </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 6</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description =  Nickel ferromagnetic fcc structure for testing ecut convergence</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-6001fa2f-b41f-4d9f-8831-475a8a5a75de", "#uuid-92de45b6-96cb-4054-9176-8385b63b271a") }); </script>

<p>ABINIT computes the total energy of ferromagnetic FCC Nickel for several values of <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>. 
At the end of output file, you get this:</p>
<div class="codehilite"><pre><span></span>  ecut1   8.00000000E+00 Hartree  
  ecut2   1.00000000E+01 Hartree  
  ecut3   1.20000000E+01 Hartree  
  ecut4   1.40000000E+01 Hartree  
  ecut5   1.60000000E+01 Hartree  
  ecut6   1.80000000E+01 Hartree  
  ecut7   2.00000000E+01 Hartree  
  ecut8   2.20000000E+01 Hartree  
etotal1  -3.9300291581E+01  
etotal2  -3.9503638785E+01  
etotal3  -3.9583278145E+01  
etotal4  -3.9613946329E+01  
etotal5  -3.9623543087E+01  
etotal6  -3.9626889070E+01  
etotal7  -3.9628094989E+01  
etotal8  -3.9628458879E+01
</pre></div>


<p>etotal convergence (at 1 mHartree) is achieve for 18&lt;=ecut&lt;=20 Hartree
etotal convergence (at 0,1 mHartree) is achieve for ecut&gt;22 Hartree</p>
<p>This is not a good result for a PAW dataset; let&rsquo;s try to optimize it.</p>
<ul>
<li>First possibility: use Vanderbilt projectors instead of Bloechl ones.</li>
</ul>
<p>Vanderbilt projectors generally are more localized in reciprocal space than
Bloechl ones (see ref. [4] for a detailed description of Vanderbilt projectors).<br />
Keyword &ldquo;bloechl&rdquo; has to be replaced by &ldquo;vanderbilt&rdquo; in the ATOMPAW input file
and rc values have to be added at the end of the file (one for each PS partial wave).
You can have a look at the ATOMPAW input file:
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt
But we will not test this case here as it produces problematic results for this example (see below).</p>
<ul>
<li>2<sup>nd</sup> possibility: use RRKJ pseudization scheme for projectors.</li>
</ul>
<p>Use this input file for ATOMPAW: ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2</p>
<div class="text-center"><button type="button" id="uuid-27399c03-0774-4c41-a793-cdcb80b346f6" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tutorial/paw2_assets/Ni.atompaw.input2
</button></div>

<div id="uuid-395d5c6f-f9e2-4744-9a6a-996e08d98e15" class="my_dialog" title="tutorial/paw2_assets/Ni.atompaw.input2" hidden><div><pre class="small-text">
Ni 28                                       ! Definition of material
GGA-PBE scalarrelativistic loggrid 700      ! All-electrons calc.: GGA+scalar-relativstic - log.grid with 700 pts
4 4 3 0 0 0                                 ! Max. n per angular momentum: 4s 3p 3d
3 2 8                                       ! Partially occupied states: 3d: occ=8
4 1 0                                       !                            4p: occ=0
0 0 0                                       !             End of occupation section
c                                           ! 1s: core state
c                                           ! 2s: core state
c                                           ! 3s: core state
v                                           ! 4s: valence state
c                                           ! 2p: core state
c                                           ! 3p: core state
v                                           ! 4p: valence state
v                                           ! 3d: valence state
2                                           ! Max. l for partial waves basis
2.3                                         ! r_PAW radius
y                                           ! Do we add an additional s partial wave ? yes
3.                                          ! Reference energy for this new s partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
y                                           ! Do we add an additional p partial wave ? yes
4.                                          ! Reference energy for this p new partial wave (Ryd)
n                                           ! Do we add an additional p partial wave ? no
y                                           ! Do we add an additional d partial wave ? yes
1.                                          ! Reference energy for this new d partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
custom rrkj                                 ! Scheme for PS partial waves and projectors
3 0. troulliermartins                       ! Scheme for pseudopotential (l_loc=3, E_loc=0Ry)
2.3                                         ! r_c matching radius for first  s partial wave
2.3                                         ! r_c matching radius for second s partial wave
2.3                                         ! r_c matching radius for first  p partial wave
2.3                                         ! r_c matching radius for second p partial wave
2.3                                         ! r_c matching radius for first  d partial wave
2.3                                         ! r_c matching radius for second d partial wave
2                                           ! Option for ABINIT file creation
default                                     ! All parameters set to default for ABINIT file
0                                           ! End of file

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-395d5c6f-f9e2-4744-9a6a-996e08d98e15", "#uuid-27399c03-0774-4c41-a793-cdcb80b346f6") }); </script>

<p>As you can see (by editing the file)  &ldquo;bloechl&rdquo; has been changed by &ldquo;custom rrkj&rdquo;
and 6 rc values have been added at the end of the file; each one
correspond to the matching radius of one PS partial wave.
Repeat the entire procedure (ATOMPAW + ABINIT)&hellip; and get a new ABINIT output file.
Note: you have to look again at log derivatives in order to verify that they still are correct&hellip;</p>
<div class="codehilite"><pre><span></span>  ecut1   8.00000000E+00 Hartree  
  ecut2   1.00000000E+01 Hartree  
  ecut3   1.20000000E+01 Hartree  
  ecut4   1.40000000E+01 Hartree  
  ecut5   1.60000000E+01 Hartree  
  ecut6   1.80000000E+01 Hartree  
  ecut7   2.00000000E+01 Hartree  
  ecut8   2.20000000E+01 Hartree  
etotal1  -3.9600401638E+01  
etotal2  -3.9627563690E+01  
etotal3  -3.9627901781E+01  
etotal4  -3.9628482371E+01  
etotal5  -3.9628946655E+01  
etotal6  -3.9629072497E+01  
etotal7  -3.9629079826E+01  
etotal8  -3.9629097793E+01
</pre></div>


<p>etotal convergence (at 1 mHartree) is achieve for 12&lt;=ecut&lt;=14 Hartree
etotal convergence (at 0,1 mHartree) is achieve for 16&lt;=ecut&lt;=18 Hartree
This is a reasonable result for a PAW dataset!</p>
<ul>
<li>3<sup>rd</sup> possibility: use enhanced polynomial pseudization scheme for projectors.</li>
</ul>
<p>Edit  ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2 and replace &ldquo;custom
rrkj&rdquo; by &ldquo;custom polynom2 7 10&rdquo;</p>
<p>Repeat the entire procedure (ATOMPAW + ABINIT)&hellip; and look at the ecut convergence&hellip;</p>
<p>Optional exercise: let&rsquo;s go back to Vanderbilt projectors</p>
<p>Repeat the procedure (ATOMPAW + ABINIT) with
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt file.</p>
<div class="text-center"><button type="button" id="uuid-3eceff4b-5d98-4fd9-a6f6-7fb5c7c1dee9" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tutorial/paw2_assets/Ni.atompaw.input.vanderbilt
</button></div>

<div id="uuid-25c4818e-c786-416e-8c75-9e7597dccfeb" class="my_dialog" title="tutorial/paw2_assets/Ni.atompaw.input.vanderbilt" hidden><div><pre class="small-text">
Ni 28                                       ! Definition of material
GGA-PBE scalarrelativistic loggrid 700      ! All-electrons calc.: GGA+scalar-relativstic - log.grid with 700 pts
4 4 3 0 0 0                                 ! Max. n per angular momentum: 4s 3p 3d
3 2 8                                       ! Partially occupied states: 3d: occ=8
4 1 0                                       !                            4p: occ=0
0 0 0                                       !             End of occupation section
c                                           ! 1s: core state
c                                           ! 2s: core state
c                                           ! 3s: core state
v                                           ! 4s: valence state
c                                           ! 2p: core state
c                                           ! 3p: core state
v                                           ! 4p: valence state
v                                           ! 3d: valence state
2                                           ! Max. l for partial waves basis
2.3                                         ! r_PAW radius
y                                           ! Do we add an additional s partial wave ? yes
3.                                          ! Reference energy for this new s partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
y                                           ! Do we add an additional p partial wave ? yes
4.                                          ! Reference energy for this p new partial wave (Ryd)
n                                           ! Do we add an additional p partial wave ? no
y                                           ! Do we add an additional d partial wave ? yes
1.                                          ! Reference energy for this new d partial wave (Ryd)
n                                           ! Do we add an additional s partial wave ? no
vanderbilt                                  ! Scheme for PS partial waves and projectors
3 0. troulliermartins                       ! Scheme for pseudopotential (l_loc=3, E_loc=0Ry)
2.3                                         ! r_c matching radius for first  s partial wave
2.3                                         ! r_c matching radius for second s partial wave
2.3                                         ! r_c matching radius for first  p partial wave
2.3                                         ! r_c matching radius for second p partial wave
2.3                                         ! r_c matching radius for first  d partial wave
2.3                                         ! r_c matching radius for second d partial wave
2                                           ! Option for ABINIT file creation
default                                     ! All parameters set to default for ABINIT file
0                                           ! End of file

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-25c4818e-c786-416e-8c75-9e7597dccfeb", "#uuid-3eceff4b-5d98-4fd9-a6f6-7fb5c7c1dee9") }); </script>

<p>As you can see ABINIT convergence cannot be achieved!
You can try whatever you want with radii and/or references energies in the
ATOMPAW input file: ABINIT always diverges!
The solution here is to change the pseudization scheme for the local pseudopotential.
Try to replace the &ldquo;troulliermartins&rdquo; keyword by &ldquo;ultrasoft&rdquo;.
Repeat the procedure (ATOMPAW + ABINIT). ABINIT can now reach convergence!
Results are below:</p>
<div class="codehilite"><pre><span></span>  ecut1   8.00000000E+00 Hartree  
  ecut2   1.00000000E+01 Hartree  
  ecut3   1.20000000E+01 Hartree  
  ecut4   1.40000000E+01 Hartree  
  ecut5   1.60000000E+01 Hartree  
  ecut6   1.80000000E+01 Hartree  
  ecut7   2.00000000E+01 Hartree  
  ecut8   2.20000000E+01 Hartree  
etotal1  -3.9609714395E+01  
etotal2  -3.9615187859E+01  
etotal3  -3.9618367959E+01  
etotal4  -3.9622476129E+01  
etotal5  -3.9624707476E+01  
etotal6  -3.9625234480E+01  
etotal7  -3.9625282524E+01  
etotal8  -3.9625330757E+01
</pre></div>


<p>etotal convergence (at 1 mHartree) is achieve for 14&lt;=ecut&lt;=16 Hartree
etotal convergence (at 0,1 mHartree) is achieve for 20&lt;=ecut&lt;=22 Hartree
Note: You could have tried the &ldquo;bessel&rdquo; keyword instead of &ldquo;ultrasoft&rdquo;&hellip;</p>
<p>Summary of convergence results:</p>
<p><img alt="ecut convergence" src="../paw2_assets/ecut.jpg" />  </p>
<p>Final remarks:</p>
<ul>
<li>
<p>The localization of projectors in reciprocal space can (generally) be predicted by a look at tprod.i files.
  Such a file contains the curve of as a function of q (reciprocal space variable).
  q is given in Bohr-1 units; it can be connected to ABINIT plane waves cut-off energy (in Hartree units) by:
  ecut=qcut2/4. These quantities are only calculated for the bound states, since the Fourier transform of an
  extended function is not well-defined.</p>
</li>
<li>
<p>Generating projectors with Blochl&rsquo;s scheme often gives the guaranty to have stable calculations. 
  atompaw ends without any convergence problem and DFT calculations run without any divergence 
  (but they need high plane wave cut-off). Vanderbilt projectors (and even more &ldquo;custom&rdquo; projectors) 
  sometimes produce instabilities during the PAW dataset generation process and/or the DFT calculations&hellip;</p>
</li>
<li>
<p>In most cases, after having changed the projector generation scheme, one has to restart the procedure from step 5. </p>
</li>
</ul>
<h2 id="8-testing-against-physical-quantities">8 Testing against physical quantities<a class="headerlink" href="#8-testing-against-physical-quantities" title="Permanent link">&para;</a></h2>
<p>Finally, the last step is to examine carefully the physical quantities obtained with the PAW dataset.</p>
<p>Copy ~abinit/tests/tutorial/Input/tpaw2_2.in in your working directory.
Edit it, to activate the eight datasets (instead of one).
Use the  ~abinit/doc/tutorial/lesson_paw2/Ni.GGA-PBE-paw.abinit.rrkj psp file
(it has been obtained from Ni.atompaw.input2 file).
Modify tpaw2_x.files file according to these new files.
Run ABINIT (this may take a while&hellip;).</p>
<div class="text-center"><button type="button" id="uuid-6dfeff6e-4747-4883-a087-7ac0988dc418" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tpaw2_2.in
</button></div>

<div id="uuid-5c59a04a-a68f-4b55-b85b-8b7bd9744b64" class="my_dialog" title="tests/tutorial/Input/tpaw2_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Nickel ferromagnetic fcc structure for testing ecut convergence</span>

<span class="c1">#  ndtset 7    # Uncomment this line to reproduce the results of the tutorial</span>
   ndtset <span class="m">1</span>    <span class="c1"># Comment this line to reproduce the results of the tutorial</span>

   acell: <span class="m">3</span>*3.5150 angstrom
   acell+  <span class="m">3</span>*0.0025 angstrom

     ecut <span class="m">15</span>.
pawecutdg <span class="m">40</span>.
   ecutsm <span class="m">0</span>.5

  nstep   <span class="m">30</span>
 tolvrs   <span class="m">1</span>.0d-12
 occopt   <span class="m">7</span>
 tsmear   <span class="m">0</span>.0075

 ntypat   <span class="m">1</span>
  rprim   <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">0</span>.0
  natom   <span class="m">1</span>
  typat   <span class="m">1</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
  znucl   <span class="m">28</span>
  nband   <span class="m">12</span>

  nsppol  <span class="m">2</span>
  spinat  <span class="m">0</span>. <span class="m">0</span>. <span class="m">4</span>.

  ngkpt   <span class="m">8</span> <span class="m">8</span> <span class="m">8</span>
nshiftk   <span class="m">4</span>
 shiftk   <span class="m">1</span>/2 <span class="m">1</span>/2 <span class="m">1</span>/2
          <span class="m">1</span>/2 <span class="m">0</span>.0 <span class="m">0</span>.0
          <span class="m">0</span>.0 <span class="m">1</span>/2 <span class="m">0</span>.0
          <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">1</span>/2

 getwfk -1
 prteig <span class="m">0</span> prtden <span class="m">0</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tpaw2_2.out, tolnlines= 15, tolabs=  3.2e-4,    tolrel=  2.0e-1, fld_options=-easy</span>
<span class="c1">#%% psp_files =  Ni.GGA-PBE-paw.abinit.rrkj </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 6</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Torrent</span>
<span class="c1">#%% keywords = PAW</span>
<span class="c1">#%% description =   Nickel ferromagnetic fcc structure for testing ecut convergence</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5c59a04a-a68f-4b55-b85b-8b7bd9744b64", "#uuid-6dfeff6e-4747-4883-a087-7ac0988dc418") }); </script>

<p>ABINIT computes the converged ground state of ferromagnetic FCC Nickel for several volumes around equilibrium.
Plot the etotal vs acell curve:</p>
<p><img alt="etotal vs acell" src="../paw2_assets/acell-etotal.jpg" />  </p>
<p>From this graph and output file, you can extract some physical quantities:</p>
<div class="codehilite"><pre><span></span>Equilibrium cell parameter: a0 = 3.523 angstrom  
Bulk modulus: B = 190 GPa  
Magnetic moment at equilibrium: μ = 0.60
</pre></div>


<p>Compare these results with published results:</p>
<ul>
<li>
<p>GGA-FLAPW (all-electrons - ref [3]):</p>
<p>a0 = 3.52 angstrom<br />
B = 200 GPa<br />
μ = 0.60</p>
</li>
<li>
<p>GGA-PAW (VASP - ref [3]):</p>
<p>a0 = 3.52 angstrom<br />
B = 194 GPa<br />
μ = 0.61</p>
</li>
<li>
<p>Experimental results from Dewaele, Torrent, Loubeyre, Mezouar. Phys. Rev. B 78, 104102 (2008):</p>
<p>a0 = 3.52 angstrom<br />
B = 183 GPa</p>
</li>
</ul>
<p>You should always compare results with all-electrons ones (or other PAW computations),
not with experimental ones&hellip;</p>
<p>Additional remark:</p>
<p>It can be useful to test the sensitivity of results to some ATOMPAW input parameters 
(see <a href="../paw2_assets/atompaw-usersguide.pdf">user&rsquo;s guide</a> for details on keywords):</p>
<ul>
<li>The analytical form and the cut-off radius rshape of the shape function used in compensation charge density definition. 
    By default a &ldquo;sinc&rdquo; function is used but &ldquo;gaussian&rdquo; shapes can have an influence on results. 
    &ldquo;Bessel&rdquo; shapes are efficient and generally need a smaller cut-off radius (rshape=~0.8*rPAW).</li>
<li>The matching radius rcore used to get pseudo core density from atomic core density.</li>
<li>The inclusion of additional (&ldquo;semi-core&rdquo;) states in the set of valence electrons.</li>
<li>The pseudization scheme used to get pseudopotential Vloc(r).</li>
</ul>
<p>All these parameters have to be meticulously checked, especially if the PAW
dataset is used for non-standard solid structures or thermodynamical domains.</p>
<p>Optional exercise: let&rsquo;s add 3s and 3p semi-core states in PAW dataset!</p>
<p>Repeat the procedure (ATOMPAW + ABINIT) with ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.semicore file&hellip;
The run is a bit longer as more electrons have to be treated by ABINIT.
Look at a0, B or μ variation.</p>
<p>Note: this new PAW dataset has a smaller rPAW radius (because semi-core states are localized).</p>
<div class="codehilite"><pre><span></span>a0 = 3.519 angstrom  
B = 194 GPa  
μ = 0.60
</pre></div>


<h2 id="9-the-real-space-optimization-rso-experienced-users">9 The Real Space Optimization (RSO) - experienced users<a class="headerlink" href="#9-the-real-space-optimization-rso-experienced-users" title="Permanent link">&para;</a></h2>
<p>In this section, an additional optimization of the atomic data is proposed
which can contribute, in some cases, to an acceleration of the convergence on ecut.
This optimization is not essential to produce efficient PAW datasets but
it can be useful. We advise experienced users to try it.</p>
<p>The idea is quite simple: when expressing the different atomic radial
functions (<script type="math/tex">\phi_i, \tphi_i, \tprj_i</script>) on the plane waves basis, the number of plane waves
depends on the &ldquo;locality&rdquo; of these radial functions in reciprocal space.<br />
In the following reference (we suggest to read it):  R.D. King-Smith, M.C.
Payne, J.S. Lin, Phys. Rev. B 44, 13063 (1991)</p>
<p>A method to enforce the locality (in reciprocal space) of projectors <script type="math/tex">\tprj_i</script> is presented:
Projectors <script type="math/tex">\tprj_i(g)</script> expressed in reciprocal space are modified according to the following scheme:
The reciprocal space is divided in 3 regions:</p>
<ul>
<li>
<p>If <script type="math/tex">g < g_{max}</script>, <script type="math/tex">\tprj_i</script>(g) is unchanged</p>
</li>
<li>
<p>If <script type="math/tex">g > \gamma</script>, <script type="math/tex">\tprj_i</script>(g) is set to zero</p>
</li>
<li>
<p>If <script type="math/tex"> g_{max} < g < \gamma</script>, <script type="math/tex">\tprj_i(g)</script> is modified so that the contribution of <script type="math/tex">\tprj_i(r)</script> is
  conserved with an error W (as small as possible).</p>
</li>
</ul>
<p><img alt="RSO" src="../paw2_assets/RSO.png" /></p>
<p>The above transformation of <script type="math/tex">\tprj_i(g)</script> is only possible if <script type="math/tex">\tprj_i(r)</script> is defined outside
the augmentation sphere up to a radius R0 (with R0 &gt; rc).
In practice we have to:</p>
<ol>
<li>Impose an error W (W is the maximum error admitted on total energy)  </li>
<li>Adjust gmax according to Ecut (<script type="math/tex">g_{max} <= E_{cut}</script>)</li>
<li>Choose <script type="math/tex">\gamma</script> so that <script type="math/tex">2 g_{max} < \gamma < 3 g_{max}</script>
</li>
</ol>
<p>and the ATOMPAW code apply the transformation to <script type="math/tex">\tprj_i</script> and deduce R0 radius.  </p>
<p>You can test it now.
In your working directory, re-use the dataset with Bloechl projectors
(~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input3).
Replace the last line but one (&ldquo;default&rdquo;) by &ldquo;rsoptim 8. 2 0.0001&rdquo;
(8., 2 and 0.0001 are the values for gmax, γ/gmax and W).
Run ATOMPAW.
You get a new psp file for ABINIT.
Run ABINIT with it using the ~abinit/tests/tutorial/Input/tpaw2_1.in file.
Compare the results with those obtained in section 7.</p>
<p>You can try several values for gmax (keeping γ/gmax and W constant) and
compare the efficiency of the atomic data; do not forget to test physical properties again.</p>
<p><img alt="RSO comparison" src="../paw2_assets/RSOcompa.jpg" /></p>
<p>How to choose the RSO parameters?</p>
<p>
<script type="math/tex">\gamma / g_{max} = 2</script> and <script type="math/tex"> 0.0001 < W < 0.001 </script> is a good choice.
gmax has to be adjusted. The lower gmax the faster the convergence is
but too low gmax can produce unphysical results.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../paw1/" title="PAW1" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                PAW1
              </span>
            </div>
          </a>
        
        
          <a href="../paw3/" title="PAW3" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PAW3
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (MT)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>