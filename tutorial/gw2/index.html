



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/gw2/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>GW2 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#second-lesson-on-gw" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  Many-Body
                </span>
              
            
            GW2
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8" checked>
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        GW2
      </label>
    
    <a href="./" title="GW2" class="md-nav__link md-nav__link--active">
      GW2
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#treatment-of-metals" title="Treatment of metals." class="md-nav__link">
    Treatment of metals.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-preliminary-kohn-sham-band-structure-calculation" title="1 The preliminary Kohn-Sham band structure calculation" class="md-nav__link">
    1 The preliminary Kohn-Sham band structure calculation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-calculation-of-the-screening-file" title="2 Calculation of the screening file" class="md-nav__link">
    2 Calculation of the screening file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-the-fermi-energy-and-the-bottom-of-the-valence-band" title="3 Finding the Fermi energy and the bottom of the valence band" class="md-nav__link">
    3 Finding the Fermi energy and the bottom of the valence band
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-computing-a-gw-spectral-function-and-the-plasmon-satellite-of-aluminum" title="4 Computing a GW spectral function, and the plasmon satellite of Aluminum" class="md-nav__link">
    4 Computing a GW spectral function, and the plasmon satellite of Aluminum
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#treatment-of-metals" title="Treatment of metals." class="md-nav__link">
    Treatment of metals.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-preliminary-kohn-sham-band-structure-calculation" title="1 The preliminary Kohn-Sham band structure calculation" class="md-nav__link">
    1 The preliminary Kohn-Sham band structure calculation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-calculation-of-the-screening-file" title="2 Calculation of the screening file" class="md-nav__link">
    2 Calculation of the screening file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-finding-the-fermi-energy-and-the-bottom-of-the-valence-band" title="3 Finding the Fermi energy and the bottom of the valence band" class="md-nav__link">
    3 Finding the Fermi energy and the bottom of the valence band
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-computing-a-gw-spectral-function-and-the-plasmon-satellite-of-aluminum" title="4 Computing a GW spectral function, and the plasmon satellite of Aluminum" class="md-nav__link">
    4 Computing a GW spectral function, and the plasmon satellite of Aluminum
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/gw2.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="second-lesson-on-gw">Second lesson on GW<a class="headerlink" href="#second-lesson-on-gw" title="Permanent link">&para;</a></h1>
<h2 id="treatment-of-metals">Treatment of metals.<a class="headerlink" href="#treatment-of-metals" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to obtain self-energy corrections to the DFT
Kohn-Sham eigenvalues within the GW approximation, in the metallic case,
without the use of a plasmon-pole model. 
The band width and Fermi energy of Aluminum will be computed.  </p>
<p>The user may read the paper</p>
<ul>
<li>
<p>F. Bruneval, N. Vast, and L. Reining, Phys. Rev. B <strong>74</strong> , 045102 (2006), 
for some information and results about the GW treatment of Aluminum. He will
also find there an analysis of the effect of self-consistency on
quasiparticles in solids (not present in this tutorial, however available in
Abinit). The description of the contour deformation technique that bypasses
the use of a plasmon-pole model to calculate the frequency convolution of G
and W can be found in</p>
</li>
<li>
<p>S. Lebegue, S. Arnaud, M. Alouani, P. Bloechl, Phys. Rev. B 67, 155208 (2003), </p>
</li>
</ul>
<p>with the relevant formulas. We will refer to these papers as the <a class="wikilink citation-wikilink" data-content="Effect of self-consistency on quasiparticles in solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2006">[Bruneval2006]</a> 
and the <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a> papers.</p>
<p>A brief description of the equations implemented in the code can be found in the <a class="wikilink theory-wikilink" href="../../theory/mbt">GW notes</a>
Also, it is suggested to acknowledge the efforts of developers of the GW part of ABINIT, 
by citing the <a class="wikilink citation-wikilink" data-content="A brief introduction to the ABINIT software package" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze2005">2005 ABINIT publication</a>.</p>
<p>The user should be familiarized with the four basic lessons of ABINIT, see the
<a class="wikilink lesson-wikilink" href="../.">tutorial home page</a> as well as the <a class="wikilink lesson-wikilink" href="../gw1">first GW lesson</a>.</p>
<p>This lesson should take about one hour to be completed (also including the
reading of <a class="wikilink citation-wikilink" data-content="Effect of self-consistency on quasiparticles in solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2006">[Bruneval2006]</a> and <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a>.</p>
<h2 id="1-the-preliminary-kohn-sham-band-structure-calculation">1 The preliminary Kohn-Sham band structure calculation<a class="headerlink" href="#1-the-preliminary-kohn-sham-band-structure-calculation" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_gw2&rdquo;?</em></p>
<p>In <a class="wikilink lesson-wikilink" href="../base4">lesson 4</a>, we have computed different properties of
Aluminum within the LDA. Unlike for silicon, in this approximation, there is
no outstanding problem in the computed band structure. Nevertheless, as you
will see, the agreement of the band structure with experiment can be improved
significantly if one relies on the GW approximation.</p>
<p>In the directory ~abinit/tests/tutorial/Input/Work_gw2, copy the files
~abinit/tests/tutorial/Input/tgw2_x.files and tgw2_1.in, and modify the
tgw2_x.files file as usual (see <a class="wikilink lesson-wikilink" href="../base1">base1 lesson</a>).<br />
Then (supposing abinit is the proper alias), issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw2_x.files &gt;&amp; tgw2_1.log &amp;
</pre></div>


<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-bd268cd3-7b33-4199-a147-8da469c52878" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw2_x.files
</button>
<button type="button" id="uuid-2c616852-8037-473d-80f9-bfb033efb550" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw2_1.in
</button>
</div></div>

<div id="uuid-5f74a79a-6f54-422f-bd8e-0bda5918faf4" class="my_dialog" title="tests/tutorial/Input/tgw2_x.files" hidden><div><pre class="small-text">
tgw2_x.in
tgw2_x.out
tgw2i
tgw2o
tgw2t
../../Psps_for_tests/13al.981214.fhi

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5f74a79a-6f54-422f-bd8e-0bda5918faf4", "#uuid-bd268cd3-7b33-4199-a147-8da469c52878") }); </script>

<div id="uuid-0d89a8f4-c232-4f31-8c0e-8684c00ecacf" class="my_dialog" title="tests/tutorial/Input/tgw2_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline aluminum</span>
<span class="c1"># Create the WFK file for the GW calculation.</span>
ndtset    <span class="m">2</span>

nband1    <span class="m">6</span>
toldfe1   <span class="m">1</span>.0d-8     

iscf2        -2
getden2      <span class="m">1</span>
nband2      <span class="m">35</span>
nbdbuf2      <span class="m">5</span>
tolwfr2     <span class="m">1</span>.0d-10

<span class="c1">#Definition of occupation numbers</span>
occopt <span class="m">3</span>
tsmear <span class="m">0</span>.05

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*7.652

rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5 
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>       
znucl <span class="m">13</span>      

<span class="c1">#Definition of the atoms</span>
natom <span class="m">1</span>  
typat <span class="m">1</span>  
xred  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  

<span class="c1">#Definition of the planewave basis set</span>
ecut  <span class="m">8</span>.0

<span class="c1">#Definition of the k-point grid</span>
ngkpt       <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>

<span class="c1">#64 k points</span>
 nshiftk     <span class="m">1</span>      
 shiftk      <span class="m">0</span>.  <span class="m">0</span>.  <span class="m">0</span>. 
 istwfk     *1
<span class="c1">#256 k points</span>
<span class="c1">#nshiftk 4</span>
<span class="c1">#shiftk 0 0 0   1/2 1/2 0   1/2 0 1/2  0 1/2 1/2</span>
<span class="c1">#istwfk     19*1</span>

<span class="c1">#Definition of the SCF procedure</span>
nstep <span class="m">50</span>          
<span class="c1">#toldfe 1.0d-8     </span>

prtvol     <span class="m">5</span>
enunit     <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw2_1.in, tgw2_2.in, tgw2_3.in, tgw2_4.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw2_1.out, tolnlines=0, tolabs=0.000e+00, tolrel=3.000e-02</span>
<span class="c1">#%% psp_files = 13al.981214.fhi</span>
<span class="c1">#%% [shell] </span>
<span class="c1">#%% post_commands = </span>
<span class="c1">#%%   ww_cp tgw2_1o_DS2_WFK tgw2_2i_WFK;</span>
<span class="c1">#%%   ww_cp tgw2_1o_DS2_WFK tgw2_3i_WFK;</span>
<span class="c1">#%%   ww_cp tgw2_1o_DS2_WFK tgw2_4i_WFK;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bruneval</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline aluminum</span>
<span class="c1">#%%   Create the WFK file for the GW calculation.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-0d89a8f4-c232-4f31-8c0e-8684c00ecacf", "#uuid-2c616852-8037-473d-80f9-bfb033efb550") }); </script>

<p>This run generates the WFK file for the subsequent GW computation and also
provides the band width of Aluminum. Note that the simple Fermi-Dirac smearing
functional is used (<a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a>=3), with a large smearing (<a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a>=0.05 Ha).
The k point grid is quite rough, an unshifted 4x4x4 Monkhorst-Pack grid (64 k
points in the full Brillouin Zone, folding to 8 k points in the Irreducible
wedge, <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>=4 4 4). Converged results would need a 4x4x4 grid with 4
shifts (256 k points in the full Brillouin zone). This grid contains the Gamma
point, at which the valence band structure reaches its minimum.</p>
<p>The output file presents the Fermi energy</p>
<div class="codehilite"><pre><span></span> Fermi (or HOMO) energy (eV) =   7.14774   Average Vxc (eV)=  -9.35982
</pre></div>


<p>as well as the lowest energy, at the Gamma point</p>
<div class="codehilite"><pre><span></span> Eigenvalues (   eV  ) for nkpt=   8  k points:
 kpt#   1, nband=  6, wtk=  0.01563, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -3.76175  19.92114  19.92114  19.92114  21.00078  21.00078
</pre></div>


<p>So, the occupied band width is 10.90 eV. More converged calculations would give 11.06 eV (see <a class="wikilink citation-wikilink" data-content="Effect of self-consistency on quasiparticles in solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2006">[Bruneval2006]</a>).<br />
This is to be compared to the experimental value of 10.6 eV (see references in <a class="wikilink citation-wikilink" data-content="Effect of self-consistency on quasiparticles in solids" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bruneval2006">[Bruneval2006]</a>).</p>
<h2 id="2-calculation-of-the-screening-file">2 Calculation of the screening file<a class="headerlink" href="#2-calculation-of-the-screening-file" title="Permanent link">&para;</a></h2>
<p>In order not to lose time, let us start the calculation of the screening file
before the examination of the corresponding input file. So, copy the file
tgw2_2.in, and modify the tgw2_x.files file as usual (replace occurrences of
twg2_x by tgw2_2). Also, copy the WFK file (tgw2_1o_WFK) to tgw2_2i_WFK. Then
run the calculation (it should take about 30 seconds on a 3 GHz PC).</p>
<div class="text-center"><button type="button" id="uuid-fdcd58de-9c2b-4340-b646-aff8eee2a4b3" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw2_2.in
</button></div>

<div id="uuid-3b7ed1c8-c4f5-494e-b60d-d28ef64845e0" class="my_dialog" title="tests/tutorial/Input/tgw2_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline aluminum : </span>
<span class="c1"># create the screening file</span>

<span class="c1">#Parameter for the screening calculation</span>
optdriver    <span class="m">3</span>
gwcalctyp    <span class="m">2</span>
nband       <span class="m">30</span>
ecuteps     <span class="m">4</span>.0
ecutwfn     <span class="m">4</span>.0

nfreqim      <span class="m">4</span>
nfreqre     <span class="m">10</span>
freqremax    <span class="m">1</span>.

<span class="c1">#Definition of occupation numbers</span>
occopt <span class="m">3</span>
tsmear <span class="m">0</span>.05

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*7.652

rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5 
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>     
znucl <span class="m">13</span>    

<span class="c1">#Definition of the atoms</span>
natom <span class="m">1</span>  
typat <span class="m">1</span>  
xred  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  

<span class="c1">#Definition of the planewave basis set</span>
ecut  <span class="m">8</span>.0

<span class="c1">#Definition of the k-point grid</span>
ngkpt        <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
nshiftk      <span class="m">1</span>      
shiftk       <span class="m">0</span>.  <span class="m">0</span>.  <span class="m">0</span>. 
istwfk       *1

<span class="c1">#Definition of the SCF procedure</span>
nstep       <span class="m">50</span>          
toldfe      <span class="m">1</span>.0d-8     

prtvol     <span class="m">5</span>
enunit     <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw2_1.in, tgw2_2.in, tgw2_3.in, tgw2_4.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw2_2.out, tolnlines= 28, tolabs=  1.10e-02, tolrel=  4.0e-01 </span>
<span class="c1">#%% psp_files = 13al.981214.fhi</span>
<span class="c1">#%% [shell]</span>
<span class="c1">#%% post_commands = </span>
<span class="c1">#%%   ww_cp tgw2_2o_SCR tgw2_3i_SCR;</span>
<span class="c1">#%%   ww_cp tgw2_2o_SCR tgw2_4i_SCR</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bruneval</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline aluminum: </span>
<span class="c1">#%%   create the screening file</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-3b7ed1c8-c4f5-494e-b60d-d28ef64845e0", "#uuid-fdcd58de-9c2b-4340-b646-aff8eee2a4b3") }); </script>

<p>We now have to consider starting a GW calculation. However, unlike in the case
of Silicon in the previous GW tutorial, where we were focussing on quantities
close to the Fermi energy (spanning a range of a few eV), here we need to
consider a much wider range of energy: the bottom of the valence band lies
around -11 eV below the Fermi level. Unfortunately, this energy is of the same
order of magnitude as the plasmon excitations. With a rough evaluation, the
classical plasma frequency for a homogeneous electron gas with a density equal
to the average valence density of Aluminum is 15.77 eV. Hence, using 
plasmon-pole models may be not really appropriate.</p>
<p>In what follows, one will compute the GW band structure without a plasmon-pole
model, by performing explicitly the numerical frequency convolution. In
practice, it is convenient to extend all the functions of frequency to the
full complex plane. And then, making use of the residue theorem, the
integration path can be deformed: one transforms an integral along the real
axis into an integral along the imaginary axis plus residues enclosed in the
new contour of integration. The method is extensively described in <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a>.</p>
<p>Examine the input file tgw2_2.in. The ten first lines contain the important
information. There, you find some input variables that you are already
familiarized with, like <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, but also new
input variables: <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqim">nfreqim</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqre">nfreqre</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gw#freqremax">freqremax</a>.
The purpose of this run is simply to generate the screening matrices. Unlike
for the plasmon-pole models, one needs to compute these at many different
frequencies. This is the purpose of the new input variables. The main variable
<a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> is set to 2 in order to specify a <em>non</em> plasmon-pole model
calculation. Note that the number of frequencies along the imaginary axis
governed by <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqim">nfreqim</a> can be chosen quite small, since all functions are
smooth in this direction. In contrast, the number of frequencies needed along
the real axis set with the variable <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqre">nfreqre</a> is usually larger.</p>
<h2 id="3-finding-the-fermi-energy-and-the-bottom-of-the-valence-band">3 Finding the Fermi energy and the bottom of the valence band<a class="headerlink" href="#3-finding-the-fermi-energy-and-the-bottom-of-the-valence-band" title="Permanent link">&para;</a></h2>
<p>In order not to lose time, let us start the calculation of the band width
before the study of the input file. So, copy the file tgw2_3.in, and modify
the tgw3_x.files file as usual (replace occurrences of twg2_x by tgw2_3).
Also, copy the WFK file (tgw2_1o_WFK) to tgw2_3i_WFK, and the screening file
(tgw2_2o_SCR) to tgw2_3i_SCR. Then run the calculation (it should take about 2 minutes on a 3 GHz PC).</p>
<p>The computation of the GW quasi-particle energy at the Gamma point of Aluminum
does not differ from the one of quasi-particle in Silicon. However, the
determination of the Fermi energy raises a completely new problem: one should
sample the Brillouin Zone, to get new energies (quasi-particle energies) and
then determine the Fermi energy. This is actually the first step towards a self-consistency!</p>
<p>Examine the input file tgw2_3.in:</p>
<div class="text-center"><button type="button" id="uuid-7f089953-825a-4fe3-a405-bd0b2d9f8f34" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw2_3.in
</button></div>

<div id="uuid-64a00c01-b6b9-4ebc-a6f6-cf3dbbb94f5a" class="my_dialog" title="tests/tutorial/Input/tgw2_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline aluminum : </span>
<span class="c1"># calculation of the quasi-particle Fermi energy</span>

<span class="c1">#Parameters for the GW calculation</span>
optdriver    <span class="m">4</span>
nband       <span class="m">30</span>
ecutsigx    <span class="m">6</span>.5
ecutwfn     <span class="m">6</span>.5

gwcalctyp   <span class="m">12</span>

nkptgw       <span class="m">8</span>
kptgw
      <span class="m">0</span>.000000    <span class="m">0</span>.000000    <span class="m">0</span>.000000
      <span class="m">0</span>.250000    <span class="m">0</span>.000000    <span class="m">0</span>.000000
      <span class="m">0</span>.500000    <span class="m">0</span>.000000    <span class="m">0</span>.000000
      <span class="m">0</span>.250000    <span class="m">0</span>.250000    <span class="m">0</span>.000000
      <span class="m">0</span>.500000    <span class="m">0</span>.250000    <span class="m">0</span>.000000
     -0.250000    <span class="m">0</span>.250000    <span class="m">0</span>.000000
      <span class="m">0</span>.500000    <span class="m">0</span>.500000    <span class="m">0</span>.000000
     -0.250000    <span class="m">0</span>.500000    <span class="m">0</span>.250000
bdgw
             <span class="m">1</span> <span class="m">1</span>
             <span class="m">2</span> <span class="m">2</span>
             <span class="m">1</span> <span class="m">2</span>
             <span class="m">1</span> <span class="m">1</span>
             <span class="m">1</span> <span class="m">3</span>
             <span class="m">1</span> <span class="m">3</span>
             <span class="m">1</span> <span class="m">5</span>
             <span class="m">1</span> <span class="m">4</span>


<span class="c1">#Definition of occupation numbers</span>
occopt <span class="m">3</span>
tsmear <span class="m">0</span>.05

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*7.652 

rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5 
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>       
znucl <span class="m">13</span>      

<span class="c1">#Definition of the atoms</span>
natom <span class="m">1</span>  
typat <span class="m">1</span>  
xred  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  

<span class="c1">#Definition of the planewave basis set</span>
ecut  <span class="m">8</span>.0

<span class="c1">#Definition of the k-point grid</span>
ngkpt         <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
nshiftk       <span class="m">1</span>     
shiftk        <span class="m">0</span>.  <span class="m">0</span>.  <span class="m">0</span>. 
istwfk        *1

<span class="c1">#Definition of the SCF procedure</span>
nstep <span class="m">50</span>          
toldfe <span class="m">1</span>.0d-8     

prtvol     <span class="m">5</span>
enunit     <span class="m">1</span>

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw2_1.in, tgw2_2.in, tgw2_3.in, tgw2_4.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw2_3.out, tolnlines=  5, tolabs=0.002, tolrel=  3.000e-02 </span>
<span class="c1">#%% psp_files = 13al.981214.fhi</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bruneval</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline aluminum: </span>
<span class="c1">#%%   calculation of the quasi-particle Fermi energy</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-64a00c01-b6b9-4ebc-a6f6-cf3dbbb94f5a", "#uuid-7f089953-825a-4fe3-a405-bd0b2d9f8f34") }); </script>

<p>The first thirty lines contain the important information. 
There, you find some input variables with values that you are
already familiarized with, like <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>.
Then, comes the input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a>=12. The value <em>x2</em> corresponds to
a contour integration. The value <em>1x</em> corresponds to a self-consistent
calculation with update of the energies only. Then, one finds the list of k
points and bands for which a quasi-particle correction will be computed:
<a class="wikilink codevar-wikilink" href="../../variables/gw#nkptgw">nkptgw</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#kptgw">kptgw</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gw#bdgw">bdgw</a>. The number and list of k points is simply
the same as <a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#kpt">kpt</a>. One might have specified less k points,
though (only those needing an update). The list of band ranges <a class="wikilink codevar-wikilink" href="../../variables/gw#bdgw">bdgw</a> has
been generated on the basis of the LDA eigenenergies. We considered only the
bands in the vicinity of the Fermi level: bands much below or much above are
likely to remain much or much above the Fermi region. In the present run, we
are just interested in the states that may cross the Fermi level, when going
from LDA to GW. For commodity, one could have selected an homogeneous range
for the whole Brillouin zone, e.g. from 1 to 5, but this would have been more time-consuming.</p>
<p>In the output file, one finds the quasi-particle energy at Gamma, for the lowest band:</p>
<div class="codehilite"><pre><span></span>k =    0.000   0.000   0.000
 Band     E_lda   &lt;Vxclda&gt;   E(N-1)  &lt;Hhartree&gt;   SigX  SigC[E(N-1)]    Z     dSigC/dE  Sig[E(N)]  DeltaE  E(N)_pert E(N)_diago
    1    -3.762    -9.451    -3.762     5.689   -15.049     5.676     0.777    -0.287    -9.390     0.060    -3.701    -3.684
</pre></div>


<p>(the last column is the relevant quantity). The updated Fermi energy is also mentioned:</p>
<div class="codehilite"><pre><span></span> New Fermi energy:     2.469501E-01 Ha ,    6.719854E+00 eV
</pre></div>


<p>The last information is not printed in case of <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> lower than 10.</p>
<p>Combining the quasi-particle energy at Gamma and the Fermi energy, gives the
band width, 10.404 eV. Using converged parameters, the band width will be
10.54 eV (see Bruneval[2006]). This is in excellent agreement with the experimental value of 10.6 eV.</p>
<h2 id="4-computing-a-gw-spectral-function-and-the-plasmon-satellite-of-aluminum">4 Computing a GW spectral function, and the plasmon satellite of Aluminum<a class="headerlink" href="#4-computing-a-gw-spectral-function-and-the-plasmon-satellite-of-aluminum" title="Permanent link">&para;</a></h2>
<p>The access to the non-plasmon-pole-model self-energy (real and imaginary part)
has additional benefit, e.g. an accurate spectral function can be computed,
see <a class="wikilink citation-wikilink" data-content="Implementation of an all-electron GW approximation based on the projector augmented wave method without plasmon pole approximation: Application to Si, SiC, AlAs, InAs, NaH, and KH" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lebegue2003">[Lebegue2003]</a>. You may be interested to see the plasmon satellite of
Aluminum, which can be accounted for within the GW approximation. </p>
<p>Remember that the spectral function is almost (except some matrix elements) the spectrum which
is measured in photoemission spectroscopy (PES). In PES, a photon impinges the
sample and extracts an electron from the material. The difference of energy
between the incoming photon and the obtained electron gives the binding energy
of the electron in the solid, or in other words the quasiparticle energy or
the band structure. In simple metals, an additional process can take place
easily: the impinging photon can <strong>extract an electron together with a global
charge oscillation in the sample</strong>. The extracted electron will have a kinetic
energy lower than in the direct process, because a part of the energy has gone
to the plasmon. The electron will appear to have a larger binding energy&hellip;
You will see that the spectral function of Aluminum consists of a main peak
which corresponds to the quasiparticle excitation and some additional peaks
which correspond to quasiparticle and plasmon excitations together.</p>
<p>In order not to lose time, this calculation can be started before the
examination of the input file. So, copy the file tgw2_4.in, and modify the
tgw4_x.files file as usual (replace occurrences of twg2_x by tgw2_4). Also,
copy the WFK file (tgw2_1o_WFK) to tgw2_4i_WFK, and the screening file
(tgw2_2o_SCR) to tgw2_4i_SCR. 
Then run the calculation (it should take about 2 minutes on a 3 GHz PC).</p>
<div class="text-center"><button type="button" id="uuid-98318552-eabc-4917-b730-a45963c75a98" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw2_4.in
</button></div>

<div id="uuid-1da34f07-fb72-406e-8852-1078d1153710" class="my_dialog" title="tests/tutorial/Input/tgw2_4.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline aluminum : perform the GW calculation</span>
<span class="c1"># at the bottom of the valence band</span>
<span class="c1"># Obtain the corresponding spectral function</span>

<span class="c1">#Parameters for the GW calculation</span>

optdriver    <span class="m">4</span>
gwcalctyp    <span class="m">2</span>
nband       <span class="m">30</span>
ecutsigx    <span class="m">4</span>.0
ecutwfn     <span class="m">4</span>.0

nfreqsp    <span class="m">200</span>
freqspmax    <span class="m">2</span>.

nkptgw       <span class="m">1</span>
kptgw
             <span class="m">0</span>.000000    <span class="m">0</span>.000000    <span class="m">0</span>.000000
bdgw
             <span class="m">1</span> <span class="m">1</span>
icutcoul     <span class="m">3</span>            <span class="c1"># old deprecated value of icutcoul, only used for legacy</span>

<span class="c1">#Definition of occupation numbers</span>
occopt <span class="m">3</span>
tsmear <span class="m">0</span>.05

<span class="c1">#Definition of the unit cell</span>
acell <span class="m">3</span>*7.652 

rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5 
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1">#Definition of the atom types</span>
ntypat <span class="m">1</span>       
znucl <span class="m">13</span>      

<span class="c1">#Definition of the atoms</span>
natom <span class="m">1</span>  
typat <span class="m">1</span>  
xred  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0  

<span class="c1">#Definition of the planewave basis set</span>
ecut  <span class="m">8</span>.0

<span class="c1">#Definition of the k-point grid</span>
ngkpt         <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>
nshiftk       <span class="m">1</span>     
shiftk        <span class="m">0</span>.  <span class="m">0</span>.  <span class="m">0</span>. 
istwfk        *1


prtvol     <span class="m">5</span>
enunit     <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw2_1.in, tgw2_2.in, tgw2_3.in, tgw2_4.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw2_4.out, tolnlines=  2, tolabs=  1.010e-06, tolrel=  3.000e-02 </span>
<span class="c1">#%% psp_files = 13al.981214.fhi</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bruneval</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline aluminum : perform the GW calculation</span>
<span class="c1">#%%   at the bottom of the valence band</span>
<span class="c1">#%%   Obtain the corresponding spectral function</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-1da34f07-fb72-406e-8852-1078d1153710", "#uuid-98318552-eabc-4917-b730-a45963c75a98") }); </script>

<p>Compared to the previous file (tgw2_3.in), the input file contains two
additional keywords: <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqsp">nfreqsp</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gw#freqspmax">freqspmax</a>. Also, the computation of
the GW self-energy is done only at the Gamma point.</p>
<p>The spectral function is written in the file tgw2_4o_SIG. It is a simple text
file. It contains, as a function of the frequency (eV), the real part of the
self-energy, the imaginary part of the self-energy, and the spectral function.
You can visualize it using your preferred software. For instance, issue</p>
<div class="codehilite"><pre><span></span>$ gnuplot
gnuplot&gt;  p<span class="s1">&#39;tgw2_4o_SIG&#39;</span> u <span class="m">1</span>:4 w l
</pre></div>


<p>You should be able to distinguish the main quasiparticle peak located at the
GW energy (-3.7 eV) and some additional features in the vicinity of the GW
eigenvalue minus a plasmon energy (-3.7 eV - 15.8 eV = -19.5 eV).</p>
<p>Another file, tgw2_4o_GW, is worth to mention: it contains information to be
used for the subsequent calculation of excitonic effects by the EXC code
(usually available at http://theory.polytechnique.fr/codes/exc; if not, see
the <a href="http://www.etsf.eu/resources/software/codes">ETSF software page</a> and further links).</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../gw1/" title="GW1" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                GW1
              </span>
            </div>
          </a>
        
        
          <a href="../bse/" title="Bethe-Salpeter" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Bethe-Salpeter
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (FBruneval, XG)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>