



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/elastic/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Elastic - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#lesson-on-elastic-properties" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  DFPT
                </span>
              
            
            Elastic
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" checked>
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Elastic
      </label>
    
    <a href="./" title="Elastic" class="md-nav__link md-nav__link--active">
      Elastic
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elastic-and-piezoelectric-properties" title="Elastic and piezoelectric properties." class="md-nav__link">
    Elastic and piezoelectric properties.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alas" title="1 The ground-state geometry of (hypothetical) wurtzite AlAs" class="md-nav__link">
    1 The ground-state geometry of (hypothetical) wurtzite AlAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" title="2 Response-function calculations of several second derivatives of the total energy" class="md-nav__link">
    2 Response-function calculations of several second derivatives of the total energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-anaddb-calculation-of-atom-relaxation-effects" title="3 ANADDB calculation of atom-relaxation effects" class="md-nav__link">
    3 ANADDB calculation of atom-relaxation effects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" title="4 Finite-difference calculation of elastic and piezoelectric constants" class="md-nav__link">
    4 Finite-difference calculation of elastic and piezoelectric constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" title="5 Alternative DFPT calculation of some piezoelectric constants" class="md-nav__link">
    5 Alternative DFPT calculation of some piezoelectric constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" title="6 Response-function calculation of the elastic constants of Al metal" class="md-nav__link">
    6 Response-function calculation of the elastic constants of Al metal
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-on-symmetry" title="Comment on symmetry" class="md-nav__link">
    Comment on symmetry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elastic-and-piezoelectric-properties" title="Elastic and piezoelectric properties." class="md-nav__link">
    Elastic and piezoelectric properties.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alas" title="1 The ground-state geometry of (hypothetical) wurtzite AlAs" class="md-nav__link">
    1 The ground-state geometry of (hypothetical) wurtzite AlAs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" title="2 Response-function calculations of several second derivatives of the total energy" class="md-nav__link">
    2 Response-function calculations of several second derivatives of the total energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-anaddb-calculation-of-atom-relaxation-effects" title="3 ANADDB calculation of atom-relaxation effects" class="md-nav__link">
    3 ANADDB calculation of atom-relaxation effects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" title="4 Finite-difference calculation of elastic and piezoelectric constants" class="md-nav__link">
    4 Finite-difference calculation of elastic and piezoelectric constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" title="5 Alternative DFPT calculation of some piezoelectric constants" class="md-nav__link">
    5 Alternative DFPT calculation of some piezoelectric constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" title="6 Response-function calculation of the elastic constants of Al metal" class="md-nav__link">
    6 Response-function calculation of the elastic constants of Al metal
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-on-symmetry" title="Comment on symmetry" class="md-nav__link">
    Comment on symmetry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/elastic.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="lesson-on-elastic-properties">Lesson on elastic properties<a class="headerlink" href="#lesson-on-elastic-properties" title="Permanent link">&para;</a></h1>
<h2 id="elastic-and-piezoelectric-properties">Elastic and piezoelectric properties.<a class="headerlink" href="#elastic-and-piezoelectric-properties" title="Permanent link">&para;</a></h2>
<p>This lesson shows how to calculate physical properties related to strain, for
an insulator and a metal:</p>
<ul>
<li>the rigid-atom elastic tensor </li>
<li>the rigid-atom piezoelectric tensor (insulators only) </li>
<li>the internal strain tensor </li>
<li>the atomic relaxation corrections to the elastic and piezoelectric tensor </li>
</ul>
<p>You should complete lessons <a href="../rf1">RF1</a> and <a href="../rf2">RF2</a>
to introduce the density-functional perturbation theory (DFPT) features of
ABINIT before starting this lesson. You will learn to use additional DFPT
features of ABINIT, and to use relevant parts of the associated codes Mrgddb and Anaddb.</p>
<p>This lesson should take about two hours.</p>
<h2 id="1-the-ground-state-geometry-of-hypothetical-wurtzite-alas">1 The ground-state geometry of (hypothetical) wurtzite AlAs<a class="headerlink" href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alas" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider working in a different subdirectory as for the other lessons. 
Why not create &ldquo;Work_elast&rdquo; in ~abinit/tests/tutorespfn/Input?</em></p>
<p>You should copy the files ~abinit/tests/tutorespfn/Input/telast_1.files and telast_1.in into Work_elast. 
You may wish to start the calculation (less than
one minute on a standard 3GHz machine) before you read the following. 
You should open your input file telast_1.in with an editor and examine it as you read this discussion.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-6ffd89b2-c9e0-4338-a977-731c001b1eff" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_1.files
</button>
<button type="button" id="uuid-06f6bb1b-2f4a-4a20-8b87-284e7700ce45" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_1.in
</button>
</div></div>

<div id="uuid-127c70ef-fb75-4217-87bf-bb92c17378cb" class="my_dialog" title="tests/tutorespfn/Input/telast_1.files" hidden><div><pre class="small-text">
telast_1.in
telast_1.out
telast_1i
telast_1o
telast_1
../../../Psps_for_tests/13al.pspnc
../../../Psps_for_tests/33as.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-127c70ef-fb75-4217-87bf-bb92c17378cb", "#uuid-6ffd89b2-c9e0-4338-a977-731c001b1eff") }); </script>

<div id="uuid-a30972e0-823f-40fa-b307-f34cf17ec508" class="my_dialog" title="tests/tutorespfn/Input/telast_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Structural optimization run</span>

   ndtset   <span class="m">2</span>       <span class="c1"># There are 2 datasets in this calculation</span>

<span class="c1"># Set 1 : Internal coordinate optimization</span>

  ionmov1   <span class="m">2</span>       <span class="c1"># Use BFGS algorithm for structural optimization</span>
   ntime1   <span class="m">5</span>       <span class="c1"># Maximum number of optimization steps</span>
  tolmxf1   <span class="m">1</span>.0e-6  <span class="c1"># Optimization is converged when maximum force </span>
                    <span class="c1"># (Hartree/Bohr) is less than this maximum</span>
  natfix1   <span class="m">2</span>       <span class="c1"># Fix the position of two symmetry-equivalent atoms </span>
                    <span class="c1">#  in doing the structural optimization</span>
  iatfix1   <span class="m">1</span> <span class="m">2</span>     <span class="c1"># Choose atoms 1 and 2 as the fixed atoms (see discussion)</span>

<span class="c1"># Set 2 : Lattice parameter relaxation (including re-optimization of</span>
<span class="c1">#         internal coordinates)</span>

 dilatmx2   <span class="m">1</span>.05    <span class="c1"># Maximum scaling allowed for lattice parameters</span>
 getxred2   -1      <span class="c1"># Start with relaxed coordinates from dataset 1</span>
  getwfk2   -1      <span class="c1"># Start with wave functions from dataset 1</span>
  ionmov2   <span class="m">2</span>       <span class="c1"># Use BFGS algorithm</span>
   ntime2   <span class="m">12</span>      <span class="c1"># Maximum number of optimization steps</span>
 optcell2   <span class="m">2</span>       <span class="c1"># Fully optimize unit cell geometry, keeping symmetry</span>
  tolmxf2   <span class="m">1</span>.0e-6  <span class="c1"># Convergence limit for forces as above</span>
 strfact2   <span class="m">100</span>     <span class="c1"># Test convergence of stresses (Hartree/bohr^3) by</span>
                    <span class="c1"># multiplying by this factor and applying force</span>
                    <span class="c1"># convergence test</span>
  natfix2   <span class="m">2</span>       
  iatfix2   <span class="m">1</span> <span class="m">2</span>     

<span class="c1">#Common input data</span>

<span class="c1">#Starting approximation for the unit cell</span>
  acell   <span class="m">7</span>.5  <span class="m">7</span>.5  <span class="m">12</span>.263388           <span class="c1">#this is a guess, with the c/a</span>
                                        <span class="c1">#ratio based on ideal tetrahedral</span>
                                        <span class="c1">#bond angles</span>

  rprim   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#hexagonal primitive vectors must be</span>
         -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#specified with high accuracy to be</span>
          <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">1</span>.0   <span class="c1">#sure that the symmetry is recognized</span>
                                        <span class="c1">#and preserved in the optimization</span>
                                        <span class="c1">#process</span>

<span class="c1">#Definition of the atom types and atoms</span>
 ntypat   <span class="m">2</span> 
  znucl   <span class="m">13</span> <span class="m">33</span>
  natom   <span class="m">4</span>
  typat   <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> <span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>
   xred   <span class="m">1</span>/3  <span class="m">2</span>/3  <span class="m">0</span>.0
          <span class="m">2</span>/3  <span class="m">1</span>/3  <span class="m">0</span>.5
          <span class="m">1</span>/3  <span class="m">2</span>/3  <span class="m">0</span>.375
          <span class="m">2</span>/3  <span class="m">1</span>/3  <span class="m">0</span>.875

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
  nband   <span class="m">8</span>              <span class="c1"># For an insulator (if described correctly as an </span>
                         <span class="c1"># insulator by DFT), conduction bands should not</span>
                         <span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
   ecut   <span class="m">6</span>.0            <span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
 ecutsm   <span class="m">0</span>.5            <span class="c1"># Smoothing energy needed for lattice paramete</span>
                         <span class="c1"># optimization.  This will be retained for</span>
                         <span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
  ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk   <span class="m">1</span>              <span class="c1"># Use one copy of grid only (default)</span>
 shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This choice of origin for the k point grid</span>
                         <span class="c1"># preserves the hexagonal symmetry of the grid,</span>
                         <span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
 diemac   <span class="m">9</span>.0            <span class="c1"># Model dielectric preconditioner</span>
  nstep   <span class="m">40</span>             <span class="c1"># Maxiumum number of SCF iterations</span>
 tolvrs   <span class="m">1</span>.0d-18        <span class="c1"># Strict tolerance on (squared) residual of the</span>
                         <span class="c1"># SCF potential needed for accurate forces and</span>
                         <span class="c1"># stresses in the structural optimization, and</span>
                         <span class="c1"># accurate wave functions in the RF calculations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
 optforces <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_1.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Structural optimization run</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a30972e0-823f-40fa-b307-f34cf17ec508", "#uuid-06f6bb1b-2f4a-4a20-8b87-284e7700ce45") }); </script>

<p>The hypothetical wurtzite structure for AlAs retains the tetrahedral
coordination of the atoms of the actual zincblende structure of AlAs, but has a hexagonal lattice. 
It was chosen for this lesson because the atomic
positions are not completely determined by symmetry. 
Both the atomic positions and the lattice constants should be optimized before beginning DFPT
calculations, especially those related to strain properties. 
While GS structural optimization was treated in lessons 1-3, we are introducing a few
new features here, and you should look at the following new input variables which will be discussed below:  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/rlx#getxred">getxred</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/rlx#iatfix">iatfix</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/rlx#natfix">natfix</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/rlx#strfact">strfact</a>   </li>
</ul>
<p>There are two datasets specified in telast_1.in. First, let us examine the
common input data. We specify a starting guess for <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a>, and give an
accurate decimal specification for <a class="wikilink codevar-wikilink" href="../../variables/basic#rprim">rprim</a>. The definition of the atom
types and atoms follows <a href="../rf1">lesson RF1</a>. The reduced atomic
positions <a class="wikilink codevar-wikilink" href="../../variables/basic#xred">xred</a> are a starting approximation, and will be replaced by our
converged results in the remaining input files, as will <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a>.</p>
<p>We will work with a fixed plane wave cutoff <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> (=6 Ha), but introduce
<a class="wikilink codevar-wikilink" href="../../variables/rlx#ecutsm">ecutsm</a> (0.5 Ha)as in <a href="../base3">lesson 3</a> to smear the cutoff,
which produces smoothly varying stresses as the lattice parameters are
optimized. We will keep the same value of <a class="wikilink codevar-wikilink" href="../../variables/rlx#ecutsm">ecutsm</a> for the DFPT calculations
as well, since changing it from the optimization run value could reintroduce
non-zero forces and stresses. For the k-point grid, we must explicitly specify
<a class="wikilink codevar-wikilink" href="../../variables/basic#shiftk">shiftk</a> since the default value results in a grid shifted so as to break
hexagonal symmetry. The RF strain calculations check this, and will exit with
an error message if the grid does not have the proper symmetry. 
The self-consistency procedures follow <a href="../rf1">lesson RF1</a>.</p>
<p>Dataset 1 optimizes the atomic positions keeping the lattice parameters fixed,
setting <a class="wikilink codevar-wikilink" href="../../variables/rlx#ionmov">ionmov</a>=2 as in <a href="../base1">lesson 1</a>. The optimization
steps proceed until the maximum force component on any atom is less than
<a class="wikilink codevar-wikilink" href="../../variables/rlx#tolmxf">tolmxf</a>. It is always advised to relax the forces before beginning the
lattice parameter optimization. Dataset 2 optimizes the lattice parameters
with <a class="wikilink codevar-wikilink" href="../../variables/rlx#optcell">optcell</a>=2 as in <a href="../base3">lesson 3</a>. However, lesson 3
treated cubic Si, and the atom positions in reduced coordinates remained
fixed. In the present, more general case, the reduced atomic coordinates must
be reoptimized as the lattice parameters are optimized. Note that it is
necessary to include <a class="wikilink codevar-wikilink" href="../../variables/rlx#getxred">getxred</a> = -1 so that the second dataset is
initialized with the relaxed coordinates. Coordinate and lattice parameter
optimizations actually take place simultaneously, with the computed stresses
at each step acting as forces on the lattice parameters. We have introduced
<a class="wikilink codevar-wikilink" href="../../variables/rlx#strfact">strfact</a> which scales the stresses so that they may be compared with the
same <a class="wikilink codevar-wikilink" href="../../variables/rlx#tolmxf">tolmxf</a> convergence test that is applied to the forces. The default
value of 100 is probably a good choice for many systems, but you should be
aware of what is happening.</p>
<p>From the hexagonal symmetry, we know that the positions of the atoms in the
a-b basal plane are fixed. However, a uniform translation along the c axis of
all the atoms leaves the structure invariant. Only the relative displacement
of the Al and As planes along the c axis is physically relevant. We will fix
the Al positions to be at reduced c-axis coordinates 0 and &frac12; (these are
related by symmetry) by introducing <a class="wikilink codevar-wikilink" href="../../variables/rlx#natfix">natfix</a> and <a class="wikilink codevar-wikilink" href="../../variables/rlx#iatfix">iatfix</a> to constrain the
structural optimization. This is really just for cosmetic purposes, since
letting them all slide an arbitrary amount (as they otherwise would) won&rsquo;t
change any results. However, you probably wouldn&rsquo;t want to publish the results
that way, so we may as well develop good habits.  </p>
<p>Now we shall examine the results of the structural optimization run. As
always, we should first examine the log file to make sure the run has
terminated cleanly. There are a number of warnings, but none of them are
apparently serious. Next, let us edit the output file, telast_1.out. </p>
<div class="text-center"><button type="button" id="uuid-c79febbe-2511-4cda-ad49-2156360ecc25" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Refs/telast_1.out
</button></div>

<div id="uuid-86459ff9-3b33-4767-aad6-f054dc396392" class="my_dialog" title="tests/tutorespfn/Refs/telast_1.out" hidden><div><pre class="small-text">

.Version 8.1.5 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu5.3 computer) 

.Copyright (C) 1998-2018 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read ~abinit/doc/users/acknowledgments.html for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Wed  7 Dec 2016.
- ( at 20h11 )

- input  file    -&gt; telast_1.in
- output file    -&gt; telast_1.out
- root for input  files -&gt; telast_1i
- root for output files -&gt; telast_1o


 DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       2      iscf =       7    lmnmax =       2
     lnmax =       2     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         428          nfft =        9720          nkpt =           8
================================================================================
P This job should need less than                       4.133 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.420 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================


 DATASET    2 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       2      iscf =       7    lmnmax =       2
     lnmax =       2     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         494          nfft =        9720          nkpt =           8
================================================================================
P This job should need less than                       4.226 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.484 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.5000000000E+00  7.5000000000E+00  1.2263388000E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
           diemac      9.00000000E+00
          dilatmx1     1.00000000E+00
          dilatmx2     1.05000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
-          fftalg         312
           getwfk1          0
           getwfk2         -1
          getxred1          0
          getxred2         -1
           iatfix        1    2
           ionmov           2
           jdtset        1    2
              kpt      0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
P           mkmem           8
           natfix           2
            natom           4
            nband           8
           ndtset           2
            ngfft          18      18      30
             nkpt           8
            nstep          40
             nsym          12
            ntime1          5
            ntime2         12
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
          optcell1          0
          optcell2          2
        optforces           1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000 -0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000    -0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolmxf      1.00000000E-06
           tolvrs      1.00000000E-18
            typat      1  1  2  2
              wtk        0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
           xangst     -1.1457022644E+00  1.9844145322E+00  0.0000000000E+00
                       1.1457022644E+00  1.9844145322E+00  3.2447527148E+00
                      -1.1457022644E+00  1.9844145322E+00  2.4335645361E+00
                       1.1457022644E+00  1.9844145322E+00  5.6783172510E+00
            xcart     -2.1650635095E+00  3.7500000000E+00  0.0000000000E+00
                       2.1650635095E+00  3.7500000000E+00  6.1316940000E+00
                      -2.1650635095E+00  3.7500000000E+00  4.5987705000E+00
                       2.1650635095E+00  3.7500000000E+00  1.0730464500E+01
             xred      3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7500000000E-01
                       6.6666666667E-01  3.3333333333E-01  8.7500000000E-01
            znucl       13.00000   33.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

================================================================================
== DATASET  1 ==================================================================
-   nproc =    1

 Exchange-correlation functional for the present dataset will be:
  LDA: new Teter (4/93) with spin-polarized option - ixc=1
 Citation for XC functional:
  S. Goedecker, M. Teter, J. Huetter, PRB 54, 1703 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.4951905  3.7500000  0.0000000  G(1)=  0.0769800  0.1333333  0.0000000
 R(2)= -6.4951905  3.7500000  0.0000000  G(2)= -0.0769800  0.1333333  0.0000000
 R(3)=  0.0000000  0.0000000 12.2633880  G(3)=  0.0000000  0.0000000  0.0815435
 Unit cell volume ucvol=  5.9739781E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.18103

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/13al.pspnc
- pspatm: opening atomic psp file    /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/13al.pspnc
-  Troullier-Martins psp for element  Al        Thu Oct 27 17:31:05 EDT 1994
- 13.00000   3.00000    940714                znucl, zion, pspdat
    1    1    2    2      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.657  11.889    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   1.829   2.761    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2   0.000   0.000    0   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.09673076353074    0.12648111154518    1.01742091001718   rchrg,fchrg,qchrg
 pspatm : epsatm=    0.22155260
         --- l  ekb(1:nproj) --&gt;
             0    2.540658
             1    1.353815
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/33as.pspnc
- pspatm: opening atomic psp file    /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/33as.pspnc
-  Troullier-Martins psp for element  As        Thu Oct 27 17:37:14 EDT 1994
- 33.00000   5.00000    940714                znucl, zion, pspdat
    1    1    1    1      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.772  10.829    1   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   2.745   5.580    0   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.05731715564010    0.36322996461007    2.76014815959125   rchrg,fchrg,qchrg
 pspatm : epsatm=   27.20579911
         --- l  ekb(1:nproj) --&gt;
             0    0.838751
 pspatm: atomic psp has been read  and splines computed

   8.77675255E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are     419.906     419.872

================================================================================

=== [ionmov= 2] Broyden-Fletcher-Goldfard-Shanno method (forces)            
================================================================================

--- Iteration: (1/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.254324165591    -2.025E+01 4.450E-03 8.334E+00 1.787E-04 1.787E-04
 ETOT  2  -20.270075644819    -1.575E-02 1.005E-07 4.210E-01 5.371E-04 7.157E-04
 ETOT  3  -20.270785645399    -7.100E-04 4.785E-06 3.263E-02 2.090E-04 5.068E-04
 ETOT  4  -20.270824761134    -3.912E-05 1.664E-07 8.458E-04 3.056E-05 5.373E-04
 ETOT  5  -20.270825185103    -4.240E-07 1.638E-09 6.028E-06 1.048E-05 5.478E-04
 ETOT  6  -20.270825188714    -3.611E-09 1.650E-11 1.112E-07 2.953E-06 5.448E-04
 ETOT  7  -20.270825188809    -9.495E-11 1.341E-12 3.967E-09 1.396E-06 5.462E-04
 ETOT  8  -20.270825188814    -4.825E-12 9.712E-14 5.430E-11 3.021E-07 5.459E-04
 ETOT  9  -20.270825188814     7.105E-15 2.969E-16 7.388E-13 2.542E-09 5.459E-04
 ETOT 10  -20.270825188814     4.619E-14 4.751E-18 1.060E-14 6.243E-10 5.459E-04
 ETOT 11  -20.270825188814    -4.263E-14 5.081E-20 1.295E-16 5.546E-11 5.459E-04
 ETOT 12  -20.270825188814    -4.619E-14 4.891E-22 6.983E-19 5.673E-12 5.459E-04

 At SCF step   12       vres2   =  6.98E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.32496227E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.32496227E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.34717014E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96552513
    2        2.00000          0.96552513
    3        2.00000          2.52108818
    4        2.00000          2.52108818

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.59877050000000E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07304645000000E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75000000000000E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75000000000000E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 5.45946E-04 3.15202E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -5.45946165183416E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -5.45946165183416E-04
 -0.00000000000000E+00 -0.00000000000000E+00  5.45946165183416E-04
 -0.00000000000000E+00 -0.00000000000000E+00  5.45946165183416E-04
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  6.69514965075633E-03
  0.00000000000000E+00 -0.00000000000000E+00  6.69514965075633E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -6.69514965075633E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -6.69514965075633E-03
 Total energy (etotal) [Ha]= -2.02708251888140E+01

--- Iteration: (2/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270825740734    -2.027E+01 2.209E-13 9.542E-06 2.546E-05 5.205E-04
 ETOT  2  -20.270825755087    -1.435E-08 2.445E-14 2.407E-07 3.041E-05 4.901E-04
 ETOT  3  -20.270825755543    -4.559E-10 8.136E-12 1.062E-08 2.370E-06 4.924E-04
 ETOT  4  -20.270825755556    -1.315E-11 1.088E-13 4.889E-10 2.371E-07 4.922E-04
 ETOT  5  -20.270825755556    -3.588E-13 6.559E-15 1.608E-11 5.830E-08 4.921E-04
 ETOT  6  -20.270825755556    -1.172E-13 8.326E-17 2.500E-13 1.243E-08 4.922E-04
 ETOT  7  -20.270825755556     1.421E-14 3.785E-19 4.107E-15 3.072E-10 4.922E-04
 ETOT  8  -20.270825755557    -1.457E-13 8.042E-21 7.829E-17 4.416E-11 4.922E-04
 ETOT  9  -20.270825755556     1.634E-13 1.696E-22 2.297E-19 9.446E-12 4.922E-04

 At SCF step    9       vres2   =  2.30E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.34247432E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.34247432E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.31230508E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96553112
    2        2.00000          0.96553112
    3        2.00000          2.52109719
    4        2.00000          2.52109719

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.59931644616518E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07310104461652E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75044518379846E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75044518379846E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.92159E-04 2.84148E-04 (free atoms)
  5.06054506647247E-33  7.01209693529788E-32 -4.92159356881141E-04
  5.06054506647247E-33  7.01209693529788E-32 -4.92159356881140E-04
 -7.59081759970871E-32  2.10362908058936E-31  4.92159356881140E-04
  6.57870858641422E-32 -3.50604846764894E-31  4.92159356881141E-04
 Reduced forces (fred)
 -2.95822839457879E-31 -2.30084430689462E-31  6.03554115126390E-03
 -2.95822839457879E-31 -2.30084430689462E-31  6.03554115126389E-03
 -2.95822839457879E-31 -1.28189897098414E-30 -6.03554115126389E-03
  8.87468518373638E-31  1.74206783236307E-30 -6.03554115126390E-03
 Total energy (etotal) [Ha]= -2.02708257555565E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-5.66742E-07
           Relative     =-2.79585E-08

--- Iteration: (3/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270826991073    -2.027E+01 1.873E-11 7.930E-04 2.319E-04 2.603E-04
 ETOT  2  -20.270828183508    -1.192E-06 2.072E-12 2.000E-05 2.769E-04 1.659E-05
 ETOT  3  -20.270828221391    -3.788E-08 6.753E-10 8.849E-07 2.158E-05 4.988E-06
 ETOT  4  -20.270828222475    -1.084E-09 9.087E-12 4.071E-08 2.171E-06 2.817E-06
 ETOT  5  -20.270828222513    -3.875E-11 5.450E-13 1.343E-09 5.303E-07 2.287E-06
 ETOT  6  -20.270828222515    -1.158E-12 6.946E-15 2.086E-11 1.137E-07 2.400E-06
 ETOT  7  -20.270828222515    -1.776E-14 3.161E-17 3.419E-13 2.713E-09 2.403E-06
 ETOT  8  -20.270828222515    -7.816E-14 6.688E-19 6.515E-15 4.173E-10 2.403E-06
 ETOT  9  -20.270828222515    -6.750E-14 1.425E-20 1.881E-17 8.983E-11 2.403E-06
 ETOT 10  -20.270828222515     1.066E-13 5.687E-23 1.499E-19 1.588E-12 2.403E-06

 At SCF step   10       vres2   =  1.50E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.50285300E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.50285300E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.99514057E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96558748
    2        2.00000          0.96558748
    3        2.00000          2.52116623
    4        2.00000          2.52116623

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60431195569678E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07360059556968E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75451869882677E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75451869882678E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 2.40330E-06 1.38755E-06 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.40330381809290E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -2.40330381809290E-06
 -0.00000000000000E+00 -0.00000000000000E+00  2.40330381809290E-06
 -0.00000000000000E+00 -0.00000000000000E+00  2.40330381809290E-06
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  2.94726472031547E-05
  0.00000000000000E+00 -0.00000000000000E+00  2.94726472031547E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -2.94726472031547E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -2.94726472031547E-05
 Total energy (etotal) [Ha]= -2.02708282225147E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-2.46696E-06
           Relative     =-1.21700E-07

--- Iteration: (4/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270828222544    -2.027E+01 4.501E-16 1.919E-08 1.125E-06 1.279E-06
 ETOT  2  -20.270828222573    -2.894E-11 5.006E-17 4.853E-10 1.361E-06 8.272E-08
 ETOT  3  -20.270828222574    -8.669E-13 1.635E-14 2.142E-11 1.061E-07 2.339E-08
 ETOT  4  -20.270828222574     8.527E-14 2.195E-16 9.813E-13 1.069E-08 1.270E-08
 ETOT  5  -20.270828222574    -1.634E-13 1.314E-17 3.222E-14 2.602E-09 1.010E-08
 ETOT  6  -20.270828222574     8.171E-14 1.662E-19 5.021E-16 5.567E-10 1.066E-08
 ETOT  7  -20.270828222574    -2.842E-14 7.612E-22 8.262E-18 1.283E-11 1.067E-08
 ETOT  8  -20.270828222574     1.066E-13 1.614E-23 1.568E-19 2.138E-12 1.067E-08

 At SCF step    8       vres2   =  1.57E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.50364062E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.50364062E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.99359243E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96558776
    2        2.00000          0.96558776
    3        2.00000          2.52116651
    4        2.00000          2.52116651

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60433646938489E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07360304693849E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75453868815444E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75453868815444E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.06704E-08 6.16058E-09 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -1.06704405580042E-08
 -0.00000000000000E+00 -0.00000000000000E+00 -1.06704405580042E-08
 -0.00000000000000E+00 -0.00000000000000E+00  1.06704405580042E-08
 -0.00000000000000E+00 -0.00000000000000E+00  1.06704405580042E-08
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  1.30855752693742E-07
  0.00000000000000E+00 -0.00000000000000E+00  1.30855752693742E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -1.30855752693742E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -1.30855752693742E-07
 Total energy (etotal) [Ha]= -2.02708282225735E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-5.88471E-11
           Relative     =-2.90305E-12

 At Broyd/MD step   4, gradients are converged : 
  max grad (force/stress) = 1.0670E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)

================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   7.1212E-24; max=  1.6135E-23
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.375453868815
       0.666666666667      0.333333333333      0.875453868815
 rms dE/dt=  7.7905E-08; max dE/dt=  1.6379E-07; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000      0.000000163785
    2       0.000000000000      0.000000000000      0.000000163785
    3       0.000000000000      0.000000000000     -0.000000097926
    4       0.000000000000      0.000000000000     -0.000000097926

 cartesian coordinates (angstrom) at end:
    1     -1.14570226435669     1.98441453221250     0.00000000000000
    2      1.14570226435669     1.98441453221250     3.24475271484805
    3     -1.14570226435669     1.98441453221250     2.43650992027823
    4      1.14570226435669     1.98441453221250     5.68126263512628

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000001067044
    2     -0.00000000000000    -0.00000000000000    -0.00000001067044
    3     -0.00000000000000    -0.00000000000000     0.00000001067044
    4     -0.00000000000000    -0.00000000000000     0.00000001067044
 frms,max,avg= 6.1605817E-09 1.0670441E-08   0.000E+00  0.000E+00 -2.685E-09 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000054869607
    2     -0.00000000000000    -0.00000000000000    -0.00000054869607
    3     -0.00000000000000    -0.00000000000000     0.00000054869607
    4     -0.00000000000000    -0.00000000000000     0.00000054869607
 frms,max,avg= 3.1678982E-07 5.4869607E-07   0.000E+00  0.000E+00 -1.381E-07 e/A
 length scales=  7.500000000000  7.500000000000 12.263388000000 bohr
              =  3.968829064425  3.968829064425  6.489505429696 angstroms
 prteigrs : about to open file telast_1o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =   0.08960   Average Vxc (hartree)=  -0.34430
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.35441   -0.30451   -0.11638    0.05456    0.05456    0.06898    0.08960    0.08960
 prteigrs : prtvol=0 or 1, do not print more k-points.


--------------------------------------------------------------------------------
 Components of total free energy (in Hartree) :

    Kinetic energy  =  5.94395511294076E+00
    Hartree energy  =  1.63720578347758E+00
    XC energy       = -8.69825289410813E+00
    Ewald energy    = -1.69355044248117E+01
    PspCore energy  =  1.46916382550259E+00
    Loc. psp. energy= -4.87435631465794E+00
    NL   psp  energy=  1.18696068908329E+00
    &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Etotal= -2.02708282225735E+01

 Other information on the energy :
    Total energy(eV)= -5.51597287924569E+02 ; Band energy (Ha)=  -1.3962204583E+00
--------------------------------------------------------------------------------
 rms coord change=  1.8529E-04   atom, delta coord (reduced):
     1        0.000000000000      0.000000000000      0.000000000000
     2        0.000000000000      0.000000000000      0.000000000000
     3        0.000000000000      0.000000000000      0.000453868815
     4        0.000000000000      0.000000000000      0.000453868815

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.50364062E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.50364062E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.99359243E-05  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure=  8.8272E-01 GPa]
- sigma(1 1)= -1.03080649E+00  sigma(3 2)=  0.00000000E+00
- sigma(2 2)= -1.03080649E+00  sigma(3 1)=  0.00000000E+00
- sigma(3 3)= -5.86535045E-01  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   nproc =    1

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   1.

 find_getdtset : getxred/=0, take data from output of dataset with index  1.

 Exchange-correlation functional for the present dataset will be:
  LDA: new Teter (4/93) with spin-polarized option - ixc=1
 Citation for XC functional:
  S. Goedecker, M. Teter, J. Huetter, PRB 54, 1703 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.4951905  3.7500000  0.0000000  G(1)=  0.0769800  0.1333333  0.0000000
 R(2)= -6.4951905  3.7500000  0.0000000  G(2)= -0.0769800  0.1333333  0.0000000
 R(3)=  0.0000000  0.0000000 12.2633880  G(3)=  0.0000000  0.0000000  0.0815435
 Unit cell volume ucvol=  5.9739781E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.615   =&gt; boxcut(ratio)=   2.07717

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/13al.pspnc
- pspatm: opening atomic psp file    /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/13al.pspnc
-  Troullier-Martins psp for element  Al        Thu Oct 27 17:31:05 EDT 1994
- 13.00000   3.00000    940714                znucl, zion, pspdat
    1    1    2    2      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.657  11.889    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   1.829   2.761    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2   0.000   0.000    0   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.09673076353074    0.12648111154518    1.01742091001718   rchrg,fchrg,qchrg
 pspatm : epsatm=    0.22155260
         --- l  ekb(1:nproj) --&gt;
             0    2.540658
             1    1.353815
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/33as.pspnc
- pspatm: opening atomic psp file    /home/buildbot/bb/ABINIT_GIT/abiref_gnu_5.3_openmpi/torrent_pimd/tests/Psps_for_tests/33as.pspnc
-  Troullier-Martins psp for element  As        Thu Oct 27 17:37:14 EDT 1994
- 33.00000   5.00000    940714                znucl, zion, pspdat
    1    1    1    1      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.772  10.829    1   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   2.745   5.580    0   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.05731715564010    0.36322996461007    2.76014815959125   rchrg,fchrg,qchrg
 pspatm : epsatm=   27.20579911
         --- l  ekb(1:nproj) --&gt;
             0    0.838751
 pspatm: atomic psp has been read  and splines computed

--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_1o_DS1_WFK
_setup2: Arith. and geom. avg. npw (full set) are     485.938     485.925

================================================================================

=== [ionmov= 2] Broyden-Fletcher-Goldfard-Shanno method (forces)            
================================================================================

--- Iteration: ( 1/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270828222573    -2.027E+01 7.842E-29 5.496E-21 1.067E-08 1.067E-08

 At SCF step    1       vres2   =  5.50E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.50364064E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.50364064E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.99359246E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96558776
    2        2.00000          0.96558776
    3        2.00000          2.52116651
    4        2.00000          2.52116651

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60433646938489E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07360304693849E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75453868815444E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75453868815444E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.06696E-08 6.16008E-09 (free atoms)
 -3.63726676652709E-32  6.29993084030669E-32 -1.06695778114474E-08
 -3.63726676652709E-32  6.29993084030669E-32 -1.06695778114474E-08
 -3.63726676652709E-32  6.29993084030669E-32  1.06695778114474E-08
  1.09118002995813E-31 -1.88997925209201E-31  1.06695778114474E-08
 Reduced forces (fred)
 -4.73270420179521E-47 -4.72494813023002E-31  1.30845172497971E-07
 -4.73270420179521E-47 -4.72494813023002E-31  1.30845172497971E-07
 -4.73270420179521E-47 -4.72494813023002E-31 -1.30845172497971E-07
  2.21325220692603E-46  1.41748443906901E-30 -1.30845172497971E-07
 Scale of Primitive Cell (acell) [bohr]
  7.50000000000000E+00  7.50000000000000E+00  1.22633880000000E+01
 Real space primitive translations (rprimd) [bohr]
  6.49519052838329E+00  3.75000000000000E+00  0.00000000000000E+00
 -6.49519052838329E+00  3.75000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22633880000000E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.97397811876170E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.50000000000000E+00  7.50000000000000E+00  1.22633880000000E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -3.50364064360485E-05  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -3.50364064360454E-05  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -1.99359246389596E-05
 Total energy (etotal) [Ha]= -2.02708282225735E+01

--- Iteration: ( 2/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270868764512    -2.027E+01 3.515E-11 3.170E-03 1.929E-05 1.930E-05
 ETOT  2  -20.270873094745    -4.330E-06 2.541E-12 2.126E-04 7.200E-05 9.130E-05
 ETOT  3  -20.270873418196    -3.235E-07 1.878E-09 1.776E-05 3.079E-06 8.822E-05
 ETOT  4  -20.270873435402    -1.721E-08 6.541E-11 2.287E-07 3.536E-07 8.787E-05
 ETOT  5  -20.270873435505    -1.026E-10 4.446E-13 2.609E-09 2.638E-07 8.813E-05
 ETOT  6  -20.270873435507    -1.730E-12 2.748E-14 9.140E-11 1.899E-07 8.794E-05
 ETOT  7  -20.270873435507    -1.599E-13 1.583E-15 1.133E-12 3.818E-08 8.798E-05
 ETOT  8  -20.270873435507     1.386E-13 8.559E-18 1.512E-14 2.973E-09 8.798E-05
 ETOT  9  -20.270873435507    -1.279E-13 4.520E-20 2.480E-16 3.404E-10 8.798E-05
 ETOT 10  -20.270873435507     9.948E-14 2.065E-21 2.238E-18 1.610E-11 8.798E-05
 ETOT 11  -20.270873435507    -5.684E-14 6.486E-24 1.395E-20 2.310E-12 8.798E-05

 At SCF step   11       vres2   =  1.39E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -2.71305168E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -2.71305168E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.44719848E-05  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.96673371
    2        2.00000          0.96673371
    3        2.00000          2.52500710
    4        2.00000          2.52500710

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16733919081342E+00  3.75394159572406E+00  0.00000000000000E+00
  2.16733919081342E+00  3.75394159572406E+00  6.13536122968479E+00
 -2.16733919081342E+00  3.75394159572406E+00  4.60709023120683E+00
  2.16733919081342E+00  3.75394159572406E+00  1.07424514608916E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75453869685479E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75453869685479E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 8.79778E-05 5.07940E-05 (free atoms)
  4.04418524164311E-32 -7.00473431374609E-32 -8.79778259418717E-05
  4.04418524164311E-32 -7.00473431374609E-32 -8.79778259418717E-05
 -2.02209262082156E-31  7.00473431374609E-32  8.79778259418717E-05
  1.21325557249293E-31  7.00473431374609E-32  8.79778259418717E-05
 Reduced forces (fred)
  2.66094094920425E-47  5.25907270147341E-31  1.07955148471143E-03
  2.66094094920425E-47  5.25907270147341E-31  1.07955148471143E-03
  1.05181454029468E-30 -1.57772181044202E-30 -1.07955148471143E-03
 -1.05181454029468E-30  5.25907270147341E-31 -1.07955148471143E-03
 Scale of Primitive Cell (acell) [bohr]
  7.50788319144811E+00  7.50788319144811E+00  1.22707224593696E+01
 Real space primitive translations (rprimd) [bohr]
  6.50201757244025E+00  3.75394159572406E+00  0.00000000000000E+00
 -6.50201757244025E+00  3.75394159572406E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22707224593696E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.99012354048222E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.50788319144811E+00  7.50788319144811E+00  1.22707224593696E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -2.71305168343624E-05  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -2.71305168343576E-05  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -1.44719848006419E-05
 Total energy (etotal) [Ha]= -2.02708734355068E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-4.52129E-05
           Relative     =-2.23044E-06

--- Iteration: ( 3/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270887218939    -2.027E+01 1.819E-10 3.538E-02 4.531E-05 1.333E-04
 ETOT  2  -20.270935772849    -4.855E-05 3.368E-11 2.406E-03 2.358E-04 3.691E-04
 ETOT  3  -20.270939461813    -3.689E-06 2.154E-08 2.032E-04 1.078E-05 3.583E-04
 ETOT  4  -20.270939660413    -1.986E-07 7.642E-10 2.663E-06 9.279E-07 3.574E-04
 ETOT  5  -20.270939661607    -1.194E-09 4.866E-12 3.043E-08 7.314E-07 3.581E-04
 ETOT  6  -20.270939661626    -1.985E-11 2.886E-13 1.032E-09 6.027E-07 3.575E-04
 ETOT  7  -20.270939661627    -9.557E-13 1.790E-14 1.373E-11 1.254E-07 3.576E-04
 ETOT  8  -20.270939661627    -2.132E-14 1.152E-16 1.914E-13 1.072E-08 3.576E-04
 ETOT  9  -20.270939661627    -2.132E-14 5.933E-19 3.170E-15 1.227E-09 3.576E-04
 ETOT 10  -20.270939661627     4.619E-14 2.728E-20 2.766E-17 5.811E-11 3.576E-04
 ETOT 11  -20.270939661627    -1.066E-13 7.891E-23 1.738E-19 8.497E-12 3.576E-04

 At SCF step   11       vres2   =  1.74E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -9.38618347E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -9.38618347E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.86374528E-06  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92186119
    2        2.00000          0.92186119
    3        2.00000          2.53780784
    4        2.00000          2.53780784

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17503598426847E+00  3.76727283304356E+00  0.00000000000000E+00
  2.17503598426847E+00  3.76727283304356E+00  6.14699135220447E+00
 -2.17503598426847E+00  3.76727283304356E+00  4.61620654221671E+00
  2.17503598426847E+00  3.76727283304356E+00  1.07631978944212E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75485036314653E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75485036314653E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 3.57613E-04 2.06468E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -3.57613203131845E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -3.57613203131845E-04
 -0.00000000000000E+00 -0.00000000000000E+00  3.57613203131845E-04
 -0.00000000000000E+00 -0.00000000000000E+00  3.57613203131845E-04
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  4.39649053417119E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.39649053417119E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.39649053417119E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.39649053417119E-03
 Scale of Primitive Cell (acell) [bohr]
  7.53454566608713E+00  7.53454566608713E+00  1.22939827044089E+01
 Real space primitive translations (rprimd) [bohr]
  6.52510795280540E+00  3.76727283304356E+00  0.00000000000000E+00
 -6.52510795280540E+00  3.76727283304356E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22939827044089E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04417970653954E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53454566608713E+00  7.53454566608713E+00  1.22939827044089E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -9.38618346559093E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -9.38618346557792E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  2.86374528097894E-06
 Total energy (etotal) [Ha]= -2.02709396616275E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-6.62261E-05
           Relative     =-3.26705E-06

--- Iteration: ( 4/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270940089267    -2.027E+01 2.620E-12 5.066E-06 1.157E-05 3.460E-04
 ETOT  2  -20.270940095710    -6.443E-09 1.021E-15 9.522E-08 3.435E-07 3.464E-04
 ETOT  3  -20.270940095791    -8.120E-11 8.500E-13 4.277E-09 3.024E-07 3.467E-04
 ETOT  4  -20.270940095795    -3.165E-12 2.644E-14 4.908E-11 1.599E-07 3.465E-04
 ETOT  5  -20.270940095795    -4.619E-14 1.198E-15 1.237E-12 2.737E-08 3.466E-04
 ETOT  6  -20.270940095795    -1.421E-14 1.336E-17 3.081E-14 4.298E-09 3.466E-04
 ETOT  7  -20.270940095795    -9.237E-14 2.476E-19 1.506E-15 2.612E-11 3.466E-04
 ETOT  8  -20.270940095795     1.279E-13 1.667E-20 3.062E-17 8.598E-11 3.466E-04
 ETOT  9  -20.270940095795    -3.197E-14 7.788E-23 5.478E-19 5.514E-12 3.466E-04

 At SCF step    9       vres2   =  5.48E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -6.68382924E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -6.68382924E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.74297754E-06  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92188396
    2        2.00000          0.92188396
    3        2.00000          2.53788797
    4        2.00000          2.53788797

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17517016667651E+00  3.76750524379178E+00  0.00000000000000E+00
  2.17517016667651E+00  3.76750524379178E+00  6.14656526765700E+00
 -2.17517016667651E+00  3.76750524379178E+00  4.61625122596875E+00
  2.17517016667651E+00  3.76750524379178E+00  1.07628164936257E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75514700076423E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75514700076423E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 3.46551E-04 2.00081E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -3.46550788422610E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -3.46550788422610E-04
 -0.00000000000000E+00 -0.00000000000000E+00  3.46550788422610E-04
 -0.00000000000000E+00 -0.00000000000000E+00  3.46550788422610E-04
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  4.26019407919513E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.26019407919513E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.26019407919513E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.26019407919513E-03
 Scale of Primitive Cell (acell) [bohr]
  7.53501048758356E+00  7.53501048758357E+00  1.22931305353140E+01
 Real space primitive translations (rprimd) [bohr]
  6.52551050002954E+00  3.76750524379178E+00  0.00000000000000E+00
 -6.52551050002954E+00  3.76750524379178E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22931305353140E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04450647534680E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53501048758356E+00  7.53501048758357E+00  1.22931305353140E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -6.68382923676384E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -6.68382923673782E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  2.74297754304003E-06
 Total energy (etotal) [Ha]= -2.02709400957947E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-4.34167E-07
           Relative     =-2.14182E-08

--- Iteration: ( 5/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270942012988    -2.027E+01 6.890E-10 1.134E-03 1.908E-04 1.558E-04
 ETOT  2  -20.270943514951    -1.502E-06 8.325E-13 3.979E-05 2.961E-05 1.262E-04
 ETOT  3  -20.270943562297    -4.735E-08 4.373E-10 4.096E-06 6.778E-06 1.330E-04
 ETOT  4  -20.270943567581    -5.284E-09 2.749E-11 1.603E-07 1.708E-06 1.312E-04
 ETOT  5  -20.270943567700    -1.194E-10 5.377E-13 1.471E-09 4.854E-07 1.308E-04
 ETOT  6  -20.270943567701    -1.165E-12 1.525E-14 4.667E-11 1.255E-07 1.309E-04
 ETOT  7  -20.270943567701    -8.527E-14 8.212E-16 1.347E-12 2.046E-08 1.309E-04
 ETOT  8  -20.270943567701     1.457E-13 4.784E-18 1.654E-14 3.788E-09 1.309E-04
 ETOT  9  -20.270943567701    -1.776E-14 1.050E-19 6.311E-17 2.145E-10 1.309E-04
 ETOT 10  -20.270943567701    -1.101E-13 2.651E-22 4.620E-19 2.099E-11 1.309E-04

 At SCF step   10       vres2   =  4.62E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  9.30687276E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  9.30687276E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -6.14419830E-07  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92185925
    2        2.00000          0.92185925
    3        2.00000          2.53786771
    4        2.00000          2.53786771

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17648621614507E+00  3.76978470833660E+00  0.00000000000000E+00
  2.17648621614507E+00  3.76978470833660E+00  6.13891193242432E+00
 -2.17648621614507E+00  3.76978470833660E+00  4.61629098089205E+00
  2.17648621614507E+00  3.76978470833660E+00  1.07552029133163E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75986089367878E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75986089367876E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.30873E-04 7.55595E-05 (free atoms)
 -3.52379030296182E-32  1.65663275655742E-31 -1.30872965084211E-04
 -3.52379030296182E-32  1.65663275655742E-31 -1.30872965084211E-04
 -3.52379030296182E-32 -2.52854473369291E-31  1.30872965084211E-04
  1.05713709088854E-31 -7.84720779421936E-32  1.30872965084211E-04
 Reduced forces (fred)
 -3.94430452610506E-31 -8.54599313989429E-31  1.60683521397443E-03
 -3.94430452610506E-31 -8.54599313989429E-31  1.60683521397443E-03
  1.18329135783152E-30  7.23122496452594E-31 -1.60683521397443E-03
 -3.94430452610506E-31  9.86076131526265E-31 -1.60683521397443E-03
 Scale of Primitive Cell (acell) [bohr]
  7.53956941667320E+00  7.53956941667320E+00  1.22778238648486E+01
 Real space primitive translations (rprimd) [bohr]
  6.52945864843522E+00  3.76978470833660E+00  0.00000000000000E+00
 -6.52945864843522E+00  3.76978470833660E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22778238648486E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04428757058524E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53956941667321E+00  7.53956941667321E+00  1.22778238648486E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  9.30687276431193E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  9.30687276432928E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -6.14419829727316E-07
 Total energy (etotal) [Ha]= -2.02709435677014E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-3.47191E-06
           Relative     =-1.71275E-07

--- Iteration: ( 6/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943631890    -2.027E+01 5.788E-12 2.529E-05 2.219E-05 1.087E-04
 ETOT  2  -20.270943668437    -3.655E-08 5.826E-14 1.774E-06 1.952E-05 8.916E-05
 ETOT  3  -20.270943671333    -2.895E-09 1.953E-11 1.191E-07 1.497E-06 9.066E-05
 ETOT  4  -20.270943671438    -1.056E-10 4.052E-13 2.408E-09 1.987E-08 9.064E-05
 ETOT  5  -20.270943671440    -1.535E-12 2.269E-14 4.886E-11 1.186E-07 9.052E-05
 ETOT  6  -20.270943671440    -1.066E-14 7.577E-16 8.501E-13 3.294E-08 9.055E-05
 ETOT  7  -20.270943671440     2.487E-14 3.481E-18 7.346E-15 1.074E-09 9.055E-05
 ETOT  8  -20.270943671440    -1.421E-14 1.345E-20 5.844E-17 1.300E-10 9.055E-05
 ETOT  9  -20.270943671440     6.750E-14 2.566E-22 7.560E-19 1.917E-11 9.055E-05

 At SCF step    9       vres2   =  7.56E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  4.48429406E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  4.48429406E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -9.46578048E-07  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92178628
    2        2.00000          0.92178628
    3        2.00000          2.53762807
    4        2.00000          2.53762807

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17640916482172E+00  3.76965125152976E+00  0.00000000000000E+00
  2.17640916482172E+00  3.76965125152976E+00  6.13830615840756E+00
 -2.17640916482172E+00  3.76965125152976E+00  4.61638091635187E+00
  2.17640916482172E+00  3.76965125152976E+00  1.07546870747594E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76030520246117E-01
  6.66666666666667E-01  3.33333333333333E-01  8.76030520246117E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 9.05539E-05 5.22813E-05 (free atoms)
 -5.03416436509100E-33 -1.74388569079806E-32 -9.05538930571458E-05
 -5.03416436509100E-33 -1.74388569079806E-32 -9.05538930571458E-05
  2.36605725159277E-31 -1.74388569079806E-32  9.05538930571458E-05
 -2.26537396429095E-31  5.23165707239419E-32  9.05538930571458E-05
 Reduced forces (fred)
  9.86076131526265E-32  3.28692043842088E-32  1.11169503884091E-03
  9.86076131526265E-32  3.28692043842088E-32  1.11169503884091E-03
 -1.47911419728940E-30  1.61059101482623E-30 -1.11169503884091E-03
  1.28189897098414E-30 -1.67632942359465E-30 -1.11169503884091E-03
 Scale of Primitive Cell (acell) [bohr]
  7.53930250305953E+00  7.53930250305953E+00  1.22766123168151E+01
 Real space primitive translations (rprimd) [bohr]
  6.52922749446516E+00  3.76965125152976E+00  0.00000000000000E+00
 -6.52922749446516E+00  3.76965125152976E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22766123168151E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04326322751859E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53930250305953E+00  7.53930250305953E+00  1.22766123168151E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  4.48429405690374E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  4.48429405692542E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -9.46578047578486E-07
 Total energy (etotal) [Ha]= -2.02709436714399E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-1.03739E-07
           Relative     =-5.11760E-09

--- Iteration: ( 7/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943709221    -2.027E+01 1.586E-12 1.579E-05 2.060E-05 6.996E-05
 ETOT  2  -20.270943732317    -2.310E-08 2.972E-14 7.414E-07 2.681E-05 4.315E-05
 ETOT  3  -20.270943733587    -1.270E-09 1.175E-11 4.694E-08 1.925E-06 4.507E-05
 ETOT  4  -20.270943733637    -5.036E-11 2.609E-13 1.661E-09 1.119E-07 4.496E-05
 ETOT  5  -20.270943733638    -1.073E-12 1.748E-14 3.897E-11 8.833E-08 4.487E-05
 ETOT  6  -20.270943733638    -1.528E-13 4.545E-16 7.992E-13 2.663E-08 4.490E-05
 ETOT  7  -20.270943733638     5.684E-14 1.545E-18 1.130E-14 6.231E-10 4.490E-05
 ETOT  8  -20.270943733638    -1.776E-14 1.912E-20 1.185E-16 5.480E-11 4.490E-05
 ETOT  9  -20.270943733638     8.527E-14 4.318E-22 8.588E-19 2.772E-11 4.490E-05

 At SCF step    9       vres2   =  8.59E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.55099670E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.55099670E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -8.30604594E-07  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92174513
    2        2.00000          0.92174513
    3        2.00000          2.53749095
    4        2.00000          2.53749095

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17631710052513E+00  3.76949179149051E+00  0.00000000000000E+00
  2.17631710052513E+00  3.76949179149051E+00  6.13822611615077E+00
 -2.17631710052513E+00  3.76949179149051E+00  4.61674405522634E+00
  2.17631710052513E+00  3.76949179149051E+00  1.07549701713771E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76065003786587E-01
  6.66666666666667E-01  3.33333333333333E-01  8.76065003786587E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.49008E-05 2.59235E-05 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.49008075788688E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -4.49008075788688E-05
 -0.00000000000000E+00 -0.00000000000000E+00  4.49008075788688E-05
 -0.00000000000000E+00 -0.00000000000000E+00  4.49008075788688E-05
 Reduced forces (fred)
  0.00000000000000E+00 -0.00000000000000E+00  5.51222619433746E-04
  0.00000000000000E+00 -0.00000000000000E+00  5.51222619433746E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -5.51222619433746E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -5.51222619433746E-04
 Scale of Primitive Cell (acell) [bohr]
  7.53898358298102E+00  7.53898358298102E+00  1.22764522323015E+01
 Real space primitive translations (rprimd) [bohr]
  6.52895130157539E+00  3.76949179149051E+00  0.00000000000000E+00
 -6.52895130157539E+00  3.76949179149051E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22764522323015E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04267316985756E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53898358298102E+00  7.53898358298102E+00  1.22764522323015E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.55099670069020E-08  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.55099670082030E-08  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -8.30604593982792E-07
 Total energy (etotal) [Ha]= -2.02709437336381E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-6.21982E-08
           Relative     =-3.06834E-09

--- Iteration: ( 8/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943754189    -2.027E+01 1.674E-12 6.476E-06 1.342E-05 3.148E-05
 ETOT  2  -20.270943763175    -8.986E-09 1.531E-14 1.027E-07 2.138E-05 1.010E-05
 ETOT  3  -20.270943763326    -1.516E-10 3.453E-12 7.077E-09 1.650E-06 1.175E-05
 ETOT  4  -20.270943763334    -7.237E-12 1.495E-13 2.561E-10 3.253E-07 1.142E-05
 ETOT  5  -20.270943763334    -1.030E-13 1.183E-15 7.127E-12 1.975E-08 1.144E-05
 ETOT  6  -20.270943763334    -1.457E-13 6.550E-17 1.827E-13 5.261E-09 1.145E-05
 ETOT  7  -20.270943763334     6.395E-14 5.581E-19 3.004E-15 6.577E-11 1.145E-05
 ETOT  8  -20.270943763334     0.000E+00 5.295E-21 6.778E-17 6.852E-12 1.145E-05
 ETOT  9  -20.270943763334     0.000E+00 6.447E-23 4.051E-19 2.383E-12 1.145E-05

 At SCF step    9       vres2   =  4.05E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -1.23192434E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -1.23192434E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -4.23321184E-07  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92175350
    2        2.00000          0.92175350
    3        2.00000          2.53751685
    4        2.00000          2.53751685

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17628571196262E+00  3.76943742490546E+00  0.00000000000000E+00
  2.17628571196262E+00  3.76943742490546E+00  6.13850800290374E+00
 -2.17628571196262E+00  3.76943742490546E+00  4.61719101287686E+00
  2.17628571196262E+00  3.76943742490546E+00  1.07556990157806E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666666E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76084140534863E-01
  6.66666666666666E-01  3.33333333333333E-01  8.76084140534862E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.14492E-05 6.61018E-06 (free atoms)
 -2.01377997404987E-32 -3.48796923031911E-32 -1.14491691532875E-05
 -2.01377997404987E-32 -3.48796923031911E-32 -1.14491691532875E-05
 -2.01377997404987E-32 -3.48796923031911E-32  1.14491691532875E-05
  6.04133992214960E-32  1.04639076909573E-31  1.14491691532875E-05
 Reduced forces (fred)
  2.62953635073671E-31  4.02186709095388E-47  1.40561632948108E-04
  2.62953635073671E-31  4.02186709095388E-47  1.40561632948108E-04
  2.62953635073671E-31  4.02186709095388E-47 -1.40561632948108E-04
 -7.88860905221012E-31 -1.12603238368137E-46 -1.40561632948108E-04
 Scale of Primitive Cell (acell) [bohr]
  7.53887484981092E+00  7.53887484981092E+00  1.22770160058075E+01
 Real space primitive translations (rprimd) [bohr]
  6.52885713588785E+00  3.76943742490546E+00  0.00000000000000E+00
 -6.52885713588785E+00  3.76943742490546E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22770160058075E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04277635736829E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53887484981092E+00  7.53887484981092E+00  1.22770160058075E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -1.23192433704265E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -1.23192433700795E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -4.23321183595175E-07
 Total energy (etotal) [Ha]= -2.02709437633338E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-2.96956E-08
           Relative     =-1.46494E-09

--- Iteration: ( 9/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943767563    -2.027E+01 3.801E-13 3.214E-06 4.409E-06 7.040E-06
 ETOT  2  -20.270943771800    -4.237E-09 3.163E-15 1.387E-07 9.391E-06 2.351E-06
 ETOT  3  -20.270943771981    -1.805E-10 1.558E-12 1.498E-08 6.836E-07 1.667E-06
 ETOT  4  -20.270943771997    -1.658E-11 9.679E-14 4.608E-10 9.371E-08 1.761E-06
 ETOT  5  -20.270943771998    -3.837E-13 2.264E-15 8.752E-12 3.106E-08 1.792E-06
 ETOT  6  -20.270943771998     4.619E-14 1.662E-16 1.802E-13 1.238E-08 1.780E-06
 ETOT  7  -20.270943771998    -2.842E-14 7.105E-19 1.947E-15 1.221E-09 1.781E-06
 ETOT  8  -20.270943771998     3.553E-15 5.067E-21 1.704E-17 3.102E-12 1.781E-06
 ETOT  9  -20.270943771998     1.066E-13 1.300E-23 3.727E-19 3.157E-12 1.781E-06

 At SCF step    9       vres2   =  3.73E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -6.32277356E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -6.32277355E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -7.04533042E-08  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92178067
    2        2.00000          0.92178067
    3        2.00000          2.53760549
    4        2.00000          2.53760549

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17629797665857E+00  3.76945866798198E+00  0.00000000000000E+00
  2.17629797665856E+00  3.76945866798198E+00  6.13881752464947E+00
 -2.17629797665857E+00  3.76945866798198E+00  4.61747625960534E+00
  2.17629797665856E+00  3.76945866798198E+00  1.07562937842548E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666666E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76088411250585E-01
  6.66666666666666E-01  3.33333333333333E-01  8.76088411250584E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.78090E-06 1.02820E-06 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  1.78090197554036E-06
 -0.00000000000000E+00 -0.00000000000000E+00  1.78090197554036E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -1.78090197554036E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -1.78090197554036E-06
 Reduced forces (fred)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.18652645142600E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -2.18652645142600E-05
  0.00000000000000E+00 -0.00000000000000E+00  2.18652645142600E-05
  0.00000000000000E+00 -0.00000000000000E+00  2.18652645142600E-05
 Scale of Primitive Cell (acell) [bohr]
  7.53891733596396E+00  7.53891733596396E+00  1.22776350492989E+01
 Real space primitive translations (rprimd) [bohr]
  6.52889392997570E+00  3.76945866798198E+00  0.00000000000000E+00
 -6.52889392997570E+00  3.76945866798198E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22776350492989E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04314916512026E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53891733596396E+00  7.53891733596396E+00  1.22776350492989E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -6.32277355515701E-08  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -6.32277355498354E-08  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -7.04533041988829E-08
 Total energy (etotal) [Ha]= -2.02709437719976E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-8.66380E-09
           Relative     =-4.27400E-10

--- Iteration: (10/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943772257    -2.027E+01 6.789E-14 2.192E-07 8.522E-07 9.287E-07
 ETOT  2  -20.270943772539    -2.814E-10 2.038E-16 1.424E-08 1.129E-07 8.158E-07
 ETOT  3  -20.270943772557    -1.870E-11 1.115E-13 1.590E-09 3.620E-08 8.520E-07
 ETOT  4  -20.270943772559    -1.602E-12 7.096E-15 2.396E-11 2.935E-09 8.490E-07
 ETOT  5  -20.270943772559    -6.040E-14 4.757E-17 1.766E-13 3.231E-09 8.458E-07
 ETOT  6  -20.270943772559     1.101E-13 1.148E-18 4.642E-15 1.441E-09 8.472E-07
 ETOT  7  -20.270943772559    -6.395E-14 1.105E-19 6.535E-17 2.587E-10 8.470E-07
 ETOT  8  -20.270943772559     4.263E-14 1.075E-21 5.275E-19 3.890E-11 8.470E-07

 At SCF step    8       vres2   =  5.27E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -1.02202185E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -1.02202185E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -6.35694432E-10  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92179058
    2        2.00000          0.92179058
    3        2.00000          2.53763814
    4        2.00000          2.53763814

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17630949720348E+00  3.76947862215111E+00  0.00000000000000E+00
  2.17630949720348E+00  3.76947862215111E+00  6.13889317063948E+00
 -2.17630949720348E+00  3.76947862215111E+00  4.61750969458154E+00
  2.17630949720348E+00  3.76947862215111E+00  1.07564028652210E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666666E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76086500141893E-01
  6.66666666666666E-01  3.33333333333333E-01  8.76086500141891E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 8.47030E-07 4.89033E-07 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  8.47030054496454E-07
 -0.00000000000000E+00 -0.00000000000000E+00  8.47030054496454E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -8.47030054496454E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -8.47030054496454E-07
 Reduced forces (fred)
 -0.00000000000000E+00 -0.00000000000000E+00 -1.03996540337493E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -1.03996540337493E-05
  0.00000000000000E+00 -0.00000000000000E+00  1.03996540337493E-05
  0.00000000000000E+00 -0.00000000000000E+00  1.03996540337493E-05
 Scale of Primitive Cell (acell) [bohr]
  7.53895724430222E+00  7.53895724430222E+00  1.22777863412790E+01
 Real space primitive translations (rprimd) [bohr]
  6.52892849161045E+00  3.76947862215111E+00  0.00000000000000E+00
 -6.52892849161045E+00  3.76947862215111E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22777863412790E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04328761373886E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53895724430222E+00  7.53895724430222E+00  1.22777863412790E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -1.02202185056979E-08  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -1.02202185043969E-08  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -6.35694431556227E-10
 Total energy (etotal) [Ha]= -2.02709437725589E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-5.61386E-10
           Relative     =-2.76941E-11

--- Iteration: (11/12) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.270943772568    -2.027E+01 1.110E-15 3.394E-09 3.937E-07 4.534E-07
 ETOT  2  -20.270943772572    -4.462E-12 8.026E-18 1.426E-10 4.124E-07 4.096E-08
 ETOT  3  -20.270943772572    -1.137E-13 2.644E-15 1.696E-11 3.807E-08 7.903E-08
 ETOT  4  -20.270943772572    -1.705E-13 8.964E-17 4.787E-13 5.195E-09 7.383E-08
 ETOT  5  -20.270943772572     9.592E-14 3.638E-18 1.332E-14 1.205E-09 7.263E-08
 ETOT  6  -20.270943772572    -2.842E-14 1.285E-19 1.692E-16 4.326E-10 7.306E-08
 ETOT  7  -20.270943772572     1.066E-14 3.178E-22 1.543E-18 4.207E-12 7.306E-08
 ETOT  8  -20.270943772572     5.329E-14 2.949E-24 1.315E-20 7.558E-13 7.306E-08

 At SCF step    8       vres2   =  1.32E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.76811664E-10  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.76811662E-10  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  7.81471509E-10  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92179175
    2        2.00000          0.92179175
    3        2.00000          2.53764203
    4        2.00000          2.53764203

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.17631167225315E+00  3.76948238944763E+00  0.00000000000000E+00
  2.17631167225314E+00  3.76948238944763E+00  6.13889775548244E+00
 -2.17631167225315E+00  3.76948238944763E+00  4.61750548144676E+00
  2.17631167225314E+00  3.76948238944763E+00  1.07564032369292E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666666E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.76085876110498E-01
  6.66666666666666E-01  3.33333333333333E-01  8.76085876110496E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 7.30559E-08 4.21788E-08 (free atoms)
 -5.53782886945862E-32  9.59180096552405E-32  7.30558910747982E-08
 -5.53782886945862E-32  9.59180096552405E-32  7.30558910747982E-08
  2.51719494066301E-32 -4.35990952978366E-32 -7.30558910747982E-08
  8.55846279825423E-32 -1.48236924012644E-31 -7.30558910747982E-08
 Reduced forces (fred)
  6.34087311462257E-47 -7.23122496452594E-31 -8.96965291487697E-07
  6.34087311462257E-47 -7.23122496452594E-31 -8.96965291487697E-07
  6.95833924229849E-47  3.28692043842088E-31  8.96965291487697E-07
 -5.92385312887924E-47  1.11755294906310E-30  8.96965291487697E-07
 Scale of Primitive Cell (acell) [bohr]
  7.53896477889527E+00  7.53896477889527E+00  1.22777955109649E+01
 Real space primitive translations (rprimd) [bohr]
  6.52893501675944E+00  3.76948238944763E+00  0.00000000000000E+00
 -6.52893501675944E+00  3.76948238944763E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22777955109649E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  6.04330420677217E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.53896477889527E+00  7.53896477889527E+00  1.22777955109649E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -3.76811663902604E-10  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -3.76811661734200E-10  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  7.81471508597836E-10
 Total energy (etotal) [Ha]= -2.02709437725723E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-1.33120E-11
           Relative     =-6.56704E-13

 At Broyd/MD step  11, gradients are converged : 
  max grad (force/stress) = 7.8147E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)

================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   9.2704E-25; max=  2.9493E-24
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.376085876110
       0.666666666667      0.333333333333      0.876085876110
 rms dE/dt=  5.1806E-07; max dE/dt=  9.2165E-07; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000     -0.000000872279
    2       0.000000000000      0.000000000000     -0.000000872279
    3       0.000000000000      0.000000000000      0.000000921652
    4       0.000000000000      0.000000000000      0.000000921652

 cartesian coordinates (angstrom) at end:
    1     -1.15165453574475     1.99472416867706     0.00000000000000
    2      1.15165453574475     1.99472416867706     3.24856477806562
    3     -1.15165453574475     1.99472416867706     2.44347866132102
    4      1.15165453574475     1.99472416867706     5.69204343938663

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000     0.00000000000000     0.00000007305589
    2     -0.00000000000000     0.00000000000000     0.00000007305589
    3      0.00000000000000    -0.00000000000000    -0.00000007305589
    4      0.00000000000000    -0.00000000000000    -0.00000007305589
 frms,max,avg= 4.2178838E-08 7.3055891E-08   0.000E+00  0.000E+00 -2.011E-09 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000     0.00000000000000     0.00000375668465
    2     -0.00000000000000     0.00000000000000     0.00000375668465
    3      0.00000000000000    -0.00000000000000    -0.00000375668465
    4      0.00000000000000    -0.00000000000000    -0.00000375668465
 frms,max,avg= 2.1689229E-06 3.7566846E-06   0.000E+00  0.000E+00 -1.034E-07 e/A
 length scales=  7.538964778895  7.538964778895 12.277795510965 bohr
              =  3.989448337354  3.989448337354  6.497129556131 angstroms
 prteigrs : about to open file telast_1o_DS2_EIG
 Fermi (or HOMO) energy (hartree) =   0.08616   Average Vxc (hartree)=  -0.34268
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.35501   -0.30563   -0.11714    0.05113    0.05113    0.06669    0.08616    0.08616
 prteigrs : prtvol=0 or 1, do not print more k-points.


--------------------------------------------------------------------------------
 Components of total free energy (in Hartree) :

    Kinetic energy  =  5.91947827140732E+00
    Hartree energy  =  1.65285115607650E+00
    XC energy       = -8.68515356316806E+00
    Ewald energy    = -1.68697612368113E+01
    PspCore energy  =  1.45231023395999E+00
    Loc. psp. energy= -4.92404864086794E+00
    NL   psp  energy=  1.18338000683125E+00
    &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Etotal= -2.02709437725723E+01

 Other information on the energy :
    Total energy(eV)= -5.51600432199940E+02 ; Band energy (Ha)=  -1.4274245107E+00
--------------------------------------------------------------------------------
 rms coord change=  2.5802E-04   atom, delta coord (reduced):
     1       -0.000000000000      0.000000000000      0.000000000000
     2       -0.000000000000     -0.000000000000      0.000000000000
     3       -0.000000000000      0.000000000000      0.000632007295
     4       -0.000000000000     -0.000000000000      0.000632007295

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.76811664E-10  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.76811662E-10  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  7.81471509E-10  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -2.7311E-07 GPa]
- sigma(1 1)= -1.10861800E-05  sigma(3 2)=  0.00000000E+00
- sigma(2 2)= -1.10861800E-05  sigma(3 1)=  0.00000000E+00
- sigma(3 3)=  2.29916817E-05  sigma(2 1)=  0.00000000E+00

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell1     7.5000000000E+00  7.5000000000E+00  1.2263388000E+01 Bohr
            acell2     7.5389647789E+00  7.5389647789E+00  1.2277795511E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
           diemac      9.00000000E+00
          dilatmx1     1.00000000E+00
          dilatmx2     1.05000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
           etotal1    -2.0270828223E+01
           etotal2    -2.0270943773E+01
            fcart1    -0.0000000000E+00 -0.0000000000E+00 -1.0670440558E-08
                      -0.0000000000E+00 -0.0000000000E+00 -1.0670440558E-08
                      -0.0000000000E+00 -0.0000000000E+00  1.0670440558E-08
                      -0.0000000000E+00 -0.0000000000E+00  1.0670440558E-08
            fcart2    -5.5378288695E-32  9.5918009655E-32  7.3055891075E-08
                      -5.5378288695E-32  9.5918009655E-32  7.3055891075E-08
                       2.5171949407E-32 -4.3599095298E-32 -7.3055891075E-08
                       8.5584627983E-32 -1.4823692401E-31 -7.3055891075E-08
-          fftalg         312
           getwfk1          0
           getwfk2         -1
          getxred1          0
          getxred2         -1
           iatfix        1    2
           ionmov           2
           jdtset        1    2
              kpt      0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
P           mkmem           8
           natfix           2
            natom           4
            nband           8
           ndtset           2
            ngfft          18      18      30
             nkpt           8
            nstep          40
             nsym          12
            ntime1          5
            ntime2         12
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
          optcell1          0
          optcell2          2
        optforces           1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           strten1    -3.5036406206E-05 -3.5036406206E-05 -1.9935924340E-05
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2    -3.7681166390E-10 -3.7681166173E-10  7.8147150860E-10
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000 -0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000    -0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolmxf      1.00000000E-06
           tolvrs      1.00000000E-18
            typat      1  1  2  2
              wtk        0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
           xangst1    -1.1457022644E+00  1.9844145322E+00  0.0000000000E+00
                       1.1457022644E+00  1.9844145322E+00  3.2447527148E+00
                      -1.1457022644E+00  1.9844145322E+00  2.4365099203E+00
                       1.1457022644E+00  1.9844145322E+00  5.6812626351E+00
           xangst2    -1.1516545357E+00  1.9947241687E+00  0.0000000000E+00
                       1.1516545357E+00  1.9947241687E+00  3.2485647781E+00
                      -1.1516545357E+00  1.9947241687E+00  2.4434786613E+00
                       1.1516545357E+00  1.9947241687E+00  5.6920434394E+00
            xcart1    -2.1650635095E+00  3.7500000000E+00  0.0000000000E+00
                       2.1650635095E+00  3.7500000000E+00  6.1316940000E+00
                      -2.1650635095E+00  3.7500000000E+00  4.6043364694E+00
                       2.1650635095E+00  3.7500000000E+00  1.0736030469E+01
            xcart2    -2.1763116723E+00  3.7694823894E+00  0.0000000000E+00
                       2.1763116723E+00  3.7694823894E+00  6.1388977555E+00
                      -2.1763116723E+00  3.7694823894E+00  4.6175054814E+00
                       2.1763116723E+00  3.7694823894E+00  1.0756403237E+01
             xred1     3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7545386882E-01
                       6.6666666667E-01  3.3333333333E-01  8.7545386882E-01
             xred2     3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7608587611E-01
                       6.6666666667E-01  3.3333333333E-01  8.7608587611E-01
            znucl       13.00000   33.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://www.abinit.org/about/?text=acknowledgments.
-
- [1] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xue, A.Zhou, J.W.Zwanziger.
- Comment : the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/about/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
-
- [2] ABINIT : First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment : the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/about/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
-
- [3] A brief introduction to the ABINIT software package.
- Z. Kristallogr. 220, 558-562 (2005).
- X. Gonze, G.-M. Rignanese, M. Verstraete, J.-M. Beuken, Y. Pouillon, R. Caracas, F. Jollet,
- M. Torrent, G. Zerah, M. Mikami, Ph. Ghosez, M. Veithen, J.-Y. Raty, V. Olevano, F. Bruneval,
- L. Reining, R. Godby, G. Onida, D.R. Hamann, and D.C. Allan.
- Comment : the second generic paper describing the ABINIT project. Note that this paper
- should be cited especially if you are using the GW part of ABINIT, as several authors
- of this part are not in the list of authors of the first or third paper.
- The .pdf of the latter paper is available at https://www.abinit.org/about/zfk_0505-06_558-562.pdf.
- Note that it should not redistributed (Copyright by Oldenburg Wissenshaftverlag,
- the licence allows the authors to put it on the Web).
-
- And optionally:
-
- [4] First-principles computation of material properties : the ABINIT software project. 
- X. Gonze, J.-M. Beuken, R. Caracas, F. Detraux, M. Fuchs, G.-M. Rignanese, L. Sindic,
- M. Verstraete, G. Zerah, F. Jollet, M. Torrent, A. Roy, M. Mikami, Ph. Ghosez, J.-Y. Raty, D.C. Allan.
- Computational Materials Science 25, 478-492 (2002). http://dx.doi.org/10.1016/S0927-0256(02)00325-7
- Comment : the original paper describing the ABINIT project.
-
- Proc.   0 individual time (sec): cpu=         26.9  wall=         27.5

================================================================================

 Calculation completed.
.Delivered   7 WARNINGs and   0 COMMENTs to log file.
+Overall time at end (sec) : cpu=         26.9  wall=         27.5

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-86459ff9-3b33-4767-aad6-f054dc396392", "#uuid-c79febbe-2511-4cda-ad49-2156360ecc25") }); </script>

<p>The first thing to look for is to see whether Abinit recognized the symmetry of the
system. In setting up a new data file, it&rsquo;s easy to make mistakes, so this is a valuable check. 
We see</p>
<div class="codehilite"><pre><span></span>DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
</pre></div>


<p>which is correct. Next, we confirm that the structural optimization converged.
The following lines from dataset 1 and dataset2 tell us that things are OK:</p>
<div class="codehilite"><pre><span></span>At Broyd/MD step   4, gradients are converged :
 max grad (force/stress) = 1.0670E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)

At Broyd/MD step  11, gradients are converged :
 max grad (force/stress) = 7.8147E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)
</pre></div>


<p>We can also confirm that the stresses are relaxed:</p>
<div class="codehilite"><pre><span></span>Cartesian components of stress tensor (hartree/bohr^3)
 sigma(1 1)= -3.76811543E-10  sigma(3 2)=  0.00000000E+00
 sigma(2 2)= -3.76811542E-10  sigma(3 1)=  0.00000000E+00
 sigma(3 3)=  7.81471561E-10  sigma(2 1)=  0.00000000E+00
</pre></div>


<p>Now would be a good time to copy telast_2.in and telast_2.files into your
working directory, since we will use the present output to start the next run.
Locate the optimized lattice parameters and reduced atomic coordinates near
the end of telast_1.out:</p>
<div class="codehilite"><pre><span></span>     acell2   7.5389647789E+00  7.5389647789E+00  1.2277795511E+01 Bohr

      xred2   3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
              6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
              3.3333333333E-01  6.6666666667E-01  3.7608587611E-01
              6.6666666667E-01  3.3333333333E-01  8.7608587611E-01
</pre></div>


<p>With your editor, copy and paste these into telast_2.in at the indicated
places in the &ldquo;Common input data&rdquo; area. Be sure to change acell2 and xred2 to
acell and xred since these common values will apply to all datasets in the next set of calculations.  </p>
<h2 id="2-response-function-calculations-of-several-second-derivatives-of-the-total-energy">2 Response-function calculations of several second derivatives of the total energy<a class="headerlink" href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" title="Permanent link">&para;</a></h2>
<p>We will now compute second derivatives of the total energy (2DTE&rsquo;s) with
respect to all the perturbations we need to compute elastic and piezoelectric
properties. You may want to review the first paragraphs of the <a class="wikilink user-guide-wikilink" href="../../guide/respfn">respfn help file</a>
which you studied in lesson RF1. 
We will introduce only one new input variable for the strain perturbation,</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfstrs">rfstrs</a>   </li>
</ul>
<p>The treatment of strain as a perturbation has some subtle aspects. It would be
a good idea to read  Metric tensor formulation of strain in density-functional
perturbation theory, by D. R. Hamann, Xifan Wu, Karin M. Rabe, and David Vanderbilt <a class="wikilink citation-wikilink" data-content="Metric tensor formulation of strain in density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#hamann2005">[Hamann2005]</a>
especially Sec. II and Sec. IV. We will do all the RF calculations you learned in lesson RF1 together
with strain, so you should review the variables</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>   </li>
</ul>
<p>It would be a good idea to copy telast_2.files into Work_elast and start the
calculation while you read (less than 2 minutes on a standard 3GHz machine).
Look at telast_2.in in your editor to follow the discussion, and double check
that you have copied acell and xred as discussed in the last section.</p>
<div class="text-center"><button type="button" id="uuid-f140499a-4ff2-4b30-ae65-9b8c61eff4b8" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_2.in
</button></div>

<div id="uuid-55e7934d-42e7-4ab9-9190-bd9af9c3cfc8" class="my_dialog" title="tests/tutorespfn/Input/telast_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Response function calculation for:</span>
<span class="c1">#    * rigid-atom elastic tensor</span>
<span class="c1">#    * rigid-atom piezoelectric tensor</span>
<span class="c1">#    * interatomic force constants at gamma</span>
<span class="c1">#    * Born effective charges</span>

   ndtset   <span class="m">3</span>

<span class="c1"># Set 1 : Initial self-consistent run</span>

  kptopt1   <span class="m">1</span>
  tolvrs1   <span class="m">1</span>.0d-18  <span class="c1">#need excellent convergence of GS quantities for RF runs</span>


<span class="c1"># Set 2 : Calculate the ddk wf&#39;s - needed for piezoelectric tensor and </span>
<span class="c1">#         Born effective charges in dataset 3</span>

  getwfk2  -1
    iscf2  -3        <span class="c1">#this option is needed for ddk</span>
  kptopt2   <span class="m">2</span>        <span class="c1">#use time-reversal symmetry only for k points</span>
    nqpt2   <span class="m">1</span>        <span class="c1">#one wave vector will be specified</span>
     qpt2   <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>    <span class="c1">#need to specify gamma point</span>
  rfelfd2   <span class="m">2</span>        <span class="c1">#set for ddk wf&#39;s only</span>
   rfdir2   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>    <span class="c1">#full set of directions needed</span>
  tolwfr2   <span class="m">1</span>.0d-20  <span class="c1">#only wf convergence can be monitored here</span>

<span class="c1"># Set 3 : response-function calculations for all needed perturbations</span>

  getddk3  -1
  getwfk3  -2
  kptopt3   <span class="m">2</span>        <span class="c1">#use time-reversal symmetry only for k points</span>
    nqpt3   <span class="m">1</span>
     qpt3   <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
  rfphon3   <span class="m">1</span>        <span class="c1">#do atomic displacement perturbation</span>
 rfatpol3   <span class="m">1</span> <span class="m">4</span>      <span class="c1">#do for all atoms</span>
  rfstrs3   <span class="m">3</span>        <span class="c1">#do strain perturbation</span>
   rfdir3   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>    <span class="c1">#the full set of directions is needed</span>
  tolvrs3   <span class="m">1</span>.0d-10  <span class="c1">#need reasonable convergence of 1st-order quantities</span>

<span class="c1">#Common input data</span>


<span class="c1"># acell  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a default value, for automatic testing : suppress it and fill the previous line</span>
  acell  <span class="m">7</span>.5389648144E+00  <span class="m">7</span>.5389648144E+00  <span class="m">1</span>.2277795374E+01 



  rprim   sqrt<span class="o">(</span><span class="m">0</span>.75<span class="o">)</span>  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#hexagonal primitive vectors must be</span>
         -sqrt<span class="o">(</span><span class="m">0</span>.75<span class="o">)</span>  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#specified with high accuracy to be</span>
          <span class="m">0</span>.0         <span class="m">0</span>.0  <span class="m">1</span>.0   <span class="c1">#sure that the symmetry is recognized</span>
                                 <span class="c1">#and preserved in the optimization</span>
                                 <span class="c1">#process</span>

<span class="c1">#Definition of the atom types and atoms</span>
 ntypat   <span class="m">2</span> 
  znucl   <span class="m">13</span> <span class="m">33</span>
  natom   <span class="m">4</span>
  typat   <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> <span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>

<span class="c1"># xred  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a set of default values, for automatic testing : suppress it and fill the previous line</span>
  xred  <span class="m">1</span>/3    <span class="m">2</span>/3    <span class="m">0</span>
        <span class="m">2</span>/3    <span class="m">1</span>/3    <span class="m">1</span>/2
        <span class="m">1</span>/3    <span class="m">2</span>/3    <span class="m">3</span>.7608588373E-01
        <span class="m">2</span>/3    <span class="m">1</span>/3    <span class="m">8</span>.7608588373E-01


<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
  nband   <span class="m">8</span>              <span class="c1"># For an insulator (if described correctly as an </span>
                         <span class="c1"># insulator by DFT), conduction bands should not</span>
                         <span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
   ecut   <span class="m">6</span>.0            <span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
 ecutsm   <span class="m">0</span>.5            <span class="c1"># Smoothing energy needed for lattice paramete</span>
                         <span class="c1"># optimization.  This will be retained for</span>
                         <span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
 kptopt   <span class="m">1</span>              <span class="c1"># Use symmetry and treat only inequivalent points</span>
  ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk   <span class="m">1</span>              <span class="c1"># Use one copy of grid only (default)</span>
 shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This choice of origin for the k point grid</span>
                         <span class="c1"># preserves the hexagonal symmetry of the grid,</span>
                         <span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
 diemac   <span class="m">9</span>.0            <span class="c1"># Model dielectric preconditioner</span>
  nstep   <span class="m">40</span>             <span class="c1"># Maxiumum number of SCF iterations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
 optforces <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = telast_2.in, telast_3.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_2.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Response function calculation for:</span>
<span class="c1">#%%       * rigid-atom elastic tensor</span>
<span class="c1">#%%       * rigid-atom piezoelectric tensor</span>
<span class="c1">#%%       * interatomic force constants at gamma</span>
<span class="c1">#%%       * Born effective charges</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-55e7934d-42e7-4ab9-9190-bd9af9c3cfc8", "#uuid-f140499a-4ff2-4b30-ae65-9b8c61eff4b8") }); </script>

<p>This has been set up as a self-contained calculation with three datasets. The
first is simply a GS run to obtain the GS wave functions we will need for the
DFPT calculations. We have removed the convergence test from the common input
data to remind ourselves that different tests are needed for different
datasets. We set a tight limit on the convergence of the self-consistent
potential with <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a>. Since we have specified <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=8, all the bands
are occupied and the potential test also assures us that all the wave
functions are well converged. This issue will come up again in the section on
metals. We could have used the output wave functions telast_1o_DS2_WFK as
input for our RF calculations and skipped dataset 1, but redoing the GS
calculation takes relatively little time for this simple system .</p>
<p>Dataset 2 involves the calculation of the derivatives of the wave functions
with respect to the Brillouin-zone wave vector, the so-called ddk wave
functions. Recall that these are auxiliary quantities needed to compute the
response to the <a class="wikilink lesson-wikilink" href="../rf1#5">electric field perturbation</a> and
introduced in lesson RF1. It would be a good idea to review the relevant
parts of <a class="wikilink user-guide-wikilink" href="../../guide/respfn#1">section 1</a> of the respfn_help file. </p>
<p>Examining this section of telast_2.in, note that electric
field as well as strain are uniform perturbations, only are defined for
<a class="wikilink codevar-wikilink" href="../../variables/gstate#qpt">qpt</a>= 0 0 0. <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>= 2 specifies that we want the ddk calculation to be
performed, which requires <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>= -3. The ddk wave functions will be used to
calculate both the piezoelectric tensor and the Born effective charges, and in
general we need them for <strong>k</strong> derivatives in all three (reduced) directions,
<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>= 1 1 1. Since there is no potential self-consistency in the ddk
calculations, we must specify convergence in terms of the wave function
residuals using <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>.  </p>
<p>Finally, dataset 3 performs the actual calculations of the needed 2DTE&rsquo;s for
the elastic and piezoelectric tensors. Setting <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a>=1 turns on the
atomic displacement perturbation, which we need for all atoms (<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a>= 1
4) and all directions (<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>= 1 1 1). Abinit will calculate first-order
wave functions for each atom and direction in turn, and use those to calculate
2DTE&rsquo;s with respect to all pairs of atomic displacements and with respect to
one atomic displacement and one component of electric field. These quantities,
the interatomic force constants (at gamma) and the Born effective charges will
be used later to compute the atomic relaxation contribution to the elastic and
piezoelectric tensor.</p>
<p>First-order wave functions for the strain perturbation are computed next.
Setting <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfstrs">rfstrs</a> = 3 specifies that we want both uniaxial and shear strains
to be treated, and <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>= 1 1 1 cycles through strains xx, yy, and zz for
uniaxial and yz, xz, and xy for shear. We note that while other perturbations
in Abinit are treated in reduced coordinates, strain is better dealt with in
Cartesian coordinates for reasons discussed in the reference cited above.
These wave functions are used to compute three types of 2DTE&rsquo;s. Derivatives
with respect to two strain components give us the so-called rigid-ion elastic
tensor. Derivatives with respect to one strain and one electric field
component give us the rigid-ion piezoelectric tensor. Finally, derivatives
with respect to one strain and one atomic displacement yield the internal-
strain force-response tensor, an intermediate quantity that will be necessary
to compute the atomic relaxation corrections to the rigid-ion quantities. As
in lesson RF1, we specify convergence in terms of the residual of the
potential (here the first-order potential) using tolvrs .</p>
<p>Your run should have completed by now. Abinit should have created quite a few files.</p>
<ul>
<li>telast_2.log (log file)</li>
<li>telast_2.out (main output file)</li>
<li>telast_2o_DS1_DDB (first derivatives of the energy from GS calculation)</li>
<li>telast_2o_DS3_DDB (second derivatives from the RF calculation)</li>
<li>telast_2o_DS1_WFK (GS wave functions)</li>
<li>telast_2o_DS2_1WF* (ddk wave functions)</li>
<li>telast_2o_DS3_1WF* (RF first-order wave functions from various perturbations)</li>
</ul>
<p>The log and out files are diagnostics and readable output information for a
wide variety of properties. The derivative database DDB files are ascii and
readable, but primarily for subsequent analysis by anaddb which we will
undertake in the next section. Finally, the various wave function binary files
are primarily of use for subsequent calculations, where they could cut the
number of needed iterations in, for example, convergence testing. We take note
of a few conventions in the file names. The root output file name telast_2o is
from the 4<sup>th</sup> line of the &ldquo;files&rdquo; file. The dataset producing the file is next.
Finally, the first-order wave function 1WF files have a final &ldquo;pertcase&rdquo;
number described in <a class="wikilink user-guide-wikilink" href="../../guide/respfn#1">section 1</a> of the respfn_help file.
While telast_2.in specifies all atomic displacements, only the symmetry-
inequivalent perturbations are treated, so the &ldquo;pertcase&rdquo; list is incomplete.
All cases specified in the input data are treated for the strain perturbation.  </p>
<p>First, take a look at the end of the telast_2.log file to make sure the run
has completed without error. You might wish to take a look at the WARNING&rsquo;s,
but they all appear to be harmless. Next, edit your telast_2.out file.
Searching backwards for ETOT you will find</p>
<div class="codehilite"><pre><span></span>     iter   2DEtotal(Ha)       deltaE(Ha) residm    vres2
-ETOT  1   2.3955208361366     -6.519E+00 6.313E-01 4.126E+02
 ETOT  2   1.3040286462220     -1.091E+00 4.926E-04 4.735E+00
 ETOT  3   1.2898966738702     -1.413E-02 1.857E-05 3.504E-01
 ETOT  4   1.2891923712805     -7.043E-04 2.937E-07 8.931E-03
 ETOT  5   1.2891781500347     -1.422E-05 7.582E-09 5.989E-05
 ETOT  6   1.2891780804502     -6.958E-08 4.440E-11 7.674E-07
 ETOT  7   1.2891780792714     -1.179E-09 1.236E-12 2.972E-08
 ETOT  8   1.2891780791847     -8.667E-11 2.674E-14 7.671E-10
 ETOT  9   1.2891780791827     -2.006E-12 9.086E-16 4.128E-12

 At SCF step    9       vres2   =  4.13E-12 &lt; tolvrs=  1.00E-10 =&gt;converged.
</pre></div>


<p>Abinit is solving a set of Schroedinger-like equations for the first-order
wave functions, and these functions minimize a variational expression for the
2DTE (Technically, they are called self-consistent Sternheimer equations)
The  energy  convergence looks similar to that of GS calculations.  The fact
that vres2, the residual of the self-consistent first-order potential, has
reached <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> well within <a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a> (40) iterations indicates that the
2DTE calculation for this perturbation (xy strain) has converged. It would
pay to examine a few more cases for different perturbations (unless you have
looked through all the warnings in the log).</p>
<p>Another convergence item to examine in your .out file is</p>
<div class="codehilite"><pre><span></span> Seventeen components of 2nd-order total energy (hartree) are
 1,2,3: 0th-order hamiltonian combined with 1st-order wavefunctions
     kin0=   9.10477366E+00 eigvalue=   3.11026184E-01  local=  -3.66858410E+00
 4,5,6,7: 1st-order hamiltonian combined with 1st and 0th-order wfs
 loc psp =  -8.91644855E+00  Hartree=   4.33575581E+00     xc=  -6.58530138E-01
     kin1=  -8.62111363E+00
 8,9,10: eventually, occupation + non-local contributions
    edocc=   0.00000000E+00     enl0=   6.43290228E-01   enl1=  -1.55388963E-01
 1-10 gives the relaxation energy (to be shifted if some occ is /=2.0)
   erelax=  -7.62521951E+00
 11,12,13 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.hart=  -1.18530360E-01   fr.kin=   5.20015318E+00 fr.loc=   4.18792202E-01
 14,15,16 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.nonl=   2.94970622E-01    fr.xc=   9.41457939E-02  Ewald=   3.02486615E+00
 17 Non-relaxation  contributions : pseudopotential core energy
  pspcore=   0.00000000E+00
 Resulting in :
 2DEtotal=    0.1289178079E+01 Ha. Also 2DEtotal=    0.350803195765E+02 eV
    (2DErelax=   -7.6252195073E+00 Ha. 2DEnonrelax=    8.9143975865E+00 Ha)
    (  non-var. 2DEtotal :    1.2891781360E+00 Ha)
</pre></div>


<p>This detailed breakdown of the contributions to 2DTE is probably of limited
interest, but you should compare &ldquo;2DEtotal&rdquo; and &ldquo;non-var. 2DEtotal&rdquo; from the
last three lines. While the first-order wave function for the present
perturbation minimizes a variational expression for the second derivative
with respect to this perturbation as we just saw, the various 2DTE given as
elastic tensors, etc. in the output and in the DDB file are all computed using
non-variational expressions. Using the non-variational expressions, mixed
second derivatives with respect to the present perturbation and all other
perturbations of interest can be computed directly from the present first-
order wave functions. The disadvantage is that the non-variational result
has errors which are linearly proportional to convergence errors in the GS and
first-order wave functions. Since errors in the variational 2DEtotal are
second-order in wave-function convergence errors, comparing this to the non-variational 
result for the diagonal second derivative will give an idea of the
accuracy of the latter and perhaps indicate the need for tighter convergence
tolerances for both the GS and RF wave functions.<br />
This is discussed in  X. Gonze and C. Lee, Phys. Rev. B 55, 10355 (1997) , Sec. II.<br />
For an atomic-displacement perturbation, the corresponding breakdown of the 2DTE is headed
&ldquo;Thirteen components.&rdquo;</p>
<p>Now let us take a look at the results we want, the various 2DTE&rsquo;s. They begin</p>
<div class="codehilite"><pre><span></span> ==&gt; Compute Derivative Database &lt;==

  2nd-order matrix (non-cartesian coordinates, masses not included,
   asr not included )
  cartesian coordinates for strain terms (1/ucvol factor
   for elastic tensor components not included)
     j1       j2             matrix element
  dir pert dir pert     real part     imaginary part

   1    1   1    1         5.4508668454         0.0000000000
   1    1   2    1        -2.7254334227         0.0000000000
   1    1   3    1         0.0000000000         0.0000000000
            .....
</pre></div>


<p>These are the &ldquo;raw&rdquo; 2DTE&rsquo;s, in reduced coordinates for atom-displacement and
electric-field perturbations, but Cartesian coordinates for strain
perturbations. This same results with the same organization appear in the file
telast_2_DS3_DDB which will be used later as input for automated analysis and
converted to more useful notation and units by anaddb. A breakout of various
types of 2DTE&rsquo;s follows (all converted to Cartesian coordinates and in atomic units):  </p>
<div class="codehilite"><pre><span></span>  Dynamical matrix, in cartesian coordinates,
    if specified in the inputs, asr has been imposed
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   1    1   1    1         0.0959051967         0.0000000000
   1    1   2    1         0.0000000000         0.0000000000
   1    1   3    1         0.0000000000         0.0000000000
            .....
</pre></div>


<p>This contains the interatomic force constant data that will be used later to
include atomic relaxation effects. &ldquo;asr&rdquo; refers to the acoustic sum rule,
which basically is a way of making sure that forces sum to zero when an atom is displaced.</p>
<div class="codehilite"><pre><span></span>  Effective charges, in cartesian coordinates,
    (from phonon response)
    if specified in the inputs, asr has been imposed
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   1    6   1    1         1.8290469443         0.0000000000
   2    6   1    1         0.0000000000         0.0000000000
   3    6   1    1         0.0000000000         0.0000000000
            .....
</pre></div>


<p>The Born effective charges will be used to find the atomic relaxation
contributions of the piezoelectric tensor.</p>
<div class="codehilite"><pre><span></span>  Rigid-atom elastic tensor , in cartesian coordinates,
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   1    7   1    7         0.0056418385         0.0000000000
   1    7   2    7         0.0013753710         0.0000000000
   1    7   3    7         0.0007168444         0.0000000000
            .....
</pre></div>


<p>The rigid-atom elastic tensor is the 2DTE with respect to a pair of strains.
We recall that &ldquo;pert&rdquo; = natom+3 and natom+4 for unaxial and shear strains, respectively.</p>
<div class="codehilite"><pre><span></span>  Internal strain coupling parameters, in cartesian coordinates,
    zero average net force deriv. has been imposed
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   1    1   1    7         0.1249319229         0.0000000000
   1    1   2    7        -0.1249319273         0.0000000000
   1    1   3    7         0.0000000000         0.0000000000
            .....
</pre></div>


<p>These 2DTE&rsquo;s with respect to one strain and one atomic displacement are needed
for atomic relaxation corrections to both the elastic tensor and piezoelectric
tensor. While this set of parameters is of limited direct interest, it should
be examined in cases when you think that high symmetry may eliminate the need
for these corrections. You are probably wrong, and any non-zero term indicates a correction.</p>
<div class="codehilite"><pre><span></span>  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   1    1   1    7         0.1249319273         0.0000000000

   1    1   2    7        -0.1249319211         0.0000000000

   1    1   3    7         0.0000000000         0.0000000000
</pre></div>


<p>Finally, we have the piezoelectric tensor, the 2DTE with respect to one strain
and one uniform electric field component. (Yes, there are non-zero elements.)  </p>
<h2 id="3-anaddb-calculation-of-atom-relaxation-effects">3 ANADDB calculation of atom-relaxation effects<a class="headerlink" href="#3-anaddb-calculation-of-atom-relaxation-effects" title="Permanent link">&para;</a></h2>
<p>In this section, we will run the program anaddb, which analyzes DDB files
generated in prior RF calculations. You should copy telast_3.in and
telast_3.files in your Work_elast directory. You should now go to the <a class="wikilink user-guide-wikilink" href="../../guide/anaddb">anaddb help file</a>
introduction. The bulk of the material in this help file is contained in the
description of the variables. You should read the descriptions of  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#elaflag">elaflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#piezoflag">piezoflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#instrflag">instrflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#chneut">chneut</a>.</li>
</ul>
<p>For the theory underlying the incorporation of atom-relaxation corrections, it
is recommended you see  X. Wu, D. Vanderbilt, and D. R. Hamann <a class="wikilink citation-wikilink" data-content="Systematic treatment of displacements, strains, and electric fields in density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#wu2005">[Wu2005]</a>.</p>
<p>Anaddb can do lots of other things, such as calculate the frequency-dependent
dielectric tensor, interpolate the phonon spectrum to make nice phonon
dispersion plots, calculate Raman spectra, etc., but we are focusing on the
minimum needed for the elastic and piezoelectric constants at zero electric field.  </p>
<p>We also mention that <a class="wikilink user-guide-wikilink" href="../../guide/mrgddb">mrgddb</a>
is another utility program that can be used to combine DDB files generated in
several different datasets or in different runs into a single DDB file that
can be analyzed by anaddb. One particular usage would be to combine the DDB
file produced by the GS run, which contains first-derivative information such
as stresses and forces with the RF DDB. It is anticipated that anaddb in a
future release will implement the finite-stress corrections to the elastic
tensor discussed in <a href="../../../theory/documents/elasticity-oganov.pdf">notes by A. R. Oganov</a> .  </p>
<p>Now would be a good time to edit telast_3.in and observe that it is very
simple, consisting of nothing more than the four variables listed above set to
appropriate values. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-54962d8c-d331-4a51-a586-a994be1e5b05" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_3.files
</button>
<button type="button" id="uuid-f02b31b6-1e6d-430e-b8c9-f6679fc2f1ff" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_3.in
</button>
</div></div>

<div id="uuid-8ed98623-48d1-4c87-a109-65be6536db03" class="my_dialog" title="tests/tutorespfn/Input/telast_3.files" hidden><div><pre class="small-text">
telast_3.in
telast_3.out
telast_2o_DS3_DDB
dummy_moldyn
dummy_GKK
dummy_epout
dummy_ddk

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8ed98623-48d1-4c87-a109-65be6536db03", "#uuid-54962d8c-d331-4a51-a586-a994be1e5b05") }); </script>

<div id="uuid-f7e4ef01-9366-4bfb-a2b5-9beaa44219ce" class="my_dialog" title="tests/tutorespfn/Input/telast_3.in" hidden><div><div class="codehilite small-text"><pre><span></span>!the input file <span class="k">for</span> the anaddb code

  elaflag  <span class="m">3</span>  !the flag <span class="k">for</span> the elastic constant
piezoflag  <span class="m">3</span>  !the flag <span class="k">for</span> the piezoelectric constant
instrflag  <span class="m">1</span>  !the flag <span class="k">for</span> the internal strain tensor

!the effective charge part
   chneut  <span class="m">1</span>  !enforce Born effective charge neutrality

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = anaddb</span>
<span class="c1">#%% test_chain = telast_2.in, telast_3.in</span>
<span class="c1">#%% input_ddb = telast_2o_DS3_DDB</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_3.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords =  NC, DFPT</span>
<span class="c1">#%% description =  The input file for the anaddb code</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-f7e4ef01-9366-4bfb-a2b5-9beaa44219ce", "#uuid-f02b31b6-1e6d-430e-b8c9-f6679fc2f1ff") }); </script>

<p>The telast_3.files file is used with anaddb in the same
manner as the abinit .files you are by now used to. The first two lines
specify the .in and .out files, the third line specifies the DDB file, and the
last two lines are dummy names which would be used in connection with other
capabilities of anaddb. Now you should run the calculation, which is done in
the same way as you are now used to for abinit:  </p>
<div class="codehilite"><pre><span></span><span class="cp">../../anaddb &lt;telast_3.files &gt;&amp;telast_3.log</span>
</pre></div>


<p>This calculation should only take a few seconds. You should edit the log file,
go to the end, and make sure the calculation terminated without error. Next,
examine telast_3.out. After some header information, we come to tables giving
the &ldquo;force-response&rdquo; and &ldquo;displacement-response&rdquo; internal strain tensors.
These represent, respectively, the force on each atom and the displacement of
each atom in response to a unit strain of the specified type. These numbers
are of limited interest to us, but represent important intermediate quantities
in the treatment of atomic relaxation (see the X. Wu paper cited above).  </p>
<p>Next, we come to the elastic tensor output:  </p>
<div class="codehilite"><pre><span></span> Elastic Tensor(clamped ion)(unit:10^2GP):

   1.6598859   0.4046480   0.2109029   0.0000000   0.0000000   0.0000000
   0.4046480   1.6598859   0.2109029   0.0000000  -0.0000000   0.0000000
   0.2109030   0.2109030   1.8258575   0.0000000  -0.0000000   0.0000000
  -0.0000000  -0.0000000  -0.0000000   0.4081820  -0.0000000   0.0000000
   0.0000000   0.0000000   0.0000000  -0.0000000   0.4081820  -0.0000000
  -0.0000000  -0.0000000  -0.0000000   0.0000000  -0.0000000   0.6276190

 Elastic Tensor(relaxed ion)(unit:10^2GP):
   (at fixed electric field boundary condition)

   1.3526217   0.5445039   0.3805291  -0.0000000   0.0000000   0.0000000
   0.5445039   1.3526217   0.3805292   0.0000000  -0.0000000   0.0000000
   0.3805292   0.3805293   1.4821104   0.0000000  -0.0000000   0.0000000
  -0.0000000   0.0000000   0.0000000   0.3055071  -0.0000000   0.0000000
   0.0000000  -0.0000000  -0.0000000  -0.0000000   0.3055071   0.0000000
  -0.0000000   0.0000000  -0.0000000   0.0000000   0.0000000   0.4040588
</pre></div>


<p>While not labeled, the rows and columns 1-6 here represent xx, yy, zz, yz, xz,
xy strains and stresses in the conventional Voigt notation.<br />
The clamped-ion results were calculated in the telast_2 RF run, and are simply
converted to standard GPa units by anaddb (the terms &ldquo;clamped ion,&rdquo; &ldquo;clamped
atom,&rdquo; and &ldquo;rigid atom&rdquo; used in various places are interchangeable, similarly for &ldquo;relaxed.&rdquo;)<br />
The relaxed-ion result was calculated by anaddb by combining 2DTE&rsquo;s for
internal strain and interatomic force constants which are stored in the input
DDB file. Comparing the clamped and relaxed results, we see that all the
diagonal elastic constants have decreased in value.<br />
This is plausible, since allowing the internal degrees of freedom to relax
should make a material less stiff. These tensors should be symmetric, and
certain tensor elements should be zero or identical by symmetry.<br />
It&rsquo;s a good idea to check these properties against a standard text such as  J.
F. Nye, Physical Properties of Crystals (Oxford U. P., Oxford 1985).
Departures from expected symmetries (there are a few in the last decimal place
here) are due to either convergence errors or, if large, incorrectly specified
geometry (however, see the final comments on symmetry  below).  </p>
<p>Next in telast_3.out we find the piezoelectric tensor results:  </p>
<div class="codehilite"><pre><span></span> Proper piezoelectric constants(clamped ion)(unit:c/m^2)

      0.00000000      0.00000000      0.38490079
      0.00000000      0.00000000      0.38490075
      0.00000000      0.00000000     -0.73943025
      0.00000000      0.43548797      0.00000000
      0.43548796      0.00000000     -0.00000000&lt;
      0.00000000      0.00000000      0.00000001

 Proper piezoelectric constants(relaxed ion)(unit:c/m^2)

      0.00000000     -0.00000000     -0.01187149
     -0.00000000      0.00000000     -0.01187169
     -0.00000000      0.00000000      0.06462779
     -0.00000000     -0.04828847     -0.00000000
     -0.04828832     -0.00000000      0.00000000
</pre></div>


<p>The 3 columns here represent x, y, and z electric polarization, and the 6 rows
the Voigt strains. The clamped-ion result was calculated in the telast_2 RF
run, and is simply scaled to conventional units by anaddb. The ion relaxation
contributions are based on 2DTE&rsquo;s for internal strain, interatomic force
constants, and Born effective charges, and typically constitute much larger
corrections to the piezoelectric tensor than to the elastic tensor. Once
again, symmetries should be checked. (The slight discrepancies seen here can
be removed by setting tolvrs3=1.0d-18 in telast_2.in.) One should be aware
that the piezoelectric tensor is identically zero in any material which has a center of symmetry.  </p>
<p>Since we are dealing with a hypothetical material, there is no experimental
data with which to compare our results. In the next section, we will calculate
a few of these numbers by a finite-difference method to gain confidence in the RF approach.  </p>
<h2 id="4-finite-difference-calculation-of-elastic-and-piezoelectric-constants">4 Finite-difference calculation of elastic and piezoelectric constants<a class="headerlink" href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" title="Permanent link">&para;</a></h2>
<p>You should copy telast_4.in and telast_4.files into your Work_elast directory.</p>
<div class="text-center"><button type="button" id="uuid-7fff7e0c-ff88-4dd5-8e06-8e3eb9189811" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_4.in
</button></div>

<div id="uuid-8c4452cf-a657-4398-9533-b3c58518abb8" class="my_dialog" title="tests/tutorespfn/Input/telast_4.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Finite-difference calculation for c-axis strain increment +/- 0.0001</span>

   ndtset   <span class="m">4</span>

<span class="c1"># Set 1 : Self-consistent run for stress</span>

  kptopt1   <span class="m">1</span>
   rprim1   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
           -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
            <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">0</span>.9999  <span class="c1">#strained value</span>

<span class="c1"># Set 2 : Run for electric polarization</span>

berryopt2  -1  <span class="c1">#preferred method to calulate electric polarization</span>
  getwfk2  -1  <span class="c1">#previous wf&#39;s will be transformed to full k set as needed</span>
  kptopt2   <span class="m">3</span>  <span class="c1">#berry phase calculation requires full k set</span>

   rprim2   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
           -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
            <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">0</span>.9999

   rfdir2   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="c1">#will calculate Cartesian polarization</span>

<span class="c1"># Set 3 : Self-consistent run for stress</span>

  getwfk3  -1  <span class="c1">#wave function shouldn&#39;t change much</span>
  kptopt3   <span class="m">1</span>
   rprim3   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
           -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
            <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">1</span>.0001  <span class="c1">#strained value</span>

<span class="c1"># Set 4 : Run for electric polarization</span>

berryopt4  -1
  getwfk4  -1
  kptopt4   <span class="m">3</span>
   rprim4   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
           -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0
            <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">1</span>.0001
   rfdir4   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>

<span class="c1">#Common input data</span>

<span class="c1">#Starting approximation for the unit cell</span>

<span class="c1"># relaxed lattice constants</span>

     acell   <span class="m">7</span>.5389648144E+00  <span class="m">7</span>.5389648144E+00  <span class="m">1</span>.2277795374E+01

<span class="c1">#Definition of the atom types and atoms</span>
 ntypat   <span class="m">2</span> 
  znucl   <span class="m">13</span> <span class="m">33</span>
  natom   <span class="m">4</span>
  typat   <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> <span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>

<span class="c1"># relaxed atomic coordinates</span>
      xred   <span class="m">3</span>.3333333333E-01  <span class="m">6</span>.6666666667E-01  <span class="m">0</span>.0000000000E+00
             <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.3333333333E-01  <span class="m">5</span>.0000000000E-01
             <span class="m">3</span>.3333333333E-01  <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.7608588373E-01
             <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.3333333333E-01  <span class="m">8</span>.7608588373E-01


<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
  nband   <span class="m">8</span>              <span class="c1"># For an insulator (if described correctly as an </span>
                         <span class="c1"># insulator by DFT), conduction bands should not</span>
                         <span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
   ecut   <span class="m">6</span>.0            <span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
 ecutsm   <span class="m">0</span>.5            <span class="c1"># Smoothing energy needed for lattice paramete</span>
                         <span class="c1"># optimization.  This will be retained for</span>
                         <span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
 kptopt   <span class="m">1</span>              <span class="c1"># Use symmetry and treat only inequivalent points</span>
  ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk   <span class="m">1</span>              <span class="c1"># Use one copy of grid only (default)</span>
 shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This choice of origin for the k point grid</span>
                         <span class="c1"># preserves the hexagonal symmetry of the grid,</span>
                         <span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
 diemac   <span class="m">9</span>.0            <span class="c1"># Model dielectric preconditioner</span>
  nstep   <span class="m">40</span>             <span class="c1"># Maxiumum number of SCF iterations</span>
 tolvrs   <span class="m">1</span>.0d-18        <span class="c1"># Needed for good stress and polarization convergence</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
 optforces <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_4.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%    AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%    Finite-difference calculation for c-axis strain increment +/- 0.0001</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8c4452cf-a657-4398-9533-b3c58518abb8", "#uuid-7fff7e0c-ff88-4dd5-8e06-8e3eb9189811") }); </script>

<p>Editing telast_4.in, you will see that it has four datasets, the first two
with the c-axis contracted 0.01% and the second two with it expanded 0.01%,
which we specified by changing the third row of <a class="wikilink codevar-wikilink" href="../../variables/basic#rprim">rprim</a>. The common data is
essentially the same as telast_2.in, and the relaxed <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a> values and
<a class="wikilink codevar-wikilink" href="../../variables/basic#xred">xred</a> from telast_1.out have already been included. Datasets 1 and 3 do the
self-consistent convergence of the GS wave functions for the strained lattices
and compute the stress. Datasets 2 and 4 introduce a new variable.  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/ffield#berryopt">berryopt</a> </li>
</ul>
<p>Electric polarization in solids is a subtle topic which has only recently been
rigorously resolved. It is now understood to be a bulk property, and to be
quantitatively described by a Berry phase formulation introduced by R. D.
King-Smith and D. Vanderbilt, Phys. Ref. B 47, 1651(1993) . It can be
calculated in a GS calculation by integrating the gradient with respect to
<strong>k</strong> of the GS wave functions over the Brillouin zone. In GS calculations,
the gradients are approximated by finite-difference expressions constructed
from neighboring points in the <strong>k</strong> mesh. These are closely related to the
ddk wave functions used in RF calculations in section 2 and introduced in 
<a class="wikilink lesson-wikilink" href="../rf1#5">lesson RF1, section 5</a>. We will use <a class="wikilink codevar-wikilink" href="../../variables/ffield#berryopt">berryopt</a> = -1,
which utilizes an improved coding of the calculation, and must specify
<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a> = 1 1 1 so that the Cartesian components of the polarization are computed.  </p>
<p>Now, run the telast_4 calculation, which should only take a minute or two, and
edit telast_4.out. To calculate the elastic constants, we need to find the
stresses  sigma(1 1) and sigma(3 3). We see that each of the four datasets
have stress results, but that there are slight differences between those from,
for example dataset 1 and dataset 2, which should be identical. Despite our
tight limit, this is still a convergence issue. Look at the following convergence results,  </p>
<div class="codehilite"><pre><span></span>Dataset 1:
 At SCF step   13       vres2   =  6.24E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

Dataset 2:
 At SCF step    1       vres2   =  5.08E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.
</pre></div>


<p>Since dataset 2 has better convergence, we will use this and the dataset 4
results, choosing those in GPa units,</p>
<div class="codehilite"><pre><span></span>- sigma(1 1)= -2.11918835E-03  sigma(3 2)=  0.00000000E+00
- sigma(3 3)= -1.82392050E-02  sigma(2 1)=  0.00000000E+00

- sigma(1 1)=  2.09886408E-03  sigma(3 2)=  0.00000000E+00
- sigma(3 3)=  1.82778679E-02  sigma(2 1)=  0.00000000E+00
</pre></div>


<p>Let us now compute the numerical derivative of  sigma(3 3)and compare to our
RF result. Recalling that our dimensionless strains were ±0.0001, we find
182.5853 GPa. This compares very well with the value  182.58575 GPa, the 3,3
element of the Rigid-ion elastic tensor we found from our anaddb calculation
in section 3. (Recall that our strain and stress were both 3 3 or z z or Voigt
3.) Similarly, the numerical derivative of  sigma(1 1)is 21.09026 GPa,
compared to  21.09029 GPa, the 3,1 elastic-tensor element.</p>
<p>The good agreement we found from this simple numerical differentiation
required that we had accurately relaxed the lattice so that the stress of the
unstrained structure was very small. Similar numerical-derivative comparisons
for systems with finite stress are more complicated, as discussed in 
<a href="../../../theory/documents/elasticity-oganov.pdf">notes by A. R. Oganov</a>. 
Numerical- derivative comparisons for the relaxed-ion results are extremely challenging
since they require relaxing atomic forces to exceedingly small limits.</p>
<p>Now let us examine the electric polarizations found in datasets 2 and 4,
focusing on the C/m^2 results,</p>
<div class="codehilite"><pre><span></span>           Polarization    -1.578272218E-11 C/m^2
           Polarization     1.578207434E-11 C/m^2
           Polarization    -2.979936062E-01 C/m^2

           Polarization    -1.577757536E-11 C/m^2
           Polarization     1.577753205E-11 C/m^2
           Polarization    -2.981427239E-01 C/m^2
</pre></div>


<p>While not labeled as such, these are the Cartesian x, y, and z components,
respectively, and the x and y components are zero within numerical accuracy as
they must be from symmetry. Numerical differentiation of the z component
yields -0.745589 C/m^2. This is to be compared with the z,3 element of our
rigid-ion piezoelectric tensor from section 3, -0.73943025 C/m^2, and the two
results do not compare as well as we might wish.</p>
<p>What is wrong? There are two possibilities. The first is that the RF
calculation produces the proper piezoelectric tensor, while numerical
differentiation of the polarization produces the improper piezoelectric
tensor. This is a subtle point, for which you are referred to  D. Vanderbilt,
J. Phys. Chem. Solids 61, 147 (2000). The improper-to-proper transformation
only effects certain tensor elements, however, and for our particular
combination of crystal symmetry and choice of strain there is no correction.
The second possibility is the subject of the next section.</p>
<h2 id="5-alternative-dfpt-calculation-of-some-piezoelectric-constants">5 Alternative DFPT calculation of some piezoelectric constants<a class="headerlink" href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" title="Permanent link">&para;</a></h2>
<p>Our GS calculation of the polarization in section 4 used, in effect, a finite-
difference approximation to ddk wave functions, while our RF calculations in
section 2 used analytic results based on the RF approach. Since the <strong>k</strong> grid
determined by <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> = 4 4 4 and <a class="wikilink codevar-wikilink" href="../../variables/basic#nshiftk">nshiftk</a> = 1 is rather coarse, this is
a probable source of discrepancy. Since this issue was noted previously in
connection with the calculation of Born effective charges by  Na Sai, K. M.
Rabe, and D. Vanderbilt, Phys. Rev. B 66, 104108 (2002) , Abinit has
incorporated the ability to use finite-difference ddk wave functions from GS
calculations in RF calculations of electric-field-related 2DTE&rsquo;s. Copy
telast_5.in and telast_5.files into Work_elast, and edit telast_5.in.</p>
<div class="text-center"><button type="button" id="uuid-a9d15df2-46ae-4c64-a564-19624e09e410" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_5.in
</button></div>

<div id="uuid-b0c3304c-606d-4b50-bbb5-a01a830d9557" class="my_dialog" title="tests/tutorespfn/Input/telast_5.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlAs in hypothetical wurzite (hexagonal) structure</span>

<span class="c1">#Alternative response function calculation for some rigid-atom </span>
<span class="c1">#piezoelectric tensor elements.</span>

   ndtset   <span class="m">3</span>

<span class="c1"># Set 1 : Initial self-consistent run</span>

  kptopt1   <span class="m">1</span>
  prtden1   <span class="m">1</span>        <span class="c1">#second dataset need density</span>
  tolvrs1   <span class="m">1</span>.0d-18  <span class="c1">#need excellent convergence of GS quantities for RF runs</span>


<span class="c1">#Second dataset : finite-difference d/dk ground-state calculation</span>
<span class="c1">#                uses bdberry_new</span>

berryopt2   -2       <span class="c1">#specifies ddk wave functions wanted</span>
  getden2   -1       <span class="c1">#use density from previous dataset</span>
  getwfk2   -1       <span class="c1">#use wave function from profious dataset</span>
  kptopt2   <span class="m">3</span>        <span class="c1">#need full set of k points herre</span>
    iscf2   -2       <span class="c1">#non-self-consistent</span>
   rfdir2   <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>    <span class="c1">#we are only checking a c-axis quantity</span>
  tolwfr2   <span class="m">1</span>.0d-20  <span class="c1"># only wave function convergence can be used with</span>
                     <span class="c1"># non-self-consistent calculation</span>

<span class="c1"># Set 3 : response-function calculations for all needed perturbations</span>

  getddk3  -1
  getwfk3  -1
  kptopt3   <span class="m">2</span>        <span class="c1">#use time-reversal symmetry only for k points</span>
    nqpt3   <span class="m">1</span>
     qpt3   <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
  rfstrs3   <span class="m">1</span>        <span class="c1">#do strain perturbation</span>
   rfdir3   <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>    <span class="c1">#the full set of directions is needed</span>
  tolvrs3   <span class="m">1</span>.0d-10  <span class="c1">#need reasonable convergence of 1st-order quantities</span>

<span class="c1">#Common input data</span>


<span class="c1">#Lattice (relaxed lattice constants)</span>
  acell   <span class="m">7</span>.5389648144E+00  <span class="m">7</span>.5389648144E+00  <span class="m">1</span>.2277795374E+01

  rprim   <span class="m">0</span>.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#hexagonal primitive vectors must be</span>
         -0.866025403784439  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1">#specified with high accuracy to be</span>
          <span class="m">0</span>.0                <span class="m">0</span>.0  <span class="m">1</span>.0   <span class="c1">#sure that the symmetry is recognized</span>
                                        <span class="c1">#and preserved in the optimization</span>
                                        <span class="c1">#process</span>

<span class="c1">#Definition of the atom types and atoms</span>
 ntypat   <span class="m">2</span> 
  znucl   <span class="m">13</span> <span class="m">33</span>
  natom   <span class="m">4</span>
  typat   <span class="m">1</span> <span class="m">1</span> <span class="m">2</span> <span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>

<span class="c1">#Atomic positions (relaxed)</span>
   xred   <span class="m">3</span>.3333333333E-01  <span class="m">6</span>.6666666667E-01  <span class="m">0</span>.0000000000E+00
          <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.3333333333E-01  <span class="m">5</span>.0000000000E-01
          <span class="m">3</span>.3333333333E-01  <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.7608588373E-01
          <span class="m">6</span>.6666666667E-01  <span class="m">3</span>.3333333333E-01  <span class="m">8</span>.7608588373E-01

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
  nband   <span class="m">8</span>              <span class="c1"># For an insulator (if described correctly as an </span>
                         <span class="c1"># insulator by DFT), conduction bands should not</span>
                         <span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
   ecut   <span class="m">6</span>.0            <span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
 ecutsm   <span class="m">0</span>.5            <span class="c1"># Smoothing energy needed for lattice paramete</span>
                         <span class="c1"># optimization.  This will be retained for</span>
                         <span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
 kptopt   <span class="m">1</span>              <span class="c1"># Use symmetry and treat only inequivalent points</span>
  ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>          <span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk   <span class="m">1</span>              <span class="c1"># Use one copy of grid only (default)</span>
 shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This choice of origin for the k point grid</span>
                         <span class="c1"># preserves the hexagonal symmetry of the grid,</span>
                         <span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
 diemac   <span class="m">9</span>.0            <span class="c1"># Model dielectric preconditioner</span>
  nstep   <span class="m">40</span>             <span class="c1"># Maxiumum number of SCF iterations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
 optforces <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_5.out, tolnlines=  3, tolabs=  3.000e-09, tolrel=  9.000e-10</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Alternative response function calculation for some rigid-atom </span>
<span class="c1">#%%   piezoelectric tensor elements.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b0c3304c-606d-4b50-bbb5-a01a830d9557", "#uuid-a9d15df2-46ae-4c64-a564-19624e09e410") }); </script>

<p>You should compare this with our previous RF data, telast_2.in, and note that
dataset1 and the Common data (after entering relaxed structural results) are
essentially identical. Dataset 2 has been replaced by a non-self-consistent GS
calculation with <a class="wikilink codevar-wikilink" href="../../variables/ffield#berryopt">berryopt</a> = -2 specified to perform the finite-difference
ddk wave function calculation. (The finite-difference first-order wave
functions are implicit but not actually calculated in the GS polarization
calculation.) We have restricted <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a> to 0 0 1 since we are only
interested in the 3,3 piezoelectric constant. Now compare dataset 3 with that
in telast_2.in. Can you figure out what we have dropped and why? Run the
telast_5 calculation, which will only take about a minute with our simplifications.</p>
<p>Now edit telast_5.out, looking for the piezoelectric tensor,</p>
<div class="codehilite"><pre><span></span>  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
     j1       j2                   matrix element
  dir pert dir pert          real part        imaginary part

   3    6   3    7        -0.0130314050         0.0000000000
</pre></div>


<div class="text-center"><button type="button" id="uuid-bf0f1dbf-b09e-4b52-8f39-ffabd2d5b751" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Refs/telast_5.out
</button></div>

<div id="uuid-3d9bea8f-bc50-44bf-b81e-7b9cc9f0688b" class="my_dialog" title="tests/tutorespfn/Refs/telast_5.out" hidden><div><pre class="small-text">

.Version 8.0.3 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu5.3 computer) 

.Copyright (C) 1998-2018 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read ~abinit/doc/users/acknowledgments.html for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Mon  4 Apr 2016.
- ( at 09h51 )

- input  file    -&gt; telast_5.in
- output file    -&gt; telast_5.out
- root for input  files -&gt; telast_5i
- root for output files -&gt; telast_5o


 DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       2
     lnmax =       2     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         428          nfft =        9720          nkpt =           8
================================================================================
P This job should need less than                       4.132 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.420 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================


 DATASET    2 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =      -2    lmnmax =       2
     lnmax =       2     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =          64
       mpw =         428          nfft =        9720          nkpt =          64
================================================================================
P This job should need less than                       6.235 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.346 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================


 DATASET    3 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  3 (RF).
     intxc =       0      iscf =       7    lmnmax =       2     lnmax =       2
     mgfft =      30  mpssoang =       3    mqgrid =    3001     natom =       4
  nloc_mem =       1    nspden =       1   nspinor =       1    nsppol =       1
      nsym =      12    n1xccc =    2501    ntypat =       2    occopt =       1
   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =          32
-   mkqmem =          32        mk1mem =          32           mpw =         428
      nfft =        9720          nkpt =          32
================================================================================
P This job should need less than                       8.327 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      1.674 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   accesswff0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.5389648144E+00  7.5389648144E+00  1.2277795374E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
         berryopt1          0
         berryopt2         -2
         berryopt3          0
           diemac      9.00000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
-          fftalg         312
           getddk1          0
           getddk2          0
           getddk3         -1
           getden1          0
           getden2         -1
           getden3          0
           getwfk1          0
           getwfk2         -1
           getwfk3         -1
             iscf1          7
             iscf2         -2
             iscf3          7
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
              kpt2     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -3.75000000E-01
                       2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       5.00000000E-01  0.00000000E+00 -3.75000000E-01
                      -2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       0.00000000E+00  2.50000000E-01 -3.75000000E-01
                       2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       5.00000000E-01  2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  5.00000000E-01 -3.75000000E-01
                       2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       5.00000000E-01  5.00000000E-01 -3.75000000E-01
                      -2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       0.00000000E+00 -2.50000000E-01 -3.75000000E-01
                       2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       5.00000000E-01 -2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -1.25000000E-01
                       2.50000000E-01  0.00000000E+00 -1.25000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       outvar_i_n : Printing only first  50 k-points.
           kptopt1          1
           kptopt2          3
           kptopt3          2
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      3.01558593E+01
P           mkmem1          8
P           mkmem2         64
P           mkmem3         32
P          mkqmem1          8
P          mkqmem2         64
P          mkqmem3         32
P          mk1mem1          8
P          mk1mem2         64
P          mk1mem3         32
            natom           4
            nband1          8
            nband2          8
            nband3          8
           nbdbuf1          0
           nbdbuf2          2
           nbdbuf3          0
           ndtset           3
            ngfft          18      18      30
             nkpt1          8
             nkpt2         64
             nkpt3         32
             nqpt1          0
             nqpt2          0
             nqpt3          1
            nstep          40
             nsym          12
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
        optdriver1          0
        optdriver2          0
        optdriver3          1
        optforces           1
            rfdir1          0       0       0
            rfdir2          0       0       1
            rfdir3          0       0       1
           rfstrs1          0
           rfstrs2          0
           rfstrs3          1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000    -0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000     0.0000000 -0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                      -0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000 -0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
           tolvrs1     1.00000000E-18
           tolvrs2     0.00000000E+00
           tolvrs3     1.00000000E-10
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-20
           tolwfr3     0.00000000E+00
            typat      1  1  2  2
              wtk1       0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
              wtk2       0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563
              wtk3       0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125
                       outvars : Printing only first  50 k-points.
           xangst     -1.1516545412E+00  1.9947241781E+00  0.0000000000E+00
                       1.1516545412E+00  1.9947241781E+00  3.2485647418E+00
                      -1.1516545412E+00  1.9947241781E+00  2.4434786836E+00
                       1.1516545412E+00  1.9947241781E+00  5.6920434254E+00
            xcart     -2.1763116825E+00  3.7694824072E+00  0.0000000000E+00
                       2.1763116825E+00  3.7694824072E+00  6.1388976870E+00
                      -2.1763116825E+00  3.7694824072E+00  4.6175055235E+00
                       2.1763116825E+00  3.7694824072E+00  1.0756403210E+01
             xred      3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7608588373E-01
                       6.6666666667E-01  3.3333333333E-01  8.7608588373E-01
            znucl       13.00000   33.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   nproc =    1

 Exchange-correlation functional for the present dataset will be:
  LDA: new Teter (4/93) with spin-polarized option - ixc=1
 Citation for XC functional:
  S. Goedecker, M. Teter, J. Huetter, PRB 54, 1703 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.5289350  3.7694824  0.0000000  G(1)=  0.0765822  0.1326442  0.0000000
 R(2)= -6.5289350  3.7694824  0.0000000  G(2)= -0.0765822  0.1326442  0.0000000
 R(3)=  0.0000000  0.0000000 12.2777954  G(3)=  0.0000000  0.0000000  0.0814478
 Unit cell volume ucvol=  6.0433042E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.16976

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/gonze/ABINIT/ABINITv8.0.3/gonze/8.0.3-private/tests/Psps_for_tests/13al.pspnc
- pspatm: opening atomic psp file    /home/gonze/ABINIT/ABINITv8.0.3/gonze/8.0.3-private/tests/Psps_for_tests/13al.pspnc
-  Troullier-Martins psp for element  Al        Thu Oct 27 17:31:05 EDT 1994
- 13.00000   3.00000    940714                znucl, zion, pspdat
    1    1    2    2      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.657  11.889    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   1.829   2.761    1   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2   0.000   0.000    0   2.2761078        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.09673076353074    0.12648111154518    1.01742091001718   rchrg,fchrg,qchrg
 pspatm : epsatm=    0.22155260
         --- l  ekb(1:nproj) --&gt;
             0    2.540658
             1    1.353815
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/gonze/ABINIT/ABINITv8.0.3/gonze/8.0.3-private/tests/Psps_for_tests/33as.pspnc
- pspatm: opening atomic psp file    /home/gonze/ABINIT/ABINITv8.0.3/gonze/8.0.3-private/tests/Psps_for_tests/33as.pspnc
-  Troullier-Martins psp for element  As        Thu Oct 27 17:37:14 EDT 1994
- 33.00000   5.00000    940714                znucl, zion, pspdat
    1    1    1    1      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    0   4.772  10.829    1   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    1   2.745   5.580    0   2.5306160        l,e99.0,e99.9,nproj,rcpsp
   0.00000000   0.00000000   0.00000000   0.00000000     rms, ekb1, ekb2, epsatm
    2.05731715564010    0.36322996461007    2.76014815959125   rchrg,fchrg,qchrg
 pspatm : epsatm=   27.20579911
         --- l  ekb(1:nproj) --&gt;
             0    0.838751
 pspatm: atomic psp has been read  and splines computed

   8.77675255E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are     424.219     424.184

================================================================================

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -20.254721409586    -2.025E+01 4.634E-03 8.323E+00 1.033E-03 1.033E-03
 ETOT  2  -20.270119196096    -1.540E-02 1.124E-07 4.547E-01 1.196E-03 1.628E-04
 ETOT  3  -20.270903177950    -7.840E-04 5.228E-06 3.336E-02 1.736E-04 1.082E-05
 ETOT  4  -20.270943324824    -4.015E-05 1.668E-07 8.826E-04 9.004E-07 1.172E-05
 ETOT  5  -20.270943768794    -4.440E-07 1.666E-09 6.074E-06 1.355E-05 1.830E-06
 ETOT  6  -20.270943772486    -3.692E-09 1.494E-11 1.055E-07 2.925E-06 1.095E-06
 ETOT  7  -20.270943772569    -8.281E-11 1.151E-12 3.544E-09 1.297E-06 2.013E-07
 ETOT  8  -20.270943772573    -4.373E-12 9.120E-14 4.512E-11 2.843E-07 8.303E-08
 ETOT  9  -20.270943772573    -1.030E-13 2.275E-16 6.457E-13 3.544E-09 7.949E-08
 ETOT 10  -20.270943772573     3.553E-14 4.016E-18 1.237E-14 4.232E-10 7.906E-08
 ETOT 11  -20.270943772573     2.842E-14 6.987E-20 1.348E-16 2.166E-12 7.906E-08
 ETOT 12  -20.270943772573    -2.842E-14 4.504E-22 1.033E-18 9.664E-12 7.907E-08
 ETOT 13  -20.270943772573    -3.553E-14 6.050E-24 6.241E-21 1.051E-12 7.907E-08

 At SCF step   13       vres2   =  6.24E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.80064359E-10  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.80064357E-10  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  7.75604717E-10  sigma(2 1)=  0.00000000E+00

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92179175
    2        2.00000          0.92179175
    3        2.00000          2.53764202
    4        2.00000          2.53764202
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   2.3179E-24; max=  6.0497E-24
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667     -0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.376085883730
       0.666666666667      0.333333333333      0.876085883730
 rms dE/dt=  5.6069E-07; max dE/dt=  9.9551E-07; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000     -0.000000946136
    2       0.000000000000      0.000000000000     -0.000000946136
    3       0.000000000000      0.000000000000      0.000000995507
    4       0.000000000000      0.000000000000      0.000000995507

 cartesian coordinates (angstrom) at end:
    1     -1.15165454116847     1.99472417807121    -0.00000000000000
    2      1.15165454116847     1.99472417807121     3.24856474182627
    3     -1.15165454116847     1.99472417807121     2.44347868356770
    4      1.15165454116847     1.99472417807121     5.69204342539397

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000    -0.00000000000000     0.00000007907130
    2     -0.00000000000000    -0.00000000000000     0.00000007907130
    3     -0.00000000000000    -0.00000000000000    -0.00000007907130
    4     -0.00000000000000    -0.00000000000000    -0.00000007907130
 frms,max,avg= 4.5651836E-08 7.9071300E-08   0.000E+00  0.000E+00 -2.011E-09 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000    -0.00000000000000     0.00000406600937
    2     -0.00000000000000    -0.00000000000000     0.00000406600937
    3     -0.00000000000000    -0.00000000000000    -0.00000406600937
    4     -0.00000000000000    -0.00000000000000    -0.00000406600937
 frms,max,avg= 2.3475116E-06 4.0660094E-06   0.000E+00  0.000E+00 -1.034E-07 e/A
 length scales=  7.538964814400  7.538964814400 12.277795374000 bohr
              =  3.989448356142  3.989448356142  6.497129483653 angstroms
 prteigrs : about to open file telast_5o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =   0.08616   Average Vxc (hartree)=  -0.34268
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.35501   -0.30563   -0.11714    0.05113    0.05113    0.06669    0.08616    0.08616
 prteigrs : prtvol=0 or 1, do not print more k-points.


--------------------------------------------------------------------------------
 Components of total free energy (in Hartree) :

    Kinetic energy  =  5.91947827500975E+00
    Hartree energy  =  1.65285115746601E+00
    XC energy       = -8.68515356530422E+00
    Ewald energy    = -1.68697612425042E+01
    PspCore energy  =  1.45231023648193E+00
    Loc. psp. energy= -4.92404864079751E+00
    NL   psp  energy=  1.18338000707508E+00
    &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Etotal= -2.02709437725731E+01

 Other information on the energy :
    Total energy(eV)= -5.51600432199964E+02 ; Band energy (Ha)=  -1.4274245066E+00
--------------------------------------------------------------------------------

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -3.80064359E-10  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -3.80064357E-10  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  7.75604717E-10  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -1.5177E-07 GPa]
- sigma(1 1)= -1.11818776E-05  sigma(3 2)=  0.00000000E+00
- sigma(2 2)= -1.11818776E-05  sigma(3 1)=  0.00000000E+00
- sigma(3 3)=  2.28190748E-05  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   nproc =    1

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   1.

 mkfilename : getden/=0, take file _DEN from output of DATASET   1.

 Exchange-correlation functional for the present dataset will be:
  LDA: new Teter (4/93) with spin-polarized option - ixc=1
 Citation for XC functional:
  S. Goedecker, M. Teter, J. Huetter, PRB 54, 1703 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.5289350  3.7694824  0.0000000  G(1)=  0.0765822  0.1326442  0.0000000
 R(2)= -6.5289350  3.7694824  0.0000000  G(2)= -0.0765822  0.1326442  0.0000000
 R(3)=  0.0000000  0.0000000 12.2777954  G(3)=  0.0000000  0.0000000  0.0814478
 Unit cell volume ucvol=  6.0433042E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.16976
--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_5o_DS1_WFK
  initberry: for direction 1, nkstr =   0, nstr =      0
  initberry: for direction 2, nkstr =   0, nstr =      0
  initberry: for direction 3, nkstr =   4, nstr =     16

================================================================================
 prteigrs : about to open file telast_5o_DS2_EIG
 Non-SCF case, kpt    1 (  0.00000  0.00000  0.12500), residuals and eigenvalues=
  8.92E-25  8.41E-25  6.95E-25  5.94E-25  5.92E-25  8.49E-25  3.17E-24  2.86E-24
 -3.5501E-01 -3.0563E-01 -1.1714E-01  5.1133E-02  5.1133E-02  6.6690E-02
  8.6162E-02  8.6162E-02
 prteigrs : prtvol=0 or 1, do not print more k-points.



 Computing the polarization (Berry phase) for reciprocal vector:
  0.00000  0.00000  0.25000 (in reduced coordinates)
  0.00000  0.00000  0.02036 (in cartesian coordinates - atomic units)
 Number of strings:    16
 Number of k points in string:    4

 Computing the ddk (Berry phase) for reciprocal vector:
  0.00000  0.00000  0.25000 (in reduced coordinates)
  0.00000  0.00000  0.02036 (in cartesian coordinates - atomic units)
 Mean square residual over all n,k,spin=   0.0000E+00; max=  0.0000E+00
 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.92179175
    2        2.00000          0.92179175
    3        2.00000          2.53764202
    4        2.00000          2.53764202
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   8.1553E-22; max=  8.0308E-21
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667     -0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.376085883730
       0.666666666667      0.333333333333      0.876085883730

 cartesian coordinates (angstrom) at end:
    1     -1.15165454116847     1.99472417807121    -0.00000000000000
    2      1.15165454116847     1.99472417807121     3.24856474182627
    3     -1.15165454116847     1.99472417807121     2.44347868356770
    4      1.15165454116847     1.99472417807121     5.69204342539397
 length scales=  7.538964814400  7.538964814400 12.277795374000 bohr
              =  3.989448356142  3.989448356142  6.497129483653 angstroms
 prteigrs : about to open file telast_5o_DS2_EIG
 Eigenvalues (hartree) for nkpt=  64  k points:
 kpt#   1, nband=  8, wtk=  0.01563, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.35501   -0.30563   -0.11714    0.05113    0.05113    0.06669    0.08616    0.08616
 prteigrs : prtvol=0 or 1, do not print more k-points.


================================================================================
== DATASET  3 ==================================================================
-   nproc =    1

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   2.

 mkfilename : getddk/=0, take file _1WF from output of DATASET   2.

 Exchange-correlation functional for the present dataset will be:
  LDA: new Teter (4/93) with spin-polarized option - ixc=1
 Citation for XC functional:
  S. Goedecker, M. Teter, J. Huetter, PRB 54, 1703 (1996)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.5289350  3.7694824  0.0000000  G(1)=  0.0765822  0.1326442  0.0000000
 R(2)= -6.5289350  3.7694824  0.0000000  G(2)= -0.0765822  0.1326442  0.0000000
 R(3)=  0.0000000  0.0000000 12.2777954  G(3)=  0.0000000  0.0000000  0.0814478
 Unit cell volume ucvol=  6.0433042E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees
 setup1 : take into account q-point for computing boxcut.

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.16976
--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_5o_DS2_WFK
 symkchk : k-point set has full space-group symmetry.

 ==&gt;  initialize data related to q vector &lt;== 

 The list of irreducible perturbations for this q vector is:
    1)    idir= 3    ipert=   7

================================================================================

--------------------------------------------------------------------------------
 Perturbation wavevector (in red.coord.)   0.000000  0.000000  0.000000
 Found    12 symmetries that leave the perturbation invariant.
 symkpt : the number of k-points, thanks to the symmetries,
 is reduced to     8 .

--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_5o_DS2_WFK
--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_5o_DS2_WFK
 Initialisation of the first-order wave-functions :
  ireadwf=   0

     iter   2DEtotal(Ha)        deltaE(Ha) residm    vres2
-ETOT  1   6.9564645294532     -1.475E+01 9.224E+00 1.083E+03
 ETOT  2   3.9215700648309     -3.035E+00 2.249E-03 5.391E+01
 ETOT  3   3.7565637556461     -1.650E-01 5.464E-05 2.350E+00
 ETOT  4   3.7505557022822     -6.008E-03 1.734E-06 5.955E-02
 ETOT  5   3.7504549303448     -1.008E-04 4.028E-08 9.403E-04
 ETOT  6   3.7504530489477     -1.881E-06 9.062E-10 1.429E-05
 ETOT  7   3.7504530230908     -2.586E-08 9.437E-12 1.380E-07
 ETOT  8   3.7504530229165     -1.743E-10 6.688E-14 2.621E-09
 ETOT  9   3.7504530229133     -3.208E-12 1.662E-15 6.657E-11

 At SCF step    9       vres2   =  6.66E-11 &lt; tolvrs=  1.00E-10 =&gt;converged.
-open ddk wf file :telast_5o_DS2_1WF15
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   4.5383E-16; max=  1.6615E-15

 Seventeen components of 2nd-order total energy (hartree) are
 1,2,3: 0th-order hamiltonian combined with 1st-order wavefunctions
     kin0=   1.94255345E+01 eigvalue=   9.98636329E-01  local=  -7.69884791E+00
 4,5,6,7: 1st-order hamiltonian combined with 1st and 0th-order wfs
 loc psp =  -1.78317292E+01  Hartree=   8.13546908E+00     xc=  -1.53606654E+00
     kin1=  -1.83623016E+01
 8,9,10: eventually, occupation + non-local contributions
    edocc=   0.00000000E+00     enl0=   1.85101229E+00   enl1=  -2.93963984E+00
 1-10 gives the relaxation energy (to be shifted if some occ is /=2.0)
   erelax=  -1.79579329E+01
 11,12,13 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.hart=   7.04608276E-01   fr.kin=   1.17316806E+01 fr.loc=  -1.46317503E+00
 14,15,16 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.nonl=   2.54397443E+00    fr.xc=  -5.90180526E-01  Ewald=   7.32916794E+00
 17 Non-relaxation  contributions : pseudopotential core energy
  pspcore=   1.45231024E+00
 Resulting in :
 2DEtotal=    0.3750453023E+01 Ha. Also 2DEtotal=    0.102055016855E+03 eV
    (2DErelax=   -1.7957932860E+01 Ha. 2DEnonrelax=    2.1708385883E+01 Ha)
    (  non-var. 2DEtotal :    3.7504532608E+00 Ha)

================================================================================

 ---- first-order wavefunction calculations are completed ----


 ==&gt; Compute Derivative Database &lt;==

  2nd-order matrix (non-cartesian coordinates, masses not included,
   asr not included )
  cartesian coordinates for strain terms (1/ucvol factor 
   for elastic tensor components not included) 
     j1       j2             matrix element
  dir pert dir pert     real part     imaginary part

   1    1   3    1         0.0000000000         0.0000000000
   1    1   3    2         0.0000000000         0.0000000000
   1    1   3    3         0.0000000000         0.0000000000
   1    1   3    4         0.0000000000         0.0000000000
   1    1   2    6         0.0000000000         0.0000000000
   1    1   3    6         0.0000000000         0.0000000000
   1    1   3    7        -0.0000000001         0.0000000000

   2    1   3    1         0.0000000000         0.0000000000
   2    1   3    2         0.0000000000         0.0000000000
   2    1   3    3         0.0000000000         0.0000000000
   2    1   3    4         0.0000000000         0.0000000000
   2    1   1    6         0.0000000000         0.0000000000
   2    1   3    6         0.0000000000         0.0000000000
   2    1   3    7         0.0000000001         0.0000000000

   3    1   1    1         0.0000000000         0.0000000000
   3    1   2    1         0.0000000000         0.0000000000
   3    1   1    2         0.0000000000         0.0000000000
   3    1   2    2         0.0000000000         0.0000000000
   3    1   1    3         0.0000000000         0.0000000000
   3    1   2    3         0.0000000000         0.0000000000
   3    1   1    4         0.0000000000         0.0000000000
   3    1   2    4         0.0000000000         0.0000000000
   3    1   3    7        -2.2518809665         0.0000000000

   1    2   3    1         0.0000000000         0.0000000000
   1    2   3    2         0.0000000000         0.0000000000
   1    2   3    3         0.0000000000         0.0000000000
   1    2   3    4         0.0000000000         0.0000000000
   1    2   2    6         0.0000000000         0.0000000000
   1    2   3    6         0.0000000000         0.0000000000
   1    2   3    7        -0.0000000001         0.0000000000

   2    2   3    1         0.0000000000         0.0000000000
   2    2   3    2         0.0000000000         0.0000000000
   2    2   3    3         0.0000000000         0.0000000000
   2    2   3    4         0.0000000000         0.0000000000
   2    2   1    6         0.0000000000         0.0000000000
   2    2   3    6         0.0000000000         0.0000000000
   2    2   3    7         0.0000000001         0.0000000000

   3    2   1    1         0.0000000000         0.0000000000
   3    2   2    1         0.0000000000         0.0000000000
   3    2   1    2         0.0000000000         0.0000000000
   3    2   2    2         0.0000000000         0.0000000000
   3    2   1    3         0.0000000000         0.0000000000
   3    2   2    3         0.0000000000         0.0000000000
   3    2   1    4         0.0000000000         0.0000000000
   3    2   2    4         0.0000000000         0.0000000000
   3    2   3    7        -2.2518809660         0.0000000000

   1    3   3    1         0.0000000000         0.0000000000
   1    3   3    2         0.0000000000         0.0000000000
   1    3   3    3         0.0000000000         0.0000000000
   1    3   3    4         0.0000000000         0.0000000000
   1    3   2    6         0.0000000000         0.0000000000
   1    3   3    6         0.0000000000         0.0000000000
   1    3   3    7        -0.0000000001         0.0000000000

   2    3   3    1         0.0000000000         0.0000000000
   2    3   3    2         0.0000000000         0.0000000000
   2    3   3    3         0.0000000000         0.0000000000
   2    3   3    4         0.0000000000         0.0000000000
   2    3   1    6         0.0000000000         0.0000000000
   2    3   3    6         0.0000000000         0.0000000000
   2    3   3    7         0.0000000001         0.0000000000

   3    3   1    1         0.0000000000         0.0000000000
   3    3   2    1         0.0000000000         0.0000000000
   3    3   1    2         0.0000000000         0.0000000000
   3    3   2    2         0.0000000000         0.0000000000
   3    3   1    3         0.0000000000         0.0000000000
   3    3   2    3         0.0000000000         0.0000000000
   3    3   1    4         0.0000000000         0.0000000000
   3    3   2    4         0.0000000000         0.0000000000
   3    3   3    7         2.2518785658         0.0000000000

   1    4   3    1         0.0000000000         0.0000000000
   1    4   3    2         0.0000000000         0.0000000000
   1    4   3    3         0.0000000000         0.0000000000
   1    4   3    4         0.0000000000         0.0000000000
   1    4   2    6         0.0000000000         0.0000000000
   1    4   3    6         0.0000000000         0.0000000000
   1    4   3    7        -0.0000000001         0.0000000000

   2    4   3    1         0.0000000000         0.0000000000
   2    4   3    2         0.0000000000         0.0000000000
   2    4   3    3         0.0000000000         0.0000000000
   2    4   3    4         0.0000000000         0.0000000000
   2    4   1    6         0.0000000000         0.0000000000
   2    4   3    6         0.0000000000         0.0000000000
   2    4   3    7         0.0000000001         0.0000000000

   3    4   1    1         0.0000000000         0.0000000000
   3    4   2    1         0.0000000000         0.0000000000
   3    4   1    2         0.0000000000         0.0000000000
   3    4   2    2         0.0000000000         0.0000000000
   3    4   1    3         0.0000000000         0.0000000000
   3    4   2    3         0.0000000000         0.0000000000
   3    4   1    4         0.0000000000         0.0000000000
   3    4   2    4         0.0000000000         0.0000000000
   3    4   3    7         2.2518785657         0.0000000000

   1    6   2    1         0.0000000000         0.0000000000
   1    6   2    2         0.0000000000         0.0000000000
   1    6   2    3         0.0000000000         0.0000000000
   1    6   2    4         0.0000000000         0.0000000000
   1    6   3    6         0.0000000000         0.0000000000

   2    6   1    1         0.0000000000         0.0000000000
   2    6   1    2         0.0000000000         0.0000000000
   2    6   1    3         0.0000000000         0.0000000000
   2    6   1    4         0.0000000000         0.0000000000
   2    6   3    6         0.0000000000         0.0000000000

   3    6   1    1         0.0000000000         0.0000000000
   3    6   2    1         0.0000000000         0.0000000000
   3    6   1    2         0.0000000000         0.0000000000
   3    6   2    2         0.0000000000         0.0000000000
   3    6   1    3         0.0000000000         0.0000000000
   3    6   2    3         0.0000000000         0.0000000000
   3    6   1    4         0.0000000000         0.0000000000
   3    6   2    4         0.0000000000         0.0000000000
   3    6   1    6         0.0000000000         0.0000000000
   3    6   2    6         0.0000000000         0.0000000000
   3    6   3    7        -4.0301867956         0.0000000000

   1    7   3    7         0.4332108824         0.0000000000

   2    7   3    7         0.4332108828         0.0000000000

   3    7   3    7         3.7504532608         0.0000000000

   1    8   3    7         0.0000000000         0.0000000000

   2    8   3    7         0.0000000000         0.0000000000

   3    8   3    7        -0.0000000003         0.0000000000


  Rigid-atom elastic tensor , in cartesian coordinates,
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    7   3    7         0.0007168444         0.0000000000

   2    7   3    7         0.0007168444         0.0000000000

   3    7   3    7         0.0062059647         0.0000000000

   1    8   3    7         0.0000000000         0.0000000000

   2    8   3    7         0.0000000000         0.0000000000

   3    8   3    7        -0.0000000000         0.0000000000

  Internal strain coupling parameters, in cartesian coordinates,
   zero average net force deriv. has been imposed  
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    1   3    7         0.0000000000         0.0000000000

   2    1   3    7        -0.0000000000         0.0000000000

   3    1   3    7         0.1834107588         0.0000000000

   1    2   3    7        -0.0000000000         0.0000000000

   2    2   3    7         0.0000000000         0.0000000000

   3    2   3    7         0.1834107588         0.0000000000

   1    3   3    7         0.0000000000         0.0000000000

   2    3   3    7        -0.0000000000         0.0000000000

   3    3   3    7        -0.1834107588         0.0000000000

   1    4   3    7         0.0000000000         0.0000000000

   2    4   3    7        -0.0000000000         0.0000000000

   3    4   3    7        -0.1834107588         0.0000000000

  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
  (from strain response)
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   3    6   3    7        -0.0130314050         0.0000000000

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      7.5389648144E+00  7.5389648144E+00  1.2277795374E+01 Bohr
              amu      2.69815390E+01  7.49215900E+01
         berryopt1          0
         berryopt2         -2
         berryopt3          0
           diemac      9.00000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
           etotal1    -2.0270943773E+01
           etotal3     3.7504530229E+00
            fcart1    -0.0000000000E+00 -0.0000000000E+00  7.9071299709E-08
                      -0.0000000000E+00 -0.0000000000E+00  7.9071299709E-08
                      -0.0000000000E+00 -0.0000000000E+00 -7.9071299709E-08
                      -0.0000000000E+00 -0.0000000000E+00 -7.9071299709E-08
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
           getddk1          0
           getddk2          0
           getddk3         -1
           getden1          0
           getden2         -1
           getden3          0
           getwfk1          0
           getwfk2         -1
           getwfk3         -1
             iscf1          7
             iscf2         -2
             iscf3          7
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
              kpt2     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -3.75000000E-01
                       2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       5.00000000E-01  0.00000000E+00 -3.75000000E-01
                      -2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       0.00000000E+00  2.50000000E-01 -3.75000000E-01
                       2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       5.00000000E-01  2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  5.00000000E-01 -3.75000000E-01
                       2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       5.00000000E-01  5.00000000E-01 -3.75000000E-01
                      -2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       0.00000000E+00 -2.50000000E-01 -3.75000000E-01
                       2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       5.00000000E-01 -2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -1.25000000E-01
                       2.50000000E-01  0.00000000E+00 -1.25000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       outvar_i_n : Printing only first  50 k-points.
           kptopt1          1
           kptopt2          3
           kptopt3          2
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      3.01558593E+01
P           mkmem1          8
P           mkmem2         64
P           mkmem3         32
P          mkqmem1          8
P          mkqmem2         64
P          mkqmem3         32
P          mk1mem1          8
P          mk1mem2         64
P          mk1mem3         32
            natom           4
            nband1          8
            nband2          8
            nband3          8
           nbdbuf1          0
           nbdbuf2          2
           nbdbuf3          0
           ndtset           3
            ngfft          18      18      30
             nkpt1          8
             nkpt2         64
             nkpt3         32
             nqpt1          0
             nqpt2          0
             nqpt3          1
            nstep          40
             nsym          12
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
        optdriver1          0
        optdriver2          0
        optdriver3          1
        optforces           1
            rfdir1          0       0       0
            rfdir2          0       0       1
            rfdir3          0       0       1
           rfstrs1          0
           rfstrs2          0
           rfstrs3          1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           strten1    -3.8006435932E-10 -3.8006435716E-10  7.7560471717E-10
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000    -0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000     0.0000000 -0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                      -0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000 -0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
           tolvrs1     1.00000000E-18
           tolvrs2     0.00000000E+00
           tolvrs3     1.00000000E-10
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-20
           tolwfr3     0.00000000E+00
            typat      1  1  2  2
              wtk1       0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
              wtk2       0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563
              wtk3       0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125
                       outvars : Printing only first  50 k-points.
           xangst     -1.1516545412E+00  1.9947241781E+00 -7.2132627467E-16
                       1.1516545412E+00  1.9947241781E+00  3.2485647418E+00
                      -1.1516545412E+00  1.9947241781E+00  2.4434786836E+00
                       1.1516545412E+00  1.9947241781E+00  5.6920434254E+00
            xcart     -2.1763116825E+00  3.7694824072E+00 -1.3631091116E-15
                       2.1763116825E+00  3.7694824072E+00  6.1388976870E+00
                      -2.1763116825E+00  3.7694824072E+00  4.6175055235E+00
                       2.1763116825E+00  3.7694824072E+00  1.0756403210E+01
             xred      3.3333333333E-01  6.6666666667E-01 -1.1102230246E-16
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7608588373E-01
                       6.6666666667E-01  3.3333333333E-01  8.7608588373E-01
            znucl       13.00000   33.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://www.abinit.org/about/?text=acknowledgments.
-
- [1] Metric tensor formulation of strain in density-functional perturbation theory, 
- D. R. Hamann, X. Wu, K. M. Rabe, and D. Vanderbilt, Phys. Rev. B71, 035117 (2005).
- Comment : Non-vanishing rfstrs. Strong suggestion to cite this paper in your publications.
-
- [2] ABINIT : First-principles approach of materials and nanosystem properties.
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Computer Phys. Comm. 180, 2582-2615 (2009).
- Comment : the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/about/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
-
- [3] A brief introduction to the ABINIT software package.
- X. Gonze, G.-M. Rignanese, M. Verstraete, J.-M. Beuken, Y. Pouillon, R. Caracas, F. Jollet,
- M. Torrent, G. Zerah, M. Mikami, Ph. Ghosez, M. Veithen, J.-Y. Raty, V. Olevano, F. Bruneval,
- L. Reining, R. Godby, G. Onida, D.R. Hamann, and D.C. Allan.
- Z. Kristallogr. 220, 558-562 (2005).
- Comment : the second generic paper describing the ABINIT project. Note that this paper
- should be cited especially if you are using the GW part of ABINIT, as several authors
- of this part are not in the list of authors of the first or third paper.
- The .pdf of the latter paper is available at https://www.abinit.org/about/zfk_0505-06_558-562.pdf.
- Note that it should not redistributed (Copyright by Oldenburg Wissenshaftverlag,
- the licence allows the authors to put it on the Web).
-
- And optionally:
-
- [4] First-principles computation of material properties : the ABINIT software project. 
- X. Gonze, J.-M. Beuken, R. Caracas, F. Detraux, M. Fuchs, G.-M. Rignanese, L. Sindic,
- M. Verstraete, G. Zerah, F. Jollet, M. Torrent, A. Roy, M. Mikami, Ph. Ghosez, J.-Y. Raty, D.C. Allan.
- Computational Materials Science 25, 478-492 (2002). http://dx.doi.org/10.1016/S0927-0256(02)00325-7
- Comment : the original paper describing the ABINIT project.
-
- [5] Fast radix 2, 3, 4 and 5 kernels for Fast Fourier Transformations
- on computers with overlapping multiply-add instructions.
- S. Goedecker, SIAM J. on Scientific Computing 18, 1605 (1997).
-
- Proc.   0 individual time (sec): cpu=         26.8  wall=          6.6

================================================================================

 Calculation completed.
.Delivered  13 WARNINGs and   2 COMMENTs to log file.
+Overall time at end (sec) : cpu=         26.8  wall=          6.6

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-3d9bea8f-bc50-44bf-b81e-7b9cc9f0688b", "#uuid-bf0f1dbf-b09e-4b52-8f39-ffabd2d5b751") }); </script>

<p>We immediately see a problem &ndash; this output, like most of the .out file, is in
atomic units, while we computed our numerical derivative in conventional C/m^2
units. While you might think to simply run anaddb to do the conversion as
before, its present version is not happy with such an incomplete DDB file as
telast_5 has generated and will not produce the desired result. While it
should be left as an exercise to the student to dig the conversion factor out
of the literature, or better yet out of the source code, we will cheat and
tell you that 1a.u.=57.2147606 C/m^2 Thus the new RF result for the 3,3 rigid-
ion piezoelectric constant is -0.7455887 C/m^2 compared to the result found in
section 4 by a completely-GS finite difference calculation, -0.745589 C/m^2.
The agreement is now excellent!</p>
<p>The fully RF calculation in section 2 in fact will converge much more rapidly
with <strong>k</strong> sample than the partial-finite-difference method introduced here.
Is it worthwhile to have learned how to do this? We believe that is always
pays to have alternative ways to test results, and besides, this didn&rsquo;t take
much time. (Have you found the conversion factor on your own yet?)  </p>
<h2 id="6-response-function-calculation-of-the-elastic-constants-of-al-metal">6 Response-function calculation of the elastic constants of Al metal<a class="headerlink" href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" title="Permanent link">&para;</a></h2>
<p>For metals, the existence of partially occupied bands is a complicating
feature for RF as well as GS calculations.<br />
Now would be a good time to review <a href="../base4">lesson 4</a> which dealt in detail with the interplay between
<strong>k</strong>-sample convergence and Fermi-surface broadening, especially <a class="wikilink lesson-wikilink" href="../base4#3">section 3</a>.
You should copy telast_6.in and telast_6.files into Work_elast, and begin your run 
while you read on, since it involves a convergence study with multiple datasets and may take about two minutes.  </p>
<div class="text-center"><button type="button" id="uuid-1f5c215d-cfa1-4928-b0dd-3371ce90332d" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/telast_6.in
</button></div>

<div id="uuid-8b972098-8c02-43b0-85da-2ab6ef69fdce" class="my_dialog" title="tests/tutorespfn/Input/telast_6.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#Al fcc metal - elastic constant calculation</span>

   ndtset   <span class="m">12</span>        <span class="c1"># Total number of datasets (3*4)</span>
   udtset   <span class="m">3</span>  <span class="m">4</span>      <span class="c1"># Double loop for k-sample convergence study</span>

<span class="c1"># Set 1 : Initial self-consistent and lattice optimization run</span>

  getwfk?1   <span class="m">0</span>
  ionmov?1   <span class="m">2</span>        <span class="c1"># Broyden lattice optimization scheme</span>
   ntime?1   <span class="m">5</span>        <span class="c1"># Maximim lattice optimization steps</span>
 optcell?1   <span class="m">1</span>        <span class="c1"># Optimize cell volume only</span>
 strfact?1   <span class="m">100</span>      <span class="c1"># Test convergence of stresses (Hartree/bohr^3) by</span>
                      <span class="c1"># multiplying by this factor and applying force</span>
                      <span class="c1"># convergence test</span>
  tolmxf?1   <span class="m">1</span>.0e-6   <span class="c1"># Convergence limit for forces as above</span>
  tolvrs?1   <span class="m">1</span>.0d-18  <span class="c1"># Need excellent convergence of GS quantities for RF runs</span>

<span class="c1"># Set 2 : Additional iteration to print density just at converged acell</span>

  prtden?2   <span class="m">1</span>        <span class="c1"># Third dataset needs density</span>
  tolvrs?2   <span class="m">1</span>.0d-18

<span class="c1"># Set 3 : Converge unoccupied wave functions</span>

  getden?3   -1       <span class="c1"># Use density from previout set</span>
  tolwfr?3   <span class="m">5</span>.0d-19  <span class="c1"># Only wave function convergence can be used with</span>
                      <span class="c1"># non-self-consistent calculation</span>
  tolwfr23   <span class="m">1</span>.0d-30  <span class="c1"># This is simply for a reason of portability of automatic tests </span>
  nstep23    <span class="m">6</span>        <span class="c1"># This is simply for a reason of portability of automatic tests</span>
  nstep33    <span class="m">20</span>       <span class="c1"># This is simply for a reason of portability of automatic tests</span>

<span class="c1"># Set 4 : response-function calculations for all needed perturbations</span>

  kptopt?4   <span class="m">2</span>        <span class="c1"># Time-reversal only for RF calculation</span>
    nqpt?4   <span class="m">1</span>
     qpt?4   <span class="m">0</span>  <span class="m">0</span>  <span class="m">0</span>  <span class="c1"># By symmetry, only need one direction</span>
   rfdir?4   <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span>
  rfstrs?4   <span class="m">3</span>        <span class="c1"># Need both unaxial and shear strains</span>
  tolvrs?4   <span class="m">1</span>.0d-12  <span class="c1"># Need reasonable convergence of 1st-order quantities</span>

<span class="c1">#Common input data</span>

<span class="c1">#Double loop data passing</span>

getcell   -1         <span class="c1"># Start from optimized (datasets ?2-?4) or previously</span>
                     <span class="c1"># optimized (datasets ?1) acell</span>
 getwfk   -1         <span class="c1"># Use last set of wave functions (except datasets ?1)</span>


<span class="c1">#Lattice definition</span>
  acell   <span class="m">3</span>*7.60     <span class="c1"># Starting value</span>
dilatmx   <span class="m">1</span>.05       <span class="c1"># Allow for optimization</span>
  rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5
          <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
          <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1">#Definition of the atom types and atoms</span>
 ntypat   <span class="m">1</span> 
  znucl   <span class="m">13</span>
  natom   <span class="m">1</span>
  typat   <span class="m">1</span>

<span class="c1">#Atomic position</span>
   xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0

<span class="c1">#Definition of the plane wave basis set</span>
   ecut   <span class="m">8</span>.0            <span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
 ecutsm   <span class="m">0</span>.5            <span class="c1"># Smoothing energy needed for lattice parameter</span>
                         <span class="c1"># optimization.  This will be retained for</span>
                         <span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid - loop over 3 k-point densities</span>

ngkpt1?   <span class="m">6</span>  <span class="m">6</span>  <span class="m">6</span>          
ngkpt2?   <span class="m">8</span>  <span class="m">8</span>  <span class="m">8</span>          
ngkpt3?   <span class="m">10</span> <span class="m">10</span> <span class="m">10</span>

nshiftk   <span class="m">4</span>              <span class="c1"># Use one copy of grid only (default)</span>
 shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This gives the usual fcc Monkhorst-Pack grid</span>
          <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
          <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
          <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Definition of occupation numbers and number of bands</span>
  nband   <span class="m">4</span>              <span class="c1"># With metallic occup</span>
 occopt   <span class="m">3</span>              <span class="c1"># Femi-function smearing</span>
 tsmear   <span class="m">0</span>.02

<span class="c1">#Definition of the self-consistency procedure</span>
  nstep   <span class="m">25</span>             <span class="c1"># Maximum number of SCF iterations</span>
                         <span class="c1"># This might not be enough for the very demanding tolwfr?3 above,</span>
                         <span class="c1"># but was chosen for portability reasons.</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
 optforces <span class="m">1</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_6.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -medium</span>
<span class="c1">#%% psp_files =  13al.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =  Al fcc metal - elastic constant calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8b972098-8c02-43b0-85da-2ab6ef69fdce", "#uuid-1f5c215d-cfa1-4928-b0dd-3371ce90332d") }); </script>

<p>While the run is in progress, edit telast_6.in.  As in t43.in, we will set
<a class="wikilink codevar-wikilink" href="../../variables/basic#udtset">udtset</a> to specify a double loop.  In the present case, however, the outer
loop will be over 3 successively larger meshes of <strong>k</strong> points, while the
inner loop will be successively  </p>
<ol>
<li>GS self-consistent runs with optimization of acell.</li>
<li>GS density-generating run for the next step.</li>
<li>Non-self-consistent GS run to converge unoccupied or slightly-occupied bands.</li>
<li>RF run for symmetry-inequivalent elastic constants.</li>
</ol>
<p>In Section 1, we did a separate GS structural optimization run and
transferred the results by hand to RF  run section 2.  Because we are doing a
convergence test here, we have combined these steps, and use <a class="wikilink codevar-wikilink" href="../../variables/rlx#getcell">getcell</a> to
transfer the optimized coordinates from the first dataset of the inner loop
forward to the rest.  If we were doing a more complicated structure with
internal coordinates that were also optimized, we would need to use both this
and <a class="wikilink codevar-wikilink" href="../../variables/rlx#getxred">getxred</a> to transfer these, as in telast_1.in.  </p>
<p>The specific data for inner-loop dataset 1 is very similar to that for telast_1.in.<br />
Inner-loop dataset 2 is a bit of a hack.  We need the density
for inner-loop dataset 3, and while we could set <a class="wikilink codevar-wikilink" href="../../variables/files#prtden">prtden</a> = 1 in dataset 1,
this would produce a separate density file for every step in the structural
optimization, and it isn&rsquo;t clear how to automatically pick out the last one.
So, dataset 2 picks up the wave functions from dataset 1 (only one file of
these is produced, for the optimized structure), does one more iteration with
fixed geometry, and writes a density file.  </p>
<p>Inner-loop dataset 3 is a non-self-consistent run whose purpose is to ensure
that all the wave functions specified by <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> are well converged. For
metals, we have to specify enough bands to make sure that the Fermi surface is
properly calculated.  Bands above the  Fermi level which have small occupancy
or near-zero occupancy if their energies exceed the Fermi energy by more than
a few times <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a>, will have very little effect on the self-consistent
potential, so the <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> test in dataset 1 doesn&rsquo;t ensure their
convergence.  Using <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a> in inner-loop dataset 3 does.  Partially-
occupied or unoccupied bands up to <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>   play a different role in
constructing the first-order wave functions than do the many unoccupied bands
beyond <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> which aren&rsquo;t explicitly treated in Abinit, as discussed in
S. de Gironcoli, Phys. Rev. B 51, 6773 (1995).  By setting <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> exactly
equal to the number of occupied bands for RF calculations for semiconductors
and insulators, we avoid having to deal with the issue of converging
unoccupied bands.  Could we avoid the extra steps by simply using <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>
instead of <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> in dataset 1?  Perhaps, but experience has shown that
this does not necessarily lead to as well-converged a potential, and it is not
recommended.  These same considerations apply to phonon calculations for
metals, or in particular to <a class="wikilink codevar-wikilink" href="../../variables/gstate#qpt">qpt</a>= 0 0 0 phonon calculations for the
interatomic force constants needed to find atom-relaxation contributions to
the elastic constants for non-trivial structures as in section 2 and section 3.  </p>
<p>The data specific to the elastic-tensor RF calculation in inner-loop dataset 4
should by now be familiar.  We take advantage of the fact that for cubic
symmetry the only symmetry-inequivalent elastic constants are C 11, C 12 , and
C 44 .  Abinit, unfortunately, does not do this analysis automatically, so we
specify <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>=1 0 0 to avoid duplicate calculations.  (Note that if atom
relaxation is to be taken into account  for a more complex structure, the full
set of directions must be used.)  </p>
<p>When the telast_6 calculations finish, first look at telast_6.log as usual to
make sure they have run to completion without error.  Next, it would be a good
idea to look at the band occupancies occ?? (where ?? is a dual-loop dataset
index) reported at the end (following  <mark>END DATASET(S)</mark>).  The highest band,
the fourth in this case, should have zero or very small occupation, or you
need to increase <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> or decrease <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a> .  Now, use your newly
perfected knowledge of the Abinit perturbation indexing conventions to scan
through telast_6.out and find C 11 , C12 , and C 44 for each of the three
<strong>k</strong> -sample choices, which will be  under the &rdquo; Rigid-atom elastic tensor&rdquo;
heading.  Also find the lattice constants for each case, whose convergence you
studied in lesson 4.  You should be able to cut-and-paste these into a table
like the following,  </p>
<div class="codehilite"><pre><span></span>            C_11           C_12           C_44           acell
ngkpt=3*6   0.0037773556   0.0022583541   0.0013453692   7.5710952266
ngkpt=3*8   0.0042004431   0.0020423388   0.0013076763   7.5693986665
ngkpt=3*10  0.0042034396   0.0020343437   0.0012956768   7.5694820855
</pre></div>


<p>We can immediately see that the lattice constant converges considerably more
rapidly with <strong>k</strong> sample than the elastic constants.   For <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> =3*6,
acell is converged to 0.02%, while the C&rsquo;s have 5-10% errors.  For <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>
=3*8, the C&rsquo;s are converged to better than 1%, much better for the largest,
C11, which should be acceptable.</p>
<p>As in lesson 4, the <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> convergence is controlled by <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a>.  The
smaller the broadening, the denser the <strong>k</strong> sample that is needed to get a
smooth variation of occupancy, and presumably stress, with strain.   While we
will not explore <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a> convergence in this lesson, you may wish to do so
on your own.  We believe that the value <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a> = 0.02  in telast_6.in
gives results within 1% of the fully-converged small-broadening limit.</p>
<p><strong>We find that<a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a></strong> <strong>=3, standard Fermi-Dirac broadening</strong> <strong>, gives
<em>much better</em> convergence of the C&rsquo;s than &ldquo;cold smearing.&rdquo;</strong>  Changing
<a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a> to 4 in telast_6.in, the option used in lesson 4, the C&rsquo;s show no
sign of convergence.  At ngkpt=3*16, errors are still ~5%.  The reasons that
this supposedly superior smoothing function performs so poorly in this context
is a future research topic.  The main thing to be learned is that checking
convergence with respect to all relevant parameters is <strong>always</strong> the user&rsquo;s
responsibility.   Simple systems that include the main physical features of a
complex system of interest will usually suffice for this testing.  Don&rsquo;t get
caught publishing a result that another researcher refutes on convergence
grounds, and don&rsquo;t blame such a mistake on Abinit!</p>
<p>Now we make a comparison with experiment.  Converting the C&rsquo;s to standard
units (Ha/Bohr^3 = 2.94210119E+04 GPa) and using zero-temperature extrapolated
experimental results from P. M. Sutton, Phys. Rev. 91, 816 (1953), we find  </p>
<div class="codehilite"><pre><span></span>                     C_11(GPa)  C_12(GPa)  C_44(GPa)
     Calculated        123.7      59.9       38.1
     Experiment (T=0)  123.0      70.8       30.9
</pre></div>


<p>Is this good agreement?  There isn&rsquo;t much literature on DFT calculations of
full sets of elastic constants.  Many calculations of the bulk modulus
(K=(C11+2C 12 )/3 in the cubic case) typically are within 10% of experiment
for the LDA.  Running telast_6 with ixc=11, the Perdew-Burke-Enzerhof GGA,
increases the calculated C&rsquo;s by 1-2%, and wouldn&rsquo;t be expected to make a large
difference for a nearly-free-electron metal.  </p>
<h3 id="comment-on-symmetry">Comment on symmetry<a class="headerlink" href="#comment-on-symmetry" title="Permanent link">&para;</a></h3>
<p>It is important to bear in mind that the way a tensor like the elastic tensor
appears is a function of the frame used. Thus for the aluminum fcc case
considered above, the nonzero elements are <em>C 11</em>, <em>C 12</em>, and <em>C 44</em>,
<em>provided that the crystal axes are aligned with the laboratory frame.</em> 
For an arbitrary alignment of the crystal axes, many more <em>C ij</em> elements will be
non-zero, and this can be confusing. </p>
<p>It&rsquo;s easy to see why this happens if you
imagine actually measuring the elastic tensor elements. If you start with the
conventional cubic cell, and apply pressure to one face, you can measure <em>C
11</em>. But if you turn the cell to some random angle, you&rsquo;ll measure a response
that is a mixture of <em>C 11</em> and <em>C 12</em>. </p>
<p>Within ABINIT, if the aluminum fcc
cell is described using <a class="wikilink codevar-wikilink" href="../../variables/basic#angdeg">angdeg</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a>, then an axis of the
primitive cell will be aligned along the laboratory <em>z</em> axis but this will not
lead to a (conventional) cell alignment with the laboratory frame. The
resulting elastic tensor will be correct but will appear to be more
complicated than in the illustration above. It can be rotated back to a simple
frame by hand (bearing in mind that all four indices of the fourth-rank
elastic tensor have to be rotated!) but it&rsquo;s easier to start with a more
conventional alignment of the unit cell. </p>
<p>If you use a standard text like
Bradley and Cracknell, The Mathematical Theory of Symmetry in Solids, Oxford
you can find the standard primitive cell descriptions for the Bravais lattice
types and these are aligned as much as possible with a standard laboratory frame.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../rf2/" title="RF2" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                RF2
              </span>
            </div>
          </a>
        
        
          <a href="../ffield/" title="Ffield" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Ffield
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (DRH)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>