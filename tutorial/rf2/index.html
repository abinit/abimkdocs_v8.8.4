



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/rf2/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>RF2 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#second-lesson-on-dfpt" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  DFPT
                </span>
              
            
            RF2
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" checked>
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        RF2
      </label>
    
    <a href="./" title="RF2" class="md-nav__link md-nav__link--active">
      RF2
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#phonon-band-structures-thermodynamical-properties" title="Phonon band structures, thermodynamical properties." class="md-nav__link">
    Phonon band structures, thermodynamical properties.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-generation-of-a-derivative-database" title="1 Generation of a derivative database" class="md-nav__link">
    1 Generation of a derivative database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-manipulation-of-the-derivative-databases-the-mrgddb-utility" title="2 Manipulation of the derivative databases (the MRGDDB utility)" class="md-nav__link">
    2 Manipulation of the derivative databases (the MRGDDB utility)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-analysis-of-the-derivative-databases" title="3 Analysis of the derivative databases" class="md-nav__link">
    3 Analysis of the derivative databases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-computation-of-interatomic-force-constants" title="4 The computation of interatomic force constants" class="md-nav__link">
    4 The computation of interatomic force constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-efficient-computation-of-phonon-band-structures" title="5 The efficient computation of phonon band structures" class="md-nav__link">
    5 The efficient computation of phonon band structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-thermodynamical-properties" title="6 Thermodynamical properties" class="md-nav__link">
    6 Thermodynamical properties
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#phonon-band-structures-thermodynamical-properties" title="Phonon band structures, thermodynamical properties." class="md-nav__link">
    Phonon band structures, thermodynamical properties.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-generation-of-a-derivative-database" title="1 Generation of a derivative database" class="md-nav__link">
    1 Generation of a derivative database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-manipulation-of-the-derivative-databases-the-mrgddb-utility" title="2 Manipulation of the derivative databases (the MRGDDB utility)" class="md-nav__link">
    2 Manipulation of the derivative databases (the MRGDDB utility)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-analysis-of-the-derivative-databases" title="3 Analysis of the derivative databases" class="md-nav__link">
    3 Analysis of the derivative databases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-computation-of-interatomic-force-constants" title="4 The computation of interatomic force constants" class="md-nav__link">
    4 The computation of interatomic force constants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-efficient-computation-of-phonon-band-structures" title="5 The efficient computation of phonon band structures" class="md-nav__link">
    5 The efficient computation of phonon band structures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-thermodynamical-properties" title="6 Thermodynamical properties" class="md-nav__link">
    6 Thermodynamical properties
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/rf2.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="second-lesson-on-dfpt">Second lesson on DFPT<a class="headerlink" href="#second-lesson-on-dfpt" title="Permanent link">&para;</a></h1>
<h2 id="phonon-band-structures-thermodynamical-properties">Phonon band structures, thermodynamical properties.<a class="headerlink" href="#phonon-band-structures-thermodynamical-properties" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to get the following physical properties, for periodic solids:</p>
<ul>
<li>Interatomic forces constants </li>
<li>Phonon band structures </li>
<li>Thermodynamical properties </li>
</ul>
<p>The calculations will be based on density-functional perturbation theory (DFPT).</p>
<p>This lesson should take about 1 hour.</p>
<h2 id="1-generation-of-a-derivative-database">1 Generation of a derivative database<a class="headerlink" href="#1-generation-of-a-derivative-database" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not create &ldquo;Work_rf2&rdquo; in ~abinit/tests/tutorespfn/Input?</em></p>
<p>This tutorial starts by the generation of a database, that might be quite time-consuming.
We suggest you to start immediately this computation&hellip;
Copy the files ~abinit/tests/tutorespfn/Input/trf2_1.files and
~abinit/tests/tutorespfn/Input/trf2_1.in in &ldquo;Work_rf2&rdquo;.
Issue now:</p>
<div class="codehilite"><pre><span></span>abinit &lt; trf2_1.files &gt;&amp; log &amp;
</pre></div>


<p>It takes about 3-5 minutes to be completed on a PC 2.8 GHz &hellip;</p>
<p>In order to do interatomic force constant calculations, and to compute
associated phonon band structure and thermodynamical properties, you should
first have some theoretical background.<br />
Let us assume that you have read the litterature relative to the <a href="../rf1">first lesson on DFPT</a>. 
You might find additional material, related to the present section, in 
<a class="wikilink citation-wikilink" data-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1997a">[Gonze1997a]</a> -especially section IX-, <a class="wikilink citation-wikilink" data-content="Ab initiocalculation of the thermodynamic properties and atomic temperature factors ofSiO2α-quartz and stishovite" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lee1995">[Lee1995]</a> and <a class="wikilink citation-wikilink" data-content="Phonons and related crystal properties from density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#baroni2001">[Baroni2001]</a>.</p>
<p>If you haven&rsquo;t read parts of these references, you should take the time to get and read them now.</p>
<p>In short, the idea is that, in order to compute properties for which the
phonon frequencies are needed in all the Brillouin zone, one can use an
elaborate Fourier interpolation, so that only few dynamical matrices need to
be computed directly. Others will be computed by interpolation.
A schematic representation of the different steps required to compute the 
dynamical matrix in the IBZ and post-process the results with anaddb is given below.</p>
<p><img alt="" src="../rf2_assets/ph_dde_workflow.png" /></p>
<p>Let us have a look at the input file trf2_1.in. </p>
<div class="text-center"><button type="button" id="uuid-28aea86e-d4cc-4551-8eaa-f981d73cc665" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_1.in
</button></div>

<div id="uuid-6dca08cb-7f16-4887-bfc5-05f7ac316594" class="my_dialog" title="tests/tutorespfn/Input/trf2_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline AlAs : computation of the phonon spectrum</span>

   ndtset   <span class="m">10</span>
<span class="c1">#Set 1 : ground state self-consistency</span>

  getwfk1   <span class="m">0</span>            <span class="c1"># Cancel default</span>
  kptopt1   <span class="m">1</span>            <span class="c1"># Automatic generation of k points, taking</span>
                         <span class="c1"># into account the symmetry</span>
    nqpt1   <span class="m">0</span>            <span class="c1"># Cancel default</span>
  tolvrs1   <span class="m">1</span>.0d-18      <span class="c1"># SCF stopping criterion (modify default)</span>
  rfphon1   <span class="m">0</span>            <span class="c1"># Cancel default</span>

<span class="c1">#Q vectors for all datasets</span>

<span class="c1">#Complete set of symmetry-inequivalent qpt chosen to be commensurate</span>
<span class="c1"># with kpt mesh so that only one set of GS wave functions is needed.</span>
<span class="c1">#Generated automatically by running GS calculation with kptopt=1,</span>
<span class="c1"># nshift=0, shiftk=0 0 0 (to include gamma) and taking output kpt set</span>
<span class="c1"># file as qpt set. Set nstep=1 so only one iteration runs.</span>

     nqpt   <span class="m">1</span>            <span class="c1"># One qpt for each dataset (only 0 or 1 allowed)</span>
                         <span class="c1"># This is the default for all datasets and must</span>
                         <span class="c1">#  be explicitly turned off for dataset 1.</span>

     qpt2   <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt3   <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt4   <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt5   <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
     qpt6   <span class="m">2</span>.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt7   <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt8  -2.50000000E-01  <span class="m">2</span>.50000000E-01  <span class="m">0</span>.00000000E+00
     qpt9   <span class="m">5</span>.00000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">0</span>.00000000E+00
     qpt10 -2.50000000E-01  <span class="m">5</span>.00000000E-01  <span class="m">2</span>.50000000E-01

<span class="c1">#Set 2 : Response function calculation of d/dk wave function </span>

    iscf2   -3         <span class="c1"># Need this non-self-consistent option for d/dk</span>
  kptopt2   <span class="m">2</span>          <span class="c1"># Modify default to use time-reversal symmetry</span>
  rfphon2   <span class="m">0</span>          <span class="c1"># Cancel default</span>
  rfelfd2   <span class="m">2</span>          <span class="c1"># Calculate d/dk wave function only</span>
  tolwfr2   <span class="m">1</span>.0d-22    <span class="c1"># Use wave function residual criterion instead</span>

<span class="c1">#Set 3 : Response function calculation of Q=0 phonons and electric field pert.</span>

  getddk3   <span class="m">2</span>          <span class="c1"># d/dk wave functions from last dataset</span>
  kptopt3   <span class="m">2</span>          <span class="c1"># Modify default to use time-reversal symmetry</span>
  rfelfd3   <span class="m">3</span>          <span class="c1"># Electric-field perturbation response only</span>

<span class="c1">#Sets 4-10 : Finite-wave-vector phonon calculations (defaults for all datasets)</span>

   getwfk   <span class="m">1</span>          <span class="c1"># Use GS wave functions from dataset1</span>
   kptopt   <span class="m">3</span>          <span class="c1"># Need full k-point set for finite-Q response</span>
   rfphon   <span class="m">1</span>          <span class="c1"># Do phonon response</span>
  rfatpol   <span class="m">1</span> <span class="m">2</span>        <span class="c1"># Treat displacements of all atoms</span>
    rfdir   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>      <span class="c1"># Do all directions (symmetry will be used)</span>
   tolvrs   <span class="m">1</span>.0d-8     <span class="c1"># This default is active for sets 3-10</span>

<span class="c1">#######################################################################</span>
<span class="c1">#Common input variables</span>

<span class="c1">#Definition of the unit cell</span>
    acell   <span class="m">3</span>*10.61         <span class="c1"># This is equivalent to   10.61 10.61 10.61</span>
    rprim   <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># In lessons 1 and 2, these primitive vectors </span>
            <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   <span class="c1"># (to be scaled by acell) were 1 0 0  0 1 0  0 0 1 </span>
            <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0   <span class="c1"># that is, the default.</span>

<span class="c1">#Definition of the atom types</span>
   ntypat   <span class="m">2</span>         <span class="c1"># There are two types of atom</span>
    znucl   <span class="m">13</span> <span class="m">33</span>     <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the </span>
                      <span class="c1"># possible type(s) of atom. The pseudopotential(s) </span>
                      <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                      <span class="c1"># to the type(s) of atom. Here, type 1 is the Aluminum,</span>
                      <span class="c1"># type 2 is the Arsenic.</span>

<span class="c1">#Definition of the atoms</span>
    natom   <span class="m">2</span>         <span class="c1"># There are two atoms</span>
    typat   <span class="m">1</span> <span class="m">2</span>       <span class="c1"># The first is of type 1 (Al), the second is of type 2 (As).</span>

     xred   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
            <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25  

<span class="c1">#Gives the number of band, explicitely (do not take the default)</span>
    nband   <span class="m">4</span>         

<span class="c1">#Exchange-correlation functional</span>

      ixc   <span class="m">1</span>             <span class="c1"># LDA Teter Pade parametrization</span>

<span class="c1">#Definition of the planewave basis set</span>

     ecut   <span class="m">3</span>.0           <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1">#Definition of the k-point grid</span>
    ngkpt   <span class="m">4</span>  <span class="m">4</span>  <span class="m">4</span>          
  nshiftk   <span class="m">4</span>              <span class="c1"># Use one copy of grid only (default)</span>
   shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="c1"># This gives the usual fcc Monkhorst-Pack grid</span>
            <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
            <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
            <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5

<span class="c1">#Definition of the SCF procedure</span>
    nstep   <span class="m">25</span>         <span class="c1"># Maximal number of SCF cycles</span>
   diemac   <span class="m">9</span>.0        <span class="c1"># Although this is not mandatory, it is worth to</span>
                       <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                       <span class="c1"># function used as the standard preconditioner</span>
                       <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                       <span class="c1"># The dielectric constant of AlAs is smaller that the one of Si (=12).</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = trf2_1.in, trf2_3.in, trf2_4.in, trf2_5.in, trf2_6.in, trf2_7.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   trf2_1.out, tolnlines= 14, tolabs=  5.000e-05, tolrel=  5.000e-04, fld_options=-medium</span>
<span class="c1">#%% psp_files =  13al.981214.fhi, 33as.pspnc </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =  Crystalline AlAs : computation of the phonon spectrum</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-6dca08cb-7f16-4887-bfc5-05f7ac316594", "#uuid-28aea86e-d4cc-4551-8eaa-f981d73cc665") }); </script>

<p>The calculation is done for AlAs, the same crystalline material as for the previous lesson on DFPT. 
Many input parameters are also quite similar, both at the level of the description
of the unit cell, as for the choice of cut-off energy and k point grid.</p>
<p>Still, this input file is rather complex: in one single run, one produces the
(Derivative Databases) DDBs needed for the rest of this tutorial. 
So, it starts with a ground-state calculation (dataset 1), followed by the
computation of the response to the d/dk perturbation (dataset 2), and the
response to electric fields, and phonons at Gamma (dataset 3). Datasets 4 to
10 generate the dynamical matrices at 7 q wavevectors, other than Gamma. At
present (v8.6), one can only compute one q point per dataset, that is why so many datasets are needed.</p>
<p>Also, the values of these q wavevectors are not determined automatically. 
They must correspond to the q wavevectors needed by the ANADDB utility (see later),
that is, they should form a reduced set of symmetry-inequivalent wavevectors,
corresponding to a regularly spaced grid. In principle, they might not include
the Gamma point, but it is recommended to have it in the set, in order for the
Fourier interpolation not to introduce errors at that important point. In
order to minimize the number of preliminary non-self-consistent calculations,
it is advised to take a q point mesh that is adjusted to the k point mesh used
for the electronic structure : all q wavevectors should connect two k point
wavevectors from this grid.</p>
<p>Such a set of q wavevectors can be generated straightforwardly by running a GS
calculation with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1, <a class="wikilink codevar-wikilink" href="../../variables/basic#nshiftk">nshiftk</a>=1, <a class="wikilink codevar-wikilink" href="../../variables/basic#shiftk">shiftk</a>=0 0 0 (to include
gamma) and taking the output kpt set file as this qpt set. One might set
<a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>=1 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>=1, so only one iteration runs, or even
<a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>=0 and <a class="wikilink codevar-wikilink" href="../../variables/files#prtvol">prtvol</a>=-1, so no real DFT calculation is done.
The input file ~abinit/tests/tutorespfn/Input/trf2_2.in is precisely an input
file that can be used to generate such a set of k points. 
Copy it in the present Work_rf2 directly, as well as the accompanying
~abinit/tests/tutorespfn/Input/trf2_2.files. Examine these files, then run
this calculation (it is very rapid - it won&rsquo;t hurt the trf2_1 job). The
following k point set is obtained:</p>
<div class="codehilite"><pre><span></span>       kpt    0.00000000E+00  0.00000000E+00  0.00000000E+00
              2.50000000E-01  0.00000000E+00  0.00000000E+00
              5.00000000E-01  0.00000000E+00  0.00000000E+00
              2.50000000E-01  2.50000000E-01  0.00000000E+00
              5.00000000E-01  2.50000000E-01  0.00000000E+00
             -2.50000000E-01  2.50000000E-01  0.00000000E+00
              5.00000000E-01  5.00000000E-01  0.00000000E+00
             -2.50000000E-01  5.00000000E-01  2.50000000E-01
</pre></div>


<p>It is, as promised, the same as the q point set in the trf2_1.in file.</p>
<p>Now, it might be worth to examine in some detail one of the Derivative
Database that has been created by the trf2_1 run. 
We suppose that the file trf2_1o_DS3_DDB has already been created. 
It corresponds to the third dataset, namely the response to q=0 and electric field.<br />
Edit this file, and read the <a class="wikilink user-guide-wikilink" href="../../guide/respfn#ddb">6.5 section</a> of the respfn help file. 
Examine the trf2_1o_DS3_DDB file carefully.</p>
<p>Seven other similar files will be generated by the trf2_1 run, containing the
same header, but a different 2DTE block. It will be the duty of the MRGDDB
utility, next section, to gather all these information.</p>
<p>Now, there might be two possibilities: either the trf2_1 run is finished, and
you can continue the tutorial with the section 2 about the MRGDDB utility, or the run is not finished.<br />
In the latter case, instead of waiting for trf2_1 to be finished, we suggest
you to pursue with section 3. You will use as DDB file the one that can be
found in ~abinit/tests/tutorespfn/Refs, with the name trf2_3.ddb.out,
<a class="wikilink abifile-wikilink" href="../../tests/tutorespfn/Refs/trf2_3.ddb.out" target="_blank">tests/tutorespfn/Refs/trf2_3.ddb.out</a>, instead of the one that would result from the section 2. 
Copy this file to the present directory, then go to
section section 3 of this tutorial. You might come back to section 2 afterwards.</p>
<h2 id="2-manipulation-of-the-derivative-databases-the-mrgddb-utility">2 Manipulation of the derivative databases (the MRGDDB utility)<a class="headerlink" href="#2-manipulation-of-the-derivative-databases-the-mrgddb-utility" title="Permanent link">&para;</a></h2>
<p>The use of the MRGDDB utility is described in its <a class="wikilink user-guide-wikilink" href="../../guide/mrgddb">help file</a>. 
Please, read it carefully now.</p>
<p>Use MRGDDB to create the merge DDB from the eight DDB&rsquo;s corresponding to
datasets 3 to 10 of the trf2_1 job, containing the dynamical matrices for the
8 q points, as well as the response to the electric field (dielectric tensor
and Born effective charges). Name the new DDB trf2_3.ddb.out .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Including also the one from dataset 1 won&rsquo;t hurt
(it contains the forces and stresses), but is not needed for the computation
of phonon band structure, interatomic force constants, and thermodynamical properties. </p>
</div>
<p>File ~abinit/tests/tutorespfn/Input/trf2_3.in is an example of input file for MRGDDB. </p>
<div class="text-center"><button type="button" id="uuid-e6daaf47-6ad4-436f-b8d7-3f258ba73e1a" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_3.in
</button></div>

<div id="uuid-696183c0-4144-4b64-b3b3-e3e15f4b3f0e" class="my_dialog" title="tests/tutorespfn/Input/trf2_3.in" hidden><div><div class="codehilite small-text"><pre><span></span>trf2_3.ddb.out
AlAs phonons on <span class="m">4</span> <span class="m">4</span> <span class="m">4</span> mesh
<span class="m">8</span>
trf2_1o_DS3_DDB
trf2_1o_DS4_DDB
trf2_1o_DS5_DDB
trf2_1o_DS6_DDB
trf2_1o_DS7_DDB
trf2_1o_DS8_DDB
trf2_1o_DS9_DDB
trf2_1o_DS10_DDB

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgddb</span>
<span class="c1">#%% test_chain = trf2_1.in, trf2_3.in, trf2_4.in, trf2_5.in, trf2_6.in, trf2_7.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   trf2_3.ddb.out, tolnlines=  0, tolabs=  9.192e-10, tolrel=  4.000e-04, fld_options=-medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = Input file for anaddb </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-696183c0-4144-4b64-b3b3-e3e15f4b3f0e", "#uuid-e6daaf47-6ad4-436f-b8d7-3f258ba73e1a") }); </script>

<p>You can copy it in the Work_rf2 directory, and run the merge as follows:</p>
<div class="codehilite"><pre><span></span>mrgddb &lt; trf2_3.in
</pre></div>


<h2 id="3-analysis-of-the-derivative-databases">3 Analysis of the derivative databases<a class="headerlink" href="#3-analysis-of-the-derivative-databases" title="Permanent link">&para;</a></h2>
<p>An introduction to the use of the ANADDB utility is described in its <a class="wikilink user-guide-wikilink" href="../../guide/anaddb">help file</a>.
Please, read it carefully.</p>
<p>This ANADDB utility is able to perform many different tasks, each governed by
a selected set of input variables, with also some input variables common to
many of the different tasks. The list of tasks to be done in one run is
governed by different flags. 
Here is the list of flags:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#dieflag">dieflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#elaflag">elaflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#elphflag">elphflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcflag">ifcflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#instrflag">instrflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nlflag">nlflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#piezoflag">piezoflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#polflag">polflag</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#thmflag">thmflag</a> </li>
</ul>
<p>Please, take some time to read the description of each of these flags. 
Note that some of these flags might be required to allow to run another task.
In this tutorial, we will focus on the flags <a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcflag">ifcflag</a> and <a class="wikilink codevar-wikilink" href="../../variables/anaddb#thmflag">thmflag</a>.</p>
<h2 id="4-the-computation-of-interatomic-force-constants">4 The computation of interatomic force constants<a class="headerlink" href="#4-the-computation-of-interatomic-force-constants" title="Permanent link">&para;</a></h2>
<p>You can copy the files ~abinit/tests/tutorespfn/Input/trf2_4.in and
~abinit/tests/tutorespfn/Input/trf2_4.files to the Work_rf2 directory.<br />
Edit the file trf2_4.in. Note that <a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcflag">ifcflag</a> is activated. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-aeea26c6-212e-4154-8a0b-8641f1df3d57" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_4.files
</button>
<button type="button" id="uuid-9853ce64-2c26-4846-93ac-a4ee28c0e44e" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_4.in
</button>
</div></div>

<div id="uuid-2f761e9f-8122-44c6-97b6-f04e06c7f1a7" class="my_dialog" title="tests/tutorespfn/Input/trf2_4.files" hidden><div><pre class="small-text">
trf2_4.in
trf2_4.out
trf2_3.ddb.out
trf2_4_band2eps
trf2_dummy1
trf2_dummy2
trf2_dummy3

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-2f761e9f-8122-44c6-97b6-f04e06c7f1a7", "#uuid-aeea26c6-212e-4154-8a0b-8641f1df3d57") }); </script>

<div id="uuid-210f2d6b-b0a5-45a5-81db-f29560ca0574" class="my_dialog" title="tests/tutorespfn/Input/trf2_4.in" hidden><div><div class="codehilite small-text"><pre><span></span>!Input file <span class="k">for</span> the anaddb code. Analysis of the AlAs DDB

!Flags
 ifcflag   <span class="m">1</span>     ! Interatomic force constant flag

!Wavevector grid number <span class="m">1</span> <span class="o">(</span>coarse grid, from DDB<span class="o">)</span>
  brav    <span class="m">2</span>      ! Bravais Lattice : <span class="m">1</span>-S.C., <span class="m">2</span>-F.C., <span class="m">3</span>-B.C., <span class="m">4</span>-Hex.<span class="o">)</span>
  ngqpt   <span class="m">4</span>  <span class="m">4</span>  <span class="m">4</span>   ! Monkhorst-Pack indices
  nqshft  <span class="m">1</span>         ! number of q-points in repeated basic q-cell
  q1shft  <span class="m">3</span>*0.0

!Effective charges
  chneut   <span class="m">1</span>     ! Charge neutrality requirement <span class="k">for</span> effective charges.

!Interatomic force constant info
  dipdip  <span class="m">1</span>      ! Dipole-dipole interaction treatment
  ifcana  <span class="m">1</span>      ! Analysis of the IFCs
  ifcout <span class="m">20</span>      ! Number of IFC<span class="s1">&#39;s written in the output, per atom</span>
<span class="s1">  natifc  1      ! Number of atoms in the cell for which ifc&#39;</span>s are analysed
   atifc  <span class="m">1</span>      ! List of atoms

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = anaddb</span>
<span class="c1">#%% test_chain = trf2_1.in, trf2_3.in, trf2_4.in, trf2_5.in, trf2_6.in, trf2_7.in</span>
<span class="c1">#%% input_ddb = trf2_3.ddb.out </span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   trf2_4.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options=-easy</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = !Input file for the anaddb code. Analysis of the AlAs DDB</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-210f2d6b-b0a5-45a5-81db-f29560ca0574", "#uuid-9853ce64-2c26-4846-93ac-a4ee28c0e44e") }); </script>

<p>Related input variables can be split in three groups.
The first group of variables define the grid of q wavevectors:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#brav">brav</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ngqpt">ngqpt</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nqshft">nqshft</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#q1shft">q1shft</a></li>
</ul>
<p>Unfortunately, the names of input variables and their meaning is not exactly
the same as the names used to generate the k points in ABINIT. 
This is a shame, a remnant of history &hellip; 
Please read carefully the documentation that describes these input variables.</p>
<p>The second group of variables allows to impose some known constraint on the
dynamical matrices and Born effective charges before proceeding with the analysis:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#asr">asr</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#chneut">chneut</a></li>
</ul>
<p>Please, read carefully the explanation for these input variables.</p>
<p>Finally, a third group of variables is related specifically to the analysis of
the Interatomic Force Constants:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#dipdip">dipdip</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcana">ifcana</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcout">ifcout</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#natifc">natifc</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#atifc">atifc</a></li>
</ul>
<p>Here also, spend some time to read the associated documentation.</p>
<p>Now, you should issue:</p>
<div class="codehilite"><pre><span></span>anaddb &lt; trf2_4.files &gt; trf2_4.log
</pre></div>


<p>It will last only a few seconds.</p>
<p>The file trf2_4.out contains the list of interatomic force constants, as well
as some analysis. </p>
<div class="text-center"><button type="button" id="uuid-5b058b46-5ba7-4716-b23d-52804c7730a8" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Refs/trf2_4.out
</button></div>

<div id="uuid-d8a52a3d-3556-4841-846e-a87e3bbe035d" class="my_dialog" title="tests/tutorespfn/Refs/trf2_4.out" hidden><div><pre class="small-text">

.Version 8.0.5 of ANADDB 
.(MPI version, prepared for a x86_64_linux_gnu5.3 computer) 

.Copyright (C) 1998-2018 ABINIT group . 
 ANADDB comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read ~abinit/doc/users/acknowledgments.html for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Thu 12 May 2016.
- ( at 02h17 )


================================================================================

 -outvars_anaddb: echo values of input variables ----------------------

 Flags :
     ifcflag         1
 Miscellaneous information :
         asr         1
      chneut         1
 Interatomic Force Constants Inputs :
      dipdip         1
      ifcana         1
      ifcout        20
      natifc         1
       atifc         1
 Description of grid 1 :
        brav         2
       ngqpt         4         4         4
      nqshft         1
      q1shft
                     0.00000000E+00  0.00000000E+00  0.00000000E+00

================================================================================

 read the DDB information and perform some checks

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.3050000  5.3050000  G(1)= -0.0942507  0.0942507  0.0942507
 R(2)=  5.3050000  0.0000000  5.3050000  G(2)=  0.0942507 -0.0942507  0.0942507
 R(3)=  5.3050000  5.3050000  0.0000000  G(3)=  0.0942507  0.0942507 -0.0942507
 Unit cell volume ucvol=  2.9859750E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.022872        0.000000
       1               2       -0.000000        0.000000
       1               3       -0.000000        0.000000
       2               1       -0.000000        0.000000
       2               2       -0.022872        0.000000
       2               3        0.000000        0.000000
       3               1        0.000000        0.000000
       3               2        0.000000        0.000000
       3               3       -0.022872        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.115792E+00    2.191360E-17    2.223726E-17
         1         2    2.191360E-17    2.115792E+00   -2.158994E-17
         1         3   -2.191360E-17   -2.191360E-17    2.115792E+00
         2         1   -2.115792E+00   -2.191360E-17   -2.223726E-17
         2         2   -2.191360E-17   -2.115792E+00    2.158994E-17
         2         3    2.191360E-17    2.191360E-17   -2.115792E+00
 Now, the imaginary part of the dynamical matrix is zeroed

================================================================================

 Calculation of the interatomic forces 

       Homogeneous q point set in the B.Z.
 Grid q points  :       32
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   0.00000000E+00  2.50000000E-01  2.50000000E-01
  3)   0.00000000E+00  5.00000000E-01  5.00000000E-01
  4)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
  5)   2.50000000E-01  0.00000000E+00  2.50000000E-01
  6)   2.50000000E-01  2.50000000E-01  5.00000000E-01
  7)   2.50000000E-01 -2.50000000E-01 -1.11022302E-16
  8)   5.00000000E-01  0.00000000E+00  5.00000000E-01
  9)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 10)  -2.50000000E-01  2.50000000E-01 -1.11022302E-16
 11)  -2.50000000E-01 -2.50000000E-01 -5.00000000E-01
 12)   2.50000000E-01  2.50000000E-01  0.00000000E+00
 13)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 14)   2.50000000E-01  7.50000000E-01  5.00000000E-01
 15)   2.50000000E-01 -1.11022302E-16 -2.50000000E-01
 16)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 17)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 18)   5.00000000E-01 -1.11022302E-16 -1.11022302E-16
 19)   7.50000000E-01  2.50000000E-01  5.00000000E-01
 20)  -1.11022302E-16  2.50000000E-01 -2.50000000E-01
 21)  -1.11022302E-16  5.00000000E-01 -1.11022302E-16
 22)  -1.11022302E-16 -1.11022302E-16 -5.00000000E-01
 23)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 24)   5.00000000E-01  7.50000000E-01  2.50000000E-01
 25)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 26)   7.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 28)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 29)  -2.50000000E-01 -1.11022302E-16  2.50000000E-01
 30)  -2.50000000E-01 -5.00000000E-01 -2.50000000E-01
 31)  -1.11022302E-16 -2.50000000E-01  2.50000000E-01
 32)  -5.00000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained

 Analysis of interatomic force constants 

 Are given : column(1-3), the total force constant
       then  column(4-6), the Ewald part
       then  column(7-9), the short-range part
 Column 1, 4 and 7 are related to the displacement
       of the generic atom along x,               
 column 2, 5 and 8 are related to the displacement
       of the generic atom along y,               
 column 3, 6 and 9 are related to the displacement
       of the generic atom along z.               

 generic atom number   1
 with cartesian coordinates  0.00000000E+00  0.00000000E+00  0.00000000E+00

 Third atom defining local coordinates : 
     ib =    2   irpt =   13

   1 interaction with atom     1 cell      40
 with coordinates     0.000000E+00    0.000000E+00    0.000000E+00
 and distance     0.000000E+00
   0.09360 -0.00000  0.00000   0.00000  0.00000  0.00000   0.09360 -0.00000  0.00000
   0.00000  0.09360 -0.00000   0.00000  0.00000  0.00000   0.00000  0.09360 -0.00000
  -0.00000  0.00000  0.09360   0.00000  0.00000  0.00000  -0.00000  0.00000  0.09360
 Traces (and ratios) :
  0.28080                   0.00000                   0.28080
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.000000        0.707107       -0.707107
 Second local vector :       -1.000000       -0.000000        0.000000
 Third  local vector :        0.000000        0.707107        0.707107
   0.09360 -0.00000 -0.00000   0.00000  0.00000  0.00000   0.09360 -0.00000 -0.00000
   0.00000  0.09360  0.00000   0.00000  0.00000  0.00000   0.00000  0.09360  0.00000
   0.00000 -0.00000  0.09360   0.00000  0.00000  0.00000   0.00000 -0.00000  0.09360
 Ratio with respect to the (1,1) element
   1.00000 -0.00000 -0.00000   0.00000  0.00000  0.00000   1.00000 -0.00000 -0.00000
   0.00000  1.00000  0.00000   0.00000  0.00000  0.00000   0.00000  1.00000  0.00000
   0.00000 -0.00000  1.00000   0.00000  0.00000  0.00000   0.00000 -0.00000  1.00000

   2 interaction with atom     2 cell       8
 with coordinates    -2.652500E+00   -2.652500E+00    2.652500E+00
 and distance     4.594265E+00
  -0.02304 -0.01599  0.01599   0.00000  0.00473 -0.00473  -0.02304 -0.02072  0.02072
  -0.01599 -0.02304  0.01599   0.00473  0.00000 -0.00473  -0.02072 -0.02304  0.02072
   0.01599  0.01599 -0.02304  -0.00473 -0.00473  0.00000   0.02072  0.02072 -0.02304
 Traces (and ratios) :
 -0.06911                   0.00000                  -0.06911
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.577350       -0.577350        0.577350
 Second local vector :        0.816497       -0.408248        0.408248
 Third  local vector :        0.000000        0.707107        0.707107
  -0.05501  0.00000 -0.00000   0.00946  0.00000  0.00000  -0.06447  0.00000 -0.00000
   0.00000 -0.00705  0.00000   0.00000 -0.00473  0.00000   0.00000 -0.00232  0.00000
  -0.00000  0.00000 -0.00705   0.00000  0.00000 -0.00473  -0.00000  0.00000 -0.00232
 Ratio with respect to the longitudinal ifc
   1.00000 -0.00000  0.00000  -0.17194  0.00000  0.00000   1.17194 -0.00000  0.00000
  -0.00000  0.12813 -0.00000   0.00000  0.08597  0.00000  -0.00000  0.04216 -0.00000
   0.00000 -0.00000  0.12813   0.00000  0.00000  0.08597   0.00000 -0.00000  0.04216

   3 interaction with atom     2 cell      13
 with coordinates    -2.652500E+00    2.652500E+00   -2.652500E+00
 and distance     4.594265E+00
  -0.02304  0.01599 -0.01599   0.00000 -0.00473  0.00473  -0.02304  0.02072 -0.02072
   0.01599 -0.02304  0.01599  -0.00473  0.00000 -0.00473   0.02072 -0.02304  0.02072
  -0.01599  0.01599 -0.02304   0.00473 -0.00473  0.00000  -0.02072  0.02072 -0.02304
 Traces (and ratios) :
 -0.06911                   0.00000                  -0.06911
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.577350        0.577350       -0.577350
 Second local vector :        0.816497        0.408248       -0.408248
 Third  local vector :        0.000000       -0.707107       -0.707107
  -0.05501  0.00000  0.00000   0.00946  0.00000  0.00000  -0.06447  0.00000  0.00000
  -0.00000 -0.00705 -0.00000   0.00000 -0.00473  0.00000  -0.00000 -0.00232 -0.00000
  -0.00000  0.00000 -0.00705   0.00000  0.00000 -0.00473  -0.00000  0.00000 -0.00232
 Ratio with respect to the longitudinal ifc
   1.00000 -0.00000 -0.00000  -0.17194  0.00000  0.00000   1.17194 -0.00000 -0.00000
   0.00000  0.12813  0.00000   0.00000  0.08597  0.00000   0.00000  0.04216  0.00000
   0.00000 -0.00000  0.12813   0.00000  0.00000  0.08597   0.00000 -0.00000  0.04216

   4 interaction with atom     2 cell      27
 with coordinates     2.652500E+00   -2.652500E+00   -2.652500E+00
 and distance     4.594265E+00
  -0.02304  0.01599  0.01599   0.00000 -0.00473 -0.00473  -0.02304  0.02072  0.02072
   0.01599 -0.02304 -0.01599  -0.00473  0.00000  0.00473   0.02072 -0.02304 -0.02072
   0.01599 -0.01599 -0.02304  -0.00473  0.00473  0.00000   0.02072 -0.02072 -0.02304
 Traces (and ratios) :
 -0.06911                   0.00000                  -0.06911
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.577350       -0.577350       -0.577350
 Second local vector :        0.816497        0.408248        0.408248
 Third  local vector :        0.000000       -0.707107        0.707107
  -0.05501  0.00000  0.00000   0.00946  0.00000  0.00000  -0.06447  0.00000  0.00000
   0.00000 -0.00705 -0.00000   0.00000 -0.00473  0.00000   0.00000 -0.00232 -0.00000
  -0.00000 -0.00000 -0.00705   0.00000  0.00000 -0.00473  -0.00000 -0.00000 -0.00232
 Ratio with respect to the longitudinal ifc
   1.00000 -0.00000 -0.00000  -0.17194  0.00000  0.00000   1.17194 -0.00000 -0.00000
  -0.00000  0.12813  0.00000   0.00000  0.08597  0.00000  -0.00000  0.04216  0.00000
   0.00000  0.00000  0.12813   0.00000  0.00000  0.08597   0.00000  0.00000  0.04216

   5 interaction with atom     2 cell      40
 with coordinates     2.652500E+00    2.652500E+00    2.652500E+00
 and distance     4.594265E+00
  -0.02304 -0.01599 -0.01599   0.00000  0.00473  0.00473  -0.02304 -0.02072 -0.02072
  -0.01599 -0.02304 -0.01599   0.00473  0.00000  0.00473  -0.02072 -0.02304 -0.02072
  -0.01599 -0.01599 -0.02304   0.00473  0.00473  0.00000  -0.02072 -0.02072 -0.02304
 Traces (and ratios) :
 -0.06911                   0.00000                  -0.06911
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.577350        0.577350        0.577350
 Second local vector :        0.816497       -0.408248       -0.408248
 Third  local vector :        0.000000        0.707107       -0.707107
  -0.05501  0.00000 -0.00000   0.00946  0.00000  0.00000  -0.06447  0.00000 -0.00000
   0.00000 -0.00705  0.00000   0.00000 -0.00473  0.00000   0.00000 -0.00232  0.00000
  -0.00000 -0.00000 -0.00705   0.00000  0.00000 -0.00473  -0.00000 -0.00000 -0.00232
 Ratio with respect to the longitudinal ifc
   1.00000 -0.00000  0.00000  -0.17194  0.00000  0.00000   1.17194 -0.00000  0.00000
  -0.00000  0.12813 -0.00000   0.00000  0.08597  0.00000  -0.00000  0.04216 -0.00000
   0.00000  0.00000  0.12813   0.00000  0.00000  0.08597   0.00000  0.00000  0.04216

   6 interaction with atom     1 cell       8
 with coordinates    -5.305000E+00   -5.305000E+00    0.000000E+00
 and distance     7.502403E+00
  -0.00259 -0.00267  0.00145  -0.00054 -0.00163  0.00000  -0.00205 -0.00104  0.00145
  -0.00267 -0.00259  0.00145  -0.00163 -0.00054  0.00000  -0.00104 -0.00205  0.00145
  -0.00145 -0.00145  0.00581   0.00000  0.00000  0.00109  -0.00145 -0.00145  0.00472
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.707107       -0.707107        0.000000
 Second local vector :        0.000002       -0.000002       -1.000000
 Third  local vector :        0.707107       -0.707107        0.000002
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581 -0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472 -0.00000
   0.00000 -0.00000  0.00007   0.00000  0.00000  0.00109   0.00000 -0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368  0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89727  0.00000
  -0.00000  0.00000 -0.01421   0.00000  0.00000 -0.20641  -0.00000  0.00000  0.19220

   7 interaction with atom     1 cell      13
 with coordinates    -5.305000E+00    0.000000E+00   -5.305000E+00
 and distance     7.502403E+00
  -0.00259  0.00145 -0.00267  -0.00054  0.00000 -0.00163  -0.00205  0.00145 -0.00104
  -0.00145  0.00581 -0.00145   0.00000  0.00109  0.00000  -0.00145  0.00472 -0.00145
  -0.00267  0.00145 -0.00259  -0.00163  0.00000 -0.00054  -0.00104  0.00145 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.707107        0.000000       -0.707107
 Second local vector :       -0.000004       -1.000000        0.000004
 Third  local vector :       -0.707107        0.000006        0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581 -0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472 -0.00000
   0.00000 -0.00000  0.00007   0.00000  0.00000  0.00109   0.00000 -0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368  0.00001   0.00000 -0.20641  0.00000   0.38852 -0.89727  0.00001
  -0.00000  0.00001 -0.01421   0.00000  0.00000 -0.20641  -0.00000  0.00001  0.19220

   8 interaction with atom     1 cell      17
 with coordinates    -5.305000E+00    0.000000E+00    5.305000E+00
 and distance     7.502403E+00
  -0.00259 -0.00145  0.00267  -0.00054  0.00000  0.00163  -0.00205 -0.00145  0.00104
   0.00145  0.00581 -0.00145   0.00000  0.00109  0.00000   0.00145  0.00472 -0.00145
   0.00267  0.00145 -0.00259   0.00163  0.00000 -0.00054   0.00104  0.00145 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.707107        0.000000        0.707107
 Second local vector :       -0.000000        1.000000       -0.000000
 Third  local vector :       -0.707107       -0.000000       -0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581 -0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472 -0.00000
   0.00000 -0.00000  0.00007   0.00000  0.00000  0.00109   0.00000 -0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10367  0.00000   0.00000 -0.20640  0.00000   0.38852 -0.89727  0.00000
  -0.00000  0.00000 -0.01421   0.00000  0.00000 -0.20640  -0.00000  0.00000  0.19220

   9 interaction with atom     1 cell      18
 with coordinates    -5.305000E+00    5.305000E+00    0.000000E+00
 and distance     7.502403E+00
  -0.00259  0.00267 -0.00145  -0.00054  0.00163  0.00000  -0.00205  0.00104 -0.00145
   0.00267 -0.00259  0.00145   0.00163 -0.00054  0.00000   0.00104 -0.00205  0.00145
   0.00145 -0.00145  0.00581   0.00000  0.00000  0.00109   0.00145 -0.00145  0.00472
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.707107        0.707107        0.000000
 Second local vector :       -0.000001       -0.000001        1.000000
 Third  local vector :        0.707107        0.707107        0.000001
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
   0.00000  0.00000  0.00007   0.00000  0.00000  0.00109   0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89728 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  10 interaction with atom     1 cell      27
 with coordinates     0.000000E+00   -5.305000E+00   -5.305000E+00
 and distance     7.502403E+00
   0.00581 -0.00145 -0.00145   0.00109  0.00000  0.00000   0.00472 -0.00145 -0.00145
   0.00145 -0.00259 -0.00267   0.00000 -0.00054 -0.00163   0.00145 -0.00205 -0.00104
   0.00145 -0.00267 -0.00259   0.00000 -0.00163 -0.00054   0.00145 -0.00104 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.000000       -0.707107       -0.707107
 Second local vector :       -1.000000        0.000003       -0.000003
 Third  local vector :        0.000005        0.707107       -0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581 -0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472 -0.00000
   0.00000 -0.00000  0.00007   0.00000  0.00000  0.00109   0.00000 -0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368  0.00001   0.00000 -0.20641  0.00000   0.38852 -0.89727  0.00001
  -0.00000  0.00001 -0.01421   0.00000  0.00000 -0.20641  -0.00000  0.00001  0.19220

  11 interaction with atom     1 cell      31
 with coordinates     0.000000E+00   -5.305000E+00    5.305000E+00
 and distance     7.502403E+00
   0.00581  0.00145 -0.00145   0.00109  0.00000  0.00000   0.00472  0.00145 -0.00145
  -0.00145 -0.00259  0.00267   0.00000 -0.00054  0.00163  -0.00145 -0.00205  0.00104
   0.00145  0.00267 -0.00259   0.00000  0.00163 -0.00054   0.00145  0.00104 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.000000       -0.707107        0.707107
 Second local vector :        1.000000       -0.000001       -0.000001
 Third  local vector :        0.000001        0.707107        0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
   0.00000  0.00000  0.00007   0.00000  0.00000  0.00109   0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89728 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  12 interaction with atom     1 cell      33
 with coordinates     5.305000E+00   -5.305000E+00    0.000000E+00
 and distance     7.502403E+00
  -0.00259  0.00267  0.00145  -0.00054  0.00163  0.00000  -0.00205  0.00104  0.00145
   0.00267 -0.00259 -0.00145   0.00163 -0.00054  0.00000   0.00104 -0.00205 -0.00145
  -0.00145  0.00145  0.00581   0.00000  0.00000  0.00109  -0.00145  0.00145  0.00472
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.707107       -0.707107        0.000000
 Second local vector :        0.000001        0.000001        1.000000
 Third  local vector :       -0.707107       -0.707107        0.000001
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
   0.00000  0.00000  0.00007   0.00000  0.00000  0.00109   0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10367 -0.00000   0.00000 -0.20640  0.00000   0.38852 -0.89727 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20640   0.00000 -0.00000  0.19220

  13 interaction with atom     1 cell      37
 with coordinates     0.000000E+00    5.305000E+00   -5.305000E+00
 and distance     7.502403E+00
   0.00581 -0.00145  0.00145   0.00109  0.00000  0.00000   0.00472 -0.00145  0.00145
   0.00145 -0.00259  0.00267   0.00000 -0.00054  0.00163   0.00145 -0.00205  0.00104
  -0.00145  0.00267 -0.00259   0.00000  0.00163 -0.00054  -0.00145  0.00104 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.000000        0.707107       -0.707107
 Second local vector :        1.000000        0.000001        0.000001
 Third  local vector :        0.000001       -0.707107       -0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
   0.00000  0.00000  0.00007   0.00000  0.00000  0.00109   0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38851  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38851  0.00000
   0.38852 -1.10367 -0.00000   0.00000 -0.20640  0.00000   0.38852 -0.89727 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20640   0.00000 -0.00000  0.19220

  14 interaction with atom     1 cell      38
 with coordinates     5.305000E+00    0.000000E+00   -5.305000E+00
 and distance     7.502403E+00
  -0.00259  0.00145  0.00267  -0.00054  0.00000  0.00163  -0.00205  0.00145  0.00104
  -0.00145  0.00581  0.00145   0.00000  0.00109  0.00000  -0.00145  0.00472  0.00145
   0.00267 -0.00145 -0.00259   0.00163  0.00000 -0.00054   0.00104 -0.00145 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.707107        0.000000       -0.707107
 Second local vector :       -0.000002        1.000000       -0.000002
 Third  local vector :        0.707107        0.000002        0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
  -0.00000  0.00000  0.00007   0.00000  0.00000  0.00109  -0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89728 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  15 interaction with atom     1 cell      41
 with coordinates     0.000000E+00    5.305000E+00    5.305000E+00
 and distance     7.502403E+00
   0.00581  0.00145  0.00145   0.00109  0.00000  0.00000   0.00472  0.00145  0.00145
  -0.00145 -0.00259 -0.00267   0.00000 -0.00054 -0.00163  -0.00145 -0.00205 -0.00104
  -0.00145 -0.00267 -0.00259   0.00000 -0.00163 -0.00054  -0.00145 -0.00104 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.000000        0.707107        0.707107
 Second local vector :       -1.000000        0.000002       -0.000002
 Third  local vector :       -0.000003       -0.707107        0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
  -0.00000  0.00000  0.00007   0.00000  0.00000  0.00109  -0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89727 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  16 interaction with atom     1 cell      42
 with coordinates     5.305000E+00    0.000000E+00    5.305000E+00
 and distance     7.502403E+00
  -0.00259 -0.00145 -0.00267  -0.00054  0.00000 -0.00163  -0.00205 -0.00145 -0.00104
   0.00145  0.00581  0.00145   0.00000  0.00109  0.00000   0.00145  0.00472  0.00145
  -0.00267 -0.00145 -0.00259  -0.00163  0.00000 -0.00054  -0.00104 -0.00145 -0.00205
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.707107        0.000000        0.707107
 Second local vector :       -0.000003       -1.000000        0.000003
 Third  local vector :        0.707107       -0.000004       -0.707107
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
  -0.00000  0.00000  0.00007   0.00000  0.00000  0.00109  -0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89727 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  17 interaction with atom     1 cell      43
 with coordinates     5.305000E+00    5.305000E+00    0.000000E+00
 and distance     7.502403E+00
  -0.00259 -0.00267 -0.00145  -0.00054 -0.00163  0.00000  -0.00205 -0.00104 -0.00145
  -0.00267 -0.00259 -0.00145  -0.00163 -0.00054  0.00000  -0.00104 -0.00205 -0.00145
   0.00145  0.00145  0.00581   0.00000  0.00000  0.00109   0.00145  0.00145  0.00472
 Traces (and ratios) :
  0.00062                   0.00000                   0.00062
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :        0.707107        0.707107        0.000000
 Second local vector :        0.000000       -0.000000       -1.000000
 Third  local vector :       -0.707107        0.707107       -0.000000
  -0.00526  0.00204  0.00000  -0.00217  0.00000  0.00000  -0.00309  0.00204  0.00000
  -0.00204  0.00581  0.00000   0.00000  0.00109  0.00000  -0.00204  0.00472  0.00000
  -0.00000  0.00000  0.00007   0.00000  0.00000  0.00109  -0.00000  0.00000 -0.00101
 Ratio with respect to the longitudinal ifc
   1.00000 -0.38852  0.00000   0.41281  0.00000  0.00000   0.58719 -0.38852  0.00000
   0.38852 -1.10368 -0.00000   0.00000 -0.20641  0.00000   0.38852 -0.89727 -0.00000
   0.00000 -0.00000 -0.01421   0.00000  0.00000 -0.20641   0.00000 -0.00000  0.19220

  18 interaction with atom     2 cell       2
 with coordinates    -7.957500E+00   -2.652500E+00   -2.652500E+00
 and distance     8.797347E+00
   0.00056  0.00019  0.00019   0.00098  0.00055  0.00055  -0.00042 -0.00036 -0.00036
   0.00065 -0.00047  0.00017   0.00055 -0.00049  0.00018   0.00010  0.00002 -0.00001
   0.00065  0.00017 -0.00047   0.00055  0.00018 -0.00049   0.00010 -0.00001  0.00002
 Traces (and ratios) :
 -0.00037                   0.00000                  -0.00037
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.904534       -0.301511       -0.301511
 Second local vector :       -0.426401        0.639581        0.639624
 Third  local vector :       -0.000013        0.707126       -0.707087
   0.00087  0.00028  0.00000   0.00135  0.00000  0.00000  -0.00048  0.00028  0.00000
  -0.00038 -0.00060  0.00000   0.00000 -0.00067  0.00000  -0.00038  0.00007  0.00000
   0.00000  0.00000 -0.00064   0.00000  0.00000 -0.00067   0.00000  0.00000  0.00003
 Ratio with respect to the longitudinal ifc
   1.00000  0.32445  0.00000   1.55643  0.00000  0.00000  -0.55643  0.32445  0.00000
  -0.43391 -0.69240  0.00001   0.00000 -0.77821  0.00000  -0.43391  0.08581  0.00001
   0.00001  0.00000 -0.74002   0.00000  0.00000 -0.77821   0.00001  0.00000  0.03820

  19 interaction with atom     2 cell       3
 with coordinates    -2.652500E+00   -7.957500E+00   -2.652500E+00
 and distance     8.797347E+00
  -0.00047  0.00065  0.00017  -0.00049  0.00055  0.00018   0.00002  0.00010 -0.00001
   0.00019  0.00056  0.00019   0.00055  0.00098  0.00055  -0.00036 -0.00042 -0.00036
   0.00017  0.00065 -0.00047   0.00018  0.00055 -0.00049  -0.00001  0.00010  0.00002
 Traces (and ratios) :
 -0.00037                   0.00000                  -0.00037
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.301511       -0.904534       -0.301511
 Second local vector :        0.639640       -0.426401        0.639564
 Third  local vector :       -0.707073       -0.000023        0.707141
   0.00087  0.00028  0.00000   0.00135  0.00000  0.00000  -0.00048  0.00028  0.00000
  -0.00038 -0.00060  0.00000   0.00000 -0.00067  0.00000  -0.00038  0.00007  0.00000
  -0.00000 -0.00000 -0.00064   0.00000  0.00000 -0.00067  -0.00000 -0.00000  0.00003
 Ratio with respect to the longitudinal ifc
   1.00000  0.32450  0.00000   1.55641  0.00000  0.00000  -0.55641  0.32450  0.00000
  -0.43385 -0.69240  0.00001   0.00000 -0.77821  0.00000  -0.43385  0.08580  0.00001
  -0.00001 -0.00000 -0.74001   0.00000  0.00000 -0.77821  -0.00001 -0.00000  0.03820

  20 interaction with atom     2 cell       4
 with coordinates    -2.652500E+00   -2.652500E+00   -7.957500E+00
 and distance     8.797347E+00
  -0.00047  0.00017  0.00065  -0.00049  0.00018  0.00055   0.00002 -0.00001  0.00010
   0.00017 -0.00047  0.00065   0.00018 -0.00049  0.00055  -0.00001  0.00002  0.00010
   0.00019  0.00019  0.00056   0.00055  0.00055  0.00098  -0.00036 -0.00036 -0.00042
 Traces (and ratios) :
 -0.00037                   0.00000                  -0.00037
  1.00000                   0.00000                   1.00000
 Transformation to local coordinates 
 First  local vector :       -0.301511       -0.301511       -0.904534
 Second local vector :        0.639565        0.639639       -0.426401
 Third  local vector :        0.707140       -0.707073       -0.000022
   0.00087  0.00028  0.00000   0.00135  0.00000  0.00000  -0.00048  0.00028  0.00000
  -0.00038 -0.00060  0.00000   0.00000 -0.00067  0.00000  -0.00038  0.00007  0.00000
  -0.00000  0.00000 -0.00064   0.00000  0.00000 -0.00067  -0.00000  0.00000  0.00003
 Ratio with respect to the longitudinal ifc
   1.00000  0.32449  0.00000   1.55642  0.00000  0.00000  -0.55642  0.32449  0.00000
  -0.43386 -0.69241  0.00003   0.00000 -0.77821  0.00000  -0.43386  0.08580  0.00003
  -0.00001  0.00002 -0.74001   0.00000  0.00000 -0.77821  -0.00001  0.00002  0.03820
-
- Proc.   0 individual time (sec): cpu=          1.7  wall=          1.7

================================================================================

+Total cpu time      1.707  and wall time      1.717 sec

 anaddb : the run completed succesfully.

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-d8a52a3d-3556-4841-846e-a87e3bbe035d", "#uuid-5b058b46-5ba7-4716-b23d-52804c7730a8") }); </script>

<p>Open this file and find the following paragraph:</p>
<div class="codehilite"><pre><span></span> Analysis of interatomic force constants

 Are given : column(1-3), the total force constant
       then  column(4-6), the Ewald part
       then  column(7-9), the short-range part
 Column 1, 4 and 7 are related to the displacement
       of the generic atom along x,
 column 2, 5 and 8 are related to the displacement
       of the generic atom along y,
 column 3, 6 and 9 are related to the displacement
       of the generic atom along z.
</pre></div>


<p>The interatomic force constants are output for the nuclei specified by the
input variable <a class="wikilink codevar-wikilink" href="../../variables/anaddb#atifc">atifc</a>. Here, only atom 1 is considered. The IFCs
with respect to the other nuclei is given, by order of increasing distance.
For each pair of nuclei involving atom 1, there is first the output of the
IFCs in cartesian coordinates, as well as their decomposition into an Ewald
and a short-range part, then, the analysis with respect to a local system of
coordinate. The latter is chosen such as to diagonalize the IFC tensor, in
case of the self-force constant, and in the other cases, the first vector is
the vector joining the two nuclei, in order to decompose the IFC into a
longitudinal and a transverse component.</p>
<h2 id="5-the-efficient-computation-of-phonon-band-structures">5 The efficient computation of phonon band structures<a class="headerlink" href="#5-the-efficient-computation-of-phonon-band-structures" title="Permanent link">&para;</a></h2>
<p>You can copy the files ~abinit/tests/tutorespfn/Input/trf2_5.in and
~abinit/tests/tutorespfn/Input/trf2_5.files to the Work_rf2 directory.<br />
Open the file trf2_5.in. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-4f5ca6d8-ed18-46cc-9d51-99bdc11f57f2" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_5.files
</button>
<button type="button" id="uuid-9fdcff53-47a0-473c-9149-989a3e88d5a5" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/trf2_5.in
</button>
</div></div>

<div id="uuid-34bc56c4-e34d-45f5-97c1-bfca0c7a8001" class="my_dialog" title="tests/tutorespfn/Input/trf2_5.files" hidden><div><pre class="small-text">
trf2_5.in
trf2_5.out
trf2_3.ddb.out
trf2_5_band2eps
trf2_dummy1
trf2_dummy2
trf2_dummy3

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-34bc56c4-e34d-45f5-97c1-bfca0c7a8001", "#uuid-4f5ca6d8-ed18-46cc-9d51-99bdc11f57f2") }); </script>

<div id="uuid-e13c8a13-2fa1-4d7c-a453-592f2ca6c5f2" class="my_dialog" title="tests/tutorespfn/Input/trf2_5.in" hidden><div><div class="codehilite small-text"><pre><span></span>!Input file <span class="k">for</span> the anaddb code. Analysis of the SiO2 DDB

!Flags
 ifcflag   <span class="m">1</span>     ! Interatomic force constant flag
 ifcout    <span class="m">0</span>

!Wavevector grid number <span class="m">1</span> <span class="o">(</span>coarse grid, from DDB<span class="o">)</span>
  brav    <span class="m">2</span>      ! Bravais Lattice : <span class="m">1</span>-S.C., <span class="m">2</span>-F.C., <span class="m">3</span>-B.C., <span class="m">4</span>-Hex.<span class="o">)</span>
  ngqpt   <span class="m">4</span>  <span class="m">4</span>  <span class="m">4</span>   ! Monkhorst-Pack indices
  nqshft  <span class="m">1</span>         ! number of q-points in repeated basic q-cell
  q1shft  <span class="m">3</span>*0.0

!Effective charges
  chneut   <span class="m">1</span>     ! Charge neutrality requirement <span class="k">for</span> effective charges.

!Interatomic force constant info
  dipdip  <span class="m">1</span>      ! Dipole-dipole interaction treatment

!Phonon band structure output <span class="k">for</span> band2eps - See note near end <span class="k">for</span>
! dealing with gamma LO-TO splitting issue.
   eivec  <span class="m">4</span>

!Wavevector list number <span class="m">1</span> <span class="o">(</span>Reduced coordinates and normalization factor<span class="o">)</span>         
  nph1l    <span class="m">71</span>      ! number of phonons in list <span class="m">1</span>                             

  qph1l   <span class="m">0</span>.0000  <span class="m">0</span>.0000  <span class="m">0</span>.0000   <span class="m">1</span>.0    !<span class="o">(</span>gamma point<span class="o">)</span>
          <span class="m">0</span>.0375  <span class="m">0</span>.0375  <span class="m">0</span>.0750   <span class="m">1</span>.0
          <span class="m">0</span>.0750  <span class="m">0</span>.0750  <span class="m">0</span>.1500   <span class="m">1</span>.0
          <span class="m">0</span>.1125  <span class="m">0</span>.1125  <span class="m">0</span>.2250   <span class="m">1</span>.0
          <span class="m">0</span>.1500  <span class="m">0</span>.1500  <span class="m">0</span>.3000   <span class="m">1</span>.0
          <span class="m">0</span>.1875  <span class="m">0</span>.1875  <span class="m">0</span>.3750   <span class="m">1</span>.0
          <span class="m">0</span>.2250  <span class="m">0</span>.2250  <span class="m">0</span>.4500   <span class="m">1</span>.0
          <span class="m">0</span>.2625  <span class="m">0</span>.2625  <span class="m">0</span>.5250   <span class="m">1</span>.0
          <span class="m">0</span>.3000  <span class="m">0</span>.3000  <span class="m">0</span>.6000   <span class="m">1</span>.0
          <span class="m">0</span>.3375  <span class="m">0</span>.3375  <span class="m">0</span>.6750   <span class="m">1</span>.0
          <span class="m">0</span>.3750  <span class="m">0</span>.3750  <span class="m">0</span>.7500   <span class="m">1</span>.0    !<span class="o">(</span>K point<span class="o">)</span>
          <span class="m">0</span>.3875  <span class="m">0</span>.3875  <span class="m">0</span>.7750   <span class="m">1</span>.0
          <span class="m">0</span>.4000  <span class="m">0</span>.4000  <span class="m">0</span>.8000   <span class="m">1</span>.0
          <span class="m">0</span>.4125  <span class="m">0</span>.4125  <span class="m">0</span>.8250   <span class="m">1</span>.0
          <span class="m">0</span>.4250  <span class="m">0</span>.4250  <span class="m">0</span>.8500   <span class="m">1</span>.0
          <span class="m">0</span>.4375  <span class="m">0</span>.4375  <span class="m">0</span>.8750   <span class="m">1</span>.0
          <span class="m">0</span>.4500  <span class="m">0</span>.4500  <span class="m">0</span>.9000   <span class="m">1</span>.0
          <span class="m">0</span>.4625  <span class="m">0</span>.4625  <span class="m">0</span>.9250   <span class="m">1</span>.0
          <span class="m">0</span>.4750  <span class="m">0</span>.4750  <span class="m">0</span>.9500   <span class="m">1</span>.0
          <span class="m">0</span>.4875  <span class="m">0</span>.4875  <span class="m">0</span>.9750   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.5000  <span class="m">1</span>.0000   <span class="m">1</span>.0    !<span class="o">(</span>X point<span class="o">)</span>
          <span class="m">0</span>.5500  <span class="m">0</span>.5500  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.6000  <span class="m">0</span>.6000  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.6500  <span class="m">0</span>.6500  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.7000  <span class="m">0</span>.7000  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.7500  <span class="m">0</span>.7500  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.8000  <span class="m">0</span>.8000  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.8500  <span class="m">0</span>.8500  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.9000  <span class="m">0</span>.9000  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">0</span>.9500  <span class="m">0</span>.9500  <span class="m">1</span>.0000   <span class="m">1</span>.0
          <span class="m">1</span>.0000  <span class="m">1</span>.0000  <span class="m">1</span>.0000   <span class="m">1</span>.0    !<span class="o">(</span>gamma point<span class="o">)</span>
          <span class="m">0</span>.9500  <span class="m">0</span>.9500  <span class="m">0</span>.9500   <span class="m">1</span>.0
          <span class="m">0</span>.9000  <span class="m">0</span>.9000  <span class="m">0</span>.9000   <span class="m">1</span>.0
          <span class="m">0</span>.8500  <span class="m">0</span>.8500  <span class="m">0</span>.8500   <span class="m">1</span>.0
          <span class="m">0</span>.8000  <span class="m">0</span>.8000  <span class="m">0</span>.8000   <span class="m">1</span>.0
          <span class="m">0</span>.7500  <span class="m">0</span>.7500  <span class="m">0</span>.7500   <span class="m">1</span>.0
          <span class="m">0</span>.7000  <span class="m">0</span>.7000  <span class="m">0</span>.7000   <span class="m">1</span>.0
          <span class="m">0</span>.6500  <span class="m">0</span>.6500  <span class="m">0</span>.6500   <span class="m">1</span>.0
          <span class="m">0</span>.6000  <span class="m">0</span>.6000  <span class="m">0</span>.6000   <span class="m">1</span>.0
          <span class="m">0</span>.5500  <span class="m">0</span>.5500  <span class="m">0</span>.5500   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.5000  <span class="m">0</span>.5000   <span class="m">1</span>.0    !<span class="o">(</span>L point<span class="o">)</span>
          <span class="m">0</span>.5000  <span class="m">0</span>.4500  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.4000  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3500  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3000  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.2500  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.2000  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1500  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1000  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.0500  <span class="m">0</span>.5000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.0000  <span class="m">0</span>.5000   <span class="m">1</span>.0    !<span class="o">(</span>X point<span class="o">)</span>
          <span class="m">0</span>.5000  <span class="m">0</span>.0250  <span class="m">0</span>.5250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.0500  <span class="m">0</span>.5500   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.0750  <span class="m">0</span>.5750   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1000  <span class="m">0</span>.6000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1250  <span class="m">0</span>.6250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1500  <span class="m">0</span>.6500   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.1750  <span class="m">0</span>.6750   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.2000  <span class="m">0</span>.7000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.2250  <span class="m">0</span>.7250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.2500  <span class="m">0</span>.7500   <span class="m">1</span>.0    !<span class="o">(</span>W point<span class="o">)</span>
          <span class="m">0</span>.5000  <span class="m">0</span>.2750  <span class="m">0</span>.7250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3000  <span class="m">0</span>.7000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3250  <span class="m">0</span>.6750   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3500  <span class="m">0</span>.6500   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.3750  <span class="m">0</span>.6250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.4000  <span class="m">0</span>.6000   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.4250  <span class="m">0</span>.5750   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.4500  <span class="m">0</span>.5500   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.4750  <span class="m">0</span>.5250   <span class="m">1</span>.0
          <span class="m">0</span>.5000  <span class="m">0</span>.5000  <span class="m">0</span>.5000   <span class="m">1</span>.0    !<span class="o">(</span>L point<span class="o">)</span>

!Wavevector list number <span class="m">2</span> <span class="o">(</span>Cartesian directions <span class="k">for</span> non-analytic gamma phonons<span class="o">)</span>

!The output <span class="k">for</span> this calculation must be cut-and-pasted into the
! t59_out.freq file to be used as band2eps input to get proper LO-TO 
! splitting at gamma.  Note that gamma occurrs twice.

  nph2l    <span class="m">1</span>       ! number of directions in list <span class="m">2</span>

  qph2l   <span class="m">1</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0    <span class="m">0</span>.0

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = anaddb</span>
<span class="c1">#%% test_chain = trf2_1.in, trf2_3.in, trf2_4.in, trf2_5.in, trf2_6.in, trf2_7.in</span>
<span class="c1">#%% input_ddb = trf2_3.ddb.out </span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   trf2_5.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options=-easy</span>
<span class="c1">#%% psp_files =  13al.981214.fhi, 33as.pspnc </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = X. Gonze</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = Input file for the anaddb code. Analysis of the SiO2 DDB</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e13c8a13-2fa1-4d7c-a453-592f2ca6c5f2", "#uuid-9fdcff53-47a0-473c-9149-989a3e88d5a5") }); </script>

<p>Note that <a class="wikilink codevar-wikilink" href="../../variables/anaddb#ifcflag">ifcflag</a> is again activated.
Indeed, in order to compute a phonon band structure using the Fourier
interpolation, the IFCs are required. This is why the two first groups of
variables, needed to generate the IFCs are still defined. The third group of
variables is now restricted to <a class="wikilink codevar-wikilink" href="../../variables/anaddb#dipdip">dipdip</a> only.</p>
<p>Then, come the input variables needed to define the list of q wavevectors in the band structure:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#eivec">eivec</a>: flag to turn on the analysis of phonon eigenvectors</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nph1l">nph1l</a>: number of q-points for phonon interpolation</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#qph1l">qph1l</a>: list of q-points for phonon interpolation</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nph2l">nph2l</a>: number of q-directions for LO-TO correction</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#qph2l">qph2l</a>: list of q-directions for LO-TO correction</li>
</ul>
<p>Now, you should issue :</p>
<div class="codehilite"><pre><span></span>anaddb &lt; trf2_5.files &gt; trf2_5.log
</pre></div>


<p>It will last only a few seconds.</p>
<p>The file trf2_5.out contains the list of eigenvalues, for all the needed
q-wavevectors. You can edit it, and have a look at the different sections of
the file. Note that the interatomic force constants are computed (they are
needed for the Fourier interpolation), but not printed.</p>
<div class="text-center"><button type="button" id="uuid-3365a582-a488-405c-b12e-d72f3aee9e0a" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Refs/trf2_5.out
</button></div>

<div id="uuid-6f5b3188-c0d8-4152-b8f1-b9a7a338f6c9" class="my_dialog" title="tests/tutorespfn/Refs/trf2_5.out" hidden><div><pre class="small-text">

.Version 8.4.2 of ANADDB 
.(MPI version, prepared for a x86_64_linux_gnu5.3 computer) 

.Copyright (C) 1998-2018 ABINIT group . 
 ANADDB comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read ~abinit/doc/users/acknowledgments.html for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Mon  5 Jun 2017.
- ( at 16h29 )


================================================================================

 -outvars_anaddb: echo values of input variables ----------------------

 Flags :
     ifcflag         1
 Miscellaneous information :
       eivec         4
         asr         1
      chneut         1
 Interatomic Force Constants Inputs :
      dipdip         1
      ifcana         0
      ifcout         0
 Description of grid 1 :
        brav         2
       ngqpt         4         4         4
      nqshft         1
      q1shft
                     0.00000000E+00  0.00000000E+00  0.00000000E+00
 First list of wavevector (reduced coord.) :
       nph1l        71
       qph1l
                     0.00000000E+00  0.00000000E+00  0.00000000E+00    1.000E+00
                     3.75000000E-02  3.75000000E-02  7.50000000E-02    1.000E+00
                     7.50000000E-02  7.50000000E-02  1.50000000E-01    1.000E+00
                     1.12500000E-01  1.12500000E-01  2.25000000E-01    1.000E+00
                     1.50000000E-01  1.50000000E-01  3.00000000E-01    1.000E+00
                     1.87500000E-01  1.87500000E-01  3.75000000E-01    1.000E+00
                     2.25000000E-01  2.25000000E-01  4.50000000E-01    1.000E+00
                     2.62500000E-01  2.62500000E-01  5.25000000E-01    1.000E+00
                     3.00000000E-01  3.00000000E-01  6.00000000E-01    1.000E+00
                     3.37500000E-01  3.37500000E-01  6.75000000E-01    1.000E+00
                     3.75000000E-01  3.75000000E-01  7.50000000E-01    1.000E+00
                     3.87500000E-01  3.87500000E-01  7.75000000E-01    1.000E+00
                     4.00000000E-01  4.00000000E-01  8.00000000E-01    1.000E+00
                     4.12500000E-01  4.12500000E-01  8.25000000E-01    1.000E+00
                     4.25000000E-01  4.25000000E-01  8.50000000E-01    1.000E+00
                     4.37500000E-01  4.37500000E-01  8.75000000E-01    1.000E+00
                     4.50000000E-01  4.50000000E-01  9.00000000E-01    1.000E+00
                     4.62500000E-01  4.62500000E-01  9.25000000E-01    1.000E+00
                     4.75000000E-01  4.75000000E-01  9.50000000E-01    1.000E+00
                     4.87500000E-01  4.87500000E-01  9.75000000E-01    1.000E+00
                     5.00000000E-01  5.00000000E-01  1.00000000E+00    1.000E+00
                     5.50000000E-01  5.50000000E-01  1.00000000E+00    1.000E+00
                     6.00000000E-01  6.00000000E-01  1.00000000E+00    1.000E+00
                     6.50000000E-01  6.50000000E-01  1.00000000E+00    1.000E+00
                     7.00000000E-01  7.00000000E-01  1.00000000E+00    1.000E+00
                     7.50000000E-01  7.50000000E-01  1.00000000E+00    1.000E+00
                     8.00000000E-01  8.00000000E-01  1.00000000E+00    1.000E+00
                     8.50000000E-01  8.50000000E-01  1.00000000E+00    1.000E+00
                     9.00000000E-01  9.00000000E-01  1.00000000E+00    1.000E+00
                     9.50000000E-01  9.50000000E-01  1.00000000E+00    1.000E+00
                     1.00000000E+00  1.00000000E+00  1.00000000E+00    1.000E+00
                     9.50000000E-01  9.50000000E-01  9.50000000E-01    1.000E+00
                     9.00000000E-01  9.00000000E-01  9.00000000E-01    1.000E+00
                     8.50000000E-01  8.50000000E-01  8.50000000E-01    1.000E+00
                     8.00000000E-01  8.00000000E-01  8.00000000E-01    1.000E+00
                     7.50000000E-01  7.50000000E-01  7.50000000E-01    1.000E+00
                     7.00000000E-01  7.00000000E-01  7.00000000E-01    1.000E+00
                     6.50000000E-01  6.50000000E-01  6.50000000E-01    1.000E+00
                     6.00000000E-01  6.00000000E-01  6.00000000E-01    1.000E+00
                     5.50000000E-01  5.50000000E-01  5.50000000E-01    1.000E+00
                     5.00000000E-01  5.00000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  4.50000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  4.00000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  3.50000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  3.00000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  2.50000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  2.00000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  1.50000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  1.00000000E-01  5.00000000E-01    1.000E+00
                     5.00000000E-01  5.00000000E-02  5.00000000E-01    1.000E+00
                     5.00000000E-01  0.00000000E+00  5.00000000E-01    1.000E+00
                     5.00000000E-01  2.50000000E-02  5.25000000E-01    1.000E+00
                     5.00000000E-01  5.00000000E-02  5.50000000E-01    1.000E+00
                     5.00000000E-01  7.50000000E-02  5.75000000E-01    1.000E+00
                     5.00000000E-01  1.00000000E-01  6.00000000E-01    1.000E+00
                     5.00000000E-01  1.25000000E-01  6.25000000E-01    1.000E+00
                     5.00000000E-01  1.50000000E-01  6.50000000E-01    1.000E+00
                     5.00000000E-01  1.75000000E-01  6.75000000E-01    1.000E+00
                     5.00000000E-01  2.00000000E-01  7.00000000E-01    1.000E+00
                     5.00000000E-01  2.25000000E-01  7.25000000E-01    1.000E+00
                     5.00000000E-01  2.50000000E-01  7.50000000E-01    1.000E+00
                     5.00000000E-01  2.75000000E-01  7.25000000E-01    1.000E+00
                     5.00000000E-01  3.00000000E-01  7.00000000E-01    1.000E+00
                     5.00000000E-01  3.25000000E-01  6.75000000E-01    1.000E+00
                     5.00000000E-01  3.50000000E-01  6.50000000E-01    1.000E+00
                     5.00000000E-01  3.75000000E-01  6.25000000E-01    1.000E+00
                     5.00000000E-01  4.00000000E-01  6.00000000E-01    1.000E+00
                     5.00000000E-01  4.25000000E-01  5.75000000E-01    1.000E+00
                     5.00000000E-01  4.50000000E-01  5.50000000E-01    1.000E+00
                     5.00000000E-01  4.75000000E-01  5.25000000E-01    1.000E+00
                     5.00000000E-01  5.00000000E-01  5.00000000E-01    1.000E+00
 Second list of wavevector (cart. coord.) :
       nph2l         1
       qph2l
                     1.00000000E+00  0.00000000E+00  0.00000000E+00    0.000E+00

================================================================================

 read the DDB information and perform some checks

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  5.3050000  5.3050000  G(1)= -0.0942507  0.0942507  0.0942507
 R(2)=  5.3050000  0.0000000  5.3050000  G(2)=  0.0942507 -0.0942507  0.0942507
 R(3)=  5.3050000  5.3050000  0.0000000  G(3)=  0.0942507  0.0942507 -0.0942507
 Unit cell volume ucvol=  2.9859750E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Now the whole DDB is in central memory

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.022872        0.000000
       1               2       -0.000000        0.000000
       1               3       -0.000000        0.000000
       2               1       -0.000000        0.000000
       2               2       -0.022872        0.000000
       2               3        0.000000        0.000000
       3               1        0.000000        0.000000
       3               2        0.000000        0.000000
       3               3       -0.022872        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality,
 and eventual restriction to some part :
   atom    displacement
         1         1    2.115792E+00    2.191360E-17    2.223726E-17
         1         2    2.191360E-17    2.115792E+00   -2.158994E-17
         1         3   -2.191360E-17   -2.191360E-17    2.115792E+00
         2         1   -2.115792E+00   -2.191360E-17   -2.223726E-17
         2         2   -2.191360E-17   -2.115792E+00    2.158994E-17
         2         3    2.191360E-17    2.191360E-17   -2.115792E+00
 Now, the imaginary part of the dynamical matrix is zeroed

================================================================================

 Calculation of the interatomic forces 

-begin at tcpu      0.029  and twall      0.029 sec
       Homogeneous q point set in the B.Z.
 Grid q points  :       32
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   0.00000000E+00  2.50000000E-01  2.50000000E-01
  3)   0.00000000E+00  5.00000000E-01  5.00000000E-01
  4)   0.00000000E+00 -2.50000000E-01 -2.50000000E-01
  5)   2.50000000E-01  0.00000000E+00  2.50000000E-01
  6)   2.50000000E-01  2.50000000E-01  5.00000000E-01
  7)   2.50000000E-01 -2.50000000E-01 -1.11022302E-16
  8)   5.00000000E-01  0.00000000E+00  5.00000000E-01
  9)  -2.50000000E-01  0.00000000E+00 -2.50000000E-01
 10)  -2.50000000E-01  2.50000000E-01 -1.11022302E-16
 11)  -2.50000000E-01 -2.50000000E-01 -5.00000000E-01
 12)   2.50000000E-01  2.50000000E-01  0.00000000E+00
 13)   2.50000000E-01  5.00000000E-01  2.50000000E-01
 14)   2.50000000E-01  7.50000000E-01  5.00000000E-01
 15)   2.50000000E-01 -1.11022302E-16 -2.50000000E-01
 16)   5.00000000E-01  2.50000000E-01  2.50000000E-01
 17)   5.00000000E-01  5.00000000E-01  5.00000000E-01
 18)   5.00000000E-01 -1.11022302E-16 -1.11022302E-16
 19)   7.50000000E-01  2.50000000E-01  5.00000000E-01
 20)  -1.11022302E-16  2.50000000E-01 -2.50000000E-01
 21)  -1.11022302E-16  5.00000000E-01 -1.11022302E-16
 22)  -1.11022302E-16 -1.11022302E-16 -5.00000000E-01
 23)   5.00000000E-01  5.00000000E-01  0.00000000E+00
 24)   5.00000000E-01  7.50000000E-01  2.50000000E-01
 25)   5.00000000E-01  2.50000000E-01 -2.50000000E-01
 26)   7.50000000E-01  5.00000000E-01  2.50000000E-01
 27)   2.50000000E-01  5.00000000E-01 -2.50000000E-01
 28)  -2.50000000E-01 -2.50000000E-01  0.00000000E+00
 29)  -2.50000000E-01 -1.11022302E-16  2.50000000E-01
 30)  -2.50000000E-01 -5.00000000E-01 -2.50000000E-01
 31)  -1.11022302E-16 -2.50000000E-01  2.50000000E-01
 32)  -5.00000000E-01 -2.50000000E-01 -2.50000000E-01

 The interatomic forces have been obtained

================================================================================

 Treat the first list of vectors 


  Phonon wavevector (reduced coordinates) :  0.00000  0.00000  0.00000
 Phonon energies in Hartree :
   0.000000E+00  0.000000E+00  0.000000E+00  1.568554E-03  1.568554E-03
   1.568554E-03
 Phonon frequencies in cm-1    :
-  0.000000E+00  0.000000E+00  0.000000E+00  3.442577E+02  3.442577E+02
-  3.442577E+02

 Analysis of degeneracies and characters (maximum tolerance=1.00E-06 a.u.)
 Symmetry characters of vibration mode #   1
       degenerate with vibration modes #   2 to    3
  3.0 -1.0 -1.0 -1.0  1.0 -1.0  1.0 -1.0 -0.0  0.0 -0.0  0.0  1.0 -1.0 -1.0  1.0
 -0.0 -0.0  0.0  0.0  1.0  1.0 -1.0 -1.0
 Symmetry characters of vibration mode #   4
       degenerate with vibration modes #   5 to    6
  3.0 -1.0 -1.0 -1.0  1.0 -1.0  1.0 -1.0  0.0  0.0 -0.0  0.0  1.0 -1.0 -1.0  1.0
 -0.0 -0.0  0.0  0.0  1.0  1.0 -1.0 -1.0

  Phonon wavevector (reduced coordinates) :  0.03750  0.03750  0.07500
 Phonon energies in Hartree :
   7.795285E-05  9.980229E-05  1.577695E-04  1.562166E-03  1.567662E-03
   1.724379E-03
 Phonon frequencies in cm-1    :
-  1.710867E+01  2.190407E+01  3.462641E+01  3.428557E+02  3.440620E+02
-  3.784574E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1241055642E-02
   in units km/s:              2.71505
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7237349267E-03
   in SI units K  :            228.53714

 Speed of sound for this q and mode:
   in atomic units:     0.1588911710E-02
   in units km/s:              3.47605
 Partial Debye temperature for this q and mode:
   in atomic units:     0.9265909288E-03
   in SI units K  :            292.59393

 Speed of sound for this q and mode:
   in atomic units:     0.2511784601E-02
   in units km/s:              5.49501
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1464774167E-02
   in SI units K  :            462.53855


  Phonon wavevector (reduced coordinates) :  0.07500  0.07500  0.15000
 Phonon energies in Hartree :
   1.510316E-04  1.997060E-04  3.074081E-04  1.546884E-03  1.564208E-03
   1.706321E-03
 Phonon frequencies in cm-1    :
-  3.314760E+01  4.383041E+01  6.746829E+01  3.395018E+02  3.433040E+02
-  3.744942E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1202256110E-02
   in units km/s:              2.63017
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7011085630E-03
   in SI units K  :            221.39231

 Speed of sound for this q and mode:
   in atomic units:     0.1589719247E-02
   in units km/s:              3.47781
 Partial Debye temperature for this q and mode:
   in atomic units:     0.9270618527E-03
   in SI units K  :            292.74263

 Speed of sound for this q and mode:
   in atomic units:     0.2447060021E-02
   in units km/s:              5.35341
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1427029333E-02
   in SI units K  :            450.61969


  Phonon wavevector (reduced coordinates) :  0.11250  0.11250  0.22500
 Phonon energies in Hartree :
   2.159182E-04  2.972209E-04  4.421728E-04  1.531171E-03  1.556374E-03
   1.676685E-03
 Phonon frequencies in cm-1    :
-  4.738857E+01  6.523244E+01  9.704572E+01  3.360532E+02  3.415847E+02
-  3.679897E+02

  Phonon wavevector (reduced coordinates) :  0.15000  0.15000  0.30000
 Phonon energies in Hartree :
   2.717020E-04  3.869205E-04  5.580036E-04  1.520603E-03  1.542538E-03
   1.638666E-03
 Phonon frequencies in cm-1    :
-  5.963171E+01  8.491924E+01  1.224676E+02  3.337337E+02  3.385479E+02
-  3.596455E+02

  Phonon wavevector (reduced coordinates) :  0.18750  0.18750  0.37500
 Phonon energies in Hartree :
   3.194811E-04  4.630449E-04  6.538201E-04  1.510670E-03  1.522530E-03
   1.600930E-03
 Phonon frequencies in cm-1    :
-  7.011800E+01  1.016266E+02  1.434969E+02  3.315538E+02  3.341567E+02
-  3.513635E+02

  Phonon wavevector (reduced coordinates) :  0.22500  0.22500  0.45000
 Phonon energies in Hartree :
   3.607519E-04  5.231523E-04  7.299392E-04  1.488838E-03  1.498259E-03
   1.576447E-03
 Phonon frequencies in cm-1    :
-  7.917588E+01  1.148187E+02  1.602031E+02  3.267622E+02  3.288299E+02
-  3.459902E+02

  Phonon wavevector (reduced coordinates) :  0.26250  0.26250  0.52500
 Phonon energies in Hartree :
   3.956084E-04  5.691329E-04  7.861710E-04  1.457987E-03  1.473367E-03
   1.564636E-03
 Phonon frequencies in cm-1    :
-  8.682601E+01  1.249102E+02  1.725446E+02  3.199911E+02  3.233668E+02
-  3.433980E+02

  Phonon wavevector (reduced coordinates) :  0.30000  0.30000  0.60000
 Phonon energies in Hartree :
   4.222266E-04  6.026179E-04  8.226684E-04  1.433654E-03  1.451995E-03
   1.558675E-03
 Phonon frequencies in cm-1    :
-  9.266804E+01  1.322593E+02  1.805548E+02  3.146507E+02  3.186761E+02
-  3.420897E+02

  Phonon wavevector (reduced coordinates) :  0.33750  0.33750  0.67500
 Phonon energies in Hartree :
   4.381552E-04  6.156317E-04  8.453991E-04  1.424197E-03  1.437169E-03
   1.563291E-03
 Phonon frequencies in cm-1    :
-  9.616394E+01  1.351155E+02  1.855437E+02  3.125752E+02  3.154222E+02
-  3.431027E+02

  Phonon wavevector (reduced coordinates) :  0.37500  0.37500  0.75000
 Phonon energies in Hartree :
   4.424639E-04  5.918846E-04  8.680708E-04  1.426644E-03  1.429647E-03
   1.588139E-03
 Phonon frequencies in cm-1    :
-  9.710960E+01  1.299036E+02  1.905195E+02  3.131121E+02  3.137712E+02
-  3.485563E+02

  Phonon wavevector (reduced coordinates) :  0.38750  0.38750  0.77500
 Phonon energies in Hartree :
   4.415964E-04  5.752161E-04  8.769186E-04  1.428195E-03  1.428544E-03
   1.601588E-03
 Phonon frequencies in cm-1    :
-  9.691920E+01  1.262453E+02  1.924614E+02  3.134527E+02  3.135292E+02
-  3.515080E+02

  Phonon wavevector (reduced coordinates) :  0.40000  0.40000  0.80000
 Phonon energies in Hartree :
   4.398251E-04  5.552767E-04  8.860997E-04  1.427989E-03  1.429514E-03
   1.617061E-03
 Phonon frequencies in cm-1    :
-  9.653045E+01  1.218691E+02  1.944764E+02  3.134074E+02  3.137420E+02
-  3.549040E+02

  Phonon wavevector (reduced coordinates) :  0.41250  0.41250  0.82500
 Phonon energies in Hartree :
   4.373612E-04  5.331477E-04  8.952406E-04  1.427870E-03  1.430443E-03
   1.633819E-03
 Phonon frequencies in cm-1    :
-  9.598969E+01  1.170124E+02  1.964826E+02  3.133811E+02  3.139459E+02
-  3.585818E+02

  Phonon wavevector (reduced coordinates) :  0.42500  0.42500  0.85000
 Phonon energies in Hartree :
   4.344483E-04  5.100432E-04  9.039643E-04  1.428068E-03  1.430956E-03
   1.650954E-03
 Phonon frequencies in cm-1    :
-  9.535037E+01  1.119415E+02  1.983972E+02  3.134247E+02  3.140585E+02
-  3.623425E+02

  Phonon wavevector (reduced coordinates) :  0.43750  0.43750  0.87500
 Phonon energies in Hartree :
   4.313508E-04  4.872491E-04  9.119302E-04  1.428469E-03  1.431110E-03
   1.667494E-03
 Phonon frequencies in cm-1    :
-  9.467057E+01  1.069388E+02  2.001455E+02  3.135126E+02  3.140924E+02
-  3.659727E+02

  Phonon wavevector (reduced coordinates) :  0.45000  0.45000  0.90000
 Phonon energies in Hartree :
   4.283401E-04  4.660834E-04  9.188482E-04  1.428964E-03  1.431008E-03
   1.682498E-03
 Phonon frequencies in cm-1    :
-  9.400978E+01  1.022935E+02  2.016639E+02  3.136213E+02  3.140700E+02
-  3.692656E+02

  Phonon wavevector (reduced coordinates) :  0.46250  0.46250  0.92500
 Phonon energies in Hartree :
   4.256760E-04  4.478502E-04  9.244801E-04  1.429457E-03  1.430770E-03
   1.695118E-03
 Phonon frequencies in cm-1    :
-  9.342507E+01  9.829177E+01  2.028999E+02  3.137295E+02  3.140176E+02
-  3.720354E+02

  Phonon wavevector (reduced coordinates) :  0.47500  0.47500  0.95000
 Phonon energies in Hartree :
   4.235884E-04  4.337672E-04  9.286389E-04  1.429869E-03  1.430506E-03
   1.704656E-03
 Phonon frequencies in cm-1    :
-  9.296692E+01  9.520089E+01  2.038127E+02  3.138200E+02  3.139597E+02
-  3.741288E+02

  Phonon wavevector (reduced coordinates) :  0.48750  0.48750  0.97500
 Phonon energies in Hartree :
   4.222584E-04  4.248544E-04  9.311893E-04  1.430141E-03  1.430308E-03
   1.710592E-03
 Phonon frequencies in cm-1    :
-  9.267502E+01  9.324477E+01  2.043724E+02  3.138796E+02  3.139163E+02
-  3.754316E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.50000  1.00000
 Phonon energies in Hartree :
   4.218018E-04  4.218018E-04  9.320487E-04  1.430235E-03  1.430235E-03
   1.712607E-03
 Phonon frequencies in cm-1    :
-  9.257480E+01  9.257480E+01  2.045610E+02  3.139004E+02  3.139004E+02
-  3.758737E+02

  Phonon wavevector (reduced coordinates) :  0.55000  0.55000  1.00000
 Phonon energies in Hartree :
   4.224286E-04  4.224286E-04  9.198501E-04  1.430392E-03  1.430392E-03
   1.713199E-03
 Phonon frequencies in cm-1    :
-  9.271237E+01  9.271237E+01  2.018838E+02  3.139348E+02  3.139348E+02
-  3.760037E+02

  Phonon wavevector (reduced coordinates) :  0.60000  0.60000  1.00000
 Phonon energies in Hartree :
   4.222994E-04  4.222994E-04  8.837014E-04  1.431902E-03  1.431902E-03
   1.714875E-03
 Phonon frequencies in cm-1    :
-  9.268400E+01  9.268400E+01  1.939500E+02  3.142661E+02  3.142661E+02
-  3.763715E+02

  Phonon wavevector (reduced coordinates) :  0.65000  0.65000  1.00000
 Phonon energies in Hartree :
   4.163542E-04  4.163542E-04  8.249109E-04  1.437339E-03  1.437339E-03
   1.717357E-03
 Phonon frequencies in cm-1    :
-  9.137919E+01  9.137919E+01  1.810470E+02  3.154595E+02  3.154595E+02
-  3.769163E+02

  Phonon wavevector (reduced coordinates) :  0.70000  0.70000  1.00000
 Phonon energies in Hartree :
   3.988215E-04  3.988215E-04  7.455435E-04  1.449362E-03  1.449362E-03
   1.720255E-03
 Phonon frequencies in cm-1    :
-  8.753121E+01  8.753121E+01  1.636279E+02  3.180982E+02  3.180982E+02
-  3.775523E+02

  Phonon wavevector (reduced coordinates) :  0.75000  0.75000  1.00000
 Phonon energies in Hartree :
   3.656332E-04  3.656332E-04  6.482449E-04  1.468950E-03  1.468950E-03
   1.723162E-03
 Phonon frequencies in cm-1    :
-  8.024721E+01  8.024721E+01  1.422733E+02  3.223972E+02  3.223972E+02
-  3.781903E+02

  Phonon wavevector (reduced coordinates) :  0.80000  0.80000  1.00000
 Phonon energies in Hartree :
   3.156943E-04  3.156943E-04  5.360220E-04  1.494410E-03  1.494410E-03
   1.725744E-03
 Phonon frequencies in cm-1    :
-  6.928688E+01  6.928688E+01  1.176432E+02  3.279850E+02  3.279850E+02
-  3.787570E+02

  Phonon wavevector (reduced coordinates) :  0.85000  0.85000  1.00000
 Phonon energies in Hartree :
   2.506332E-04  2.506332E-04  4.120246E-04  1.521753E-03  1.521753E-03
   1.727796E-03
 Phonon frequencies in cm-1    :
-  5.500763E+01  5.500763E+01  9.042895E+01  3.339861E+02  3.339861E+02
-  3.792073E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1410758998E-02
   in units km/s:              3.08631
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8226992616E-03
   in SI units K  :            259.78757

 Speed of sound for this q and mode:
   in atomic units:     0.1410758998E-02
   in units km/s:              3.08631
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8226992616E-03
   in SI units K  :            259.78757

 Speed of sound for this q and mode:
   in atomic units:     0.2319195732E-02
   in units km/s:              5.07368
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1352463899E-02
   in SI units K  :            427.07381


  Phonon wavevector (reduced coordinates) :  0.90000  0.90000  1.00000
 Phonon energies in Hartree :
   1.737148E-04  1.737148E-04  2.793762E-04  1.546012E-03  1.546012E-03
   1.729238E-03
 Phonon frequencies in cm-1    :
-  3.812600E+01  3.812600E+01  6.131598E+01  3.393103E+02  3.393103E+02
-  3.795239E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1466703808E-02
   in units km/s:              3.20870
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8553240780E-03
   in SI units K  :            270.08966

 Speed of sound for this q and mode:
   in atomic units:     0.1466703808E-02
   in units km/s:              3.20870
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8553240780E-03
   in SI units K  :            270.08966

 Speed of sound for this q and mode:
   in atomic units:     0.2358820295E-02
   in units km/s:              5.16037
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1375571389E-02
   in SI units K  :            434.37057


  Phonon wavevector (reduced coordinates) :  0.95000  0.95000  1.00000
 Phonon energies in Hartree :
   8.883718E-05  8.883718E-05  1.410789E-04  1.562645E-03  1.562645E-03
   1.730079E-03
 Phonon frequencies in cm-1    :
-  1.949751E+01  1.949751E+01  3.096325E+01  3.429610E+02  3.429610E+02
-  3.797084E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1500134812E-02
   in units km/s:              3.28183
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8748197270E-03
   in SI units K  :            276.24589

 Speed of sound for this q and mode:
   in atomic units:     0.1500134812E-02
   in units km/s:              3.28183
 Partial Debye temperature for this q and mode:
   in atomic units:     0.8748197270E-03
   in SI units K  :            276.24589

 Speed of sound for this q and mode:
   in atomic units:     0.2382307034E-02
   in units km/s:              5.21175
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1389267933E-02
   in SI units K  :            438.69560


  Phonon wavevector (reduced coordinates) :  1.00000  1.00000  1.00000
 Phonon energies in Hartree :
   0.000000E+00  0.000000E+00  0.000000E+00  1.568554E-03  1.568554E-03
   1.568554E-03
 Phonon frequencies in cm-1    :
-  0.000000E+00  0.000000E+00  0.000000E+00  3.442577E+02  3.442577E+02
-  3.442577E+02

  Phonon wavevector (reduced coordinates) :  0.95000  0.95000  0.95000
 Phonon energies in Hartree :
   6.837554E-05  6.837554E-05  1.350811E-04  1.566706E-03  1.566706E-03
   1.725215E-03
 Phonon frequencies in cm-1    :
-  1.500670E+01  1.500670E+01  2.964687E+01  3.438523E+02  3.438523E+02
-  3.786409E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1333231734E-02
   in units km/s:              2.91670
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7774884050E-03
   in SI units K  :            245.51113

 Speed of sound for this q and mode:
   in atomic units:     0.1333231734E-02
   in units km/s:              2.91670
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7774884050E-03
   in SI units K  :            245.51113

 Speed of sound for this q and mode:
   in atomic units:     0.2633900813E-02
   in units km/s:              5.76216
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1535987547E-02
   in SI units K  :            485.02593


  Phonon wavevector (reduced coordinates) :  0.90000  0.90000  0.90000
 Phonon energies in Hartree :
   1.329417E-04  1.329417E-04  2.681893E-04  1.561387E-03  1.561387E-03
   1.710765E-03
 Phonon frequencies in cm-1    :
-  2.917734E+01  2.917734E+01  5.886075E+01  3.426849E+02  3.426849E+02
-  3.754696E+02
 Speed of sound for this q and mode:
   in atomic units:     0.1296093084E-02
   in units km/s:              2.83545
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7558306021E-03
   in SI units K  :            238.67214

 Speed of sound for this q and mode:
   in atomic units:     0.1296093084E-02
   in units km/s:              2.83545
 Partial Debye temperature for this q and mode:
   in atomic units:     0.7558306021E-03
   in SI units K  :            238.67214

 Speed of sound for this q and mode:
   in atomic units:     0.2614666998E-02
   in units km/s:              5.72008
 Partial Debye temperature for this q and mode:
   in atomic units:     0.1524771141E-02
   in SI units K  :            481.48407


  Phonon wavevector (reduced coordinates) :  0.85000  0.85000  0.85000
 Phonon energies in Hartree :
   1.901717E-04  1.901717E-04  3.971959E-04  1.553307E-03  1.553307E-03
   1.689692E-03
 Phonon frequencies in cm-1    :
-  4.173787E+01  4.173787E+01  8.717443E+01  3.409115E+02  3.409115E+02
-  3.708445E+02

  Phonon wavevector (reduced coordinates) :  0.80000  0.80000  0.80000
 Phonon energies in Hartree :
   2.371963E-04  2.371963E-04  5.195984E-04  1.543697E-03  1.543697E-03
   1.665803E-03
 Phonon frequencies in cm-1    :
-  5.205858E+01  5.205858E+01  1.140387E+02  3.388022E+02  3.388022E+02
-  3.656016E+02

  Phonon wavevector (reduced coordinates) :  0.75000  0.75000  0.75000
 Phonon energies in Hartree :
   2.722873E-04  2.722873E-04  6.322816E-04  1.534136E-03  1.534136E-03
   1.643150E-03
 Phonon frequencies in cm-1    :
-  5.976015E+01  5.976015E+01  1.387698E+02  3.367039E+02  3.367039E+02
-  3.606296E+02

  Phonon wavevector (reduced coordinates) :  0.70000  0.70000  0.70000
 Phonon energies in Hartree :
   2.953189E-04  2.953189E-04  7.314530E-04  1.526110E-03  1.526110E-03
   1.625042E-03
 Phonon frequencies in cm-1    :
-  6.481501E+01  6.481501E+01  1.605354E+02  3.349424E+02  3.349424E+02
-  3.566555E+02

  Phonon wavevector (reduced coordinates) :  0.65000  0.65000  0.65000
 Phonon energies in Hartree :
   3.079350E-04  3.079350E-04  8.130088E-04  1.520490E-03  1.520490E-03
   1.613206E-03
 Phonon frequencies in cm-1    :
-  6.758392E+01  6.758392E+01  1.784348E+02  3.337090E+02  3.337090E+02
-  3.540578E+02

  Phonon wavevector (reduced coordinates) :  0.60000  0.60000  0.60000
 Phonon energies in Hartree :
   3.131609E-04  3.131609E-04  8.733514E-04  1.517288E-03  1.517288E-03
   1.607341E-03
 Phonon frequencies in cm-1    :
-  6.873087E+01  6.873087E+01  1.916785E+02  3.330062E+02  3.330062E+02
-  3.527705E+02

  Phonon wavevector (reduced coordinates) :  0.55000  0.55000  0.55000
 Phonon energies in Hartree :
   3.144589E-04  3.144589E-04  9.101687E-04  1.515870E-03  1.515870E-03
   1.605454E-03
 Phonon frequencies in cm-1    :
-  6.901574E+01  6.901574E+01  1.997589E+02  3.326951E+02  3.326951E+02
-  3.523564E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.50000  0.50000
 Phonon energies in Hartree :
   3.145491E-04  3.145491E-04  9.225051E-04  1.515503E-03  1.515503E-03
   1.605176E-03
 Phonon frequencies in cm-1    :
-  6.903555E+01  6.903555E+01  2.024665E+02  3.326144E+02  3.326144E+02
-  3.522955E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.45000  0.50000
 Phonon energies in Hartree :
   3.223715E-04  3.332238E-04  9.172299E-04  1.510985E-03  1.515740E-03
   1.598191E-03
 Phonon frequencies in cm-1    :
-  7.075237E+01  7.313418E+01  2.013087E+02  3.316229E+02  3.326665E+02
-  3.507624E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.40000  0.50000
 Phonon energies in Hartree :
   3.430001E-04  3.822372E-04  9.018838E-04  1.498556E-03  1.515169E-03
   1.581233E-03
 Phonon frequencies in cm-1    :
-  7.527982E+01  8.389137E+01  1.979406E+02  3.288951E+02  3.325411E+02
-  3.470404E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.35000  0.50000
 Phonon energies in Hartree :
   3.698289E-04  4.462496E-04  8.785494E-04  1.481231E-03  1.507478E-03
   1.567838E-03
 Phonon frequencies in cm-1    :
-  8.116805E+01  9.794047E+01  1.928193E+02  3.250926E+02  3.308531E+02
-  3.441006E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.30000  0.50000
 Phonon energies in Hartree :
   3.958854E-04  5.073143E-04  8.533551E-04  1.462957E-03  1.487554E-03
   1.572167E-03
 Phonon frequencies in cm-1    :
-  8.688681E+01  1.113426E+02  1.872898E+02  3.210820E+02  3.264804E+02
-  3.450507E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.25000  0.50000
 Phonon energies in Hartree :
   4.159581E-04  5.442385E-04  8.398450E-04  1.447372E-03  1.465264E-03
   1.591419E-03
 Phonon frequencies in cm-1    :
-  9.129224E+01  1.194465E+02  1.843247E+02  3.176615E+02  3.215882E+02
-  3.492760E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.20000  0.50000
 Phonon energies in Hartree :
   4.274278E-04  5.412255E-04  8.509430E-04  1.436702E-03  1.448188E-03
   1.619981E-03
 Phonon frequencies in cm-1    :
-  9.380956E+01  1.187853E+02  1.867604E+02  3.153196E+02  3.178404E+02
-  3.555448E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.15000  0.50000
 Phonon energies in Hartree :
   4.304933E-04  5.078008E-04  8.788541E-04  1.431249E-03  1.437678E-03
   1.652732E-03
 Phonon frequencies in cm-1    :
-  9.448236E+01  1.114494E+02  1.928862E+02  3.141229E+02  3.155338E+02
-  3.627329E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.10000  0.50000
 Phonon energies in Hartree :
   4.278663E-04  4.662753E-04  9.068088E-04  1.429681E-03  1.432494E-03
   1.683226E-03
 Phonon frequencies in cm-1    :
-  9.390581E+01  1.023356E+02  1.990215E+02  3.137787E+02  3.143961E+02
-  3.694253E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.05000  0.50000
 Phonon energies in Hartree :
   4.237040E-04  4.339366E-04  9.255817E-04  1.429928E-03  1.430616E-03
   1.704816E-03
 Phonon frequencies in cm-1    :
-  9.299227E+01  9.523809E+01  2.031417E+02  3.138329E+02  3.139839E+02
-  3.741638E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.00000  0.50000
 Phonon energies in Hartree :
   4.218018E-04  4.218018E-04  9.320487E-04  1.430235E-03  1.430235E-03
   1.712607E-03
 Phonon frequencies in cm-1    :
-  9.257480E+01  9.257480E+01  2.045610E+02  3.139004E+02  3.139004E+02
-  3.758737E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.02500  0.52500
 Phonon energies in Hartree :
   4.247415E-04  4.258720E-04  9.303333E-04  1.429745E-03  1.430690E-03
   1.708578E-03
 Phonon frequencies in cm-1    :
-  9.321998E+01  9.346811E+01  2.041846E+02  3.137927E+02  3.140001E+02
-  3.749894E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.05000  0.55000
 Phonon energies in Hartree :
   4.332940E-04  4.376791E-04  9.252837E-04  1.428402E-03  1.432002E-03
   1.696708E-03
 Phonon frequencies in cm-1    :
-  9.509704E+01  9.605946E+01  2.030763E+02  3.134979E+02  3.142881E+02
-  3.723844E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.07500  0.57500
 Phonon energies in Hartree :
   4.467026E-04  4.560862E-04  9.171888E-04  1.426586E-03  1.434025E-03
   1.677647E-03
 Phonon frequencies in cm-1    :
-  9.803989E+01  1.000993E+02  2.012997E+02  3.130994E+02  3.147322E+02
-  3.682010E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.10000  0.60000
 Phonon energies in Hartree :
   4.638243E-04  4.793957E-04  9.065339E-04  1.424907E-03  1.436541E-03
   1.652464E-03
 Phonon frequencies in cm-1    :
-  1.017977E+02  1.052152E+02  1.989612E+02  3.127310E+02  3.152842E+02
-  3.626739E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.12500  0.62500
 Phonon energies in Hartree :
   4.832390E-04  5.055242E-04  8.940143E-04  1.424176E-03  1.439287E-03
   1.622619E-03
 Phonon frequencies in cm-1    :
-  1.060587E+02  1.109497E+02  1.962135E+02  3.125704E+02  3.158869E+02
-  3.561237E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.15000  0.65000
 Phonon energies in Hartree :
   5.033174E-04  5.321238E-04  8.805690E-04  1.425358E-03  1.441990E-03
   1.589916E-03
 Phonon frequencies in cm-1    :
-  1.104654E+02  1.167877E+02  1.932626E+02  3.128299E+02  3.164802E+02
-  3.489462E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.17500  0.67500
 Phonon energies in Hartree :
   5.222390E-04  5.566775E-04  8.674253E-04  1.429514E-03  1.444393E-03
   1.556406E-03
 Phonon frequencies in cm-1    :
-  1.146182E+02  1.221766E+02  1.903778E+02  3.137421E+02  3.170077E+02
-  3.415916E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.20000  0.70000
 Phonon energies in Hartree :
   5.380076E-04  5.766439E-04  8.561131E-04  1.437684E-03  1.446278E-03
   1.524241E-03
 Phonon frequencies in cm-1    :
-  1.180790E+02  1.265587E+02  1.878951E+02  3.155352E+02  3.174214E+02
-  3.345321E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.22500  0.72500
 Phonon energies in Hartree :
   5.485912E-04  5.897305E-04  8.483340E-04  1.447478E-03  1.450594E-03
   1.495563E-03
 Phonon frequencies in cm-1    :
-  1.204019E+02  1.294309E+02  1.861878E+02  3.176847E+02  3.183685E+02
-  3.282381E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.25000  0.75000
 Phonon energies in Hartree :
   5.523383E-04  5.942939E-04  8.455434E-04  1.447890E-03  1.464217E-03
   1.476435E-03
 Phonon frequencies in cm-1    :
-  1.212242E+02  1.304324E+02  1.855753E+02  3.177751E+02  3.213586E+02
-  3.240401E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.27500  0.72500
 Phonon energies in Hartree :
   5.436976E-04  5.959186E-04  8.447005E-04  1.443237E-03  1.470466E-03
   1.478208E-03
 Phonon frequencies in cm-1    :
-  1.193278E+02  1.307890E+02  1.853903E+02  3.167539E+02  3.227300E+02
-  3.244292E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.30000  0.70000
 Phonon energies in Hartree :
   5.226481E-04  5.951584E-04  8.434334E-04  1.437335E-03  1.479867E-03
   1.485213E-03
 Phonon frequencies in cm-1    :
-  1.147080E+02  1.306222E+02  1.851122E+02  3.154585E+02  3.247933E+02
-  3.259667E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.32500  0.67500
 Phonon energies in Hartree :
   4.944725E-04  5.848034E-04  8.449154E-04  1.435633E-03  1.487328E-03
   1.498039E-03
 Phonon frequencies in cm-1    :
-  1.085242E+02  1.283495E+02  1.854375E+02  3.150850E+02  3.264308E+02
-  3.287816E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.35000  0.65000
 Phonon energies in Hartree :
   4.619784E-04  5.606523E-04  8.521147E-04  1.440528E-03  1.495296E-03
   1.512581E-03
 Phonon frequencies in cm-1    :
-  1.013925E+02  1.230489E+02  1.870176E+02  3.161594E+02  3.281796E+02
-  3.319731E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.37500  0.62500
 Phonon energies in Hartree :
   4.274625E-04  5.221379E-04  8.652457E-04  1.452607E-03  1.502962E-03
   1.528506E-03
 Phonon frequencies in cm-1    :
-  9.381718E+01  1.145960E+02  1.898995E+02  3.188104E+02  3.298619E+02
-  3.354682E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.40000  0.60000
 Phonon energies in Hartree :
   3.933283E-04  4.725691E-04  8.816518E-04  1.469843E-03  1.509001E-03
   1.546429E-03
 Phonon frequencies in cm-1    :
-  8.632559E+01  1.037169E+02  1.935002E+02  3.225933E+02  3.311873E+02
-  3.394020E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.42500  0.57500
 Phonon energies in Hartree :
   3.622167E-04  4.180346E-04  8.978443E-04  1.488016E-03  1.512821E-03
   1.566191E-03
 Phonon frequencies in cm-1    :
-  7.949738E+01  9.174799E+01  1.970540E+02  3.265818E+02  3.320257E+02
-  3.437391E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.45000  0.55000
 Phonon energies in Hartree :
   3.369681E-04  3.667192E-04  9.110572E-04  1.502938E-03  1.514703E-03
   1.585455E-03
 Phonon frequencies in cm-1    :
-  7.395594E+01  8.048555E+01  1.999539E+02  3.298567E+02  3.324388E+02
-  3.479672E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.47500  0.52500
 Phonon energies in Hartree :
   3.203612E-04  3.287878E-04  9.195743E-04  1.512332E-03  1.515371E-03
   1.599835E-03
 Phonon frequencies in cm-1    :
-  7.031116E+01  7.216057E+01  2.018232E+02  3.319186E+02  3.325854E+02
-  3.511232E+02

  Phonon wavevector (reduced coordinates) :  0.50000  0.50000  0.50000
 Phonon energies in Hartree :
   3.145491E-04  3.145491E-04  9.225051E-04  1.515503E-03  1.515503E-03
   1.605176E-03
 Phonon frequencies in cm-1    :
-  6.903555E+01  6.903555E+01  2.024665E+02  3.326144E+02  3.326144E+02
-  3.522955E+02

================================================================================

 Treat the second list of vectors 


  Phonon at Gamma, with non-analyticity in the
  direction (cartesian coordinates)  1.00000  0.00000  0.00000
 Phonon energies in Hartree :
   0.000000E+00  0.000000E+00  0.000000E+00  1.568554E-03  1.568554E-03
   1.730353E-03
 Phonon frequencies in cm-1    :
-  0.000000E+00  0.000000E+00  0.000000E+00  3.442577E+02  3.442577E+02
-  3.797686E+02
-
- Proc.   0 individual time (sec): cpu=          2.5  wall=          2.5

================================================================================

+Total cpu time      2.523  and wall time      2.529 sec

 anaddb : the run completed succesfully.

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-6f5b3188-c0d8-4152-b8f1-b9a7a338f6c9", "#uuid-3365a582-a488-405c-b12e-d72f3aee9e0a") }); </script>

<p>Please, edit also the other output file, named trf2_5_B2EPS.freq. 
It contains the frequencies, in a format suitable for graphical output, using the program
band2eps (the latter should be more documented, and will not be described in the present tutorial).</p>
<p>You can copy the files <a class="wikilink abifile-wikilink" data-content="Input file for 'band2eps.' This data layout must be used,  line-by-line." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/trf2_6.in" target="_blank">tests/tutorespfn/Input/trf2_6.in</a> and
<a class="wikilink abifile-wikilink" href="../../tests/tutorespfn/Input/trf2_6.files" target="_blank">tests/tutorespfn/Input/trf2_6.files</a> to the Work_rf2 directory, then issue</p>
<div class="codehilite"><pre><span></span>band2eps &lt; trf2_6.files &gt; trf2_6.log
</pre></div>


<p>The file trf2_6.out.eps has been produced. It is an .eps file (eps stand for
Encapsulated PostScript). You can use the program ghostview to vizualize it.
The command to issue will depend on the way you have configured your machine,
but the following might perhaps do the work:</p>
<div class="codehilite"><pre><span></span>gv trf2_6.out.eps
</pre></div>


<p>You should see a nice phonon band structure for AlAs. Well, not so nice, after
all, because there are two strange dips for the highest phonon band, at the Gamma point.<br />
This is due to the lack of LO-TO splitting for the ANADDB treatment of the first list of vector. 
The correct phonon band structure is:</p>
<p><img alt="" src="../rf2_assets/trf2_6.out.png" /></p>
<p>You can correct the LO-TO splitting by the following little hack.</p>
<p>Edit the file trf2_5_B2EPS.freq, and note that the value of the frequency, in
the sixth column, has a discontinuity exactly for the Gamma point (the three
first columns give the k point coordinates), that is, at lines 1 and 31 :</p>
<div class="codehilite"><pre><span></span> 0.000000D+00  0.000000D+00  0.000000D+00  0.156855D-02  0.156855D-02  0.156855D-02
</pre></div>


<p>Replace these values (sixth column, line 1 and 31) by the correct value,
including the LO-TO splitting, that you can find in the file trf2_5.out, at
the end, second list of vector. That is, the lines 1 and 31 should now read :</p>
<div class="codehilite"><pre><span></span> 0.000000D+00  0.000000D+00  0.000000D+00  0.156855D-02  0.156855D-02  1.730353E-03
</pre></div>


<p>Now, run again band2eps. Your phonon band structure should be perfect!</p>
<p>It can be compared with the AlAs phonon band structure published in
<a class="wikilink citation-wikilink" data-content="Ab initio calculation of phonon dispersions in semiconductors" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#giannozzi1991">[Giannozzi1991]</a>.</p>
<p>Of course, one should make a convergence study, on the k and q point grids
(separately !), as well as on the energy cut-off, and also test LDA and GGA
&hellip; But this is left to the user !</p>
<h2 id="6-thermodynamical-properties">6 Thermodynamical properties<a class="headerlink" href="#6-thermodynamical-properties" title="Permanent link">&para;</a></h2>
<p>We will give only a very short example of the use of ANADDB to compute
thermodynamical properties. This is because this part of ANADDB is likely the
farthest from a clean, stable, usage. By exploring the input variables, the
user should be able to produce figures and data like the ones for SiO2 quartz
and stishovite, published in <a class="wikilink citation-wikilink" data-content="Ab initiocalculation of the thermodynamic properties and atomic temperature factors ofSiO2α-quartz and stishovite" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lee1995">[Lee1995]</a>. </p>
<p>You can copy the files ~abinit/tests/tutorespfn/Input/trf2_7.in and
~abinit/tests/tutorespfn/Input/trf2_7.files to the Work_rf2 directory, and
have a look at them.<br />
The same DDB as for trf2_4 and trf2_5 is used, namely trf2_3.ddb.out. The
following additional input variables are present:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#thmflag">thmflag</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ng2qpt">ng2qpt</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ngrids">ngrids</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#q2shft">q2shft</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nchan">nchan</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#nwchan">nwchan</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#thmtol">thmtol</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#ntemper">ntemper</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#temperinc">temperinc</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/anaddb#tempermin">tempermin</a></li>
</ul>
<p>Examine the input file, the input variables, then run anaddb (as usual &hellip;).
Then, edit the output file. You should be able to find the crucial section:</p>
<div class="codehilite"><pre><span></span># At  T     F(J/mol-c)     E(J/mol-c)     S(J/(mol-c.K)) C(J/(mol-c.K))
# (A mol-c is the abbreviation of a mole-cell, that is, the
#  number of Avogadro times the atoms in a unit cell)
 2.000E+01  8.1384755E+03  8.1463588E+03  3.9416455E-01  1.4169104E+00
 4.000E+01  8.1061318E+03  8.2368069E+03  3.2668770E+00  7.8985031E+00
 6.000E+01  7.9980215E+03  8.4575659E+03  7.6590742E+00  1.3992228E+01
 8.000E+01  7.7974375E+03  8.7915524E+03  1.2426436E+01  1.9325166E+01
 1.000E+02  7.5004822E+03  9.2274431E+03  1.7269609E+01  2.4175006E+01
 1.200E+02  7.1069991E+03  9.7544364E+03  2.2061978E+01  2.8411189E+01
 1.400E+02  6.6189291E+03  1.0359248E+04  2.6716565E+01  3.1955267E+01
 1.600E+02  6.0396227E+03  1.1028289E+04  3.1179167E+01  3.4847423E+01
 1.800E+02  5.3732223E+03  1.1749439E+04  3.5423427E+01  3.7183864E+01
 2.000E+02  4.6241910E+03  1.2512641E+04  3.9442251E+01  3.9069448E+01
</pre></div>


<p>There, one finds, the phonon free energy, the phonon internal energy, the
phonon entropy and the phonon heat capacity.
The atomic temperature factors can also be computed. 
An example is presented in tests/v5, test 22 .</p>
<div class="text-center"><button type="button" id="uuid-09b9a64a-4796-46d5-bdba-c9170cc1ed82" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/v5/Input/t22.in
</button></div>

<div id="uuid-fc0c0604-de21-4311-b332-d25db779748b" class="my_dialog" title="tests/v5/Input/t22.in" hidden><div><div class="codehilite small-text"><pre><span></span>!Input file <span class="k">for</span> the anaddb code. Analysis of the SiO2 DDB

!Flags
 dieflag   <span class="m">1</span>     ! Frequency-dependent Dielectric tensor flag
 ifcflag   <span class="m">1</span>     ! Interatomic force constant flag
 thmflag   <span class="m">1</span>     ! Thermal flag. Gives Internal energy, entropy,
                 !   heat capacity, phonon DOS, Debye-Waller factor<span class="o">)</span>

!Effective charges
  chneut  <span class="m">2</span>      ! Charge neutrality requirement <span class="k">for</span> effective charges.
                 !        <span class="nv">2</span><span class="o">=</span>&gt; imposed with weights proportional to screening<span class="o">)</span>

!Interatomic force constant info
  dipdip  <span class="m">1</span>      ! Dipole-dipole interaction treatment
  ifcana  <span class="m">1</span>      ! Analysis of the IFCs
  ifcout <span class="m">16</span>      ! Number of IFC<span class="s1">&#39;s written in the output, per atom</span>
<span class="s1">  natifc  2      ! Number of atoms in the cell for which ifc&#39;</span>s are analysed
   atifc  <span class="m">1</span> <span class="m">4</span>    ! List of atoms

!Thermal information
  nchan   <span class="m">1250</span>   ! <span class="c1"># of channels for the DOS with channel width 1 cm-1</span>
  nwchan  <span class="m">5</span>      ! <span class="c1"># of different channel widths from this integer down to 1 cm-1</span>
  thmtol  <span class="m">0</span>.03  ! Tolerance on thermodynamical <span class="k">function</span> fluctuations

!Wavevector grid number <span class="m">1</span> <span class="o">(</span>coarse grid, from DDB<span class="o">)</span>
  brav    <span class="m">4</span>      ! Bravais Lattice : <span class="m">1</span>-S.C., <span class="m">2</span>-F.C., <span class="m">3</span>-B.C., <span class="m">4</span>-Hex.<span class="o">)</span>
  ngqpt   <span class="m">2</span>  <span class="m">2</span>  <span class="m">2</span>   ! Monkhorst-Pack indices
  nqshft  <span class="m">1</span>         ! number of q-points in repeated basic q-cell
  q1shft  <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.5

!Wavevector grid number <span class="m">2</span> <span class="o">(</span>series of fine grids, extrapolated from intrat forces<span class="o">)</span>
  ng2qpt   <span class="m">20</span> <span class="m">20</span> <span class="m">20</span>  ! sample the BZ up to ngqpt2
  ngrids   <span class="m">1</span>         ! number of grids of increasing size
  q2shft   <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.5

!Wavevector list number <span class="m">1</span> <span class="o">(</span>Reduced coordinates and normalization factor<span class="o">)</span>
  nph1l    <span class="m">11</span>      ! number of phonons in list <span class="m">1</span>
  qph1l <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.45   <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.4    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.35   <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.3    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.25   <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.2    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.15   <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.1    <span class="m">1</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.05   <span class="m">1</span>.0

!Wavevector list number <span class="m">2</span> <span class="o">(</span>Gamma point only, with limiting direction
!           in cartesian coordinates. <span class="o">)</span>
  nph2l  <span class="m">1</span>         ! number of phonons in list <span class="m">2</span>
  qph2l  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">1</span>.0    <span class="m">0</span>.0

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = anaddb</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   t22.out, tolnlines = 0, tolabs = 0.000e+00, tolrel = 0.000e+00</span>
<span class="c1">#%% extra_inputs = t22.ddb.in.gz</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = P. Boulanger</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   SiO2 alpha-quartz with 9 atoms per cell.</span>
<span class="c1">#%%   Compute the atomic temperature factors.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fc0c0604-de21-4311-b332-d25db779748b", "#uuid-09b9a64a-4796-46d5-bdba-c9170cc1ed82") }); </script>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Do not forget that we are working in the harmonic approximation; beyond some
temperature, anharmonic effects will have a sizeable contributions.</p>
</div>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../rf1/" title="RF1" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                RF1
              </span>
            </div>
          </a>
        
        
          <a href="../elastic/" title="Elastic" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Elastic
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (XG)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>