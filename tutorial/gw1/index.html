



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/gw1/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>GW1 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#first-lesson-on-gw" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  Many-Body
                </span>
              
            
            GW1
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8" checked>
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        GW1
      </label>
    
    <a href="./" title="GW1" class="md-nav__link md-nav__link--active">
      GW1
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" title="The quasi-particle band structure of Silicon, in the GW approximation." class="md-nav__link">
    The quasi-particle band structure of Silicon, in the GW approximation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-general-example-of-well-converged-gw-calculation" title="1 General example of well converged GW calculation" class="md-nav__link">
    1 General example of well converged GW calculation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-the-four-steps-of-a-gw-calculation" title="1.a The four steps of a GW calculation." class="md-nav__link">
    1.a The four steps of a GW calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" title="1.b Generating the Kohn-Sham band structure: the WFK file." class="md-nav__link">
    1.b Generating the Kohn-Sham band structure: the WFK file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-generating-the-screening-the-scr-file" title="1.c Generating the screening: the SCR file." class="md-nav__link">
    1.c Generating the screening: the SCR file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-computing-the-gw-energies" title="1.d Computing the GW energies." class="md-nav__link">
    1.d Computing the GW energies.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1e-examination-of-the-output-file" title="1.e Examination of the output file." class="md-nav__link">
    1.e Examination of the output file.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" title="2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)" class="md-nav__link">
    2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-self-energy-optional" title="3 Convergence on the number of planewaves in the wavefunctions to calculate the Self-Energy (optional)" class="md-nav__link">
    3 Convergence on the number of planewaves in the wavefunctions to calculate the Self-Energy (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-on-the-number-of-planewaves-to-calculate-x-optional" title="4 Convergence on the number of planewaves to calculate x (optional)" class="md-nav__link">
    4 Convergence on the number of planewaves to calculate x (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-convergence-on-the-number-of-bands-to-calculate-c-important" title="5 Convergence on the number of bands to calculate c (important)" class="md-nav__link">
    5 Convergence on the number of bands to calculate c (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-screening-1-optional" title="6 Convergence on the number of planewaves in the wavefunctions to calculate the screening (-1) (optional)" class="md-nav__link">
    6 Convergence on the number of planewaves in the wavefunctions to calculate the screening (-1) (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-convergence-on-the-number-of-bands-to-calculate-the-screening-1-important" title="7 Convergence on the number of bands to calculate the screening (-1) (important)" class="md-nav__link">
    7 Convergence on the number of bands to calculate the screening (-1) (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-convergence-on-the-dimension-of-the-screening-1-matrix-important" title="8 Convergence on the dimension of the screening -1 matrix (important)" class="md-nav__link">
    8 Convergence on the dimension of the screening -1 matrix (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-calculation-of-the-gw-corrections-for-the-band-gap-in" title="9 Calculation of the GW corrections for the band gap in " class="md-nav__link">
    9 Calculation of the GW corrections for the band gap in 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-in-the-gw-code" title="Advanced features in the GW code" class="md-nav__link">
    Advanced features in the GW code
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculations-without-using-the-plasmon-pole-model" title="Calculations without using the Plasmon-Pole model" class="md-nav__link">
    Calculations without using the Plasmon-Pole model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-consistent-calculations" title="Self-consistent calculations" class="md-nav__link">
    Self-consistent calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" title="The quasi-particle band structure of Silicon, in the GW approximation." class="md-nav__link">
    The quasi-particle band structure of Silicon, in the GW approximation.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-general-example-of-well-converged-gw-calculation" title="1 General example of well converged GW calculation" class="md-nav__link">
    1 General example of well converged GW calculation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1a-the-four-steps-of-a-gw-calculation" title="1.a The four steps of a GW calculation." class="md-nav__link">
    1.a The four steps of a GW calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" title="1.b Generating the Kohn-Sham band structure: the WFK file." class="md-nav__link">
    1.b Generating the Kohn-Sham band structure: the WFK file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1c-generating-the-screening-the-scr-file" title="1.c Generating the screening: the SCR file." class="md-nav__link">
    1.c Generating the screening: the SCR file.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1d-computing-the-gw-energies" title="1.d Computing the GW energies." class="md-nav__link">
    1.d Computing the GW energies.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1e-examination-of-the-output-file" title="1.e Examination of the output file." class="md-nav__link">
    1.e Examination of the output file.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" title="2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)" class="md-nav__link">
    2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-self-energy-optional" title="3 Convergence on the number of planewaves in the wavefunctions to calculate the Self-Energy (optional)" class="md-nav__link">
    3 Convergence on the number of planewaves in the wavefunctions to calculate the Self-Energy (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-convergence-on-the-number-of-planewaves-to-calculate-x-optional" title="4 Convergence on the number of planewaves to calculate x (optional)" class="md-nav__link">
    4 Convergence on the number of planewaves to calculate x (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-convergence-on-the-number-of-bands-to-calculate-c-important" title="5 Convergence on the number of bands to calculate c (important)" class="md-nav__link">
    5 Convergence on the number of bands to calculate c (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-screening-1-optional" title="6 Convergence on the number of planewaves in the wavefunctions to calculate the screening (-1) (optional)" class="md-nav__link">
    6 Convergence on the number of planewaves in the wavefunctions to calculate the screening (-1) (optional)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-convergence-on-the-number-of-bands-to-calculate-the-screening-1-important" title="7 Convergence on the number of bands to calculate the screening (-1) (important)" class="md-nav__link">
    7 Convergence on the number of bands to calculate the screening (-1) (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-convergence-on-the-dimension-of-the-screening-1-matrix-important" title="8 Convergence on the dimension of the screening -1 matrix (important)" class="md-nav__link">
    8 Convergence on the dimension of the screening -1 matrix (important)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-calculation-of-the-gw-corrections-for-the-band-gap-in" title="9 Calculation of the GW corrections for the band gap in " class="md-nav__link">
    9 Calculation of the GW corrections for the band gap in 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features-in-the-gw-code" title="Advanced features in the GW code" class="md-nav__link">
    Advanced features in the GW code
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculations-without-using-the-plasmon-pole-model" title="Calculations without using the Plasmon-Pole model" class="md-nav__link">
    Calculations without using the Plasmon-Pole model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-consistent-calculations" title="Self-consistent calculations" class="md-nav__link">
    Self-consistent calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/gw1.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="first-lesson-on-gw">First lesson on GW<a class="headerlink" href="#first-lesson-on-gw" title="Permanent link">&para;</a></h1>
<h2 id="the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation">The quasi-particle band structure of Silicon, in the GW approximation.<a class="headerlink" href="#the-quasi-particle-band-structure-of-silicon-in-the-gw-approximation" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to calculate self-energy corrections to the
DFT Kohn-Sham eigenvalues in the GW approximation.</p>
<p>A brief description of the formalism and of the equations implemented in the
code can be found in the <a class="wikilink theory-wikilink" href="../../theory/mbt">GW_notes</a>.
The different formulas of the GW formalism have been written in a <a class="wikilink abifile-wikilink" href="../../topics/documents/gwa.pdf" target="_blank">pdf document</a>
by Valerio Olevano (who also wrote the first version of this tutorial).
For a much more consistent discussion of the theoretical aspects of the GW
method we refer the reader to the review</p>
<p>&ldquo;Quasiparticle calculations in solids&rdquo;, by Aulbur WG, Jonsson L, Wilkins JW, <br />
in Solid State Physics 54, 1-218 (2000), also available 
<a href="https://www.abinit.org/sites/default/files/quasiparticle_calculations_in_solids.pdf.bz2">here</a>.</p>
<p>It is suggested to acknowledge the efforts of developers of
the GW part of ABINIT, by citing the <a class="wikilink citation-wikilink" data-content="A brief introduction to the ABINIT software package" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze2005">2005 ABINIT publication</a>.</p>
<p>The user should be familiarized with the four basic lessons of ABINIT, 
see the <a class="wikilink user-guide-wikilink" href="../../guide">tutorial home page</a>
After this first tutorial on GW, you should read the <a class="wikilink lesson-wikilink" href="../gw2">second lesson on GW</a></p>
<p>This lesson should take about 2 hours.</p>
<h2 id="1-general-example-of-well-converged-gw-calculation">1 General example of well converged GW calculation<a class="headerlink" href="#1-general-example-of-well-converged-gw-calculation" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_gw1&rdquo;?</em></p>
<p>At the end of <a href="../base3">lesson 3</a>, we computed the Kohn-Sham band
structure of silicon. In this approximation, the band dispersion as well as
the band widths are reasonable, but the band gaps are qualitatively wrong.
Now, we will compute the band gaps much more accurately, using the so-called
GW approximation.</p>
<p>We start by an example, in which we show how to perform in a single input file
the calculation of the ground state density, the Kohn Sham band structure, the
screening, and the GW corrections. We use reasonable values for the parameters
of the calculation. The discussion on the convergence tests is postponed to
the next paragraphs. We will see that GW calculations are <strong>much more</strong> time-consuming 
than the computation of the Kohn-Sham eigenvalues.</p>
<p>So, let us run immediately this calculation, and while it is running, we will
explain what has been done.</p>
<p><em>In the directory ~abinit/tests/tutorial/Input/Work_gw1, copy the files
~abinit/tests/tutorial/Input/tgw1_x.files and tgw1_1.in, and modify the
tgw1_x.files file as usual (see lesson 1).</em></p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_1.log &amp;
</pre></div>


<p>It is very important to run this job in background because it takes about 1 minute. 
In the meantime, you should read the following.</p>
<h4 id="1a-the-four-steps-of-a-gw-calculation"><strong>1.a The four steps of a GW calculation.</strong><a class="headerlink" href="#1a-the-four-steps-of-a-gw-calculation" title="Permanent link">&para;</a></h4>
<p>In order to perform a standard one-shot GW calculation one has to:</p>
<ol>
<li>
<p>Run a converged Ground State calculation to obtain the self-consistent density. </p>
</li>
<li>
<p>Perform a non self-consistent run to compute the Kohn-Sham eigenvalues and the eigenfunctions 
     including several empty states. Note that, unlike standard band structure calculations, 
     here the KS states must be computed on a regular grid of k-points. </p>
</li>
<li>
<p>Use <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=3 to compute the independent-particle susceptibility ( 0) on a regular grid of 
     <strong>q</strong> -points, for at least two frequencies (usually, =0 and a large purely imaginary 
     frequency - of the order of the plasmon frequency, a dozen of eV). 
     The inverse dielectric matrix (-1) is then obtained via matrix inversion and stored in an external file (SCR). 
     The list of <strong>q</strong> -points is automatically defined by the k-mesh used to generate the KS states in the previous step. </p>
</li>
<li>
<p>Use <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=4 to compute the self-energy () matrix element for a given set of k-points in order 
     to obtain the GW quasiparticle energies Note that the k-point must belong to the k-mesh used to generate the WFK file in step 2. </p>
</li>
</ol>
<p>The flowchart diagram of a standard one-shot run is depicted in the figure below.</p>
<p><img alt="" src="../gw1_assets/gw_flowchart.png" /></p>
<p>The input file tgw1_1.in has precisely that structure: there are four datasets.</p>
<p>The first dataset performs the SCF calculation to get the density. The second
dataset reads the previous density file and performs a NSCF run including
several empty states. The third dataset reads the WFK file produced in the
previous step and drives the computation of susceptibility and dielectric
matrices, producing another specialized file, tgw1_xo_DS2_SCR (_SCR for
&ldquo;Screening&rdquo;, actually the inverse dielectric matrix -1). Then, in the fourth
dataset, the code calculates the quasiparticle energies for the 4<sup>th</sup> and 5<sup>th</sup> bands at the  point.</p>
<p>So, you can edit this tgw1_1.in file.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-cbbecbef-497e-4bb8-8ddc-89909fed8f12" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_x.files
</button>
<button type="button" id="uuid-85332416-9e83-48bb-aad0-ad9748d11f0c" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_1.in
</button>
</div></div>

<div id="uuid-b09eebeb-683f-405c-82c9-d716a6b81fdc" class="my_dialog" title="tests/tutorial/Input/tgw1_x.files" hidden><div><pre class="small-text">
../tgw1_x.in
tgw1_x.out
tgw1i
tgw1o
tgw1
../../../Psps_for_tests/14si.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b09eebeb-683f-405c-82c9-d716a6b81fdc", "#uuid-cbbecbef-497e-4bb8-8ddc-89909fed8f12") }); </script>

<div id="uuid-6209c92a-2a2b-42b2-81d6-bc9ce20bd1ca" class="my_dialog" title="tests/tutorial/Input/tgw1_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>
<span class="c1"># Dataset 1: ground state calculation to get the density </span>
<span class="c1"># Dataset 2: NSCF run to produce the WFK file for 10 k-points in IBZ</span>
<span class="c1"># Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1"># Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>

ndtset      <span class="m">4</span>

<span class="c1">############</span>
<span class="c1"># Dataset 1</span>
<span class="c1">############</span>
<span class="c1"># SCF-GS run </span>
nband1  <span class="m">6</span>
tolvrs1 <span class="m">1</span>.0e-10

<span class="c1">############</span>
<span class="c1"># Dataset 2</span>
<span class="c1">############</span>
<span class="c1"># Definition of parameters for the calculation of the WFK file</span>
nband2      <span class="m">40</span>       <span class="c1"># Number of (occ and empty) bands to be computed</span>
nbdbuf2      <span class="m">5</span>
iscf2       -2
getden2     -1
tolwfr2  <span class="m">1</span>.0d-18     <span class="c1"># Will stop when this tolerance is achieved </span>

<span class="c1">############</span>
<span class="c1"># Dataset 3</span>
<span class="c1">############</span>
<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver3  <span class="m">3</span>        <span class="c1"># Screening calculation</span>
getwfk3     -1       <span class="c1"># Obtain WFK file from previous dataset</span>
nband3      <span class="m">17</span>       <span class="c1"># Bands to be used in the screening calculation</span>
ecuteps3    <span class="m">3</span>.6      <span class="c1"># Cut-off energy of the planewave set to represent the dielectric matrix. </span>
                     <span class="c1"># It is important to adjust this parameter.</span>
ppmfrq3    <span class="m">16</span>.7 eV   <span class="c1"># Imaginary frequency where to calculate the screening</span>

<span class="c1">############</span>
<span class="c1"># Dataset 4</span>
<span class="c1">############</span>
<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver4  <span class="m">4</span>        <span class="c1"># Self-Energy calculation</span>
getwfk4     -2       <span class="c1"># Obtain WFK file from dataset 1</span>
getscr4     -1       <span class="c1"># Obtain SCR file from previous dataset</span>
nband4      <span class="m">30</span>       <span class="c1"># Bands to be used in the Self-Energy calculation</span>
ecutsigx4    <span class="m">6</span>.0     <span class="c1"># Dimension of the G sum in Sigma_x. </span>
                     <span class="c1"># (the dimension in Sigma_c is controlled by ecuteps)</span>
nkptgw4      <span class="m">1</span>       <span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw4               <span class="c1"># k-points in reduced coordinates</span>
  -0.125    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw4       <span class="m">4</span>  <span class="m">5</span>     <span class="c1"># calculate GW corrections for bands from 4 to 5</span>



<span class="c1"># Data common to the three different datasets</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the </span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s) </span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25


<span class="c1"># Definition of the k-point grid</span>
ngkpt   <span class="m">4</span> <span class="m">4</span> <span class="m">4</span>  
nshiftk <span class="m">4</span>
shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5  <span class="c1"># These shifts will be the same for all grids</span>
        <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
        <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1"># Definition of the SCF procedure</span>
nstep   <span class="m">20</span>        <span class="c1"># Maximal number of SCF cycles</span>
<span class="c1">#toldfe  1.0d-6    # Will stop when this tolerance is achieved on total energy</span>
diemac  <span class="m">12</span>.0      <span class="c1"># Although this is not mandatory, it is worth to</span>
                  <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                  <span class="c1"># function used as the standard preconditioner</span>
                  <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                  <span class="c1"># Here, we follow the prescription for bulk silicon.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_1.out, tolnlines= 70, tolabs=  0.02, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW </span>
<span class="c1">#%% description = </span>
<span class="c1">#%% Crystalline silicon</span>
<span class="c1">#%% Calculation of the GW corrections</span>
<span class="c1">#%% Dataset 1: ground state calculation and calculation of the WFK file for 10 k-points in IBZ</span>
<span class="c1">#%% Dataset 2: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1">#%% Dataset 3: calculation of the Self-Energy matrix elements (GW corrections)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-6209c92a-2a2b-42b2-81d6-bc9ce20bd1ca", "#uuid-85332416-9e83-48bb-aad0-ad9748d11f0c") }); </script>

<p>The dataset-independent part of this file (the last half of the file),
contains the usual set of input variables describing the cell, atom types,
number, position, planewave cut-off energy, SCF convergence parameters driving
the Kohn-Sham band structure calculation. Then, for the fourth datasets, you
will find specialized additional input variables.</p>
<h4 id="1b-generating-the-kohn-sham-band-structure-the-wfk-file"><strong>1.b Generating the Kohn-Sham band structure: the WFK file.</strong><a class="headerlink" href="#1b-generating-the-kohn-sham-band-structure-the-wfk-file" title="Permanent link">&para;</a></h4>
<p>Dataset 1 is a rather standard SCF calculation. It&rsquo;s worth noticing that we
use <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a> to stop the SCF cycle because we want a well-converged KS potential
to be used in the subsequent NSCF calculation. Dataset 2 computes 40 bands and
we set <a class="wikilink codevar-wikilink" href="../../variables/gstate#nbdbuf">nbdbuf</a> to 5 so that only the first 35 states must be converged within <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>. </p>
<div class="codehilite"><pre><span></span>############
# Dataset 1
############
# SCF-GS run 
nband1  6
tolvrs1 1.0e-10

############
# Dataset 2
############
# Definition of parameters for the calculation of the WFK file
nband2      40       # Number of (occ and empty) bands to be computed
nbdbuf2      5
iscf2       -2
getden2     -1
tolwfr2  1.0d-18     # Will stop when this tolerance is achieved
</pre></div>


<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <a class="wikilink codevar-wikilink" href="../../variables/gstate#nbdbuf">nbdbuf</a> tricks allows us to save several minimization steps because the
last bands usually require more iterations to converge</p>
</div>
<h4 id="1c-generating-the-screening-the-scr-file"><strong>1.c Generating the screening: the SCR file.</strong><a class="headerlink" href="#1c-generating-the-screening-the-scr-file" title="Permanent link">&para;</a></h4>
<p>In dataset 3, the calculation of the screening (susceptibility, dielectric
matrix) is performed. We need to set <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=3 to do that:</p>
<div class="codehilite"><pre><span></span>optdriver3  3        # Screening calculation
</pre></div>


<p>The <a class="wikilink codevar-wikilink" href="../../variables/files#getwfk">getwfk</a> input variable is similar to other &ldquo;get&rdquo; input variables of ABINIT:</p>
<div class="codehilite"><pre><span></span>getwfk3     -1       # Obtain WFK file from previous dataset
</pre></div>


<p>In this case, it tells the code to use the WFK file calculated in the previous dataset.</p>
<p>Then, three input variables describe the computation:</p>
<div class="codehilite"><pre><span></span>nband3      17       # Bands used in the screening calculation
ecut        8.0      # Cut-off energy of the planewave set to represent the wavefunctions
ecuteps3    3.6      # Cut-off energy of the planewave set to represent the dielectric matrix
</pre></div>


<p>In this case, we use 17 bands to calculate the Kohn-Sham response function
<script type="math/tex">\chi^{(0)}_{KS}</script>. A cut-off of 8 Hartree is used to represent the
wavefunctions in the calculation of <script type="math/tex">\chi^{(0)}_{KS}</script>. The dimension of
<script type="math/tex">\chi^{(0)}_{KS}</script>, as well as all the other matrices (<script type="math/tex">\chi</script>, <script type="math/tex">\epsilon</script>) is
determined by <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=3.6 Hartree, giving 169 planewaves.</p>
<p>Finally, we define the frequencies at which the screening must be evaluated:
=0.0 eV and the imaginary frequency = i 16.7 eV. The latter is determined by
the input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#ppmfrq">ppmfrq</a></p>
<div class="codehilite"><pre><span></span>ppmfrq3    16.7 eV  # Imaginary frequency where to calculate the screening
</pre></div>


<p>The two frequencies are used to calculate the plasmon-pole model parameters.
For the non-zero frequency it is recommended to use a value close to the
plasmon frequency for the plasmon-pole model to work well. Plasmons
frequencies are usually close to 0.5 Hartree. The parameters for the screening
calculation are not far from the ones that give converged Energy Loss Function
(-Im \epsilon^-1_00) spectra, So that one can start up by using indications
from EELS calculations existing in literature.</p>
<h4 id="1d-computing-the-gw-energies"><strong>1.d Computing the GW energies.</strong><a class="headerlink" href="#1d-computing-the-gw-energies" title="Permanent link">&para;</a></h4>
<p>In dataset 4 the calculation of the Self-Energy matrix elements is performed.
One needs to define the driver option, as well as the _WFK and _SCR files.</p>
<div class="codehilite"><pre><span></span>optdriver4  4       # Self-Energy calculation
getwfk4    -2       # Obtain WFK file from dataset 2
getscr4    -1       # Obtain SCR file from previous dataset
</pre></div>


<p>The <a class="wikilink codevar-wikilink" href="../../variables/files#getscr">getscr</a> input variable is similar to other &ldquo;get&rdquo; input variables of ABINIT.</p>
<p>Then, comes the definition of parameters needed to compute the self-energy. As
for the computation of the susceptibility and dielectric matrices, one must
define the set of bands, and two sets of planewaves:</p>
<div class="codehilite"><pre><span></span>nband4       30      # Bands to be used in the Self-Energy calculation
ecutsigx4   6.0      # Dimension of the G sum in Sigma_x
                     # (the dimension in Sigma_c is controlled by npweps)
</pre></div>


<p>In this case, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> controls the number of bands used to calculate the
correlation part of the Self-Energy. <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> gives the number of
planewaves used to calculate  x (the exchange part of the self-energy). The
size of the planewave set used to compute c (the correlation part of the
self-energy) is controlled by <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> (cannot be larger than the value
used to generate the SCR file). However, it is taken equal to the number of
planewave of x if the latter is smaller than the one for c.</p>
<p>Then, come the parameters defining the k-points and the band indices for which
the quasiparticle energies will be computed:</p>
<div class="codehilite"><pre><span></span>nkptgw4      1               # number of k-point where to calculate the GW correction
kptgw4                       # k-points
  -0.125    0.000    0.000
bdgw4       4  5             # calculate GW corrections for bands from 4 to 5
</pre></div>


<p><a class="wikilink codevar-wikilink" href="../../variables/gw#nkptgw">nkptgw</a> defines the number of k-points for which the GW corrections will be
computed. The k-point reduced coordinates are specified in <a class="wikilink codevar-wikilink" href="../../variables/gw#kptgw">kptgw</a>. At
present, they MUST belong to the k-mesh used to generate the WFK file. Hence
if you wish the GW correction in a particular k-point, you should choose a
grid containing it. Usually this is done by taking the k-point grid where the
convergence is achieved and shifting it such as at least one k-point is placed
on the wished position in the Brillouin zone. <a class="wikilink codevar-wikilink" href="../../variables/gw#bdgw">bdgw</a> gives the
minimum/maximum band whose energies are calculated for the given k-point.</p>
<p>There is an additional parameter, called <a class="wikilink codevar-wikilink" href="../../variables/gw#zcut">zcut</a>, related to the self-energy
computation. It is meant to avoid some divergences that might occur in the
calculation due to integrable poles along the integration path.</p>
<h4 id="1e-examination-of-the-output-file"><strong>1.e Examination of the output file.</strong><a class="headerlink" href="#1e-examination-of-the-output-file" title="Permanent link">&para;</a></h4>
<p>Let us hope that your calculation has been completed, and that we can examine
the output file. Open tgw1_1.out in your preferred editor and find the section
corresponding to DATASET 3.</p>
<p>After the description of the unit cell and of the pseudopotentials, you will
find the list of k-points used for the electrons and the grid of q-point (in
the Irreducible part of the Brillouin Zone) on which the susceptibility and
dielectric matrices will be computed. It is a set of BZ points defined as all
the possible differences among the k-points ( <em>q=k-k&rsquo;</em> ) of the grid chosen to
generate the WFK file. From the last statement it is clear the interest to
choose homogeneous k-point grids, in order not to minimize the number of q-points.</p>
<p>After this section, the code prints the parameters of the FFT grid needed to
represent the wavefunctions and to compute their convolution (required for the
screening matrices). Then we have some information about the MPI distribution
of the bands and the total number of valence electrons computed by integrating
the density in the unit cell.</p>
<p>On the basis of the density, one can obtain the classical Drude plasmon
frequency. The next lines calculate the average density of the system, and
evaluate the r_s parameter, then compute the Drude plasmon frequency. This is
the value used by default for <a class="wikilink codevar-wikilink" href="../../variables/gw#ppmfrq">ppmfrq</a>. It is in fact the second frequency
where the code calculates the dielectric matrix to adjust the plasmon-pole
model parameters. It has been found that Drude plasma frequency is a
reasonable value where to adjust the model. The control over this parameter is
however left to the user in order to check that the result does not change
when changing <a class="wikilink codevar-wikilink" href="../../variables/gw#ppmfrq">ppmfrq</a>. If it is the case, then the plasmon-pole model is
not appropriated and one should go beyond by taking into account a full
dynamical dependence in the screening (see later, the contour-deformation
method). However, the plasmon-pole model has been found to work well for a
very large range of systems when focusing only on the real part of the GW
corrections.</p>
<p>At the end of the screening calculation, the macroscopic dielectric constant is printed:</p>
<div class="codehilite"><pre><span></span>  dielectric constant =  13.5073
  dielectric constant without local fields =  15.0536
</pre></div>


<p>Note that the convergence in the dielectric constant DOES NOT guarantee the
convergence in the GW corrections. In fact, the dielectric constant is
representative of only one element i.e. the head of the full dielectric
matrix. Even if the convergence on the dielectric constant with local fields
takes somehow into account also other non-diagonal elements. In a GW
calculation all the -1 matrix is used to build the Self-Energy operator.<br />
The dielectric constant here reported is the so-called RPA dielectric constant
due to the electrons. Although evaluated at zero frequency, it is understood
that the ionic response is not included (this term can be computed with DFPT
and ANADDB). The RPA dielectric constant restricted to electronic effects is
also not the same as the one computed in the RESPFN part of ABINIT, that
includes exchange-correlation effects.</p>
<p>We now enter the fourth dataset. As for dataset 3, after some general
information (origin of WFK file, header, description of unit cell, k-points,
q-points), the description of the FFT grid and jellium parameters, there is
the echo of parameters for the plasmon-pole model, and the inverse dielectric
function (the screening). The self-energy operator has been constructed, and
one can evaluate the GW energies, for each of the states.</p>
<p>The final results are:</p>
<div class="codehilite"><pre><span></span>k =   -0.125   0.000   0.000
 Band     E0  &lt;VxcLDA&gt;   SigX SigC(E0)    Z dSigC/dE  Sig(E)    E-E0     E
    4   5.616 -11.115 -12.334   1.257   0.775  -0.290 -11.085   0.030   5.646
    5   8.357 -10.140  -5.951  -3.336   0.779  -0.284  -9.476   0.664   9.021

 E^0_gap          2.741
 E^GW_gap         3.375
 DeltaE^GW_gap    0.634
</pre></div>


<p>For the desired k-point, state 4, then state 5, one finds different information:</p>
<ul>
<li>E0 is the Kohn-Sham eigenenergy </li>
<li>VxcLDA gives the average Kohn-Sham exchange-correlation potential </li>
<li>SigX gives the exchange contribution to the self-energy </li>
<li>SigC(E0) gives the correlation contribution to the self-energy, evaluated at the Kohn-Sham eigenenergy</li>
<li>Z is the renormalisation factor </li>
<li>dSigC/dE is the energy derivative of SigC with respect to the energy</li>
<li>SigC(E) gives the correlation contribution to the self-energy, evaluated at the GW energy</li>
<li>E-E0 is the difference between GW energy and Kohn-Sham eigenenergy </li>
<li>E is the GW energy </li>
</ul>
<p>In this case, the gap is also analyzed: E^0_gap is the direct Kohn-Sham gap at
that k point (and spin, in the case of spin-polarized calculations), E^GW_gap
is the GW one, and DeltaE^GW_gap is the difference. This direct gap is always
computed between the band whose number is equal to the number of electrons in
the cell divided by two (integer part, in case of spin-polarized calculation),
and the next one. (Warning: for a metal, these two bands do not systematically
lie below and above the Fermi energy - but the concept of a direct gap is not relevant in that case).</p>
<p>It is seen that the average Kohn-Sham exchange-correlation potential for the
state 4 (a valence state) is very close to the exchange self-energy
correction. For that state, the correlation correction is small, and the
difference between Kohn-Sham and GW energies is also small (43 meV). By
contrast, the exchange self-energy is much smaller than the average Kohn-Sham
potential for the state 5 (a conduction state), but the correlation correction
is much larger than for state 4. On the whole, the difference between Kohn-
Sham and GW energies is not very large, but nevertheless, it is quite
important when compared with the size of the gap.</p>
<h2 id="2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file">2 Preparing convergence studies: Kohn-Sham structure (WFK file) and screening (SCR file)<a class="headerlink" href="#2-preparing-convergence-studies-kohn-sham-structure-wfk-file-and-screening-scr-file" title="Permanent link">&para;</a></h2>
<p>In the following sections, we will perform different convergence studies. In
order to keep the CPU time at a reasonable level, we will use fake WFK and SCR
data. Moreover we will only consider the correction at the  point only. In
this way, we will be able to verify convergence aspects that could be very
cumbersome (at least in the framework of a tutorial) if more k-points were
used. Testing the convergence with a  point only grid of k point represents a
convenient approach although some caution should always be used.</p>
<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_2.in, and modify the tgw1_x.files file as usual. Edit the tgw1_2.in
file, and take the time to examine it.</p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_2.log &amp;
</pre></div>


<p>After this step you will need the WFK and SCR files produced in this run for
the next runs (up to 6.8). Move tgw1o_DS2_WFK to tgw1o_DS1_WFK and tgw1o_DS3_SCR to tgw1o_DS1_SCR.</p>
<p>The next sections are intended to show you how to find the converged
parameters for a GW calculation. In principle, the following parameters might
be used to decrease the CPU time and/or the memory requirements:
<a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=3 <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>. and for <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=4,
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>.</p>
<p>Before 2008, the advice was indeed to check independently what was the best
value for each of these. However, with the evolution of memory/disk space, as
well as the advent of new techniques to diminish the number of bands that is
needed (see e.g. F. Bruneval, X. Gonze, Phys. Rev. B 78, 085125 (2008), and
the input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcomp">gwcomp</a>), standard calculations nowadays only need the
tuning of <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>, simultaneously for <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=3 and =4.
Indeed, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a> and can have the default value of <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>, while
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a> can have the default value of 4*<a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> for norm-conserving
pseudopotentials, or <a class="wikilink codevar-wikilink" href="../../variables/paw#pawecutdg">pawecutdg</a> for PAW calculations. Actually, the present
tutorial needs to be updated to account for the current practice.</p>
<p>We begin by the convergence study on the three parameters needed in the self-
energy calculation (<a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=4): <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>.
This is because for these, we will not need a double dataset loop to check
this convergence, and we will rely on the previously determined SCR file.</p>
<h2 id="3-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-self-energy-optional">3 Convergence on the number of planewaves in the wavefunctions to calculate the Self-Energy (optional)<a class="headerlink" href="#3-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-self-energy-optional" title="Permanent link">&para;</a></h2>
<p>The convergence study is done in the input file tgw1_3.in. First, we check the
convergence on the number of planewaves used to describe the wavefunctions, in
the calculation of the Self-Energy. This will be done by defining five
datasets, with increasing <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>:</p>
<div class="codehilite"><pre><span></span>ndtset     5
ecutwfn:  3.0
ecutwfn+  1.0
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_3.in, and modify the tgw1_x.files file as usual. Edit the tgw1_3.in
file, and take the time to examine it.</p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_3.log &amp;
</pre></div>


<div class="text-center"><button type="button" id="uuid-0ee4a4ee-3630-4278-90ae-0c66fe7dd56f" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_3.in
</button></div>

<div id="uuid-fd6575cf-6471-4a34-97d0-d8bc37b0464c" class="my_dialog" title="tests/tutorial/Input/tgw1_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

<span class="c1"># Convergence with respect to the number of planewaves to represent the wavefunctions</span>
ndtset     <span class="m">5</span>
ecutwfn:  <span class="m">3</span>.0
ecutwfn+  <span class="m">1</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver  <span class="m">4</span>
getwfk     <span class="m">1</span>
getscr     <span class="m">1</span>
nband      <span class="m">100</span>
ecutsigx    <span class="m">6</span>.0
ppmfrq    <span class="m">16</span>.7 eV
nkptgw      <span class="m">1</span>
kptgw      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw       <span class="m">4</span>  <span class="m">5</span> 

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> 
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_3.out, tolnlines= 70, tolabs=  9.000e-03, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%    Crystalline silicon</span>
<span class="c1">#%%    Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fd6575cf-6471-4a34-97d0-d8bc37b0464c", "#uuid-0ee4a4ee-3630-4278-90ae-0c66fe7dd56f") }); </script>

<p>Edit the output file. The number of plane waves used for the wavefunctions in
the computation of the self-energy is mentioned in the fragments of output:</p>
<div class="codehilite"><pre><span></span> SIGMA fundamental parameters:
 PLASMON POLE MODEL
 number of plane-waves for SigmaX                  169
 number of plane-waves for SigmaC and W            169
 number of plane-waves for wavefunctions            59
</pre></div>


<p>Gathering the GW energies for each planewave set, one gets:</p>
<div class="codehilite"><pre><span></span> number of plane-waves for wavefunctions            59
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.490 -15.198   4.050   0.812  -0.232 -11.212   0.277   6.192
    5   8.445  -9.431  -3.101  -5.381   0.822  -0.216  -8.651   0.781   9.226

 number of plane-waves for wavefunctions           113
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.648 -15.253   3.853   0.807  -0.239 -11.448   0.200   6.115
    5   8.445  -9.685  -3.234  -5.511   0.818  -0.222  -8.916   0.769   9.214

 number of plane-waves for wavefunctions           137
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.244   3.810   0.806  -0.241 -11.474   0.165   6.080
    5   8.445  -9.675  -3.213  -5.557   0.818  -0.223  -8.935   0.740   9.185

 number of plane-waves for wavefunctions           169
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.244   3.801   0.806  -0.241 -11.481   0.157   6.072
    5   8.445  -9.686  -3.216  -5.571   0.818  -0.223  -8.950   0.736   9.181

 number of plane-waves for wavefunctions           259
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.650 -15.250   3.790   0.806  -0.241 -11.497   0.152   6.068
    5   8.445  -9.697  -3.218  -5.583   0.818  -0.223  -8.965   0.733   9.178
</pre></div>


<p>So that <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>=5.0 (<a class="wikilink codevar-wikilink" href="../../variables/internal#npwwfn">%npwwfn</a>=137) can be considered to lead to
eigenenergies converged within 0.01 eV.</p>
<h2 id="4-convergence-on-the-number-of-planewaves-to-calculate-x-optional">4 Convergence on the number of planewaves to calculate x (optional)<a class="headerlink" href="#4-convergence-on-the-number-of-planewaves-to-calculate-x-optional" title="Permanent link">&para;</a></h2>
<p>Second, we check the convergence on the number of planewaves in the
calculation of x. This study in done in tgw1_4.in As mentioned in the
documentation <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, safe values exist for <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>, so that if you
do not want to squeeze the CPU time for your calculation (you might gain only
a few percent in some cases &hellip;), you can impose these values, and skip the
corresponding convergence study.</p>
<p>In this lesson, this convergence study will be done by defining five datasets,
with increasing <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>:</p>
<div class="codehilite"><pre><span></span>ndtset     7
ecutsigx:  3.0
ecutsigx+  1.0
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_4.in, and modify the tgw1_x.files file as usual. Edit the tgw1_4.in
file, and take the time to examine it.</p>
<div class="text-center"><button type="button" id="uuid-c1250014-bb30-44ec-9adf-c55bd42d9f9b" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_4.in
</button></div>

<div id="uuid-ba4f206f-e63c-4d26-ab45-2ab75066a9f0" class="my_dialog" title="tests/tutorial/Input/tgw1_4.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

<span class="c1"># Convergence with respect to the number of planewaves in the sum to calculate SigmaX</span>
ndtset  <span class="m">7</span>
ecutsigx: <span class="m">3</span>.0
ecutsigx+ <span class="m">1</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver  <span class="m">4</span>
getwfk     <span class="m">1</span>
getscr     <span class="m">1</span>
ecutwfn    <span class="m">5</span>.0
nband      <span class="m">100</span>
ppmfrq    <span class="m">16</span>.7 eV
nkptgw      <span class="m">1</span>
kptgw      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw       <span class="m">4</span>  <span class="m">5</span> 



<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> 
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_4.out, tolnlines= 70, tolabs=  9.000e-03, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Crystalline silicon</span>
<span class="c1">#%%  Calculation of the GW corrections</span>
<span class="c1">#%%  Convergence with respect to the number of planewaves in the sum to calculate SigmaX</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-ba4f206f-e63c-4d26-ab45-2ab75066a9f0", "#uuid-c1250014-bb30-44ec-9adf-c55bd42d9f9b") }); </script>

<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_4.log &amp;
</pre></div>


<p>Edit the output file. The number of plane waves used for x is mentioned in
the fragments of output:</p>
<div class="codehilite"><pre><span></span> SIGMA fundamental parameters:
 PLASMON POLE MODEL
 number of plane-waves for SigmaX                   59
 number of plane-waves for SigmaC and W             59
</pre></div>


<p>Gathering the GW energies for each planewave set, one gets:</p>
<div class="codehilite"><pre><span></span> number of plane-waves for SigmaX                   59
 number of plane-waves for SigmaC and W             59
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.194   3.886   0.808  -0.238 -11.372   0.268   6.183
    5   8.445  -9.675  -3.174  -5.573   0.818  -0.222  -8.916   0.759   9.204

 number of plane-waves for SigmaX                  113
 number of plane-waves for SigmaC and W            113
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.236   3.825   0.806  -0.240 -11.455   0.184   6.099
    5   8.445  -9.675  -3.208  -5.561   0.818  -0.222  -8.934   0.741   9.186

 number of plane-waves for SigmaX                  137
 number of plane-waves for SigmaC and W            137
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.241   3.815   0.806  -0.240 -11.468   0.172   6.087
    5   8.445  -9.675  -3.211  -5.558   0.818  -0.223  -8.933   0.741   9.187

 number of plane-waves for SigmaX                  169
 number of plane-waves for SigmaC and W            169
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.244   3.810   0.806  -0.241 -11.474   0.165   6.080
    5   8.445  -9.675  -3.213  -5.557   0.818  -0.223  -8.935   0.740   9.185

 number of plane-waves for SigmaX                  259
 number of plane-waves for SigmaC and W            169
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.246   3.810   0.806  -0.241 -11.475   0.164   6.079
    5   8.445  -9.675  -3.215  -5.557   0.818  -0.223  -8.937   0.738   9.183

 number of plane-waves for SigmaX                  283
 number of plane-waves for SigmaC and W            169
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.246   3.810   0.806  -0.241 -11.475   0.164   6.079
    5   8.445  -9.675  -3.215  -5.557   0.818  -0.223  -8.937   0.738   9.183

 number of plane-waves for SigmaX                  283
 number of plane-waves for SigmaC and W            169
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.915 -11.639 -15.246   3.810   0.806  -0.241 -11.475   0.164   6.079
    5   8.445  -9.675  -3.215  -5.557   0.818  -0.223  -8.937   0.738   9.183
</pre></div>


<p>So that ecutsigx=6.0 (npwsigx=169) can be considered converged within 0.01 eV.</p>
<h2 id="5-convergence-on-the-number-of-bands-to-calculate-c-important">5 Convergence on the number of bands to calculate c (important)<a class="headerlink" href="#5-convergence-on-the-number-of-bands-to-calculate-c-important" title="Permanent link">&para;</a></h2>
<p>At last, as concerns the computation of the self-energy, we check the
convergence on the number of bands in the calculation of c. This convergence
study is rather important, usually, BUT it can be done at the same time as the
convergence study for the number of bands for the dielectric matrix.</p>
<p>The convergence on the number of bands to calculate the Self-Energy will be
done by defining five datasets, with increasing <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>:</p>
<div class="codehilite"><pre><span></span>ndtset  5
nband:  50
nband+  50
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_5.in, and modify the tgw1_x.files file as usual. Edit the tgw1_5.in
file, and take the time to examine it.<br />
Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_5.log &amp;
</pre></div>


<div class="text-center"><button type="button" id="uuid-ec22e324-287d-407d-b319-ee974f6ccdd5" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_5.in
</button></div>

<div id="uuid-31dc8e1d-5a86-418d-8a6c-35062e00ccb0" class="my_dialog" title="tests/tutorial/Input/tgw1_5.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

<span class="c1"># Convergence with respect to the number of bands</span>
ndtset  <span class="m">5</span>
nband:  <span class="m">50</span>
nband+  <span class="m">50</span>

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver  <span class="m">4</span>
getwfk     <span class="m">1</span>
getscr     <span class="m">1</span>
ecutwfn     <span class="m">5</span>.0
ecutsigx     <span class="m">6</span>.0
ppmfrq    <span class="m">16</span>.7 eV
nkptgw      <span class="m">1</span>
kptgw      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw       <span class="m">4</span>  <span class="m">5</span> 


<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_5.out, tolnlines= 70, tolabs=  9.000e-03, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%    Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-31dc8e1d-5a86-418d-8a6c-35062e00ccb0", "#uuid-ec22e324-287d-407d-b319-ee974f6ccdd5") }); </script>

<p>Edit the output file. The number of bands used for the self-energy is
mentioned in the fragments of output:</p>
<div class="codehilite"><pre><span></span> SIGMA fundamental parameters:
 PLASMON POLE MODEL
 number of plane-waves for SigmaX                  169
 number of plane-waves for SigmaC and W            169
 number of plane-waves for wavefunctions           137
 number of bands                                    50
</pre></div>


<p>Gathering the GW energies for each number of bands, one gets:</p>
<div class="codehilite"><pre><span></span> number of bands                                   50
    4   5.915 -11.639 -15.244   3.878   0.807  -0.240 -11.419   0.220   6.135
    5   8.445  -9.675  -3.213  -5.492   0.819  -0.222  -8.881   0.794   9.239

 number of bands                                  100
    4   5.915 -11.639 -15.244   3.810   0.806  -0.241 -11.474   0.165   6.080
    5   8.445  -9.675  -3.213  -5.557   0.818  -0.223  -8.935   0.740   9.185

 number of bands                                  150
    4   5.915 -11.639 -15.244   3.805   0.806  -0.241 -11.478   0.161   6.076
    5   8.445  -9.675  -3.213  -5.563   0.818  -0.223  -8.940   0.735   9.180

 number of bands                                  200
    4   5.915 -11.639 -15.244   3.804   0.806  -0.241 -11.479   0.160   6.075
    5   8.445  -9.675  -3.213  -5.564   0.818  -0.223  -8.940   0.734   9.180

 number of bands                                  250
    4   5.915 -11.639 -15.244   3.804   0.806  -0.241 -11.479   0.160   6.075
    5   8.445  -9.675  -3.213  -5.564   0.818  -0.223  -8.941   0.734   9.179
</pre></div>


<p>So that nband=100 can be considered converged within 0.01 eV.</p>
<p>At this stage, we know that for the self-energy computation, we need
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>=5.0 <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutsigx">ecutsigx</a>=6.0, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=100 .</p>
<h2 id="6-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-screening-1-optional">6 Convergence on the number of planewaves in the wavefunctions to calculate the screening (-1) (optional)<a class="headerlink" href="#6-convergence-on-the-number-of-planewaves-in-the-wavefunctions-to-calculate-the-screening-1-optional" title="Permanent link">&para;</a></h2>
<p>Now, we come back to the calculation of the screening. Adequate convergence
studies will couple the change of parameters for <a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=3 with a
computation of the GW energy changes. One cannot rely on the convergence of
the macroscopic dielectric constant to assess the convergence of the GW energies.</p>
<p>As a consequence, we will define a double loop over the datasets:</p>
<div class="codehilite"><pre><span></span>ndtset      10
udtset      5  2
</pre></div>


<p>The datasets 12,22,32,42 and 52, drive the computation of the GW energies:</p>
<div class="codehilite"><pre><span></span># Calculation of the Self-Energy matrix elements (GW corrections)
optdriver?2   4
getscr?2     -1
ecutwfn?2     5.0
ecutsigx      6.0
nband?2       100
</pre></div>


<p>The datasets 11,21,31,41 and 51, drive the corresponding computation of the screening:</p>
<div class="codehilite"><pre><span></span># Calculation of the screening (epsilon^-1 matrix)
optdriver?1  3
</pre></div>


<p>In this latter series, we will have to vary the three different parameters
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>.</p>
<p>First, we check the convergence on the number of planewaves to describe the
wavefunctions, in the calculation of the screening. This will be done by
defining five datasets, with increasing <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>:</p>
<div class="codehilite"><pre><span></span>ecutwfn:?   3.0
ecutwfn+?   1.0
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_6.in, and modify the tgw1_x.files file as usual. Edit the tgw1_6.in
file, and take the time to examine it.<br />
Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_6.log &amp;
</pre></div>


<div class="text-center"><button type="button" id="uuid-a2d380cc-4772-4431-84f1-4b8a53beb320" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_6.in
</button></div>

<div id="uuid-76e5f622-7a50-40e1-856e-fb4060329c99" class="my_dialog" title="tests/tutorial/Input/tgw1_6.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

ndtset      <span class="m">10</span>
udtset      <span class="m">5</span>  <span class="m">2</span>

<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver?1  <span class="m">3</span>
ecuteps      <span class="m">6</span>.0
nband?1      <span class="m">25</span>

<span class="c1"># Convergence with respect to the number of planewaves in wavefunctions to calculate epsilon^-1</span>
ecutwfn:?   <span class="m">3</span>.0
ecutwfn+?   <span class="m">1</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver?2  <span class="m">4</span>
getscr?2     -1
ecutwfn?2    <span class="m">5</span>.0
ecutsigx      <span class="m">6</span>.0
nband?2      <span class="m">100</span>

nkptgw        <span class="m">1</span>
kptgw        <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw         <span class="m">4</span>  <span class="m">5</span>


<span class="c1"># GW calculation general parameters</span>
getwfk       <span class="m">1</span>
ppmfrq      <span class="m">16</span>.7 eV


<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat <span class="m">1</span> <span class="m">1</span>         <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> 
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_6.out,      tolnlines= 70, tolabs=  7.000e-02, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-76e5f622-7a50-40e1-856e-fb4060329c99", "#uuid-a2d380cc-4772-4431-84f1-4b8a53beb320") }); </script>

<p>Edit the output file. The number of plane waves used for the wavefunctions in
the computation of the screening is mentioned in the fragments of output:</p>
<div class="codehilite"><pre><span></span> EPSILON^-1 parameters (SCR file):
 dimension of the eps^-1 matrix                    169
 number of plane-waves for wavefunctions            59
</pre></div>


<p>Gathering the macroscopic dielectric constant and GW energies for each
planewave set, one gets:</p>
<div class="codehilite"><pre><span></span> dielectric constant =  99.4320
 dielectric constant without local fields = 147.6068
 number of plane-waves for wavefunctions            59
    4   5.915 -11.639 -15.244   3.843   0.811  -0.233 -11.446   0.193   6.108
    5   8.445  -9.675  -3.213  -5.527   0.819  -0.221  -8.909   0.766   9.211

 dielectric constant =  99.8529
 dielectric constant without local fields = 144.5675
 number of plane-waves for wavefunctions           113
    4   5.915 -11.639 -15.244   3.789   0.804  -0.244 -11.492   0.147   6.063
    5   8.445  -9.675  -3.213  -5.564   0.817  -0.224  -8.941   0.734   9.179

 dielectric constant =  99.5260
 dielectric constant without local fields = 143.7201
 number of plane-waves for wavefunctions           137
    4   5.915 -11.639 -15.244   3.779   0.804  -0.243 -11.500   0.140   6.055
    5   8.445  -9.675  -3.213  -5.568   0.816  -0.226  -8.945   0.729   9.175

 dielectric constant =  98.2593
 dielectric constant without local fields = 142.5976
 number of plane-waves for wavefunctions           169
    4   5.915 -11.639 -15.244   3.772   0.802  -0.248 -11.505   0.134   6.049
    5   8.445  -9.675  -3.213  -5.573   0.815  -0.227  -8.951   0.724   9.169

 dielectric constant =  96.8379
 dielectric constant without local fields = 141.0644
 number of plane-waves for wavefunctions           259
    4   5.915 -11.639 -15.244   3.769   0.804  -0.244 -11.508   0.131   6.047
    5   8.445  -9.675  -3.213  -5.578   0.815  -0.227  -8.954   0.721   9.166
</pre></div>


<p>So that <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>=4.0 (<a class="wikilink codevar-wikilink" href="../../variables/internal#npwwfn">%npwwfn</a>=113) can be considered to lead to
eigenenergies converged within 0.01 eV.</p>
<h2 id="7-convergence-on-the-number-of-bands-to-calculate-the-screening-1-important">7 Convergence on the number of bands to calculate the screening (-1) (important)<a class="headerlink" href="#7-convergence-on-the-number-of-bands-to-calculate-the-screening-1-important" title="Permanent link">&para;</a></h2>
<p>This convergence study is rather important. It can be done at the same time as
the convergence study for the number of bands for the self-energy. Note that
the number of bands used to calculate both the screening and the self-energy
can be lowered by a large amount by resorting to the extrapolar technique (see
the input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcomp">gwcomp</a>).</p>
<p>Second, we check the convergence on the number of bands in the calculation of
the screening. This will be done by defining five datasets, with increasing <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>:</p>
<div class="codehilite"><pre><span></span>nband11  25
nband21  50
nband31  100
nband41  150
nband51  200
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_7.in, and modify the tgw1_x.files file as usual. Edit the tgw1_7.in
file, and take the time to examine it.</p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_7.log &amp;
</pre></div>


<div class="text-center"><button type="button" id="uuid-01265b6a-04d8-40ff-9dce-12f223cb5303" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_7.in
</button></div>

<div id="uuid-369aeb0e-87ec-4ce7-8bc9-347861207bbf" class="my_dialog" title="tests/tutorial/Input/tgw1_7.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

ndtset      <span class="m">10</span>
udtset      <span class="m">5</span>  <span class="m">2</span>

<span class="c1"># Convergence with respect to the number of bands to calculate epsilon^-1</span>
nband11  <span class="m">25</span>
nband21  <span class="m">50</span>
nband31  <span class="m">100</span>
nband41  <span class="m">150</span>
nband51  <span class="m">200</span>

<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver?1  <span class="m">3</span>
ecuteps      <span class="m">6</span>.0
ecutwfn?1    <span class="m">4</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver?2  <span class="m">4</span>
getscr?2     -1
ecutwfn?2    <span class="m">5</span>.0
ecutsigx       <span class="m">6</span>.0
nband?2      <span class="m">100</span>
nkptgw?2      <span class="m">1</span>
kptgw?2      <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw?2       <span class="m">4</span>  <span class="m">5</span> 

getwfk       <span class="m">1</span>
ppmfrq      <span class="m">16</span>.7 eV

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_7.out, tolnlines= 70, tolabs=  7.000e-02, tolrel=  3.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-369aeb0e-87ec-4ce7-8bc9-347861207bbf", "#uuid-01265b6a-04d8-40ff-9dce-12f223cb5303") }); </script>

<p>Edit the output file. The number of bands used for the wavefunctions in the
computation of the screening is mentioned in the fragments of output:</p>
<div class="codehilite"><pre><span></span> EPSILON^-1 parameters (SCR file):
 dimension of the eps^-1 matrix                    169
 number of plane-waves for wavefunctions           113
 number of bands                                    25
</pre></div>


<p>Gathering the macroscopic dielectric constant and GW energies for each number
of bands, one gets:</p>
<div class="codehilite"><pre><span></span> dielectric constant =  99.8529
 dielectric constant without local fields = 144.5675
 number of bands                                    25
    4   5.915 -11.639 -15.244   3.789   0.804  -0.244 -11.492   0.147   6.063
    5   8.445  -9.675  -3.213  -5.564   0.817  -0.224  -8.941   0.734   9.179

 dielectric constant = 100.9503
 dielectric constant without local fields = 144.5701
 number of bands                                    50
    4   5.915 -11.639 -15.244   3.624   0.806  -0.241 -11.624   0.015   5.930
    5   8.445  -9.675  -3.213  -5.738   0.814  -0.228  -9.085   0.590   9.035

 dielectric constant = 101.2722
 dielectric constant without local fields = 144.5703
 number of bands                                   100
    4   5.915 -11.639 -15.244   3.577   0.807  -0.239 -11.662  -0.023   5.892
    5   8.445  -9.675  -3.213  -5.792   0.813  -0.230  -9.131   0.544   8.989

 dielectric constant = 101.3772
 dielectric constant without local fields = 144.5703
 number of bands                                   150
    4   5.915 -11.639 -15.244   3.568   0.807  -0.240 -11.669  -0.030   5.885
    5   8.445  -9.675  -3.213  -5.800   0.813  -0.230  -9.137   0.538   8.983

 dielectric constant = 101.3814
 dielectric constant without local fields = 144.5703
 number of bands                                   200
    4   5.915 -11.639 -15.244   3.568   0.807  -0.240 -11.669  -0.030   5.885
    5   8.445  -9.675  -3.213  -5.801   0.813  -0.230  -9.137   0.537   8.983
</pre></div>


<p>So that the computation using 100 bands can be considered converged within 0.01 eV.</p>
<h2 id="8-convergence-on-the-dimension-of-the-screening-1-matrix-important">8 Convergence on the dimension of the screening -1 matrix (important)<a class="headerlink" href="#8-convergence-on-the-dimension-of-the-screening-1-matrix-important" title="Permanent link">&para;</a></h2>
<p>Third, we check the convergence on the number of plane waves in the
calculation of the screening. This will be done by defining six datasets, with
increasing <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>:</p>
<div class="codehilite"><pre><span></span>ecuteps:?     3.0
ecuteps+?     1.0
</pre></div>


<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_8.in, and modify the tgw1_x.files file as usual. Edit the tgw1_8.in
file, and take the time to examine it.</p>
<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_8.log &amp;
</pre></div>


<div class="text-center"><button type="button" id="uuid-e89fa6b8-f82e-4962-a1fa-7e9641b2c578" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_8.in
</button></div>

<div id="uuid-5bcdb66b-5526-4f29-b6ae-35d5bf3a9ccd" class="my_dialog" title="tests/tutorial/Input/tgw1_8.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections</span>

ndtset      <span class="m">12</span>
udtset      <span class="m">6</span>  <span class="m">2</span>

<span class="c1"># Calculation of the screening (epsilon^-1 matrix)</span>
optdriver?1  <span class="m">3</span>
nband?1      <span class="m">100</span>
ecutwfn?1    <span class="m">4</span>.0

<span class="c1"># Convergence with respect to the dimension of epsilon^-1 matrix</span>
ecuteps:?     <span class="m">3</span>.0
ecuteps+?     <span class="m">1</span>.0

<span class="c1"># Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver?2  <span class="m">4</span>
getscr?2     -1
ecutwfn?2    <span class="m">5</span>.0
ecutsigx       <span class="m">6</span>.0
nband?2      <span class="m">100</span>
nkptgw        <span class="m">1</span>
kptgw        <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000
bdgw         <span class="m">4</span>  <span class="m">5</span> 
icutcoul?2   <span class="m">3</span>        <span class="c1"># old deprecated value of icutcoul, only used for legacy</span>

<span class="c1"># GW calculation general parameters</span>
getwfk       <span class="m">1</span>
ppmfrq      <span class="m">16</span>.7 eV


<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the</span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s)</span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>


<span class="c1"># Sampling of the BZ</span>
ngkpt   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> 
nshiftk <span class="m">1</span>
shiftk  <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0
istwfk  *1         <span class="c1"># This is mandatory in all the GW steps.</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgw1_2.in, tgw1_3.in, tgw1_4.in, tgw1_5.in, tgw1_6.in, tgw1_7.in, tgw1_8.in</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_8.out,  tolnlines= 70, tolabs=  7.000e-02, tolrel=  7.000e-02</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW corrections</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5bcdb66b-5526-4f29-b6ae-35d5bf3a9ccd", "#uuid-e89fa6b8-f82e-4962-a1fa-7e9641b2c578") }); </script>

<p>Edit the output file. The number of bands used for the wavefunctions in the
computation of the screening is mentioned in the fragments of output:</p>
<div class="codehilite"><pre><span></span> EPSILON^-1 parameters (SCR file):
 dimension of the eps^-1 matrix                     59
</pre></div>


<p>Gathering the macroscopic dielectric constant and GW energies for each number
of bands, one gets:</p>
<div class="codehilite"><pre><span></span> dielectric constant = 102.1696
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                     59
    4   5.915 -11.639 -15.244   3.721   0.808  -0.237 -11.545   0.094   6.009
    5   8.445  -9.675  -3.213  -5.805   0.813  -0.230  -9.141   0.534   8.979

 dielectric constant = 101.3721
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                    113
    4   5.915 -11.639 -15.244   3.613   0.807  -0.239 -11.633   0.007   5.922
    5   8.445  -9.675  -3.213  -5.799   0.813  -0.230  -9.136   0.539   8.984

 dielectric constant = 101.3560
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                    137
    4   5.915 -11.639 -15.244   3.591   0.807  -0.239 -11.651  -0.012   5.904
    5   8.445  -9.675  -3.213  -5.793   0.813  -0.230  -9.131   0.543   8.989

 dielectric constant = 101.2722
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                    169
    4   5.915 -11.639 -15.244   3.577   0.807  -0.239 -11.662  -0.023   5.892
    5   8.445  -9.675  -3.213  -5.792   0.813  -0.230  -9.131   0.544   8.989

 dielectric constant = 101.2405
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                    259
    4   5.915 -11.639 -15.244   3.577   0.807  -0.239 -11.662  -0.023   5.892
    5   8.445  -9.675  -3.213  -5.792   0.813  -0.230  -9.130   0.544   8.990
 dielectric constant = 101.2404
 dielectric constant without local fields = 144.5703
 dimension of the eps^-1 matrix                    283
    4   5.915 -11.639 -15.244   3.577   0.807  -0.239 -11.662  -0.023   5.892
    5   8.445  -9.675  -3.213  -5.792   0.813  -0.230  -9.130   0.544   8.990
</pre></div>


<p>So that ecuteps=6.0 (npweps=169) can be considered converged within 0.01 eV.</p>
<p>At this stage, we know that for the screening computation, we need
<a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a>=4.0 <a class="wikilink codevar-wikilink" href="../../variables/gw#ecuteps">ecuteps</a>=6.0, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a>=100.</p>
<p>Of course, until now, we have skipped the most difficult part of the
convergence tests: the convergence in the number of k-points. It is as
important to check the convergence on this parameter, than on the other ones.
However, this might be very time consuming, since the CPU time scales as the
square of the number of k points (roughly), and the number of k-points can
increase very rapidly from one possible grid to the next denser one. This is
why we will leave this out of the present tutorial, and consider that we
already know a sufficient k-point grid, for the last calculation.</p>
<h2 id="9-calculation-of-the-gw-corrections-for-the-band-gap-in">9 Calculation of the GW corrections for the band gap in <a class="headerlink" href="#9-calculation-of-the-gw-corrections-for-the-band-gap-in" title="Permanent link">&para;</a></h2>
<p>Now we try to perform a GW calculation for a real problem: the calculation of
the GW corrections for the direct band gap of bulk Silicon in .</p>
<p>In directory ~abinit/tests/tutorial/Input/Work_gw1, copy the file
../tgw1_9.in, and modify the tgw1_x.files file as usual. Then, edit the
tgw1_9.in file, and, without examining it, comment the line</p>
<div class="codehilite"><pre><span></span> ngkpt    2 2 2         # Density of k points used for the automatic tests of the tutorial
</pre></div>


<p>and uncomment the line</p>
<div class="codehilite"><pre><span></span>#ngkpt    4 4 4        # Density of k points needed for a converged calculation
</pre></div>


<p>Then, issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tgw1_x.files &gt;&amp; tgw1_9.log &amp;
</pre></div>


<p>This job lasts about 1 minute so it is worth to run it before the examination of the input file.
Now, you can examine it.  </p>
<div class="text-center"><button type="button" id="uuid-90f77e01-84f9-45c5-9443-4f9c9dc53ab2" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/tgw1_9.in
</button></div>

<div id="uuid-28da2e43-5bd5-48a8-9f13-e47c4f1f3114" class="my_dialog" title="tests/tutorial/Input/tgw1_9.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW correction to the direct band gap in Gamma</span>
<span class="c1"># Dataset 1: ground state calculation </span>
<span class="c1"># Dataset 2: calculation of the WFK file </span>
<span class="c1"># Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1"># Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>

ndtset      <span class="m">4</span>

ngkpt    <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>         <span class="c1"># Density of k points used for the automatic tests of the tutorial</span>
<span class="c1">#ngkpt    4 4 4        # Density of k points needed for a converged calculation</span>

nshiftk  <span class="m">4</span>
shiftk   <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.0  <span class="c1"># This grid contains the Gamma point, which is the point at which</span>
         <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.5  <span class="c1"># we will compute the (direct) band gap. There are 19 k points</span>
         <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.5  <span class="c1"># in the irreducible Brillouin zone, if ngkpt 4 4 4 is used.</span>
         <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.0
istwfk  *1            <span class="c1"># For the GW computations, do not take advantage of the </span>
                      <span class="c1"># specificities of k points to reduce the number of components of the</span>
                      <span class="c1"># wavefunction.</span>
tolwfr  <span class="m">1</span>.0d-10   

<span class="c1"># Dataset1: usual self-consistent ground-state calculation</span>
<span class="c1"># Definition of the k-point grid</span>
shiftk1  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5  <span class="c1"># This grid is the most economical, but does not contain the Gamma point.</span>
         <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
istwfk1 *0            <span class="c1"># For the ground state, let the code use the time-reversal symmetry</span>
tolvrs1 1e-10

<span class="c1"># Dataset2: calculation of WFK file</span>
<span class="c1"># Definition of k-points</span>
iscf2    -2             <span class="c1"># Non self-consistent calculation</span>
getden2  -1             <span class="c1"># Read previous density file</span>
nband2   <span class="m">105</span>
nbdbuf2   <span class="m">5</span>

<span class="c1"># Dataset3: Calculation of the screening (epsilon^-1 matrix)</span>
optdriver3   <span class="m">3</span>       <span class="c1"># Screening calculation</span>
getwfk3     -1       <span class="c1"># Obtain WFK file from previous dataset</span>
nband3      <span class="m">25</span>       <span class="c1"># Bands to be used in the screening calculation</span>
ecutwfn3    <span class="m">3</span>.6      <span class="c1"># Planewaves to be used to represent the wavefunctions</span>
ecuteps3    <span class="m">6</span>.0      <span class="c1"># Dimension of the screening matrix</span>
ppmfrq3    <span class="m">16</span>.7 eV  <span class="c1"># Imaginary frequency where to calculate the screening</span>


<span class="c1"># Dataset4: Calculation of the Self-Energy matrix elements (GW corrections)</span>
optdriver4  <span class="m">4</span>        <span class="c1"># Self-Energy calculation</span>
getwfk4     -2       <span class="c1"># Obtain WFK file from dataset 1</span>
getscr4     -1       <span class="c1"># Obtain SCR file from previous dataset</span>
nband4      <span class="m">100</span>      <span class="c1"># Bands to be used in the Self-Energy calculation</span>
ecutwfn4    <span class="m">5</span>.0      <span class="c1"># Planewaves to be used to represent the wavefunctions</span>
ecutsigx4    <span class="m">6</span>.0     <span class="c1"># Dimension of the G sum in Sigma_x</span>

nkptgw4      <span class="m">1</span>               <span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw4                       <span class="c1"># k-points</span>
  <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="c1"># (Gamma)</span>
bdgw4       <span class="m">4</span>  <span class="m">5</span>             <span class="c1"># calculate GW corrections for bands from 4 to 5</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell  <span class="m">3</span>*10.217        <span class="c1"># This is equivalent to   10.217 10.217 10.217</span>
rprim  <span class="m">0</span>.0  <span class="m">0</span>.5  <span class="m">0</span>.5   <span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
       <span class="m">0</span>.5  <span class="m">0</span>.0  <span class="m">0</span>.5   
       <span class="m">0</span>.5  <span class="m">0</span>.5  <span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat  <span class="m">1</span>         <span class="c1"># There is only one type of atom</span>
znucl <span class="m">14</span>          <span class="c1"># The keyword &quot;znucl&quot; refers to the atomic number of the </span>
                  <span class="c1"># possible type(s) of atom. The pseudopotential(s) </span>
                  <span class="c1"># mentioned in the &quot;files&quot; file must correspond</span>
                  <span class="c1"># to the type(s) of atom. Here, the only type is Silicon.</span>

<span class="c1"># Definition of the atoms</span>
natom <span class="m">2</span>           <span class="c1"># There are two atoms</span>
typat  <span class="m">1</span> <span class="m">1</span>        <span class="c1"># They both are of type 1, that is, Silicon.</span>
xred              <span class="c1"># Reduced coordinate of atoms</span>
      <span class="m">0</span>.0  <span class="m">0</span>.0  <span class="m">0</span>.0
      <span class="m">0</span>.25 <span class="m">0</span>.25 <span class="m">0</span>.25

<span class="c1"># Definition of the planewave basis set (at convergence 16 Rydberg 8 Hartree)</span>
ecut <span class="m">8</span>.0          <span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1"># Definition of the SCF procedure</span>
nstep   <span class="m">10</span>        <span class="c1"># Maximal number of SCF cycles</span>
diemac  <span class="m">12</span>.0      <span class="c1"># Although this is not mandatory, it is worth to</span>
                  <span class="c1"># precondition the SCF cycle. The model dielectric</span>
                  <span class="c1"># function used as the standard preconditioner</span>
                  <span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
                  <span class="c1"># Here, we follow the prescription for bulk silicon.</span>




<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgw1_9.out, tolnlines= 70, tolabs=  7.000e-02, tolrel=  3.000e-02, fld_options= -ridiculous</span>
<span class="c1">#%% psp_files = 14si.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = GW</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%   Crystalline silicon</span>
<span class="c1">#%%   Calculation of the GW correction to the direct band gap in Gamma</span>
<span class="c1">#%%   Dataset 1: ground state calculation </span>
<span class="c1">#%%   Dataset 2: calculation of the WFK file </span>
<span class="c1">#%%   Dataset 3: calculation of the screening (epsilon^-1 matrix for W)</span>
<span class="c1">#%%   Dataset 4: calculation of the Self-Energy matrix elements (GW corrections)</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-28da2e43-5bd5-48a8-9f13-e47c4f1f3114", "#uuid-90f77e01-84f9-45c5-9443-4f9c9dc53ab2") }); </script>

<p>We need the usual part of the input file to perform a ground state
calculation. This is done in dataset 1 and at the end we print out the
density. We use a 4x4x4 FCC grid (so, 256 k points in the full Brillouin
Zone), shifted, because it is the most economical. It gives 10 k-points in the
Irreducible part of the Brillouin Zone. However, this k-point grid does not
contains the  point, and, at present, one cannot perform calculations of the
self-energy corrections for other k points than those present in the grid of
k-points in the WFK file.</p>
<p>Then in dataset 2 we perform a non self-consistent calculation to calculate
the Kohn-Sham structure in a set of 19 k-points in the Irreducible Brillouin
Zone. This set of k-points is also derived from a 4x4x4 FCC grid, but a NON-
SHIFTED one. It has the same density of points as the 10 k-point set, but the
symmetries are not used in a very efficient way. However, this set contains
the  point, which allows us to tackle the computation of the band gap at this point.</p>
<p>In dataset 3 we calculate the screening. The screening calculation is very
time-consuming. So, we have decided to decrease a bit the parameters found in
the previous convergence studies. Indeed, <a class="wikilink codevar-wikilink" href="../../variables/gw#ecutwfn">ecutwfn</a> has been decreased from
4.0 to 3.6. This is rather innocuous. Also, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> has been decreased from
100 to 25. This is a drastic change. The CPU time of this part is linear with
respect to this parameter (or more exactly, with the number of conduction
bands). Thus, the CPU time has been decreased by a factor of 4. Referring to
our previous convergence study, we see that the absolute accuracy on the GW
energies is now on the order of 0.2 eV only. However, the gap energy
(difference between valence and conduction states), that is the relative
accuracy, is likely correct within 0.02 eV. It is very important to clarify
this point: in bulk systems what matters is only the relative accuracy. There
is no zero of the energy defined for a bulk system. Hence in these systems one
CAN WELL check the convergence only on the relative accuracy on the energies
rather than the absolute, by checking the convergence on the band gap for
example. This will reduce a lot the values to be found for the convergence
parameters. The same holds for 2-, 1-, and 0-dimensional systems if one is
interested only on relative energies and is not interested in calculating
quantities like the work function.</p>
<p>Finally in dataset 4 we calculate the self-energy matrix element in , using
the previously determined parameters.</p>
<p>You should obtain the following results:</p>
<div class="codehilite"><pre><span></span> k =    0.000   0.000   0.000
 Band     E0  VxcLDA    SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E
    4   5.951 -11.253 -12.628   1.187   0.777  -0.287 -11.398  -0.146   5.806
    5   8.464 -10.042  -5.563  -3.878   0.777  -0.287  -9.575   0.467   8.931

 E^0_gap          2.513
 E^GW_gap         3.126
 DeltaE^GW_gap    0.613
</pre></div>


<p>So that the LDA energy gap in  is about 2.53 eV, while the GW correction is
about 0.64 eV, so that the GW band gap found is 3.17 eV.</p>
<p>One can compare now what have been obtained to what one can get from the literature.</p>
<div class="codehilite"><pre><span></span> EXP         3.40 eV   Landolt-Boernstein

 LDA         2.57 eV   L. Hedin, Phys. Rev. 139, A796 (1965)
 LDA         2.57 eV   M.S. Hybertsen and S. Louie, PRL 55, 1418 (1985)
 LDA (FLAPW) 2.55 eV   N. Hamada, M. Hwang and A.J. Freeman, PRB 41, 3620 (1990)
 LDA (PAW)   2.53 eV   B. Arnaud and M. Alouani, PRB 62, 4464 (2000)
 LDA         2.53 eV   present work

 GW          3.27 eV   M.S. Hybertsen and S. Louie, PRL 55, 1418 (1985)
 GW          3.35 eV   M.S. Hybertsen and S. Louie, PRB 34, 5390 (1986)
 GW          3.30 eV   R.W. Godby, M. Schlueter, L.J. Sham, PRB 37, 10159 (1988)
 GW  (FLAPW) 3.30 eV   N. Hamada, M. Hwang and A.J. Freeman, PRB 41, 3620 (1990)
 GW  (PAW)   3.15 eV   B. Arnaud and M. Alouani, PRB 62, 4464 (2000)
 GW  (FLAPW) 3.12 eV   W. Ku and A.G. Eguiluz, PRL 89, 126401 (2002)
 GW          3.17 eV   present work
</pre></div>


<p>The values are spread over an interval of 0.2 eV. They depend on the details
of the calculation. In the case of pseudopotential calculations, they depend
of course on the pseudopotential used. However, a GW result is hardly
meaningful beyond 0.1 eV, in the present state of the art. But this goes also
with the other source of inaccuracy, the choice of the pseudopotential, that
can arrive up to even 0.2 eV. This can also be taken into account when
choosing the level of accuracy for the convergence parameters in the GW calculation.</p>
<p>Finally, it is possible to calculate a full band plot of a system. There are
two possible techniques. The first one is based on the use of Wannier
functions, to interpolate a few selected points obtained using the direct GW
approach. You need to have the Wannier90 plug-in installed. See the directory
tests/wannier90, test case 03, for an example of a file where a GW calculation
is followed by the use of Wannier90. Another practical way follows from the
fact that the GW corrections are quite linear with the energy, for each group
of bands. This is evident when reporting on a plot the GW correction with
respect to the 0-order LDA energy for each state. One can then simply correct
the Kohn-Sham band structure at any point, by using a GW correction for the
k-points where it has not been calculated explicitly, using a fit of the GW
correction at a sparse set of points.</p>
<h2 id="advanced-features-in-the-gw-code">Advanced features in the GW code<a class="headerlink" href="#advanced-features-in-the-gw-code" title="Permanent link">&para;</a></h2>
<p>The user might switch to the [lesson:gw2|second GW tutorial] before
coming back to the present section.</p>
<h4 id="calculations-without-using-the-plasmon-pole-model"><strong>Calculations without using the Plasmon-Pole model</strong><a class="headerlink" href="#calculations-without-using-the-plasmon-pole-model" title="Permanent link">&para;</a></h4>
<p>In order to circumvent the plasmon-pole model, the GW frequency convolution
has to be calculated explicitly along the real axis. This is a tough job,
since G and W have poles along the real axis. Therefore it is more convenient
to use another path of integration along the imaginary axis plus the residues
enclosed in the path.</p>
<p>Consequently, it is better to evaluate the screening for imaginary frequencies
(to perform the integration) and also for real frequencies (to evaluate the
contributions of the residues that may enter into the path of integration).
The number of imaginary frequencies is set by the input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqim">nfreqim</a>.
The regular grid of real frequencies is determined by the input variables
<a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqre">nfreqre</a>, which sets the number of real frequencies, and <a class="wikilink codevar-wikilink" href="../../variables/gw#freqremax">freqremax</a>,
which indicates the maximum real frequency used.</p>
<p>The method is particularly suited to output the spectral function (contained
in file out.sig). The grid of real frequencies used to calculate the spectral
function is set by the number of frequencies (input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#nfreqsp">nfreqsp</a>) and
by the maximum frequency calculated (input variable <a class="wikilink codevar-wikilink" href="../../variables/gw#freqspmax">freqspmax</a>).</p>
<h4 id="self-consistent-calculations"><strong>Self-consistent calculations</strong><a class="headerlink" href="#self-consistent-calculations" title="Permanent link">&para;</a></h4>
<p>The details in the implementation and the justification for the approximations
retained can be found in F. Bruneval, N. Vast, and L. Reining, Phys. Rev. B <strong>74</strong> , 045102 (2006).<br />
The only added input variables are <a class="wikilink codevar-wikilink" href="../../variables/files#getqps">getqps</a> and <a class="wikilink codevar-wikilink" href="../../variables/files#irdqps">irdqps</a>. These variables
concerns the reading of the _QPS file, that contains the eigenvalues and the
unitary transform matrices of a previous quasiparticle calculation. QPS stands
for &ldquo;QuasiParticle Structure&rdquo;.<br />
The only modified input variables for self-consistent calculations are
<a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> and <a class="wikilink codevar-wikilink" href="../../variables/gw#bdgw">bdgw</a>.<br />
When the variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> is in between 0 and 9, The code calculates the
quasiparticle energies only and does not output any QPS file (as in a standard GW run).<br />
When the variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> is in between 10 and 19, the code calculates
the quasiparticle energies only and outputs them in a QPS file.<br />
When the variable <a class="wikilink codevar-wikilink" href="../../variables/gw#gwcalctyp">gwcalctyp</a> is in between 20 and 29, the code calculates
the quasiparticle energies and wavefunctions and outputs them in a QPS file.<br />
For a full self-consistency calculation, the quasiparticle wavefunctions are
expanded in the basis set of the Kohn-Sham wavefunctions. The variable
<a class="wikilink codevar-wikilink" href="../../variables/gw#bdgw">bdgw</a> now indicates the size of all matrices to be calculated and
diagonalized. The quasiparticle wavefunctions are consequently linear
combinations of the Kohn-Sham wavefunctions in between the min and max values of bdgw.</p>
<p>A correct self-consistent calculation should consist of the following runs:</p>
<ul>
<li>1) Self-consistent Kohn-Sham calculation: outputs a WFK file </li>
<li>2) Screening calculation (with Kohn-Sham inputs): outputs a SCR file </li>
<li>3) Sigma calculation (with Kohn-Sham inputs): outputs a QPS file </li>
<li>4) Screening calculation (with the WFK, and QPS file as an input): outputs a new SCR file </li>
<li>5) Sigma calculation (with the WFK, QPS and the new SCR files): outputs a new QPS file </li>
<li>6) Screening calculation (with the WFK, the new QPS file): outputs a newer SCR file </li>
<li>7) Sigma calculation (with the WFK, the newer QPS and SCR files): outputs a newer QPS </li>
<li>............ and so on, until the desired accuracy is reached </li>
</ul>
<p>Note that for Hartree-Fock calculations a dummy screening is required for
initialization reasons. Therefore, a correct HF calculations should look like</p>
<ul>
<li>1) Self-consistent Kohn-Sham calculation: outputs a WFK file </li>
<li>2) Screening calculation using very low convergence parameters (with Kohn-Sham inputs): output a <strong>dummy</strong> SCR file </li>
<li>3) Sigma calculation (with Kohn-Sham inputs): outputs a QPS file </li>
<li>4) Sigma calculation (with the WFK and QPS files): outputs a new QPS file </li>
<li>5) Sigma calculation (with the WFK and the new QPS file): outputs a newer QPS file </li>
<li>............ and so on, until the desired accuracy is reached </li>
</ul>
<p>In the case of a self-consistent calculation, the output is slightly more complex:<br />
<strong>For instance, iteration 2</strong></p>
<div class="codehilite"><pre><span></span> k =    0.500   0.250   0.000
 Band     E_lda  &lt;Vxclda&gt;    E(N-1) &lt;Hhartree&gt;    SigX  SigC[E(N-1)]    Z     dSigC/dE  Sig[E(N)]  DeltaE  E(N)_pert E(N)_diago
    1    -3.422   -10.273    -3.761     6.847   -15.232     4.034     1.000     0.000   -11.198    -0.590    -4.351    -4.351
    2    -0.574   -10.245    -0.850     9.666   -13.806     2.998     1.000     0.000   -10.807    -0.291    -1.141    -1.141
    3     2.242    -9.606     2.513    11.841   -11.452     1.931     1.000     0.000    -9.521    -0.193     2.320     2.320
    4     3.595   -10.267     4.151    13.866   -11.775     1.842     1.000     0.000    -9.933    -0.217     3.934     3.934
    5     7.279    -8.804     9.916    16.078    -4.452    -1.592     1.000     0.000    -6.044     0.119    10.034    10.035
    6    10.247    -9.143    13.462    19.395    -4.063    -1.775     1.000     0.000    -5.838     0.095    13.557    13.557
    7    11.488    -9.704    15.159    21.197    -4.061    -1.863     1.000     0.000    -5.924     0.113    15.273    15.273
    8    11.780    -9.180    15.225    20.958    -3.705    -1.893     1.000     0.000    -5.598     0.135    15.360    15.360

 E^0_gap          3.684
 E^GW_gap         5.764
 DeltaE^GW_gap    2.080
</pre></div>


<p>The columns are</p>
<ul>
<li><strong>Band</strong> : index of the band   </li>
<li><strong>E_lda</strong> : LDA eigenvalue   </li>
<li><strong>&lt; Vxclda&gt;</strong>: diagonal expectation value of the xc potential in between LDA bra and ket   </li>
<li><strong>E(N-1)</strong> : quasiparticle energy of the previous iteration (equal to LDA for the first iteration)   </li>
<li><strong>&lt; Hhartree&gt;</strong>: diagonal expectation value of the Hartree Hamiltonian (equal to E_lda - <Vxclda> for the first iteration only)   </li>
<li><strong>SigX</strong> : diagonal expectation value of the exchange self-energy   </li>
<li><strong>SigC[E(N-1)]</strong> : diagonal expectation value of the correlation self-energy 
    (evaluated for the energy of the preceeding iteration)   </li>
<li><strong>Z</strong> : quasiparticle renormalization factor Z (taken equal to 1 in methods HF, SEX, COHSEX and model GW)   </li>
<li><strong>dSigC/dE</strong> : Derivative of the correlation self-energy with respect to the energy   </li>
<li><strong>Sig[E(N)]</strong> : Total self-energy for the new quasiparticle energy   </li>
<li><strong>DeltaE</strong> : Energy difference with respect to the previous step   </li>
<li><strong>E(N)_pert</strong> : QP energy as obtained by the usual perturbative method   </li>
<li><strong>E(N)_diago</strong> : QP energy as obtained by the full diagonalization </li>
</ul>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../tdepes/" title="Tdepes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Tdepes
              </span>
            </div>
          </a>
        
        
          <a href="../gw2/" title="GW2" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GW2
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (VOlevano, XG)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>