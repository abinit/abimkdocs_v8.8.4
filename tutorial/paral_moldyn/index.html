



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paral_moldyn/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Moldyn - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#parallelism-for-molecular-dynamics" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  Parallelism
                </span>
              
            
            Moldyn
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9" checked>
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Moldyn
      </label>
    
    <a href="./" title="Moldyn" class="md-nav__link md-nav__link--active">
      Moldyn
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-perform-molecular-dynamics-calculations-using-parallelism" title="How to perform Molecular Dynamics calculations using parallelism" class="md-nav__link">
    How to perform Molecular Dynamics calculations using parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-the-molecular-dynamics-method" title="1 Summary of the molecular dynamics method" class="md-nav__link">
    1 Summary of the molecular dynamics method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-performing-molecular-dynamics-with-abinit" title="2 Performing molecular dynamics with ABINIT" class="md-nav__link">
    2 Performing molecular dynamics with ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-convergence-on-k-points-and-supercell-size" title="3 The convergence on K-points and supercell size" class="md-nav__link">
    3 The convergence on K-points and supercell size
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-compute-the-melting-temperature-of-al-at-a-given-pressure" title="4 Compute the melting temperature of Al at a given pressure" class="md-nav__link">
    4 Compute the melting temperature of Al at a given pressure
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-perform-molecular-dynamics-calculations-using-parallelism" title="How to perform Molecular Dynamics calculations using parallelism" class="md-nav__link">
    How to perform Molecular Dynamics calculations using parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-summary-of-the-molecular-dynamics-method" title="1 Summary of the molecular dynamics method" class="md-nav__link">
    1 Summary of the molecular dynamics method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-performing-molecular-dynamics-with-abinit" title="2 Performing molecular dynamics with ABINIT" class="md-nav__link">
    2 Performing molecular dynamics with ABINIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-convergence-on-k-points-and-supercell-size" title="3 The convergence on K-points and supercell size" class="md-nav__link">
    3 The convergence on K-points and supercell size
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-compute-the-melting-temperature-of-al-at-a-given-pressure" title="4 Compute the melting temperature of Al at a given pressure" class="md-nav__link">
    4 Compute the melting temperature of Al at a given pressure
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paral_moldyn.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="parallelism-for-molecular-dynamics">Parallelism for molecular dynamics<a class="headerlink" href="#parallelism-for-molecular-dynamics" title="Permanent link">&para;</a></h1>
<h2 id="how-to-perform-molecular-dynamics-calculations-using-parallelism">How to perform Molecular Dynamics calculations using parallelism<a class="headerlink" href="#how-to-perform-molecular-dynamics-calculations-using-parallelism" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to perform molecular dynamics with ABINIT
using a parallel computer.
You will learn how to launch molecular dynamics calculation and what are the
main input variables that govern convergence and numerical efficiency.  </p>
<p>You are supposed to know already some basics of parallelism in ABINIT,
explained in the tutorial 
<a href="../basepar">A first introduction to ABINIT in parallel</a>, and 
<a href="../paral_gspw">ground state with plane waves</a>.</p>
<p>This lesson should take about 1.5 hour to be done and requires to have at
least a 200 CPU core parallel computer.</p>
<h2 id="1-summary-of-the-molecular-dynamics-method">1 Summary of the molecular dynamics method<a class="headerlink" href="#1-summary-of-the-molecular-dynamics-method" title="Permanent link">&para;</a></h2>
<p>The basic idea underlying Ab Initio Molecular Dynamics (AIMD) is to compute
the forces acting on the nuclei from electronic structure calculations that
are performed as the molecular dynamics trajectory is generated. </p>
<p>An AIMD calculation assumes only that the system is composed of nuclei and
electrons, that the Born -Oppenheimer approximation is valid, and that the
dynamics of the nuclei can be treated classically on the ground-state
electronic surface. It allows both equilibrium thermodynamic and dynamical
properties of a system at finite temperature to be computed. For example
melting temperatures, phase transitions, atomic vibrations, structure
factor&hellip; but also XANES or IR spectrum can be obtained with this technique.</p>
<p>AIMD deals with supercells of hundred to thousand of atoms (usually, the
larger, the better!). In addition Molecular Dynamics simulations can be
performed for days, weeks or even months! They are therefore very time
consuming and can not be done without the help of high speed and massively
parallel computing.</p>
<p>In the following, when &ldquo;run ABINIT over nn CPU cores&rdquo; appears, you have to use
a specific command line according to the operating system and architecture of
the computer you are using. This can be for instance: mpirun -n nn abinit &lt;
abinit.files or the use of a specific submission file.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before continuing, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_paral_moldyn&rdquo;? 
In what follows, the name of files are mentioned as if you were in this subdirectory.<br />
All the input files can be found in the ~abinit/tests/tutoparal/Input directory.</p>
<p>You can compare your results with several reference output files located in
~abinit/tests/tutorial/Refs and __~abinit/tests/tutorial/Refs/ directories
(for the present tutorial they are named tmoldyn_*.out).</p>
</div>
<h2 id="2-performing-molecular-dynamics-with-abinit">2 Performing molecular dynamics with ABINIT<a class="headerlink" href="#2-performing-molecular-dynamics-with-abinit" title="Permanent link">&para;</a></h2>
<p>There are different algorithms to do molecular dynamics. See the input
variable <a class="wikilink codevar-wikilink" href="../../variables/rlx#ionmov">ionmov</a>, with values 1, 6, 7, 8, 9, 12, 13 and 14. <a class="wikilink codevar-wikilink" href="../../variables/rlx#dtion">dtion</a>
controls the ion time steps in atomic units of time (one atomic time unit is
2.418884e-17 seconds, which is the value of Planck&rsquo;s constant in hartree*sec).
The default value is 100. You should try several values for <a class="wikilink codevar-wikilink" href="../../variables/rlx#dtion">dtion</a> in order
to establish the stable and efficient choice. For example this value should
decrease at high pressure.  </p>
<p>Except for the isothermal/isenthalpic (<a class="wikilink codevar-wikilink" href="../../variables/rlx#ionmov">ionmov</a> 13) ensemble the input
variable <a class="wikilink codevar-wikilink" href="../../variables/rlx#optcell">optcell</a> must be set to 0.<br />
You have also to define the maximal number of timesteps of the molecular dynamics.  </p>
<p>Usually you can set the input variable <a class="wikilink codevar-wikilink" href="../../variables/rlx#ntime">ntime</a> to a large value, 5000, since
there is no &ldquo;end&rdquo; to a molecular dynamics simulation. You can always stop or
restart the calculation at your convenience by using the input variable <a class="wikilink codevar-wikilink" href="../../variables/rlx#restartxf">restartxf</a>.</p>
<p>The input file tmoldyn_01.in is an example of a file that contains data for a
molecular dynamics simulation using the isokinetic ensemble for aluminum. </p>
<div class="text-center"><button type="button" id="uuid-ed0c98fd-24d1-4bdc-94c7-bf811165db88" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tmoldyn_01.in
</button></div>

<div id="uuid-c3ae3528-d154-4970-a27d-d980ba9e1a41" class="my_dialog" title="tests/tutoparal/Input/tmoldyn_01.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#parallelization</span>
paral_kgb <span class="m">1</span>
npband <span class="m">10</span>
npfft <span class="m">3</span>
npkpt <span class="m">1</span>
bandpp <span class="m">2</span>

prtden <span class="m">0</span> prtwf <span class="m">0</span> prteig <span class="m">0</span>
ecut <span class="m">3</span>.

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.d-3 nstep <span class="m">50</span>

<span class="c1">#K-points and sym</span>
occopt <span class="m">3</span>
kptopt <span class="m">0</span> nkpt <span class="m">1</span>
nsym <span class="m">1</span>

<span class="c1">#Molecular Dynamics parameters</span>
ionmov <span class="m">12</span> ntime <span class="m">50</span>
dtion <span class="m">100</span>
mdtemp <span class="m">3000</span> <span class="m">3000</span>
tsmear <span class="m">0</span>.009500446

<span class="c1">#Cell and atoms definition</span>
acell <span class="m">3</span>*12.81
rprim <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
natom <span class="m">32</span> ntypat <span class="m">1</span> typat <span class="m">32</span>*1 znucl <span class="m">13</span>.0
nband <span class="m">80</span> 
  xred
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tmoldyn_01.out, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% psp_files = 13al.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% nprocs_to_test = 30</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = </span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-c3ae3528-d154-4970-a27d-d980ba9e1a41", "#uuid-ed0c98fd-24d1-4bdc-94c7-bf811165db88") }); </script>

<p>Open the tmoldyn_01.in file and look at it carefully. The unit cell is defined at
the end. It is a 2x2x2 fcc supercell containing 32 atoms of Al. <a class="wikilink codevar-wikilink" href="../../variables/rlx#ionmov">ionmov</a> is
set to 12 for the isokinetic ensemble, and since <a class="wikilink codevar-wikilink" href="../../variables/rlx#ntime">ntime</a> is set to 50,
ABINIT will carry on 50 time steps of molecular dynamics. The calculation will
be performed for a temperature of 3000 K, see the key variable <a class="wikilink codevar-wikilink" href="../../variables/rlx#mdtemp">mdtemp</a>. It
gives the initial and final temperature in Kelvin of the simulation. The
temperature will change linearly from the initial temperature <strong>mdtemp(1)</strong> at
itime=1 to the final temperature <strong>mdtemp(2)</strong> at the end of the <a class="wikilink codevar-wikilink" href="../../variables/rlx#ntime">ntime</a>
timesteps. Here the temperature will stay constant during the whole simulation.  </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that we use the same temperature for the ions and the electrons:
<a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a> has been set to 3 for a Fermi-Dirac smearing and <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a> has
been set to 3000 Kelvin. Nothing prevent you to use different electronic and
ionic temperature, you just have to know why you are doing so!</p>
</div>
<p>Molecular dynamics simulations are always large calculations, dealing with
supercells of hundreds to thousands of atoms. Therefore they are always
performed in parallel. In tmoldyn_01.in, <a class="wikilink codevar-wikilink" href="../../variables/paral#paral_kgb">paral_kgb</a> has been set to 1 to
activate the parallelisation over K-points, G-vectors and bands. The three
following keywords give the number of processors for each level of
parallelisation. Since we have only one K-point in the simulation (the gamma
point), <a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a> has been set to 1. <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> is set to 3 and <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> to
10, for a total number of 3x10=30 processors. You might use the tmoldyn.files
file. Edit it and adapt it with the appropriate file names.</p>
<p>Then run the calculation in parallel over 30 CPU cores. You can change the
distribution of processors over the level of parallelisation to try to find
the most efficient one. Set for example <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>  to 1 and <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> to 40.
You can make other choices and compare the individual cpu time. Since
molecular dynamics can last for weeks, it is crucial to find the appropriate
distribution to reduce the computational time at the maximum. Look at the
output file. For each iteration you will see the coordinates, the forces, the
velocities and the kinetic and the total energy.</p>
<p>In addition, ABINIT should have generated a HIST.nc file, which contains the
whole history of the molecular dynamics simulation: atomic positions,
velocities, primitive translations, stress tensor, energies&hellip; at each time
step. This file will be used to restart the calculation if you want to perform
more time steps or to extract the necessary informations to make use of the
molecular dynamics simulation. In tmoldyn_01.in add the keyword <a class="wikilink codevar-wikilink" href="../../variables/rlx#restartxf">restartxf</a>
and set it to -1. Run the calculation again, in the same directory. Look at
the new output file. The number of each time step are indicated over the total
number of steps:</p>
<div class="codehilite"><pre><span></span>Iteration: (  1/100) Internal Cycle: (1/1)
</pre></div>


<p>Since we already performed 50 steps of molecular dynamics, the total number of
time steps are now 100. So the first 50 iterations are from the previous
calculation. You can check that by comparing tmoldyn_01.out and
tmoldyn_01.outA. There is only one HIST.nc file and it contains the history of
the two calculations.</p>
<p>Now we can calculate and plot several quantities. 
We need for that the diag_moldyn.py python script. 
You can find it in the <em>~abinit/doc/tutorial/documents/lesson_paral_moldyn</em> 
directory (link <a href="../paral_moldyn_assets/diag_moldyn.py">here</a>).<br />
Run the script as:</p>
<div class="codehilite"><pre><span></span>python diag_moldyn.py
</pre></div>


<p>You can read (on standard output) the average value and the standard deviation
of the total energy, the temperature and the pressure. You have also generated
several files which contain pressures, energies, stresses, positions and
temperatures. You can plot this files to observe the behavior of the
quantities during the molecular dynamics. Note that 100 time steps is far from
being sufficient to equilibrate physical quantities as pressure. 2000 or 3000
are more common numbers to reach this goal but it would exceed the time
allocated for this tutorial.</p>
<h2 id="3-the-convergence-on-k-points-and-supercell-size">3 The convergence on K-points and supercell size<a class="headerlink" href="#3-the-convergence-on-k-points-and-supercell-size" title="Permanent link">&para;</a></h2>
<p>In the previous section you have learned to perform molecular dynamics with
abinit. We used a fcc supercell of 32 atoms with only one K-point. In this
section we will make convergence studies with respect to these parameters.</p>
<p><strong>3.a</strong> <strong>Computing the convergence in K-points</strong></p>
<p>The files tmoldyn_02.in and tmoldyn_03.in are input files for 2x2x2 and 3x3x3
K-points grid respectively, or 4 and 14 K-points in the irreducible Brillouin zone. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-18c94320-23c3-4a03-9556-11f725886504" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tmoldyn_02.in
</button>
<button type="button" id="uuid-cf7fc3f3-2163-4a2b-9358-17adf6cc8d84" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tmoldyn_03.in
</button>
</div></div>

<div id="uuid-caf8842c-159a-4c43-b304-f74e2c2220ff" class="my_dialog" title="tests/tutoparal/Input/tmoldyn_02.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#parallelization</span>
paral_kgb <span class="m">1</span>
npband <span class="m">10</span>
npfft <span class="m">3</span>
npkpt <span class="m">4</span>
bandpp <span class="m">2</span>

prtden <span class="m">0</span> prtwf <span class="m">0</span> prteig <span class="m">0</span>
ecut <span class="m">3</span>.

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.d-3 nstep <span class="m">50</span>

<span class="c1">#K-points and sym</span>
occopt <span class="m">3</span>
kptopt <span class="m">1</span> ngkpt <span class="m">2</span> <span class="m">2</span> <span class="m">2</span>
nsym <span class="m">1</span>

<span class="c1">#Molecular Dynamics parameters</span>
ionmov <span class="m">12</span> ntime <span class="m">100</span>
dtion <span class="m">100</span>
mdtemp <span class="m">3000</span> <span class="m">3000</span>
tsmear <span class="m">0</span>.009500446

<span class="c1">#Cell and atoms definition</span>
acell <span class="m">3</span>*12.81
rprim <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
natom <span class="m">32</span> ntypat <span class="m">1</span> typat <span class="m">32</span>*1 znucl <span class="m">13</span>.0
nband <span class="m">80</span> 
  xred
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tmoldyn_02.out, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% psp_files = 13al.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% nprocs_to_test = 120</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = </span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-caf8842c-159a-4c43-b304-f74e2c2220ff", "#uuid-18c94320-23c3-4a03-9556-11f725886504") }); </script>

<div id="uuid-8d16b995-2e82-401f-8c1b-d892510e44a8" class="my_dialog" title="tests/tutoparal/Input/tmoldyn_03.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#parallelization</span>
paral_kgb <span class="m">1</span>
npband <span class="m">5</span>
npfft <span class="m">2</span>
npkpt <span class="m">14</span>
bandpp <span class="m">2</span>

prtden <span class="m">0</span> prtwf <span class="m">0</span> prteig <span class="m">0</span>
ecut <span class="m">3</span>.

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.d-3 nstep <span class="m">50</span>

<span class="c1">#K-points and sym</span>
occopt <span class="m">3</span>
kptopt <span class="m">1</span> ngkpt <span class="m">3</span> <span class="m">3</span> <span class="m">3</span>
istwfk <span class="m">14</span>*1
nsym <span class="m">1</span>

<span class="c1">#Molecular Dynamics parameters</span>
ionmov <span class="m">12</span> ntime <span class="m">100</span>
dtion <span class="m">100</span>
mdtemp <span class="m">3000</span> <span class="m">3000</span>
tsmear <span class="m">0</span>.009500446

<span class="c1">#Cell and atoms definition</span>
acell <span class="m">3</span>*12.81
rprim <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
natom <span class="m">32</span> ntypat <span class="m">1</span> typat <span class="m">32</span>*1 znucl <span class="m">13</span>.0
nband <span class="m">80</span>
  xred
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tmoldyn_03.out, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% psp_files = 13al.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% nprocs_to_test = 140</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = </span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8d16b995-2e82-401f-8c1b-d892510e44a8", "#uuid-cf7fc3f3-2163-4a2b-9358-17adf6cc8d84") }); </script>

<p>Since the parallelisation is the most efficient over the k-point level
you should always put <a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a> to the largest possible value before increasing
<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> and <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>. We have followed this rule in the input files.
Change the name of the previous file PRESS to PRESS01 to save it. Run now
ABINIT in parallel over 120 CPU cores with tmoldyn_02.in  and over 140 CPU
cores with tmoldyn_03.in. At the end of each calculation use the
diag_moldyn.py script and save the results in PRESS02 and PRESS03. You can now
plot the pressures in term of the K-points grids and compare the average values:</p>
<p><img alt="Kpoints" src="../paral_moldyn_assets/Kpoints.png" />  </p>
<p>As said previously our simulations are too short to be completely convincing
but you can see that you need at least a 2x2x2 K-points grid for a 32 atoms
cell. If you have some time, increase ntime to 300 and run again ABINIT.</p>
<p><strong>3.b</strong> <strong>Computing the convergence in cell size</strong></p>
<p>We also have to check if our cell is sufficiently large to give reliable
physical quantities. In the previous section we used a 2x2x2 fcc supercell.
tmoldyn_04.in is an input file for a 3x3x3 fcc supercell and therefore
contains 108 atoms. <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a> has been scaled accordingly to
take into account the new size of the cell. </p>
<p>Run now ABINIT in parallel over 45 CPU cores and then diag_moldyn.py 
(note that the output file is very big, and no reference has been provided for comparison). 
Save the pressure to PRESS04.
tmoldyn_05.in has the same cell but a 2x2x2 K-points grid (note that the
output file is very big, and no reference has been provided for comparison).
Run it over the adequate number of cores and save the pressure to PRESS05.
Plot now PRESS04 and PRESS05 and compare the average values. You&rsquo;ll see that
for this size of cell, the gamma point is sufficient.</p>
<p>We are now going to increase again the cell size. With a 4x4x4 fcc cell, the
file tmoldyn_06.in has 256 atoms. Of course, <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a> has been
scaled. This calculation should last for 30 min over 60 CPU cores (note that
the output file is very big, and no reference has been provided for
comparison). Run it and save the pressure to PRESS06. Plot now PRESS02,
PRESS04 and PRESS06, remove the first steps and compare the pressure average values:</p>
<p><img alt="cells" src="../paral_moldyn_assets/cell.png" />  </p>
<p>You can see that even if the pressure was converge in term of K-points, the 32
atoms supercell was not sufficient to give a reliable pressure. A 3x3x3
supercell with the gamma point seems to be the adequate size. You see also
that with a bigger cell, the pressure fluctuations are considerably reduced.  </p>
<p>Note that here we made the convergence studies using the pressure as a
criteria. The results can depend on the physical quantity you are looking at,
pressure, temperature, energy, or dynamical matrices by observing the
displacement fluctuations.... Always check if your cell is large enough and
give the corresponding uncertainty.<br />
Also, to reduce the time necessary to do this tutorial we set the value of
ecut to 3Ha. This is too small, for Al, it should be closer to 8 Ha.</p>
<h2 id="4-compute-the-melting-temperature-of-al-at-a-given-pressure">4 Compute the melting temperature of Al at a given pressure<a class="headerlink" href="#4-compute-the-melting-temperature-of-al-at-a-given-pressure" title="Permanent link">&para;</a></h2>
<p>As an example of what can be done in molecular dynamics, we are going to
calculate the melting temperature of aluminum using the so-called Heat Until
it Melts (HUM) method. In this method the solid phase is heated gradually
until melting occurs. Let us start with a temperature of 5500K.<br />
An example of file is given with tmoldyn_07.in. To work fast, we use a 32
atoms supercell and the gamma point (note that the output file is very big,
and no reference has been provided for comparison).  </p>
<div class="text-center"><button type="button" id="uuid-976efae1-18df-4c84-9638-81a8aa5c9f05" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tmoldyn_07.in
</button></div>

<div id="uuid-4aa9e181-c9cf-4710-8c3b-3062629431d7" class="my_dialog" title="tests/tutoparal/Input/tmoldyn_07.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#parallelization</span>
paral_kgb <span class="m">1</span>
npband <span class="m">10</span>
npfft <span class="m">3</span>
npkpt <span class="m">1</span>
bandpp <span class="m">2</span>

prtden <span class="m">0</span> prtwf <span class="m">0</span> prteig <span class="m">0</span>
ecut <span class="m">3</span>.

<span class="c1">#SCF cycle parameters</span>
tolvrs <span class="m">1</span>.d-3 nstep <span class="m">50</span>

<span class="c1">#K-points and sym</span>
occopt <span class="m">3</span>
kptopt <span class="m">0</span> nkpt <span class="m">1</span>
nsym <span class="m">1</span>

<span class="c1">#Molecular Dynamics parameters</span>
ionmov <span class="m">12</span> ntime <span class="m">300</span>
dtion <span class="m">100</span>
mdtemp <span class="m">6500</span> <span class="m">6500</span>
tsmear <span class="m">6500</span>. K

<span class="c1">#Cell and atoms definition</span>
acell <span class="m">3</span>*12.81
rprim <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
<span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
natom <span class="m">32</span> ntypat <span class="m">1</span> typat <span class="m">32</span>*1 znucl <span class="m">13</span>.0
nband <span class="m">80</span>
  xred
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.25000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.00000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.50000000E+00
  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00  <span class="m">0</span>.75000000E+00
  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.75000000E+00  <span class="m">0</span>.50000000E+00

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% psp_files = 13al.pspnc</span>
<span class="c1">#%% [NCPU_30]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tmoldyn_07.out, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% nprocs_to_test = 30</span>
<span class="c1">#%% max_nprocs = 30</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = </span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-4aa9e181-c9cf-4710-8c3b-3062629431d7", "#uuid-976efae1-18df-4c84-9638-81a8aa5c9f05") }); </script>

<p>Run ABINIT in parallel over 30 CPU cores and then diag_moldyn.py.<br />
Save the pressure to PRESS71. Plot the atomic positions, you see that at this
temperature, the cell is solid. Increase the temperature to 6000K (do not
forget to also change the electronic temperature with tsmear) and run ABINIT.
Save the pressure and again, look at the positions. The cell is still solid.<br />
Set the temperature to 6500K. Look at the positions: the ions are moving
across the cell and do not come back to their equilibrium positions. The cell
has melted and is now liquid. Plot the pressures for the three simulations:  </p>
<p><img alt="melting" src="../paral_moldyn_assets/melting.png" />  </p>
<p><img alt="xcart" src="../paral_moldyn_assets/xcart.png" />  </p>
<p>You can clearly observe a discontinuous change in pressure due to the volume
difference between the solid and liquid phases. This give a melting
temperature of 6250 K at 149 GPa. With more sophisticated techniques the
melting temperature at this pressure is around 5500 K. Indeed, in addition to
the crude parameters we used (ecut, natom&hellip;), the HUM method has some
intrinsic drawbacks. In HUM the crystal is heated homogeneously, the melting
initiates in the bulk and this results in an overheating effect.  </p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../paral_mbt/" title="Many-Body" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Many-Body
              </span>
            </div>
          </a>
        
        
          <a href="../analysis_tools/" title="Analysis tools" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Analysis tools
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (JB)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>