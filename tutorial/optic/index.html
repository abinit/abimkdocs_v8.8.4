



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/optic/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Optic - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#lesson-on-optical-properties" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
            
            Optic
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Optic
      </label>
    
    <a href="./" title="Optic" class="md-nav__link md-nav__link--active">
      Optic
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequency-dependent-linear-and-second-order-nonlinear-optical-response" title="Frequency-dependent linear and second order nonlinear optical response." class="md-nav__link">
    Frequency-dependent linear and second order nonlinear optical response.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-computing-the-momentum-matrix-elements" title="1 Computing the momentum matrix elements" class="md-nav__link">
    1 Computing the momentum matrix elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computing-the-linear-and-nonlinear-optical-response" title="2 Computing the linear and nonlinear optical response" class="md-nav__link">
    2 Computing the linear and nonlinear optical response
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-faster-computation-of-the-imaginary-part-of-the-linear-optical-response" title="3 Faster computation of the imaginary part of the linear optical response" class="md-nav__link">
    3 Faster computation of the imaginary part of the linear optical response
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequency-dependent-linear-and-second-order-nonlinear-optical-response" title="Frequency-dependent linear and second order nonlinear optical response." class="md-nav__link">
    Frequency-dependent linear and second order nonlinear optical response.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-computing-the-momentum-matrix-elements" title="1 Computing the momentum matrix elements" class="md-nav__link">
    1 Computing the momentum matrix elements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-computing-the-linear-and-nonlinear-optical-response" title="2 Computing the linear and nonlinear optical response" class="md-nav__link">
    2 Computing the linear and nonlinear optical response
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-faster-computation-of-the-imaginary-part-of-the-linear-optical-response" title="3 Faster computation of the imaginary part of the linear optical response" class="md-nav__link">
    3 Faster computation of the imaginary part of the linear optical response
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/optic.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="lesson-on-optical-properties">Lesson on optical properties<a class="headerlink" href="#lesson-on-optical-properties" title="Permanent link">&para;</a></h1>
<h2 id="frequency-dependent-linear-and-second-order-nonlinear-optical-response">Frequency-dependent linear and second order nonlinear optical response.<a class="headerlink" href="#frequency-dependent-linear-and-second-order-nonlinear-optical-response" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to get the following physical properties, for semiconductors:</p>
<ul>
<li>Frequency dependent linear dielectric tensor </li>
<li>Frequency dependent second order nonlinear susceptibility tensor </li>
</ul>
<p>in the simple &ldquo;Random-Phase Approximation&rdquo; or &ldquo;Sum-over-states&rdquo; approach. 
This tutorial will help you to discover the <a class="wikilink user-guide-wikilink" href="../../guide/optic">optic help file</a>.</p>
<p>This lesson should take about 1 hour.</p>
<h2 id="1-computing-the-momentum-matrix-elements">1 Computing the momentum matrix elements<a class="headerlink" href="#1-computing-the-momentum-matrix-elements" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not create &ldquo;Work_optic&rdquo; in ~abinit/tests/tutorespfn/Input?</em></p>
<p>In order to use the Optic utility, you should first have some theoretical background. 
Could you read the first two sections of the <a class="wikilink user-guide-wikilink" href="../../guide/optic">optic help file</a>?</p>
<p>Now, you are ready to run ABINIT and prepare the needed file.</p>
<p>Copy the files ~abinit/tests/tutorespfn/Input/toptic_1.files and
~abinit/tests/tutorespfn/Input/toptic_1.in in &ldquo;Work_optic&rdquo;. 
Issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; toptic_1.files &gt;&amp; log
</pre></div>


<p>We now examine the files. </p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-22e988df-6d38-4c0e-8307-6b9c12156426" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/toptic_1.files
</button>
<button type="button" id="uuid-cc5eda47-8538-417b-a59e-03d33286af0a" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/toptic_1.in
</button>
</div></div>

<div id="uuid-33c31902-f4dd-489c-8811-944c484eb03b" class="my_dialog" title="tests/tutorespfn/Input/toptic_1.files" hidden><div><pre class="small-text">
toptic_1.in
toptic_1.out
toptic_1i
toptic_1o
toptic_1
../../../Psps_for_tests/31ga.pspnc
../../../Psps_for_tests/33as.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-33c31902-f4dd-489c-8811-944c484eb03b", "#uuid-22e988df-6d38-4c0e-8307-6b9c12156426") }); </script>

<div id="uuid-708626d6-b892-441b-93d2-6e3c4de2deae" class="my_dialog" title="tests/tutorespfn/Input/toptic_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Prepare the computation of linear and non-linear optic properties</span>
<span class="c1"># of GaAs crystal : ground-state with few bands,</span>
<span class="c1"># then non-SCF with a larger number of bands, then ddk for different directions</span>
<span class="c1"># Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low.</span>

 ndtset <span class="m">6</span>

<span class="c1">#First dataset : SC run with kpoints in the IBZ</span>
  nband1  <span class="m">4</span>     
  nstep1 <span class="m">25</span>   
 kptopt1 <span class="m">1</span>
 nbdbuf1 <span class="m">0</span>
 prtden1 <span class="m">1</span>   getden1 <span class="m">0</span>   getwfk1 <span class="m">0</span>    <span class="c1"># Usual file handling data</span>

<span class="c1">#Second dataset : NSC run with large number of bands, and points in the IBZ</span>
    iscf2 -2  
   nband2 <span class="m">20</span>  <span class="c1"># This number of bands might be too low for non-linear optics and real part of linear optics</span>
   nstep2 <span class="m">25</span>
  kptopt2  <span class="m">1</span>
  getwfk2  <span class="m">1</span>   getden2 <span class="m">1</span>   <span class="c1"># Usual file handling data</span>

<span class="c1">#Third dataset : NSC run with large number of bands, and points in the the full BZ</span>
    iscf3 -2  
   nband3 <span class="m">20</span>  <span class="c1"># This number of bands might be too low for non-linear optics and real part of linear optics </span>
   nstep3 <span class="m">25</span>
  kptopt3  <span class="m">3</span>
  getwfk3  <span class="m">2</span>   getden3 <span class="m">1</span>   <span class="c1"># Usual file handling data</span>


<span class="c1">#Fourth dataset : ddk response function along axis 1</span>
   iscf4 -3
  nband4 <span class="m">20</span>   <span class="c1"># This number of bands might be too low for non-linear optics and real part of linear optics</span>
  nstep4  <span class="m">1</span>  nline4  <span class="m">0</span>  prtwf4  <span class="m">3</span>
 kptopt4  <span class="m">3</span>

   nqpt4  <span class="m">1</span>  qpt4  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 
  rfdir4  <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 rfelfd4  <span class="m">2</span>
 getwfk4  <span class="m">3</span>

<span class="c1">#Fifth dataset : ddk response function along axis 2</span>
   iscf5 -3
  nband5 <span class="m">20</span>   <span class="c1"># This number of bands might be too low for non-linear optics and real part of linear optics</span>
  nstep5  <span class="m">1</span>  nline5  <span class="m">0</span>   prtwf5  <span class="m">3</span>
 kptopt5  <span class="m">3</span>

   nqpt5  <span class="m">1</span>  qpt5  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0
  rfdir5  <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
 rfelfd5  <span class="m">2</span>
 getwfk5  <span class="m">3</span>

<span class="c1">#Sixth dataset : ddk response function along axis 3</span>
   iscf6 -3
  nband6 <span class="m">20</span>   <span class="c1"># This number of bands might be too low for non-linear optics and real part of linear optics</span>
  nstep6  <span class="m">1</span>  nline6  <span class="m">0</span>    prtwf6  <span class="m">3</span>
 kptopt6  <span class="m">3</span>

   nqpt6  <span class="m">1</span>  qpt6  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0
  rfdir6  <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
 rfelfd6  <span class="m">2</span>
 getwfk6  <span class="m">3</span>


<span class="c1">#Data common to all datasets</span>
 nshiftk <span class="m">4</span>
 shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
         <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
 ngkpt  <span class="m">4</span>  <span class="m">4</span>  <span class="m">4</span>        <span class="c1"># This is much too low : should be at least 24x24x24</span>

 acell   <span class="m">3</span>*10.60
 amu <span class="m">69</span>.72  <span class="m">74</span>.9216
 diemac <span class="m">10</span>.0
 ecut <span class="m">2</span>.00             <span class="c1"># This is also too low</span>
 ixc <span class="m">3</span>
 natom  <span class="m">2</span>  nbdbuf <span class="m">2</span>
 ntypat  <span class="m">2</span>
 rprim   <span class="m">0</span> .5 .5  .5 <span class="m">0</span> .5  .5 .5 <span class="m">0</span>
 xred <span class="m">3</span>*0.00d0 <span class="m">3</span>*0.25d0
 tnons <span class="m">72</span>*0.0
 typat  <span class="m">1</span> <span class="m">2</span>  tolwfr  <span class="m">1</span>.e-20
 znucl  <span class="m">31</span> <span class="m">33</span>


<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = toptic_1.in, toptic_2.in</span>
<span class="c1">#%% need_cpp_vars = !HAVE_MPI_IO_DEFAULT</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   toptic_1.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  31ga.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Sharma, X. Gonze</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Prepare the computation of linear and non-linear optic properties</span>
<span class="c1">#%%  of GaAs crystal : ground-state with few bands,</span>
<span class="c1">#%%  then non-SCF with a larger number of bands, then ddk for different directions</span>
<span class="c1">#%%  Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-708626d6-b892-441b-93d2-6e3c4de2deae", "#uuid-cc5eda47-8538-417b-a59e-03d33286af0a") }); </script>

<p>The computation concerns a crystal of GaAs, in the Zinc-blende structure (2 atoms per primitive cell).<br />
The <em>toptic_1.files</em> is a typical ABINIT &ldquo;files&rdquo; file (nothing special). 
By contrast, it is worth to take some time to examine the other file <em>toptic_1.in</em>. 
Edit it. It has six datasets. </p>
<p>The first dataset is a quite standard self-consistent
determination of the ground state for a fixed geometry. Only the occupied bands are treated. 
The density is printed.<br />
The second dataset is a non-self-consistent calculation, where the number of
bands has been increased to include unoccupied states. 
The k points are restricted to the Irreducible Brillouin Zone.<br />
The third dataset uses the result of the second one to produce the
wavefunctions for all the bands, for the full Brillouin Zone 
(this step might be skipped but is included for later CPU time saving).<br />
The fourth to sixth datasets correspond to the computation of the ddk matrix elements. 
Note that the number of bands is the same as for dataset 2 and 3.
Note also that these are non-self-consistent calculations, moreover,
restricted to <a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>=1 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>=0. 
Indeed, only the matrix elements between explicitly computed states are required. 
Using a larger nstep would lead to a full computation of derivative of the wavefunction with respect to
the wavevector, while only the matrix elements are needed. 
Such a larger value of nstep would not lead to erroneous matrix elements, but would be a waste of time.</p>
<p>In order to have a sufficiently fast tutorial, the k point sampling was chosen to be ridiculously small. 
Instead of 4x4x4 FCC (256 k points), it should be something like 28x28x28 FCC (about 100000 k points). 
Also, the cut-off energy (2 Ha) is too small. As often, convergence studies are the responsibility of the user.</p>
<p>The run is less than one minute on a 2.8 GHz PC. The files toptic_1o_DS3_WFK,
toptic_1o_DS4_1WF7, toptic_1o_DS5_1WF8 and toptic_1o_DS6_1WF9 are the four
files requested for the Optic run. 
The three latter ones contain the matrix elements.</p>
<p>Real preparation runs (with adequate k point sampling and cut-off energy) can
last several hours (days) on such a PC.</p>
<h2 id="2-computing-the-linear-and-nonlinear-optical-response">2 Computing the linear and nonlinear optical response<a class="headerlink" href="#2-computing-the-linear-and-nonlinear-optical-response" title="Permanent link">&para;</a></h2>
<p>Next step is to compute the linear and nonlinear optical response: once the
momentum matrix elements are available you are ready to determine the optical
response (up to second order in the current implementation) for material under study.</p>
<p>First, read the <a class="wikilink user-guide-wikilink" href="../../guide/optic#input">section 3</a> of the Optic help file.</p>
<p>Copy the files ~abinit/tests/tutorespfn/Input/toptic_2.files and
~abinit/tests/tutorespfn/Input/toptic_2.in in &ldquo;Work_optic&rdquo;.</p>
<p>The toptic_2.in is your input file. You should edit it, read it carefully. For
help on various input parameters in this file please see the help file.</p>
<div class="text-center"><button type="button" id="uuid-7e4f6798-286c-427a-b87a-d53e6d1414c0" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/toptic_2.in
</button></div>

<div id="uuid-2a7f79ea-86e7-4d5b-8fb2-29b8cc93e536" class="my_dialog" title="tests/tutorespfn/Input/toptic_2.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="p">&amp;</span>FILES
 <span class="nv">ddkfile_1</span> <span class="o">=</span> <span class="s1">&#39;toptic_1o_DS4_1WF7&#39;</span>,
 <span class="nv">ddkfile_2</span> <span class="o">=</span> <span class="s1">&#39;toptic_1o_DS5_1WF8&#39;</span>,
 <span class="nv">ddkfile_3</span> <span class="o">=</span> <span class="s1">&#39;toptic_1o_DS6_1WF9&#39;</span>,
 <span class="nv">wfkfile</span> <span class="o">=</span> <span class="s1">&#39;toptic_1o_DS3_WFK&#39;</span>
/
<span class="p">&amp;</span>PARAMETERS
 <span class="nv">broadening</span> <span class="o">=</span> <span class="m">0</span>.002,
 <span class="nv">domega</span> <span class="o">=</span> <span class="m">0</span>.0003,
 <span class="nv">maxomega</span> <span class="o">=</span> <span class="m">0</span>.3,
 <span class="nv">scissor</span> <span class="o">=</span> <span class="m">0</span>.000,
 <span class="nv">tolerance</span> <span class="o">=</span> <span class="m">0</span>.002
/
<span class="p">&amp;</span>COMPUTATIONS
 <span class="nv">num_lin_comp</span> <span class="o">=</span> <span class="m">1</span>,
 <span class="nv">lin_comp</span> <span class="o">=</span> <span class="m">11</span>,
 <span class="nv">num_nonlin_comp</span> <span class="o">=</span> <span class="m">2</span>,
 <span class="nv">nonlin_comp</span> <span class="o">=</span> <span class="m">123</span>,222,
 <span class="nv">num_linel_comp</span> <span class="o">=</span> <span class="m">0</span>,
 <span class="nv">num_nonlin2_comp</span> <span class="o">=</span> <span class="m">0</span>,
/

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = optic</span>
<span class="c1">#%% test_chain = toptic_1.in, toptic_2.in</span>
<span class="c1">#%% need_cpp_vars = !HAVE_MPI_IO_DEFAULT</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   toptic_2_0001_0001-linopt.out,        tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy;</span>
<span class="c1">#%%   toptic_2_0001_0002_0003-ChiTotRe.out, tolnlines= 16, tolabs=  7.000e-04, tolrel=  7.000e-04, fld_options = -easy;</span>
<span class="c1">#%%   toptic_2_0001_0002_0003-ChiTotIm.out, tolnlines= 16, tolabs=  4.000e-04, tolrel=  2.000e-04, fld_options = -easy</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Sharma, X. Gonze</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = Input file for optic code. </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-2a7f79ea-86e7-4d5b-8fb2-29b8cc93e536", "#uuid-7e4f6798-286c-427a-b87a-d53e6d1414c0") }); </script>

<p>When you have read the input file, you can run the code, as usual, using the
following command (assuming optic can be accessed thanks to &ldquo;optic&rdquo; - copy the
executable in the current directory if needed)</p>
<div class="codehilite"><pre><span></span>optic &lt; toptic_2.files &gt; log &amp;
</pre></div>


<p>It will take a few seconds to run. You have produced numerous output files.
Now, you can examine some of these output files. </p>
<p>The header contains the information about the calculation. 
See the <a class="wikilink user-guide-wikilink" href="../../guide/optic#output">section 4</a> of the Optic help file.
These files can be plotted in xmgrace, please do so using the following
command and look at the results. (If you do not have xmgrace installed on your
computer, please get it from the Web, and install it, or alternatively, use
your preferred plotting package).</p>
<p>We will first have a look at the linear optic file.</p>
<div class="codehilite"><pre><span></span>xmgrace toptic_2_0001_0001-linopt.out
</pre></div>


<p>On the graph, you should see three curves. One of them is positive, and always
larger than the two others. It is the modulus of the dielectric function.
Another one is also always positive, it is the imaginary part of the
dielectric function. The last one is the real part.<br />
There are a large number of peaks. This is at variance with the experimental
spectra, that are much smoother. The origin of this discrepancy is to be found
in the very bad k point sampling that we used in order to be able to perform
the tutorial. In the next section, we will improve this sampling, and start a convergence study.</p>
<p>Concerning the non-linear optics, the graphs for the xyz components are also
quite bad, with many isolated (but broadened) peaks. However, the yyy ones are
perfect &hellip; Indeed, they vanish due to symmetry reasons! 
Visualize the imaginary part with:</p>
<div class="codehilite"><pre><span></span>xmgrace toptic_2_0002_0002_0002-ChiTotIm.out
</pre></div>


<p>and the Real part with:</p>
<div class="codehilite"><pre><span></span>xmgrace toptic_2_0002_0002_0002-ChiTotRe.out
</pre></div>


<p>It might be the perfect time to finish with <a class="wikilink user-guide-wikilink" href="../../guide/optic#troubleshooting">section 5</a> of the optic help file.</p>
<p>For comparison, we have included in the tutorial, three files that have been
obtained with a much better k point sampling (still with a low cut-off energy
and a number of bands that should be larger). You can visualize them:</p>
<div class="codehilite"><pre><span></span>xmgrace ~abinit/doc/tutorial/lesson_optic/toptic_ref_0001_0001-linopt.out
</pre></div>


<p>for the linear optics, obtained with a 28x28x28 grid (keeping everything else fixed), and</p>
<div class="codehilite"><pre><span></span>xmgrace ~abinit/doc/tutorial/lesson_optic/toptic_ref_0001_0002_0003-ChiTotIm.out
</pre></div>


<p>as well as</p>
<div class="codehilite"><pre><span></span>xmgrace ~abinit/doc/tutorial/lesson_optic/toptic_ref_0001_0002_0003-ChiTotRe.out
</pre></div>


<p>for the non-linear optics, obtained with a 18x18x18 grid (keeping everything else fixed).</p>
<p>Concerning the linear spectrum, we will now compare this (underconverged)
result toptic_ref_0001_0001-linopt.out with experimental data and converged
theoretical results.  </p>
<p>The book by Cohen M.L. and Chelikowsky, &ldquo;Electronic Structure and Optical
Properties of Semiconductors&rdquo; (Springer-Verlag, Berlin, 1988) presents a
comparison of experimental data with the empirical pseudopotential method
spectrum. If you do not have acess to this book, you can see an experimental
spectrum in e.g. H.R. Phillips, H. Ehrenreich, Phys. Rev. 127, 1550 (1963),
and a theoretical spectrum in e.g. M.-Z. Huang and W. Y. Ching, Phys. Rev. B
47, 9449 (1993) (well, there are numerous papers that present such data).</p>
<p>We discuss first the imaginary spectrum. Prominent experimental features of
this spectrum are two peaks located close to 3 eV and 5 eV, both with the same
approximate height. The spectrum is zero below about 1.5 eV (the direct band
gap), and decreases with some wiggles beyond 5.5 eV. Converged theoretical
spectra also show two peaks at about the same location, although their heights
are markedly different: about 10 for the first one (at 3 eV), and 25 for the
second one (at 5 eV). Other features are rather similar to the experimental
ones. In the linear optic spectrum of toptic_ref_0001_0001-linopt.out, we note
that there is a shoulder at around 3 eV, and a peak at 4.2 eV, with respective
approximate heights of 7 and 25. Some comments are in order:</p>
<ul>
<li>
<p>The main different between experimental and converged theoretical spectra is due 
    to the presence of excitons (electron-hole bound states), not treated at all in 
    this rather elementary theoretical approach: excitons transfer some oscillator strength 
    from the second peak (at 5 eV) to the first one (at 3 eV). Going beyond the Sum-Over-State approach, 
    but still keeping the independent-electron approximation, e.g. in the framework of the TDDFT (adiabatic LDA) 
    will not correct this problem. One needs to use the Bethe-Salpeter approximation, or to rely on 
    <em>fancy</em> exchange-correlation kernels, to produce an optical spectrum in qualitative agreement with the experimental data. 
    Still, trends should be correct (e.g. change of the peak positions with pressure, 
    comparison between different semiconductors, etc). </p>
</li>
<li>
<p>In many early theoretical spectra (including the ones in the Cohen-Chelikowsky book), 
    the agreement between the theoretical and experimental band gap is artificially good. 
    In straight DFT, one cannot avoid the band gap problem. However, it is possible to 
    add an artificial &ldquo;scissor shift&rdquo;, to make the theoretical band gap match the experimental one. </p>
</li>
<li>
<p>Our theoretical spectrum present additional deficiencies with respect to the other ones, 
    mostly due to a still too rough sampling of the k space (there are too many wiggles in the spectrum), 
    and to an rather inaccurate band structure (the cut-off energy was really very low, so that 
    the first peak only appears as a shoulder to the second peak). </p>
</li>
</ul>
<p>The real part of the spectrum is related by the Kramers-Kronig relation to the imaginary part. 
We note that the deficiencies of the imaginary part of the
spectrum translate to the real part: the first peak is too low, and the
second peak too high, while the spectrum correctly changes sign around 5 eV,
and stays negative below 8 eV. </p>
<p>In our simulation, more states should be needed
to obtain a better behaviour. Also, the limiting low-frequency value is only
4.3, while it should be on the order of 10. This can be corrected by
increasing the cut-off energy, the k point sampling and the number of unoccupied states.</p>
<p>Similar considerations apply to the non-linear spectra.</p>
<h2 id="3-faster-computation-of-the-imaginary-part-of-the-linear-optical-response">3 Faster computation of the imaginary part of the linear optical response<a class="headerlink" href="#3-faster-computation-of-the-imaginary-part-of-the-linear-optical-response" title="Permanent link">&para;</a></h2>
<p>In the case of the imaginary part of the linear optical response, there are
several points that make the calculation easier:</p>
<ul>
<li>
<p>The time-reversal symmetry can be used to decrease the number of k points 
    by a factor of two (this is also true for the computation of the real spectrum); </p>
</li>
<li>
<p>The number of unoccupied bands can be reduced to the strict minimum needed 
    to span the target range of frequencies. </p>
</li>
</ul>
<p>We will focus on the energy range from 0 eV to 8 eV, for which only 5 unoccupied bands are needed.</p>
<p>Copy the files toptic_3.files and toptic_3.in in &ldquo;Work_optic&rdquo;:</p>
<div class="codehilite"><pre><span></span>cp ../toptic_3.files .
cp ../toptic_3.in .
</pre></div>


<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-4fa674c4-87b9-4a80-be02-161e08fe9c11" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/toptic_3.files
</button>
<button type="button" id="uuid-0321202d-b4b6-46e4-a067-c56b1a2a1dd4" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorespfn/Input/toptic_3.in
</button>
</div></div>

<div id="uuid-fc9f707a-544d-41f0-9fcc-929639ed03ed" class="my_dialog" title="tests/tutorespfn/Input/toptic_3.files" hidden><div><pre class="small-text">
toptic_3.in
toptic_3.out
toptic_3i
toptic_3o
toptic_3
../../../Psps_for_tests/31ga.pspnc
../../../Psps_for_tests/33as.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fc9f707a-544d-41f0-9fcc-929639ed03ed", "#uuid-4fa674c4-87b9-4a80-be02-161e08fe9c11") }); </script>

<div id="uuid-3fdaa4e1-7bc9-4b4f-897c-eb63b22579d4" class="my_dialog" title="tests/tutorespfn/Input/toptic_3.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Prepare the computation of linear optic properties (for the imaginary spectrum only)</span>
<span class="c1"># of GaAs crystal : ground-state with few bands,</span>
<span class="c1"># then non-SCF with a larger number of bands, then ddk for different directions</span>
<span class="c1"># Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low.</span>

 ndtset <span class="m">6</span>

<span class="c1">#First dataset : SC run with kpoints in the IBZ</span>
  nband1  <span class="m">4</span>     
  nstep1 <span class="m">25</span>   
 kptopt1 <span class="m">1</span>
 nbdbuf1 <span class="m">0</span>
 prtden1 <span class="m">1</span>   getden1 <span class="m">0</span>   getwfk1 <span class="m">0</span>    <span class="c1"># Usual file handling data</span>

<span class="c1">#Second dataset : NSC run with large number of bands, and points in the IBZ</span>
    iscf2 -2  
   nband2  <span class="m">9</span>  <span class="c1"># Minimal number of bands for linear optics (imaginary part of the spectrum)</span>
   nstep2 <span class="m">25</span>
  kptopt2  <span class="m">1</span>
  getwfk2  <span class="m">1</span>   getden2 <span class="m">1</span>   <span class="c1"># Usual file handling data</span>

<span class="c1">#Third dataset : NSC run with large number of bands, and points in the the full BZ</span>
    iscf3 -2  
   nband3  <span class="m">9</span>  <span class="c1"># Minimal number of bands for linear optics (imaginary part of the spectrum)</span>
   nstep3 <span class="m">25</span>
  kptopt3  <span class="m">2</span>  <span class="c1"># Time-reversal symmetry can be used in the present implementation for linear optics</span>
  getwfk3  <span class="m">2</span>   getden3 <span class="m">1</span>   <span class="c1"># Usual file handling data</span>


<span class="c1">#Fourth dataset : ddk response function along axis 1</span>
   iscf4 -3
  nband4  <span class="m">9</span>   <span class="c1"># Minimal number of bands for linear optics (imaginary part of the spectrum)</span>
  nstep4  <span class="m">1</span>  nline4  <span class="m">0</span>     prtwf4   <span class="m">3</span>
 kptopt4  <span class="m">2</span>   <span class="c1"># Time-reversal symmetry can be used in the present implementation for linear optics</span>

   nqpt4  <span class="m">1</span>  qpt4  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 
  rfdir4  <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>
 rfelfd4  <span class="m">2</span>
 getwfk4  <span class="m">3</span>

<span class="c1">#Fifth dataset : ddk response function along axis 2</span>
   iscf5 -3
  nband5  <span class="m">9</span>   <span class="c1"># Minimal number of bands for linear optics (imaginary part of the spectrum)</span>
  nstep5  <span class="m">1</span>  nline5  <span class="m">0</span>    prtwf5  <span class="m">3</span>
 kptopt5  <span class="m">2</span>   <span class="c1"># Time-reversal symmetry can be used in the present implementation for linear optics</span>

   nqpt5  <span class="m">1</span>  qpt5  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0
  rfdir5  <span class="m">0</span> <span class="m">1</span> <span class="m">0</span>
 rfelfd5  <span class="m">2</span>
 getwfk5  <span class="m">3</span>

<span class="c1">#Sixth dataset : ddk response function along axis 3</span>
   iscf6 -3
  nband6  <span class="m">9</span>   <span class="c1"># Minimal number of bands for linear optics (imaginary part of the spectrum)</span>
  nstep6  <span class="m">1</span>  nline6  <span class="m">0</span>    prtwf6  <span class="m">3</span>
 kptopt6  <span class="m">2</span>   <span class="c1"># Time-reversal symmetry can be used in the present implementation for linear optics</span>

   nqpt6  <span class="m">1</span>  qpt6  <span class="m">0</span>.0d0 <span class="m">0</span>.0d0 <span class="m">0</span>.0d0
  rfdir6  <span class="m">0</span> <span class="m">0</span> <span class="m">1</span>
 rfelfd6  <span class="m">2</span>
 getwfk6  <span class="m">3</span>


<span class="c1">#Data common to all datasets</span>
 nshiftk <span class="m">4</span>
 shiftk  <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>.5
         <span class="m">0</span>.5 <span class="m">0</span>.0 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.5 <span class="m">0</span>.0
         <span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.5
 ngkpt  <span class="m">3</span>*4        <span class="c1"># This is much too low : should be at least 24x24x24</span>

 acell   <span class="m">3</span>*10.60
 amu <span class="m">69</span>.72  <span class="m">74</span>.9216
 diemac <span class="m">10</span>.0
 ecut <span class="m">2</span>.00             <span class="c1"># This is also too low</span>
 ixc <span class="m">3</span>
 natom  <span class="m">2</span>  nbdbuf <span class="m">2</span>
 ntypat  <span class="m">2</span>
 rprim   <span class="m">0</span> .5 .5  .5 <span class="m">0</span> .5  .5 .5 <span class="m">0</span>
 xred <span class="m">3</span>*0.00d0 <span class="m">3</span>*0.25d0
 tnons <span class="m">72</span>*0.0
 typat  <span class="m">1</span> <span class="m">2</span>  tolwfr  <span class="m">1</span>.e-20
 znucl  <span class="m">31</span> <span class="m">33</span>

<span class="c1">## After modifying the following section, one might need to regenerate the pickle database with runtests.py -r</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = toptic_3.in, toptic_4.in</span>
<span class="c1">#%% need_cpp_vars = !HAVE_MPI_IO_DEFAULT</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   toptic_3.out, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -easy</span>
<span class="c1">#%% psp_files =  31ga.pspnc, 33as.pspnc</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = S. Sharma, X. Gonze</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  Prepare the computation of linear optic properties (for the imaginary spectrum only)</span>
<span class="c1">#%%  of GaAs crystal : ground-state with few bands,</span>
<span class="c1">#%%  then non-SCF with a larger number of bands, then ddk for different directions</span>
<span class="c1">#%%  Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-3fdaa4e1-7bc9-4b4f-897c-eb63b22579d4", "#uuid-0321202d-b4b6-46e4-a067-c56b1a2a1dd4") }); </script>

<p>Issue:</p>
<div class="codehilite"><pre><span></span>abinit &lt; toptic_3.files &gt;&amp; log
</pre></div>


<p>Now, examine the file toptic_3.in . There are two important changes with respect to the file toptic_1.in:</p>
<ul>
<li>the number of unoccupied bands has been reduced, so that the total number of bands is 9 instead of 20 </li>
<li>when applicable, the value of <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a> 3 in our previous simulation has been changed to 2, 
    in order to take advantage of the time-reversal symmetry</li>
</ul>
<p>When the run is finished (it is only 8 secs on a 2.8 GHz PC), you can process
the WFK files and obtain the linear optic spectra. 
Copy the files toptic_4.files and toptic_4.in in &ldquo;Work_optic&rdquo;:</p>
<div class="codehilite"><pre><span></span>cp ../toptic_4.files .
cp ../toptic_4.in .
</pre></div>


<p>Examine the toptic_4.in file: only the linear optic spectra will be build.</p>
<p>When you have read the input file, you can run the code, as usual using the following command</p>
<div class="codehilite"><pre><span></span>optic &lt; toptic_4.files &gt; log &amp;
</pre></div>


<p>Then, you can vizualize the files toptic_2_0001_0001-linopt.out and
toptic_4_0001_0001-linopt.out using xmgrace and compare them. The spectra
looks completely identical. However, a careful look at these files, by editing
them, show that indeed, the imaginary part is very similar:</p>
<div class="codehilite"><pre><span></span> # Energy(eV)         Im(eps(w))
 #calculated the component:  1  1  of dielectric function
 #broadening:    0.000000E+00    2.000000E-03
 #scissors shift:    0.000000E+00
 #energy window:    3.982501E+01eV    1.463542E+00Ha
    8.163415E-03    7.204722E-04
    1.632683E-02    1.441005E-03
    2.449025E-02    2.161659E-03
    3.265366E-02    2.882494E-03
 ....
</pre></div>


<p>But the real part slightly differ (this is seen at lines 1007 and beyond):</p>
<div class="codehilite"><pre><span></span> # Energy(eV)         Re(eps(w))
    8.163415E-03    1.186677E+01
    1.632683E-02    1.186693E+01
    2.449025E-02    1.186720E+01
    3.265366E-02    1.186758E+01
  ...
</pre></div>


<p>for toptic_2_0001_0001-linopt.out and</p>
<div class="codehilite"><pre><span></span> # Energy(eV)         Re(eps(w))
    8.163415E-03    1.177773E+01
    1.632683E-02    1.177789E+01
    2.449025E-02    1.177816E+01
    3.265366E-02    1.177854E+01
  ...
</pre></div>


<p>for toptic_4_0001_0001-linopt.out. This small difference is due to the number
of bands (nband=20 for toptic_2_0001_0001-linopt.out and nband=9 for toptic_4_0001_0001-linopt.out).</p>
<p>Then, you can increase the number of k points, and watch the change in the
imaginary part of the spectrum. There will be more and more peaks, until they
merge, and start to form a smooth profile (still not completely smooth with 28x28x28). 
For information, we give some timings of the corresponding ABINIT run for a 2.8 GHz PC:</p>
<div class="codehilite"><pre><span></span>k-point grid     CPU time
4x4x4            8 secs
6x6x6            20 secs
8x8x8            43 secs
10x10x10         80 secs
12x12x12         138 secs
16x16x16         338 secs
20x20x20         702 secs
24x24x24         1335 secs
28x28x28         2633 secs
</pre></div>


<p>For grids on the order of 16x16x16, the treatment by optics also takes several
minutes, due to IO (30 minutes for the 28x28x28 grid).<br />
You might note how the first peak slowly develop with increasing number of k
points but nevertheless stays much smaller than the converged one, and
even smaller than the experimental one.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../nuc/" title="Nuc" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Nuc
              </span>
            </div>
          </a>
        
        
          <a href="../positron/" title="Positron" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Positron
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (SS, XG, YG)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>