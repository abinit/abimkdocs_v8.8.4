



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/guide/respfn/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Respfn - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // matchcal version
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // acronyms
                KS: "{\\text{KS}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // symbols commonly used
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#the-dfpt-code" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  User Guide
                </span>
              
            
            Respfn
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.8.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link md-tabs__link--active">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Respfn
      </label>
    
    <a href="./" title="Respfn" class="md-nav__link md-nav__link--active">
      Respfn
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-introducing-the-computation-of-responses" title="0 Introducing the computation of responses" class="md-nav__link">
    0 Introducing the computation of responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-description-of-perturbations" title="1 Description of perturbations" class="md-nav__link">
    1 Description of perturbations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-filenames-and-input-of-ground-state-wavefunctions" title="2 Filenames and input of ground-state wavefunctions" class="md-nav__link">
    2 Filenames and input of ground-state wavefunctions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-use-of-symmetries" title="3 The use of symmetries" class="md-nav__link">
    3 The use of symmetries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-organisation-of-response-function-computations" title="4 Organisation of response-function computations" class="md-nav__link">
    4 Organisation of response-function computations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-list-of-relevant-input-variables" title="5 List of relevant input variables" class="md-nav__link">
    5 List of relevant input variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-different-output-files" title="6 The different output files" class="md-nav__link">
    6 The different output files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-numerical-quality-of-the-calculations" title="7 Numerical quality of the calculations" class="md-nav__link">
    7 Numerical quality of the calculations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-12" type="checkbox" id="nav-1-12">
    
    <label class="md-nav__link" for="nav-1-12">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-12">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_MacOSX/" title="MacOSX" class="md-nav__link">
      MacOSX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../README_xlf/" title="Xlf" class="md-nav__link">
      Xlf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorial/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-introducing-the-computation-of-responses" title="0 Introducing the computation of responses" class="md-nav__link">
    0 Introducing the computation of responses
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-description-of-perturbations" title="1 Description of perturbations" class="md-nav__link">
    1 Description of perturbations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-filenames-and-input-of-ground-state-wavefunctions" title="2 Filenames and input of ground-state wavefunctions" class="md-nav__link">
    2 Filenames and input of ground-state wavefunctions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-use-of-symmetries" title="3 The use of symmetries" class="md-nav__link">
    3 The use of symmetries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-organisation-of-response-function-computations" title="4 Organisation of response-function computations" class="md-nav__link">
    4 Organisation of response-function computations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-list-of-relevant-input-variables" title="5 List of relevant input variables" class="md-nav__link">
    5 List of relevant input variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-different-output-files" title="6 The different output files" class="md-nav__link">
    6 The different output files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-numerical-quality-of-the-calculations" title="7 Numerical quality of the calculations" class="md-nav__link">
    7 Numerical quality of the calculations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/guide/respfn.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="the-dfpt-code">The DFPT code<a class="headerlink" href="#the-dfpt-code" title="Permanent link">&para;</a></h1>
<p>This page complements the main <a class="wikilink user-guide-wikilink" href="../abinit">abinit help file</a>, for matters related
to responses to perturbations computed with DFPT.
It will be easier to discover the present file with the help of the <a class="wikilink lesson-wikilink" href="../../tutorial/rf1">rf1 lesson</a>.  </p>
<p><a id="intro"></a> </p>
<h2 id="0-introducing-the-computation-of-responses">0 Introducing the computation of responses<a class="headerlink" href="#0-introducing-the-computation-of-responses" title="Permanent link">&para;</a></h2>
<p>ABINIT can compute the response to different perturbations, and provide access
to quantities that are second derivatives of total energy (2DTE) with respect
to these perturbations. 
Presently, they can be of four types: </p>
<ol>
<li>phonons </li>
<li>static homogeneous electric field</li>
<li>strain  </li>
<li>magnetic field (coupling to the spin, not the orbital motion)</li>
</ol>
<p>The physical properties connected to 2DTE with respect to perturbations (1) and (2) are the phonon
dynamical matrices, the dielectric tensor, and the Born effective charges,
while the additional strain perturbation (3), mixed with phonon and electric
field leads to elastic constant, internal strain, and piezoelectricity.
The magnetic field perturbation is a recent addition to ABINIT, and will not be detailed at present.</p>
<p>More functionalities of the computation of responses should be implemented
sooner or later. Some third derivatives of the
total energy (3DTE) are also implemented. The 3DTE might give phonon-phonon
coupling, non-linear electric response, anharmonic elastic constants, Gruneisen parameters,&hellip;</p>
<p>The basic quantities that ABINIT will compute are the <strong>first-order</strong> derivatives
of the wavefunctions (1WF) with respect to these perturbations. The later
calculation of the 2DTE and 3DTE from these 1WF is an easy computational task:
the construction of the 2DTE with respect to perturbations j1 and j2
involves mainly evaluating matrix elements between the 1WF of j1 and/or the 1WF of j2. 
More details on this technique can be found in <a class="wikilink citation-wikilink" data-content="First-principles responses of solids to atomic displacements and homogeneous electric fields: Implementation of a conjugate-gradient algorithm" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1997">[Gonze1997]</a> and <a class="wikilink citation-wikilink" data-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1997a">[Gonze1997a]</a>.</p>
<p>The calculation of the 1WF for a particular perturbation is done using a
variational principle and an algorithm rather similar to the one used to find
the unperturbed ground-state wavefunctions. Thus, a lot of technical details
and parameters are the same for both ground-state and response-function
calculations. This justifies the development of one unique code for these two
classes of properties: many of the routines of abinit are common in these
calculations, or had to be duplicated, but with relatively small modifications.</p>
<p>The ABINIT code performs a rather primitive analysis of the calculated 2DTEs.
For example, it gives the phonon frequencies, electronic dielectric tensor and
effective charges. But the main output of the code is the Derivative DataBase
(DDB): a file that contains the set of all 2DTEs and 3DTEs calculated by the
code. This DDB can be manipulated by the MRGDDB code, and fully analyzed by
the Anaddb code. See the corresponding <a class="wikilink user-guide-wikilink" href="../mrgddb">mrgddb help file</a> and <a class="wikilink user-guide-wikilink" href="../anaddb">anaddb help file</a>.</p>
<p><a id="1"></a></p>
<h2 id="1-description-of-perturbations">1 Description of perturbations<a class="headerlink" href="#1-description-of-perturbations" title="Permanent link">&para;</a></h2>
<p>The perturbation of the <strong>phonon</strong> type is the displacement of one atom along
one of the axis of the unit cell, by a unit of length (in reduced coordinates).
It is characterized by two integer numbers and one wavevector.
The two integer numbers are the number of the moved atom, which will be noted
<strong>ipert</strong>, and the number of the axis of the unit cell, which will be noted <strong>idir</strong>. </p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><em>ipert</em> for phonon perturbation can have values between 1 and <a class="wikilink codevar-wikilink" href="../../variables/basic#natom">natom</a>,
<em>idir</em> can have values between 1 and 3.</p>
</div>
<p>The set of all possible phonon perturbations for one wavevector has thus 3 * <a class="wikilink codevar-wikilink" href="../../variables/basic#natom">natom</a> elements. 
From this basis set, all phonons can be constructed by linear combination. 
The set of atoms to be moved in one dataset of ABINIT is determined by the input
variable <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a>. The set of directions to be considered in one dataset of
ABINIT is determined by the input variable <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a>. The wavevector to be
considered in one dataset of ABINIT is determined by the input variables
<a class="wikilink codevar-wikilink" href="../../variables/gstate#nqpt">nqpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#qpt">qpt</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptnrm">qptnrm</a>.</p>
<p>The perturbations of the <strong>electric field</strong> type are</p>
<ul>
<li>the application of the homogeneous electric field along the axes of the reciprocal lattice </li>
<li>the derivative of the Hamiltonian with respect to the electronic wavevector along 
    the axes of the Brillouin zone (which gives derivatives of wavefunctions with respect to their wavevector), 
    an <strong>auxiliary</strong> quantity needed <strong>before</strong> the application of the homogeneous electric field. 
    The perturbation is the change of wavevector by dk in the Hamiltonian, hence the perturbation 
    is referred to as the derivative dk perturbation (&ldquo;ddk&rdquo; perturbation). </li>
</ul>
<dl>
<dt>Note 1</dt>
<dd>the ddk perturbation is defined as the derivative with respect to k
in reduced coordinates; this is equivalent to applying a linear perturbation
of strength 2*pi along the conjugate direction in real space. This statement
comes from the derivation of the phase factor exp(i*2*pi*k*r) with respect to
k in reduced coordinates.</dd>
<dt>Note 2</dt>
<dd>in case the electric field type perturbation is computed inside a
finite electric field, the derivative of the Hamiltonian with respect to the
electronic wavevector is not computed: everything is done by a finite-
difference technique. Also, the definition of the homogeneous electric field
perturbation is not along the axes of the reciprocal lattice, but in cartesian
coordinates. Sorry for the possible confusion &hellip;</dd>
</dl>
<p>These electric-type perturbations are also characterized by two numbers:
<em>ipert</em> being natom + 1 for the ddk perturbation and natom + 2 for the electric
field, and <em>idir</em> being 1, 2 or 3, as for phonon perturbations. Although the
possibility of electric field characterized by a non-zero wavevector is
envisioned for a future version of the code, at present only homogeneous
fields are considered. So the wavevector of the electric field type
perturbations is <script type="math/tex">\Gamma</script> (q=0).</p>
<p>The perturbations of the <strong>strain</strong> type are either an uniaxial strain or a
shear strain. The strain perturbations are considered in cartesian coordinates
(x,y,z). They are characterized by two numbers, with <em>ipert</em> being natom + 3 for
the uniaxial strains, and natom + 4 for the shear strains, and <em>idir</em> describes
the particular component. </p>
<p>Explicitly, for uniaxial strains:</p>
<ul>
<li>idir = 1 gives the xx strain perturbation, </li>
<li>idir = 2 gives the yy strain perturbation, </li>
<li>idir = 3 gives the zz strain perturbation, </li>
</ul>
<p>while for shear strains:</p>
<ul>
<li>idir=1 gives the yz strain perturbation, </li>
<li>idir=2 gives the xz perturbation, </li>
<li>idir=3 gives the xy perturbation.  </li>
</ul>
<p>Note that the &ldquo;rigid-atom&rdquo; elastic constants, as output of ABINIT, are those
obtained with <strong>frozen</strong> internal coordinates. The internal coordinate
relaxation, needed to give &ldquo;physical&rdquo; elastic constants can be handled through
the knowledge of the internal strain and dynamical matrix at Gamma, in ANADDB.
Of course, if all the internal coordinate are fixed by symmetry, all the
internal strains vanish, and the &ldquo;rigid-atom&rdquo; and &ldquo;physical&rdquo; elastic constants are equal.<br />
Limitations of the present implementation (as of v5.7):</p>
<ul>
<li>Symmetry is presently used to skip redundant k points in the BZ sum, 
    but not to skip redundant strain perturbations.</li>
</ul>
<p>We also define the index of the perturbation, called <em>pertcase</em>, equal to idir + 3*ipert. 
Accordingly, pertcase runs from 1 to 3 * (natom + 4), and will be
needed to identify output and input files, see section 6.</p>
<div class="admonition summary">
<p class="admonition-title">Summary</p>
<p>To summarize, the perturbations are characterized by two numbers, <strong>ipert</strong> from
1 to natom + 4, and <strong>idir</strong>, from 1 to 3, as well as one wavevector (that is
gamma when a non-phonon perturbation is considered). A number called
<strong>pertcase</strong> combines <em>ipert</em> and <em>idir</em>, and runs from 1 to 3 * (natom + 4).</p>
</div>
<p>The 2DTE, being derivative of the total energy with respect to two
perturbations, will be characterized by two sets of (idir,ipert), or by two
pertcase numbers, while 3DTE will need three such sets or pertcase numbers.
In addition they will depend on one wavevector (for 2DTE) or two wavevectors (for 3DTE).</p>
<p>In the non-stationary implementation of the 2DTE, used for off-diagonal elements in ABINIT, the first pertcase
corresponds to the perturbation that gives the derivative of the potential,
and the second pertcase corresponds to the perturbation that gives the
derivative of the wavefunctions.</p>
<p><a id="2"></a></p>
<h2 id="2-filenames-and-input-of-ground-state-wavefunctions">2 Filenames and input of ground-state wavefunctions<a class="headerlink" href="#2-filenames-and-input-of-ground-state-wavefunctions" title="Permanent link">&para;</a></h2>
<p>The <strong>same</strong> &lsquo;files&rsquo; file as for GS calculations is used for RF calculations.
Actually, in the multi-dataset mode, one will be able to make in one ABINIT
run, ground-state computations as well as response-function computations, so
that the &lsquo;files&rsquo; file must be the same.... The &lsquo;input&rsquo; file will have many
common input variables for these different cases, but also some separate ones.</p>
<p>Two ground-state wavefunction files might be needed:</p>
<ul>
<li>the file of ground-state wavefunctions at a set of wavevectors, named k-points</li>
<li>the file of ground-state wavefunctions at the corresponding k+q, where q is the wavevector of the perturbation</li>
</ul>
<p>These files also contain the corresponding eigenvalues.</p>
<p>Note that the second file (k+q) will be identical to the first one (k), in the
case of zero-wavevector perturbation. Also, if the q-wavevector maps the
k-point grid onto itself (q being the difference between points that belong to
the grid), all the information on the k+q grid is contained in the k grid, a
fact that ABINIT is able to exploit.</p>
<p>One should have a look at the input variables <a class="wikilink codevar-wikilink" href="../../variables/files#irdwfk">irdwfk</a>, and <a class="wikilink codevar-wikilink" href="../../variables/files#irdwfq">irdwfq</a>, for
a description of the ground-state wavefunction file names generated from the
root names provided in the &lsquo;files&rsquo; file. In the multi-dataset mode, the
following input variables will be relevant: <a class="wikilink codevar-wikilink" href="../../variables/files#getwfk">getwfk</a>, and <a class="wikilink codevar-wikilink" href="../../variables/files#getwfq">getwfq</a>. The
file names of the ground-state wavefunction file follow the same convention as
for the ground-state case. Thus, the corresponding section of the 
<a class="wikilink user-guide-wikilink" href="../abinit#files-file">corresponding section</a> of the abinit help file, if needed.</p>
<p>In the case of an electric field perturbation, the output 1WF of the
corresponding ddk perturbation is needed as input. If the option <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>=1
is used, then the code will take care of doing first the derivative dk
perturbation calculation, then write the 1WF at the correct place, as an
output file, then begin the homogeneous field perturbation calculation.
Usually, the use of <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>=1 is not recommended, as the ddk computation is
the most often done with different parameters as the electric field perturbation,
a dataset with <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>=2 being followed with a dataset with <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a>=3.</p>
<p>The nomenclature for first-order wavefunction files is also given in the
<a class="wikilink user-guide-wikilink" href="../abinit#files-file">abinit help</a> file, but it is worth to specify it in more
detail here. The root name is formed from the string of character in the third
line of the &lsquo;files&rsquo; file (for an input file) or the fourth line of the &lsquo;files&rsquo;
file (for an output file), that is complemented, in the multi-dataset mode, by
&lsquo; <strong>_DS</strong> &lsquo; and the dataset pertcase (the index of the perturbation). Then,
the string &lsquo; <strong>_1WF</strong> &lsquo; is added, followed by pertcase. This gives, e.g., for
a &lsquo;files&rsquo; file whose fourth line is &lsquo;/tmp/o&rsquo;, for the dataset number 3, and a
perturbation corresponding to the displacement of the second atom in the x
direction (pertcase=4), the following name of the corresponding 1<sup>st</sup>-order
wavefunction output file:</p>
<div class="codehilite"><pre><span></span> /tmp/o_DS3_1WF4
</pre></div>


<p>Such a file might be used as input of another computation, or of another dataset.</p>
<p>The relevant input variables are: <a class="wikilink codevar-wikilink" href="../../variables/files#ird1wf">ird1wf</a>, and <a class="wikilink codevar-wikilink" href="../../variables/files#irdddk">irdddk</a>, as well as
<a class="wikilink codevar-wikilink" href="../../variables/files#get1wf">get1wf</a>, and <a class="wikilink codevar-wikilink" href="../../variables/files#getddk">getddk</a>, in the multi-dataset mode.</p>
<p><a id="symmetries"></a></p>
<h2 id="3-the-use-of-symmetries">3 The use of symmetries<a class="headerlink" href="#3-the-use-of-symmetries" title="Permanent link">&para;</a></h2>
<p>In order to understand correctly the behaviour of response-function runs, 
some information on the use of symmetries must be given.</p>
<p>Some perturbations (including their wavevector) may be invariant for some
symmetries. The code is able to use symmetries to skip perturbations of which a
symmetric has already been calculated (except in the case of strain
perturbations). ABINIT is also able to use the symmetries that keeps the
perturbations invariant to reduce the number of k points needed for the
sampling of electronic wavefunctions in the Brillouin zone (although this
feature is not optimal yet). There is one exception to this, the ddk
perturbation, for which the spatial symmetries cannot be used yet.</p>
<p>In any case, unlike for the ground-state, the input k-point set for response
function should NOT have been decreased by using spatial symmetries, prior to
the loop over perturbations (see section 4). Only the time-reversal symmetry,
retained by calculations at q=0, ought to be used to decrease this input
k-point set. Considering each perturbation in turn, ABINIT will be able to
select from this non-reduced set of k-points, the proper k-point set,
automatically, by using the symmetries that leave each perturbation invariant.</p>
<p>Accordingly, the preferred way to generate the k-point grid is of course to
use the <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../../variables/gstate#kptrlatt">kptrlatt</a> input variables, with different values of <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>:</p>
<ul>
<li>kptopt = 1 for the ground state</li>
<li>kptopt = 2 for response functions at q=0 </li>
<li>kptopt = 3 for response functions at non-zero q </li>
</ul>
<p><a id="4"></a></p>
<h2 id="4-organisation-of-response-function-computations">4 Organisation of response-function computations<a class="headerlink" href="#4-organisation-of-response-function-computations" title="Permanent link">&para;</a></h2>
<p>In agreement with the information provided in the previous sections, different
cases can be distinguished.</p>
<p>When one considers the response to an atomic displacement with q=0, the
following procedure is suggested:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, a self-consistent response-function computation with the atomic displacement perturbation, 
    with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2)</p>
</li>
</ul>
<p>When one considers the response to an electric field (with q=0), the following
procedure is suggested:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, a non-self-consistent response-function computation of the d/dk perturbation, 
    with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2, and <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=-3)</p>
</li>
<li>
<p>third, a self-consistent response-function computation of the electric field perturbation, 
    with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2)</p>
</li>
</ul>
<p>When one considers the response to an atomic displacement in the special case
where q connects k-points that both belong to the special k-point grid, the
following procedure is suggested:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, a self-consistent response-function computation of the atomic displacement perturbation, 
    with the full set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=3)</p>
</li>
</ul>
<p>When one considers the response to an atomic displacement for a general q
point, the following procedure is suggested:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, a non-self-consistent ground-state run with the set of k+q points, that might be 
    reduced thanks to symmetries (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>third, a self-consistent response-function computation of the atomic displacement perturbation, 
    with the full set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=3)</p>
</li>
</ul>
<p>Of course, these different steps can be combined when a set of responses is
looked for. In particular, the computations of responses at gamma, in the case
where the full dynamical matrix as well as the dielectric tensor and the Born
effective charges are needed, can be combined as follows:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, the three non-self-consistent response-function computations (one for each direction) 
    of the d/dk perturbation, with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2, and <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=-3)</p>
</li>
<li>
<p>third, all the self-consistent response-function computations of the electric field perturbations 
    and of the atomic displacements, with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2)</p>
</li>
</ul>
<p>Still, computations of perturbations at different q wavevectors cannot be
mixed. But they can follow the other computations. Supposing that
perturbations at q=0 and a general q point are to be performed, they will be combined as follows:</p>
<ul>
<li>
<p>first, a self-consistent ground-state computation with the restricted set of k-points 
    in the Irreducible Brillouin Zone (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>second, the three non-self-consistent response-function computations (one for each direction) 
    of the d/dk perturbation, with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2, and <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=-3)</p>
</li>
<li>
<p>third, all q=0 self-consistent response-function computations of the electric field perturbations 
    and of the atomic displacements, with the half set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=2)</p>
</li>
<li>
<p>fourth, a non-self-consistent ground-state computation with the set of k+q points, 
    that might be reduced thanks to symmetries (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=1)</p>
</li>
<li>
<p>fifth, the self-consistent response-function computations of the atomic displacement perturbations 
    with a q wavevector, with the full set of k-points (with <a class="wikilink codevar-wikilink" href="../../variables/basic#kptopt">kptopt</a>=3)</p>
</li>
</ul>
<p>Note that the error in the 2DTE is <strong>linear</strong> in the <strong>ground-state</strong>
wavefunction error (unlike the error due to the 1WFs). Moreover, a large
prefactor is associated with this source of error (it can even cause cause the
instability of the SCF procedure). As a consequence, the convergence of the
ground-state wavefunction should be very good. The same is true at the level
of the ddk wavefunctions.</p>
<p>As mentioned in the introduction, inside the response-function part of the
code, the calculation proceeds in two steps: first the calculation of the
first order derivative of the wavefunctions (1WF), then the combinations of
these 1WF to build the 2DTE and 3DTE.</p>
<p>In an initialisation part, the input file and all the ground-state files are
read, and a few basic quantities are constructed.</p>
<p>In the first part, every perturbation is examined, one at a time, separately:</p>
<ul>
<li>
<p>A file containing previous RF wavefunctions is eventually read.</p>
</li>
<li>
<p>The minimisation of the variational expression is performed, and this procedure generates 
    the 1WF as well as the first-order density and potential.</p>
</li>
<li>
<p>It is possible, knowing these quantities for the perturbation ipert1, to construct all the 2DTE 
    with respect to this perturbation and any ipert2, except for ipert2 being an homogeneous electric field, 
    in which case the derivative of the ground-state wavefunctions with respect to their wavevector (ddk) is also needed. 
    This feature has been implemented for ipert2 being any phonon (of the same wavevector than ipert1), 
    or an homogeneous electric field.</p>
</li>
<li>
<p>The first-order wavefunctions (1WF) are written as well as the first-order density or potential (if requested).</p>
</li>
</ul>
<p><a id="5"></a></p>
<h2 id="5-list-of-relevant-input-variables">5 List of relevant input variables<a class="headerlink" href="#5-list-of-relevant-input-variables" title="Permanent link">&para;</a></h2>
<p>A subset of the ABINIT input variables have a modified meaning or a modified
behaviour in case of RF calculations. Here is the list of these input
variables, together with the variables that applies only to RF computations.
Note that the code will do a RF calculation (<a class="wikilink codevar-wikilink" href="../../variables/gstate#optdriver">optdriver</a>=1) when one of
<a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a> or <a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a> is non-zero.</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/rlx#amu">amu</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/files#getwfk">getwfk</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#getwfq">getwfq</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#get1wf">get1wf</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#getddk">getddk</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/files#irdwfk">irdwfk</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#irdwfq">irdwfq</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#ird1wf">ird1wf</a>, <a class="wikilink codevar-wikilink" href="../../variables/files#irdddk">irdddk</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#nqpt">nqpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#qpt">qpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/gstate#qptnrm">qptnrm</a> </li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfasr">rfasr</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfatpol">rfatpol</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfdir">rfdir</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfelfd">rfelfd</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#rfphon">rfphon</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/dfpt#dfpt_sciss">dfpt_sciss</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a></li>
</ul>
<p><a id="output"></a></p>
<h2 id="6-the-different-output-files">6 The different output files<a class="headerlink" href="#6-the-different-output-files" title="Permanent link">&para;</a></h2>
<p>Output from the code goes to several places listed below.</p>
<p><strong>6.1. The log file</strong></p>
<p>This file is the same as the log file of the abinit code when computing ground
state (GS) results. Possibly, the output of datasets related to response
functions will be intertwined with those concerned with ground-state case. The
purpose of this file is the same as in the GS case, and the use of error messages is unchanged.</p>
<p><a id="6.2"></a>
<strong>6.2. The main output file</strong></p>
<p>This file is the same as the main output file of the abinit code when
computing ground state (GS) results. Possibly, the output of datasets
related to response functions will be intertwined with those concerned with
ground-state case. We explain here the parts related to the RF computation.</p>
<p>The initialisation part is the same as for the GS. So, the reader is advised
to read the <a class="wikilink user-guide-wikilink" href="../abinit#outputfile">section 6.2</a> of the abinit help file,
as well as the first paragraph of the section <a class="wikilink user-guide-wikilink" href="../abinit#6.3">6.3</a> of
this file. Afterwards, the content of the main output file differs a bit&hellip;</p>
<p>The main output file reports on the initialisation of the ground-state
wavefunctions at k+q, then the loop on the perturbations begins. For each
perturbation, there is:</p>
<ul>
<li>a short description of the perturbation</li>
<li>the timing information</li>
<li>the report on the initialisation of the 1WF</li>
<li>then the iterations for the minimisation begin, and the output file describes 
    the number of the iteration, the second derivative of the total energy obtained (2DTEnergy in Ha), 
    the change in 2DTEnergy since last iteration, the maximum residual over all bands and k points, 
    and the square of the potential residual.</li>
<li>after the iterations are completed, the residuals are reported</li>
<li>in case of the derivative dk perturbation, ek2 (to be explained) and the f-sum rule ratio value are printed. 
    The f-sum rule ratio should be close to 1 (not when ecutsm/=0, however).</li>
<li>then the components of the 2DTEnergy, broken in at most 14 pieces, depending on the perturbation</li>
<li>then the 2DTEnergy in Hartree and in eV</li>
<li>then the relaxation contribution (caused by changes in wavefunctions), and the non-relaxation contribution 
    (Ewald and frozen-wavefunction contribution)</li>
<li>then the 2DTEnergy evaluated using a non-variational expression.</li>
</ul>
<p>After the computation of each perturbation, the output file reports on the
2DTE matrix elements. This part is not executed if the only perturbation is
the derivative dk perturbation. It will give the following information:</p>
<ul>
<li>if <a class="wikilink codevar-wikilink" href="../../variables/files#prtvol">prtvol</a>=1 or bigger, the full detail of every contribution to the 2DTE in reduced coordinates.</li>
<li>the 2DTE in reduced coordinates.</li>
<li>then it will use the 2DTE to perform already some analysis of the data without use the Mrgddb and Anaddb codes, namely: 
    the full dynamical matrix (cartesian coordinates, masses included) the effective charges, and the dielectric tensor, 
    the phonon frequencies (including the analysis of the non- analyticity if we are at Gamma). 
    Note that phonon frequencies lower than 1.0d-8Ha (absolute value) are automatically set to zero, 
    while imaginary phonon frequencies (square roots of negative eigenvalues - indicating an instability) 
    are printed as negative (this facilitates the post-processing).</li>
</ul>
<p>For this last analysis, the code assumes that the whole set of perturbations
in a class has been calculated, either all the phonon perturbations or the
homogeneous electric field perturbation, or both. If this is not true, the
code will give results that may be wrong in the case that the reduced system
of coordinates is not cartesian (for the dynamical matrix, the effective
charge tensor of the dielectric matrix), or in all case wrong (the phonon
frequencies); also the code will put zero in the matrix elements that have not been calculated. 
A Warning message is issued if the above information cannot be trusted.</p>
<p>Finally, the code provides the timing information.</p>
<p><a id="6.3"></a>
<strong>6.3. The first-order wavefunction (1WF) files</strong></p>
<p>These are unformatted data files containing the planewaves coefficients of all
the wavefunctions, written in the following format. First, the header (see
<a class="wikilink user-guide-wikilink" href="../abinit#header">section 6.4</a> of the abinit help file), followed by</p>
<div class="codehilite"><pre><span></span>     <span class="n">bantot</span><span class="o">=</span><span class="mi">0</span>                                    <span class="o">&lt;--</span> <span class="n">counts</span> <span class="n">over</span> <span class="k">all </span><span class="n">bands</span>
     <span class="nb">index</span><span class="o">=</span><span class="mi">0</span>                                     <span class="o">&lt;--</span> <span class="nb">index </span><span class="n">for</span> <span class="n">the</span> <span class="n">wavefunctions</span>
     <span class="k">do </span><span class="n">isppol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nsppol</span>
      <span class="k">do </span><span class="n">ikpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nkpt</span>
       <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="n">npw1</span><span class="p">,</span><span class="n">nspinor</span><span class="p">,</span><span class="n">nband</span>                    <span class="o">&lt;--</span> <span class="n">for</span> <span class="n">each</span> <span class="n">k</span> <span class="n">point</span>
       <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="n">kg</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">npw1</span><span class="p">)</span>                        <span class="o">&lt;--</span> <span class="n">plane</span> <span class="n">wave</span> <span class="n">reduced</span> <span class="n">coordinates</span>
       <span class="k">do </span><span class="n">iband</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nband1</span>
        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="p">(</span><span class="n">eigen1</span><span class="p">(</span><span class="n">jband</span><span class="o">+</span><span class="p">(</span><span class="n">iband</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nband</span><span class="o">+</span><span class="n">bantot</span><span class="p">),</span><span class="n">jband</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">nband</span><span class="p">)</span>  <span class="o">&lt;--</span> <span class="n">column</span> <span class="n">of</span> <span class="n">eigenvalue</span> <span class="n">matrix</span>
        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="p">(</span><span class="n">cg</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="nb">index</span><span class="p">),</span><span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">npw1</span><span class="o">*</span><span class="n">nspinor</span><span class="p">)</span>   <span class="o">&lt;--</span> <span class="n">wavefunction</span> <span class="n">coefficients</span>
       <span class="n">enddo</span>                                            <span class="n">for</span> <span class="n">a</span> <span class="n">single</span> <span class="n">band</span> <span class="nb">and </span><span class="n">k</span> <span class="n">point</span>
       <span class="n">bantot</span><span class="o">=</span><span class="n">bantot</span><span class="o">+</span><span class="n">nband</span>
       <span class="nb">index</span><span class="o">=</span><span class="nb">index</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">npw1</span><span class="o">*</span><span class="n">nspinor</span><span class="o">*</span><span class="n">nband1</span>
      <span class="n">enddo</span>
     <span class="n">enddo</span>
</pre></div>

<p>In this code section, npw1(ikpt) is the number of planewaves in the basis at
the k+q point, nband1(ikpt) is likewise the number of bands at the k point
(which may vary among k points depending on occopt), and the factor of 2 in
writing the wavefunction results from the fact that it is complex.<br />
eigen1 is the array that contains the matrix element of the first-order
Hamiltonian between the different ground-state wavefunctions. It could be used
to build the electron-phonon coupling and deformation potentials.<br />
Note that the format for first-order WF file differs from the format used for
the ground-state WF file by the fact that eigen1 is now an array, and no more
a vector, and is written with the corresponding wf, and no more before the
writing of all wf for one k point.</p>
<p><strong>6.4. The first-order density files</strong></p>
<p>They consist of the header lines, followed by</p>
<div class="codehilite"><pre><span></span>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="p">(</span><span class="n">rhor1</span><span class="p">(</span><span class="n">ir</span><span class="p">),</span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cplex</span><span class="o">*</span><span class="n">ngfft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ngfft</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ngfft</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

<p>Here, rhor1 is the change of electron density in electrons/Bohr^3. The
parameter cplex is 1 when q=0 and 2 when q/=0 . Indeed, for q=0, the density
change is a real quantity, while it is complex in general when q/=0 .</p>
<p><a id="ddb"></a>
<strong>6.5. The derivative database (DDB)</strong></p>
<p>It is made of two parts. The first should allow one to unambiguously identify
the run that has generated the DDB, while the second part contains the 2DTE,
grouped by blocks of data.</p>
<p>Note that the DDB output of the ABINIT code can be merged with other DDBs as
described in the <a class="wikilink user-guide-wikilink" href="../mrgddb">Mrgddb help file</a>.</p>
<p>The first part contains:</p>
<ul>
<li>the DDB version number (that defines the structure of the DDB)</li>
<li>seven parameters needed for the dimensionning of the DDB file 
    (<a class="wikilink codevar-wikilink" href="../../variables/basic#natom">natom</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#nsym">nsym</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#ntypat">ntypat</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a>, and <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> - 
    or the array <a class="wikilink codevar-wikilink" href="../../variables/basic#nband">nband</a> (<a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a>* <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a>) if <a class="wikilink codevar-wikilink" href="../../variables/basic#occopt">occopt</a>=2)</li>
<li>different information on the run that generated the 2DTE 
    (<a class="wikilink codevar-wikilink" href="../../variables/basic#acell">acell</a>,<a class="wikilink codevar-wikilink" href="../../variables/rlx#amu">amu</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#ixc">ixc</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#kpt">kpt</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#kptnrm">kptnrm</a>, 
     <a class="wikilink codevar-wikilink" href="../../variables/gstate#ngfft">ngfft</a>,<a class="wikilink codevar-wikilink" href="../../variables/gstate#occ">occ</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#rprim">rprim</a>,<a class="wikilink codevar-wikilink" href="../../variables/dfpt#dfpt_sciss">dfpt_sciss</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#symrel">symrel</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#xred">xred</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#tnons">tnons</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#typat">typat</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>,<a class="wikilink codevar-wikilink" href="../../variables/basic#wtk">wtk</a>,<a class="wikilink codevar-wikilink" href="../../variables/internal#ziontypat">%ziontypat</a>, 
    as well as information on the pseudopotentials by means of their Kleinman-Bylander energies). 
    These values are simply a transcription of the input data, or other simple internal parameters.</li>
</ul>
<p>Note: the format and content of this first part of the DDBs have to be updated in the future &hellip;</p>
<p>The second part contains:</p>
<ul>
<li>the number of data blocks</li>
<li>for each data block, the type of the block, its number of elements, and the list of elements.</li>
</ul>
<p>The elements of a 2DTE block are described by 4 integers and 2 real numbers.
The 2 first integers define a first perturbation in the form (idir1,ipert1),
the two next define a second perturbation in the form (idir2,ipert2). The
matrix element corresponds to the derivative of the total energy with respect
to the parameters corresponding to these perturbations. The real numbers are
the real and imaginary parts of the 2DTE. Sometimes, the code uses spatial
symmetries, the time-reversal symmetry, or even the permutation of first and
second perturbations to deduce the value of non-computed matrix elements. This
behaviour might be improved, as it is sometimes confusing &hellip;</p>
<p><em>If you follow the tutorial, you should go back to the tutorial window now.</em></p>
<p><a id="numerical-quality"></a></p>
<h2 id="7-numerical-quality-of-the-calculations">7 Numerical quality of the calculations<a class="headerlink" href="#7-numerical-quality-of-the-calculations" title="Permanent link">&para;</a></h2>
<p>It is possible to get from the RF calculations essentially EXACT derivatives
of the total energy with respect to perturbations. There is a published
account of this fact in <a class="wikilink citation-wikilink" data-content="Adiabatic density-functional perturbation theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze1995">[Gonze1995]</a>. An agreement of 8 digits
or more was obtained in the comparison with finite-difference derivatives of GS data.</p>
<p>The accuracy of these calculations are thus entirely determined by the input
parameters the user choose for the RF run, and the preparatory GS runs.</p>
<p>We will now review the convergence parameters, usually the same as for the GS
calculations, indicating only the specific features related to RF calculations.</p>
<p>Input parameters that could influence the accuracy of the calculation are:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> (the energy cut-off, that depends strongly on the pseudopotential)</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#ixc">ixc</a> (describing the exchange-correlation functional)</li>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#nkpt">nkpt</a>(or, more accurately, the Brillouin zone sampling, that can be determined 
     alternatively by the inputs variables <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../../variables/gstate#kptrlatt">kptrlatt</a>)</li>
<li>one of the self-consistent convergence tolerance parameters, <a class="wikilink codevar-wikilink" href="../../variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a>, or <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a>.</li>
</ul>
<p>The input parameters <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>, <a class="wikilink codevar-wikilink" href="../../variables/rlx#ecutsm">ecutsm</a>, <a class="wikilink codevar-wikilink" href="../../variables/basic#ixc">ixc</a>, <a class="wikilink codevar-wikilink" href="../../variables/dev#intxc">intxc</a>, the set of
k-wavevectors, as well as the related variables have to be the SAME in the
ground-state calculations that go before a RF run and this RF run.</p>
<p>Namely: do not try to use ground-state wavefunction files produced with
<a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>=10Ha for a RF run with <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>=20Ha. In some cases, the code will complain
and stop, but in other cases, it might simply produce garbage !</p>
<p>If the value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#ngfft">ngfft</a> is input by hand, its value must also be equal in
the GS and RF cases. ALWAYS use <a class="wikilink codevar-wikilink" href="../../variables/gstate#ngfft">ngfft</a> large enough to have boxcut=2 or
larger, in order to avoid any FFT filter error. In the GS case, boxcut as
small as 1.5 could be allowed in some cases. It is not allowed with RF
calculations, because they are more sensitive to that error.</p>
<p>The convergence tests with respect to <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a>, and the k-point grid should be
done carefully. This was already emphasized in the <a class="wikilink user-guide-wikilink" href="../abinit">abinit help file</a> and is re-
emphasized here. The user should test the convergence DIRECTLY on the property
he or she is interested in. For example, if the user wants a phonon frequency
accurate to 10 cm^-1, he/she could be lead to do a full calculation (GS+RF) of
phonons at 30Ha, then another full calculation at 35Ha, then another at
40Ha&hellip; It is an error to rely on tolerance on the total energy (for example
1mHa/atom) or geometry (accuracy of one part per thousand on the bond lengths)
to draw &lsquo;a priori&rsquo; conclusions on the convergence of other quantities, and not
monitor the convergence of these directly. To be clear: if phonon frequencies
are needed, check the convergence of phonon frequencies !</p>
<p>The user should note that for bands with very small occupancy in the metallic
case as well as unoccupied bands for insulators, the ground state run
preceeding response function runs will not necessarily converge these
wavefunctions using usual ground-state tests such as <a class="wikilink codevar-wikilink" href="../../variables/basic#toldfe">toldfe</a> or (better)
<a class="wikilink codevar-wikilink" href="../../variables/basic#tolvrs">tolvrs</a>. To be sure that inaccuracies are not introduced into the response
function calculation by poorly converged unoccupied bands, a separate run
starting from a saved charge density (<a class="wikilink codevar-wikilink" href="../../variables/files#prtden">prtden</a>=1 in the self-consistent run)
and using <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>=-2 and <a class="wikilink codevar-wikilink" href="../../variables/basic#tolwfr">tolwfr</a> may be needed.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorial/" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link md-tabs__link--active">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorial/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../optic/" title="Optic" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Optic
              </span>
            </div>
          </a>
        
        
          <a href="../spacegroup/" title="Spacegroup" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Spacegroup
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.8.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 The Abinit Group (XG, DCA)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>